(function(k){var z=window.AmazonUIPageJS||window.P,D=z._namespace||z.attributeErrors,f=D?D("CheckoutWebappAssets",""):z;f.guardFatal?f.guardFatal(k)(f,window):f.execute(function(){k(f,window)})})(function(k,z,D){"use strict";k.when("A","jQuery","utils/createClass").register("components/Component",function(f,a,e){var g=e({$el:null,props:{},defaultProps:{},init:function(d){this.$el=a(d.$el);if(1<this.$el.length)throw Error("Component must be attached with only one DOM element");if(!this.$el.length)return this;
this.bindAll();this.props=a.extend({},this.defaultProps,d);this.onInit(this.props)},onInit:a.noop,find:function(d){return this.$el.find(d)},bindAll:function(){for(var d in this)"function"===typeof this[d]&&(this[d]=a.proxy(this[d],this))},data:function(){return this.$el.data.apply(this.$el,arguments)}});g.create=function(d){var h=this;return d.$el.length?f.map(d.$el,function(c){return new h(f.extend({},d,{$el:a(c)}))}):[]};g.extend=function(){function d(c){c=a.call(this,c);c.extend=d;c.create=g.create;
return c}var a=g.extend;return d}();return g});"use strict";k.when("jQuery","components/Component","weblab-helper").register("components/Checkbox",function(f,a,e){return a.extend({checkbox:null,$el:null,defaultProps:{onChange:f.noop},onInit:function(){if(e.isPyoClientSideInitiationEnabled()){if(!this.$el.length||!this.$el.is(":checkbox"))throw Error("[Checkbox] No checkbox input is found");this.$el.bind("change",this.handleChange)}else{if(!this.$el.hasClass("a-checkbox"))throw Error("[Checkbox] Checkbox component must instantiate with an `a-checkbox` element");
this.$input=this.find(":checkbox");if(!this.$input.length)throw Error("[Checkbox] No checkbox input is found");this.$input.bind("change",this.handleChange)}},handleChange:function(a){this.props.onChange(this.isChecked(),this,a)},isChecked:function(){return e.isPyoClientSideInitiationEnabled()?this.$el.is(":checked"):this.$input.is(":checked")},data:function(a,d){return this.$el.data(a,d)}})});"use strict";k.when("A","jQuery","components/Component","components/Checkbox","weblab-helper").register("components/PrimaryActionBlockerCheckbox",
function(f,a,e,g,d){function h(){var a=f.reduce(c,function(a,c){var h="";if(a.blocking)return a;d.isPyoClientSideInitiationEnabled()?(a=c.shouldBlock())&&(h=c.getBlockerMessage()):(a=!c.isChecked())&&(h=c.data("blocker-message"));return{blocking:a,message:h}},{blocking:null,message:""});f.equals(a,l)||(l=a,f.trigger(m.blockingStateChanged,a))}var c=[],l={blocking:null,message:""},m={blockingStateChanged:"checkbox:primaryActionBlocker:blockingStateChanged"};e=e.extend({onInit:function(a){d.isPyoClientSideInitiationEnabled()?
(this.checkbox=new g({$el:this.$el,onChange:h}),this.blockerMessage=a.blockerMessage,c.push(this)):(this.checkbox=new g({$el:this.$el,onChange:h}),c.push(this.checkbox));h()},shouldBlock:function(){return!this.$el.is(":checked")},getBlockerMessage:function(){return this.blockerMessage}});e.events=m;e.tryChangingBlockingState=h;e.getState=function(){return c.length?a.extend({},l):null};var p=d.isPyoClientSideInitiationEnabled()?"checkout:unload":"checkout:beforeReload";f.on(p,function(){c=[];l={blocking:null,
message:""}});return e});"use strict";k.register("configurations/keys",function(){var f={VIEW_TYPE:"VIEW_TYPE",CONTAINER_SELECTOR:"CONTAINER_SELECTOR",PURCHASE_ID_SELECTOR:"PURCHASE_ID_SELECTOR",validate:function(a){if("string"!==typeof a||!f[a])throw Error('The key "'+a+'" is not defined within "configurations/keys".');}};return f});"use strict";k.when("configurations/keys").register("configurations/newCheckoutExperienceConfig",function(f){var a={};a[f.VIEW_TYPE]="newCheckoutExperience";a[f.CONTAINER_SELECTOR]=
"#checkout-experience-container";a[f.PURCHASE_ID_SELECTOR]='input[name\x3d"purchaseId"]';return{getConfiguration:function(e){return e in a?a[e]:null}}});k.when("A").register("utils/createClass",function(f){function a(){}if(f.createClass)return f.createClass;var e=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;a.extend=function(g){var d=this.prototype,h=Object.create?Object.create(d):function(a){function d(){}d.prototype=a;return new d}(d),c;for(c in g)h[c]="function"===typeof g[c]&&"function"===typeof d[c]&&
e.test(g[c])?function(a,c){return function(){var h=this._super;this._super=d[a];var e=c.apply(this,arguments);this._super=h;return e}}(c,g[c]):g[c];g="function"===typeof h.init?h.hasOwnProperty("init")?h.init:function(){d.init.apply(this,arguments)}:function(){};g.prototype=h;h.constructor=g;g.extend=a.extend;return g};return function(e){return a.extend(e)}});"use strict";k.when("A","client-side-metrics","utils/redirectionUtils","utils/urlConstants").register("utils/pageConductor",function(f,a,e,
g){return{redirectToGurupa:function(a){e.redirectInCurrentTab(g.GURUPA_URL,a)},replaceDisplayContent:function(a,h){0<a.length&&a.replaceWith(h)}}});"use strict";k.when("A","client-side-metrics").register("utils/redirectionUtils",function(f,a){function e(d,h,c,e){d&&0<d.length?(a.setCountValue("checkout:"+h+":startRedirection",1),z.open(g(d,c),e?"_blank":"_self")):a.setCountValue("checkout:"+h+":emptyUrl",1)}function g(a,h){var c=Object.keys(h).map(function(a){return a+"\x3d"+h[a]});return 0<c.length?
a+(-1<a.indexOf("?")?"\x26":"?")+c:a}return{redirectInCurrentTab:function(a,h,c){e(a,h,c||{},!1)},openInNewTab:function(a,h,c){e(a,h,c||{},!0)}}});"use strict";k.register("utils/smsMessageValidator",function(){var f=/^[\n\r !-Z[\]\\^_a-~¡£¤¥§¿ÄÅÆÇÉÑÓÖØÜßàäåæçèéìñòóöøùüĄąĆćĘęĞğİıŁłŃńŚśŞşŹ-żΓΔΘΛΞΠΣΦΨΩ€]*$/;return{isValid:function(a){return f.test(a)}}});"use strict";k.register("utils/urlConstants",function(){return{GURUPA_URL:"/gp/buy/shared/handlers/dispatch.html",SHOPPING_PORTAL_ROUTED_WEBAPP_LOCATION_PURCHASES:"/checkout/p/"}});
"use strict";k.when("utils/urlConstants").register("utils/urlUtils",function(f){function a(a,g){return f.SHOPPING_PORTAL_ROUTED_WEBAPP_LOCATION_PURCHASES+a+g}return{buildShoppingPortalRoutedWebappUrl:a,buildShoppingPortalRoutedWebappUrlWithParams:function(e,g,d){e=a(e,g);if(!d)return e;g=Object.keys(d).map(function(a){return a+"\x3d"+d[a]});for(var h=0;h<g.length;h++)e=e+(-1<e.indexOf("?")?"\x26":"?")+g[h];return e}}});"use strict";k.when("A","jQuery","page-transition-controller","page-conductor",
"widgets/ageVerification/ageVerificationCommon","client-side-metrics").register("widgets/ageVerification/removeLineItems",function(f,a,e,g,d,h){f.declarative("age-restriction-remove-restricted-items","click",function(c){h.increaseCount("checkout:ageverification:removeRestrictedItemsClick",1);c=c.data;var e=(new Date).getTime(),f=g.setAjaxTransitionHeader({"x-amz-checkout-page":"agelimitation"});d.startPageTransition(c.loadingText);a.ajax({type:"POST",url:c.url+"\x26cachebuster\x3d"+e,data:a.param(c.param,
!0),dataType:"text",headers:f,error:g.ajaxRedirect,success:g.ajaxUpdatePage})})});"use strict";k.when("A","jQuery").register("widgets/ageVerification/switchIdForm",function(f,a){f.declarative("age-verification-change-id-dropdown","change",function(e){e=".age-verification-id-"+e.$target.find(":selected").val().toLowerCase().replace(/_/g,"-");var g=a("[name\x3d'age_verification_form']");g.find(".age-verification-id").addClass("aok-hidden");g.find(e).removeClass("aok-hidden")})});"use strict";k.when("A",
"jQuery","page-transition-controller","page-conductor","widgets/ageVerification/ageVerificationCommon").register("widgets/ageVerification/ageVerification",function(f,a,e,g,d){function h(d){var c=!0;d.find(".a-button-error, .a-form-error").removeClass("a-button-error").removeClass("a-form-error").end().find(".calendar-dropdown select, .age-verification-id:visible select, :text:visible, [type\x3ddate]:visible, [type\x3dnumber]:visible").each(function(d,h){d=a(h);d.val()||(c=!1,"INPUT"===d.prop("tagName")?
d.addClass("a-form-error"):d.siblings(".a-button-dropdown").addClass("a-button-error"))});return c?!0:(d.find("#missing-fields-error-message").removeClass("aok-hidden"),!1)}function c(c){c=d.buildFormData(c);var h=g.setAjaxTransitionHeader({"x-amz-checkout-page":"agelimitation"});return a.ajax({type:"POST",url:"/gp/buy/agelimitation/handlers/dob-uploader.html",data:c,dataType:"text",headers:h,success:t,error:g.ajaxRedirect})}function l(c){var h=c.data("profile");c=d.buildFormData(c);return a.ajax({type:"POST",
url:"/ap/cvf/request/identity?sif_profile\x3d"+h,data:c,dataType:"json",success:m,error:g.ajaxRedirect})}function m(d,c){var h=a('[name\x3d"age_verification_form"]');c=h.find('input[name\x3d"ageLimitation"]').val();h=h.find('input[name\x3d"ivvDomain"]').val();d={claimToken:d.token,ageLimit:c,ivvDomain:h};c=g.setAjaxTransitionHeader({"x-amz-checkout-page":"agelimitation"});return a.ajax({type:"POST",url:"/gp/buy/agelimitation/handlers/decode.html",data:d,dataType:"text",headers:c,success:p,error:g.ajaxRedirect})}
function p(c,h,e){var f=c.trim(),p;-1!==f.indexOf("newRequestToken\x3d")&&(p=f.split("\x3d")[1]);p?(d.stopPageTransition(),c=a('[name\x3d"age_verification_form"]'),c.find("#id-error-message").removeClass("aok-hidden"),c.find('input[name\x3d"requestToken"]').val(p)):g.ajaxUpdatePage(c,h,e)}function t(c,h,e){var f=c.trim();null!==e&&null===e.getResponseHeader("x-amz-checkout-agelimitation-embu-write-failed")&&-1===f.indexOf("embuWriteFailed")?g.ajaxUpdatePage(c,h,e):(d.stopPageTransition(),a('[name\x3d"age_verification_form"]').find("#upload-error-message").removeClass("aok-hidden"))}
a(document.documentElement).delegate('[name\x3d"age_verification_form"]',"submit",function(e){e.preventDefault();e=a(e.target);e.find("#dob-error-message").addClass("aok-hidden");e.find("#id-error-message").addClass("aok-hidden");e.find("#missing-fields-error-message").addClass("aok-hidden");h(e)&&d.validateDateOfBirth()&&(d.startPageTransition(e.data("loadingtext")),"true"===e.find('input[name\x3d"isDateOfBirthOnlyEnabled"]').val()?c(e):l(e))});return{validateDateOfBirth:d.validateDateOfBirth,validateForm:h,
callCVF:l,submitDateOfBirthForm:c,decodeClaimToken:m,verifyServiceResult:p,verifyDateOfBirthUploadResult:t}});"use strict";k.when("A","jQuery","page-transition-controller","page-conductor").register("widgets/ageVerification/ageVerificationCommon",function(f,a,e,g){function d(a){a=a.split(/\D/);return new Date(a[0],a[1]-1,a[2])}function h(a){var d=a.find('input[name\x3d"dob_input"]');d.length?c(d,"dob-error-message"):(l(a.find('[name\x3d"month"]'),"dob-error-message"),l(a.find('[name\x3d"day"]'),"dob-error-message"),
l(a.find('[name\x3d"year"]'),"dob-error-message"))}function c(a,d){var c=a.parent(".a-input-text-wrapper");(c.length?c:a).addClass("a-form-error");m(a,d)}function l(a,d){a=a.siblings("span.a-button-dropdown");a.addClass("a-button-error");m(a,d)}function m(d,c){d.attr("aria-invalid",!0);d.attr("aria-errormessage",c);a("#"+c).removeClass("aok-hidden")}return{validateDateOfBirth:function(){var c=a('[name\x3d"age_verification_form"]'),e=c.find('input[name\x3d"dob_input"]');if(e.length)e=d(e.val());else{var f=
c.find('[name\x3d"year"]').val(),g=c.find('[name\x3d"month"]').val(),l=c.find('[name\x3d"day"]').val(),e=d(f+"-"+g+"-"+l);if(e.getFullYear()!==Number(f)||e.getMonth()!==Number(g)-1||e.getDate()!==Number(l))return h(c),!1}f=c.find('input[name\x3d"ageLimitation"]').val();g=new Date;if(g.getFullYear()-e.getFullYear()>Number(f)||g.getFullYear()-e.getFullYear()===Number(f)&&0<=g.getMonth()-e.getMonth()&&0<=g.getDate()-e.getDate())return!0;h(c);return!1},buildFormData:function(a){var c=a.serialize();if(!a.find('input[name\x3d"dob_input"]').length){var d=
a.find('[name\x3d"year"]').val(),e=a.find('[name\x3d"month"]').val();a=a.find('[name\x3d"day"]').val();d=d+"-"+("0"+e).slice(-2)+"-"+("0"+a).slice(-2);c+="\x26dob_input\x3d"+d}return c},stopPageTransition:function(){if(g.isSPP()){var c=a("#agelimitation");c.removeClass("spp-panel.collapsed");c.addClass("spp-panel.expanded");var d=c.find(".panel-content");c.find(".shrink-placeholder").hide();d.show();e.unblockAllActions()}else e.hide()},startPageTransition:function(c){if(g.isSPP()){e.blockAllActions();
var d=a("#agelimitation");e.shrinkPanel(d,!0,c)}else e.show()},addSelectError:l,addInputError:c}});"use strict";k.when("A").register("widgets/ageVerification/formPreprocessor/formPreprocessor",function(){function f(a){return/\d/.test(a)}return{preprocessForm:function(a){var e=a.clone();0===a.find('[name\x3d"dob_input"]').length&&(e.find('[name\x3d"day"]').val(a.find('[name\x3d"day"]').val()),e.find('[name\x3d"month"]').val(a.find('[name\x3d"month"]').val()),e.find('[name\x3d"year"]').val(a.find('[name\x3d"year"]').val()));
a=e.find('[name\x3d"door-number"]');var g=a.val(),g=g.replace(/(?![A-Za-z0-9])[-¿]/g," ");g=f(g)?g.split(" ").filter(f).join(" "):g;g=g.replace(/\s\s+/g," ").trim();a.val(g);return e}}});"use strict";k.when("A","jQuery","client-side-metrics","configurations/keys","configurations/newCheckoutExperienceConfig","utils/redirectionUtils").register("widgets/deliveryAddress/newCheckoutExperience/deliveryAddress",function(f,a,e,g,d,h){var c=d.getConfiguration(g.VIEW_TYPE);f.declarative("change-delivery-option-action",
"click",function(a){e.setCountValue("checkout:newCheckoutExperience:changeDelivery",1);h.redirectInCurrentTab(a.data.redirectionUrl,c)});f.declarative("add-delivery-instructions-action","click",function(a){e.setCountValue("checkout:newCheckoutExperience:addDeliveryInstruction",1);h.redirectInCurrentTab(a.data.redirectionUrl,c)})});"use strict";k.when("A","jQuery","weblab-helper","gift-utility","a-checkbox","page-transition-controller","a-truncate","a-popover-base","email-validation","widgets/giftOptions/giftOptionsSaveControls",
"gift-contact-picker","utils/smsMessageValidator").register("widgets/giftOptions/giftOptions",function(f,a,e,g,d,h,c,l,m,p,t,w){function A(b){this._domElement=b}function B(b){this._domElement=b}function fa(b){this._domElement=b;this.isInputValid=function(){return J()?L(this._domElement.val())||m(this._domElement.val()):m(this._domElement.val())};this.toggleValidationError=function(b){var a=J()?"#gcx-egift-warning-no-contact-details-":"#egift-recipient-email-warning-";x(n.find(a+this.getLineItemIndex()),
b);y(this._domElement,b,"")}}function I(b){this._domElement=b;this.isInputValid=function(){if(!J()||!L(this._domElement.val()))return!0;var b=ga(this._domElement.val());return b.isValid?!0:"gcx-egift-warning-not-valid-mobile-"!==b.warningKey};this.toggleValidationError=function(b){x(n.find("#gcx-egift-warning-not-valid-mobile-"+this.getLineItemIndex()),b);y(this._domElement,b,"-phone")}}function S(b){this._domElement=b;this.isInputValid=function(){if(!J()||!L(this._domElement.val()))return!0;var b=
ga(this._domElement.val());return b.isValid?!0:"gcx-egift-warning-not-supported-mobile-"!==b.warningKey};this.toggleValidationError=function(b){x(n.find("#gcx-egift-warning-not-supported-mobile-"+this.getLineItemIndex()),b);y(this._domElement,b,"-region")}}function ha(b){this._domElement=b;this.isInputValid=function(){return X(this.getLineItemIndex()).senderNameIsOptional||a.trim(this._domElement.val())};this.toggleValidationError=function(b){x(n.find("#sender-name-empty-warning-"+this.getLineItemIndex()),
b);y(this._domElement,b,"-empty")}}function M(b){this._domElement=b;this.isInputValid=function(){return!g.valueContainsUrl(a.trim(this._domElement.val()))}}function ia(b){M.call(this,b);this.toggleValidationError=function(b){x(n.find("#sender-name-url-warning-"+this.getLineItemIndex()),b);y(this._domElement,b,"-url")}}function ja(b){M.call(this,b);this.toggleValidationError=function(b){x(n.find("#message-url-warning-"+this.getLineItemIndex()),b);y(this._domElement,b,"-url")}}function ka(b){this._domElement=
b;var a=this.getLineItemIndex();this.isInputValid=function(){var b=!1;if(w&&0<n.find('[id^\x3d"message-invalid-chars-warning-"]').length)var b=v(a).val(),c=C(a).val(),b=b+Y(c),b=L(N(a).val())&&!w.isValid(b);return!b};this.toggleValidationError=function(b){x(n.find("#message-invalid-chars-warning-"+a),b);y(this._domElement,b,"-chars")}}function la(b){this._domElement=b;this.isInputValid=function(){var b=this.getLineItemIndex(),a=X(b),c=v(b).val(),b=C(b).val(),c=c+Y(b),b=g.getLineCount(c,a.maxLineLength),
d=c.length;if(a=b<=a.maxLines&&d<=a.maxChars)a=!(512<z.unescape(encodeURIComponent(c)).length);return a};this.toggleValidationError=function(b){var a=this.getLineItemIndex();x(n.find("#message-length-warning-"+a),b);y(this._domElement,b,"-length");y(n.find("#gift-message-sender-input-"+a),b,"-length");b=!b;n.find("#message-counter-"+a).find(".counter-text").toggleClass("a-color-error",!b)}}function ma(b){this._domElement=b;this.isInputValid=function(){return m(this._domElement.val())};this.toggleValidationError=
function(b){var a=this.getLineItemIndex();x(n.find("#recipient-not-email-warning-"+a),b);y(this._domElement,b,"")}}function v(b){return n.find("#message-area-"+b)}function T(b){return d("#gift-wrap-checkbox-"+b,n)}function E(b){return d("#digital-gift-message-checkbox-"+b,n)}function na(b){return n.find("#digital-gift-message-input-wrapper-"+b)}function O(b){return n.find("#digital-gift-message-text-input-"+b)}function N(b){return n.find("#egift-recipient-text-input-"+b)}function C(b){return n.find("#gift-message-sender-input-"+
b)}function Z(b){return d("#toggle-gift-item-checkbox-"+b,n)}function U(b){return n.find("#gift-wrap-selection-"+b)}function K(b){b.addClass("aok-hidden")}function F(b){b.removeClass("aok-hidden")}function x(b,a){a?F(b):K(b)}function G(b){b.prop("disabled",!0);b.removeClass("a-form-normal").addClass("a-form-disabled")}function H(b){b.prop("disabled",!1);b.removeClass("a-form-disabled").addClass("a-form-normal")}function oa(b){K(b.find(".gift-options-summary-header"));F(b.find(".gift-options-expanded-header"))}
function X(b){return v(b).closest("[data-message-validation-options]").data("messageValidationOptions")}function L(b){return/^\+?[()\s.0-9-]*$/.test(b)&&9<b.length&&19>b.length}function ga(b){var a=String(b);if(!a)return{isValid:!1,warningKey:"gcx-egift-warning-not-valid-mobile-"};b="+"===a[0]?a:"+1"+a;if(11!==(b.match(/\d/g)||[]).length||!/^(\+[1-9][\s.-]?)?(\(\d{3}\)|\d{3})[\s.-]?\d{3}[\s.-]?\d{4}$/.test(a))return{isValid:!1,warningKey:"gcx-egift-warning-not-valid-mobile-"};if("1"!==b[1])return{isValid:!1,
warningKey:"gcx-egift-warning-not-supported-mobile-"};b=b.slice(2).replace(/[()\s-.]/g,"");return/(?:2(?:0[1-35-9]|1[02-9]|2[03-589]|3[149]|4[08]|5[1-46]|6[0279]|7[0269]|8[13])|3(?:0[1-57-9]|1[02-9]|2[01356]|3[0-24679]|4[167]|5[12]|6[014]|8[056])|4(?:0[124-9]|1[02-579]|2[3-5]|3[0245]|4[023578]|58|6[39]|7[0589]|8[04])|5(?:0[1-47-9]|1[0235-8]|20|3[0149]|4[01]|5[19]|6[1-47]|7[0-5]|8[056])|6(?:0[1-35-9]|1[024-9]|2[03689]|[34][016]|5[0179]|6[0-279]|78|8[0-29])|7(?:0[1-46-8]|1[2-9]|2[04-7]|3[1247]|4[037]|5[47]|6[02359]|7[0-59]|8[156])|8(?:0[1-6]|1[02-8]|2[08]|3[0-289]|4[03578]|5[046-9]|6[02-5]|7[028])|9(?:0[134689]|1[02-9]|2[0589]|3[0146-8]|4[01579]|5[12469]|7[0-389]|8[04-69]))[2-9]\d{6}$/.test(b)?
{isValid:!0,warningKey:D}:{isValid:!1,warningKey:"gcx-egift-warning-not-supported-mobile-"}}function J(){return document.getElementById("gcx-egift-warning-no-contact-details-0")}function pa(b,a,c){var d=n.find("#message-counter-"+b).find("."+a+"-counter");b=d.find(".count");a=d.find(".message");var e=Math.abs(c),d=d.data("messageData");c=0<c?"remaining":"over";var h=1===e?"single":"multiple";b.text(e);a.text(d[c][h])}function Y(b){return b?"\n"+Array(qa+1).join("X")+b:""}function r(b,a){var c=!0;
Array.isArray(b)&&b.forEach(function(b){b.validate(a)||(c=!1)});return c}function va(b){var a=[];Array.isArray(b)&&b.forEach(function(b){b.validate(!1)||a.push(b)});return a}function aa(b){if(0<v(b).size()){var a=X(b),c=v(b).val(),d=C(b).val(),c=c+Y(d),d=g.getLineCount(c,a.maxLineLength);pa(b,"lines",a.maxLines-d);pa(b,"chars",a.maxChars-c.length)}}function P(b){var a=n.find("#notification-preview-"+b);if(a){var c=v(b).val(),d=C(b).val(),e=N(b).val();b=n.find("#notification-preview-wrap-image-"+b);
J()&&L(e)?(K(b),c.length>q.maxGiftMessageLengthForSMS&&(c=c.substr(0,q.maxGiftMessageLengthForSMS)+"..."),d.length>q.maxSenderNameLengthForSMS&&(d=d.substr(0,q.maxSenderNameLengthForSMS)+"..."),c=q.sentByStringSMS.replace(q.placeholderChar,d)+"\n"+q.exampleURL+"\n"+c+"\n"+q.acceptByStringSMS.replace(q.placeholderChar,q.expireDateSMS)):(F(b),c=c+"\n"+ra.replace(q.placeholderChar,d)+"\n"+q.acceptByStringEmail.replace(q.placeholderChar,q.expireDateEmail));a.text(c)}}function y(b,a,c){b.toggleClass("gift-input-error"+
c,a)}function ba(b){var c=b.val();c!==a.trim(c)&&b.val(a.trim(c))}function sa(b,c){if(n&&0!==a("#item-"+c.itemId).length){var d=b.parent().find(".selected");ta(d);b=b.find(".gw-card");ua(b);n.find('input[name\x3d"wrap.'+c.itemId+'"]').val(c.wrapNo)}}function ua(b){b.addClass("selected");b.attr("aria-pressed","true")}function ta(b){b.removeClass("selected");b.attr("aria-pressed","false")}function wa(){var b=document.querySelectorAll(".gw-card");0!==b.length&&(k.when("a-carousel-framework").execute(function(b){b.createAll();
b.initializeAll()}),z.NodeList&&!NodeList.prototype.forEach&&(b=Array.prototype.slice.call(b)),b.forEach(function(b){function c(){d.classList.remove("active");d.style.removeProperty("background-position")}b.addEventListener("keydown",function(b){if("keydown"===b.type){var c=b.which||b.keyCode;if(32===c||13===c)b.preventDefault(),c=b.target.dataset,sa(a(b.target).parents("li"),{itemId:c.itemId,wrapNo:c.wrapId})}});b=b.querySelector(".gw-card-header");var d=b.querySelector(".gw-hover-zoom");b.addEventListener("mousemove",
function(b){var a=b.currentTarget.offsetWidth,c=b.currentTarget.offsetHeight;d.classList.add("active");c=b.offsetY/c*100;d.style.setProperty("background-position","".concat(b.offsetX/a*100,"% ").concat(c,"%"))});b.addEventListener("pointerup",c);b.addEventListener("pointerleave",c);b.addEventListener("pointercancel",c)}))}function ca(b){var a=b.val(),c=a.replace(/[\u2018\u2019\u0060\u00B4]/g,"'").replace(/[\u201C\u201D]/g,'"');c!==a&&b.val(c)}function da(){return document.getElementById("gcx-egift-warning-no-contact-details-0")}
var n,qa=5,ra="",q={localizedFromString:"",acceptByStringEmail:"",acceptByStringSMS:"",sentByStringSMS:"",exampleURL:"",expireDateEmail:"",expireDateSMS:"",maxGiftMessageLengthForSMS:168,maxSenderNameLengthForSMS:20,placeholderChar:"@"};A.prototype.getLineItemIndex=function(){var b=this._domElement.attr("id").split("-");if(2>b.length)throw Error("Expected DOM element id to be suffixed with -lineItemIndex");return b[b.length-1]};A.prototype.validate=function(b){b=this._domElement.prop("disabled")||
this.isInputValid();this.toggleValidationError(!b);return b};B.prototype=new A;B.prototype.validate=function(b){var a=this._domElement.prop("disabled")||this.isInputValid();b&&!a||this.toggleValidationError(!a);return a};fa.prototype=new B;I.prototype=new B;S.prototype=new B;ha.prototype=new B;M.prototype=new A;ia.prototype=new M;ja.prototype=new M;ka.prototype=new A;la.prototype=new A;ma.prototype=new B;var u=[],V={},W={},Q={},R={},ea=function(b){n=a(b||"#giftOptions-contains");u=[];n.find(".a-truncate").each(function(){c.get(this).update()});
n.find(".toggle-gift-checkbox").trigger("change");n.find(".gift-message-textarea textarea").trigger("change");n.find(".digital-gift-message-checkbox").trigger("change");(b=f.state("giftPageState"))&&b.localizedFromStringLength&&(qa=b.localizedFromStringLength);b&&b.notificationPreviewAcceptByStringSMS&&(q.acceptByStringEmail=b.notificationPreviewAcceptByStringEmail,q.acceptByStringSMS=b.notificationPreviewAcceptByStringSMS,q.sentByStringSMS=b.notificationPreviewSentByStringSMS,q.exampleURL=b.notificationPreviewExampleURL,
q.expireDateEmail=b.notificationPreviewExpireDateEmail,q.expireDateSMS=b.notificationPreviewExpireDateSMS,q.maxGiftMessageLengthForSMS=b.notificationPreviewMaxGiftMessageSMS,q.maxSenderNameLengthForSMS=b.notificationPreviewMaxSenderNameSMS,q.placeholderChar=b.placeholderChar,ra=b.localizedFromString);n.find(".recipient-contact-details-input").bind("paste",function(){var b=this;z.setTimeout(function(){a(b).parent().trigger("change")},0)});wa();e.isEGiftOptionsActive()&&t.isEnabled()&&k.when("mash").execute(function(){F(n.find(".chewbacca-gift-options-contact-picker-button"))});
a(n.find(".recipient-contact-details-input")).each(function(){var b=a(this);b.is("input")||(b=b.find("input"));if(b.attr("id").match("^egift")){var c=new fa(b),d=new I(b),b=new S(b);W[c.getLineItemIndex()]=[c,d,b];u.push(c);u.push(d);u.push(b)}else c=new ma(b),d=c.getLineItemIndex(),Q[d]=[c],u.push(c)});a(n.find(".sender-name-text-input")).each(function(){var b=a(this);b.is("input")||(b=b.find("input"));var c=new ha(b),b=new ia(b),d=b.getLineItemIndex();V[d]=[c,b];u.push(c);u.push(b)});a(n.find(".gift-message-textarea").find("textarea")).each(function(){var b=
a(this),c=new ja(b),d=new la(b),b=new ka(b),e=d.getLineItemIndex();R[e]=[c,d,b];u.push(c);u.push(d);u.push(b)});n.find('.chewbacca-enabled-save-gift-options-button input[type\x3d"submit"]').bind("click touchend",function(b){r(u,!1)||(b.preventDefault(),b.stopImmediatePropagation())})};f.declarative("chewbacca-toggle-gift-item","change",function(b){b=b.data.lineItemIndex;if(Z(b).isChecked()){H(v(b));var a=C(b);a&&H(a);0!==E(b).size()&&(E(b).enable(),E(b).isChecked()&&H(O(b)));0!==T(b).size()&&T(b).enable();
a=n.find('input[name\x3d"wrap.'+b+'"]');0!==a.size()&&a.prop("disabled",!1);0!==U(b).size()&&U(b).prop("disabled",!1);F(n.find("#gift-options-box-"+b))}else{G(v(b));(a=C(b))&&G(a);0!==E(b).size()&&(a=E(b),a.uncheck(),a.disable(),G(O(b)));0!==T(b).size()&&(a=T(b),a.uncheck(),a.disable());a=n.find('input[name\x3d"wrap.'+b+'"]');0!==a.size()&&(n.find("#gift-wrap-radio-"+b+"-none").click(),a.prop("disabled",!0));if(0!==U(b).size()){var c=n.find("#gift-wrap-carousel-"+b);if(0!==c.length){var d=c.find(".selected");
ta(d);d=c.find(".gw-none").parent();ua(d);n.find('input[name\x3d"wrap.'+b+'"]').val("");c=c.find(".a-carousel-restart");0<c.length&&c.click()}c=U(b);a.prop("disabled",!0);c.prop("disabled",!0)}K(n.find("#gift-options-box-"+b))}a=v(b);c=C(b);d=E(b);(e.isEGiftOptionsActive()&&0<N(b).size()?0:0<Z(b).size()&&!Z(b).isChecked())?(G(a),G(c),d.disable()):(H(a),H(c),d.enable());r(Q[b],!1);r(V[b],!1);r(R[b],!1)});f.declarative("chewbacca-gift-message-textarea","change keyup click focus",function(b){if("textarea"===
b.targetTag&&n){b=b.data.lineItemIndex;if(da()){var a=v(b);ca(a)}P(b);aa(b);r(R[b],!0)}});f.declarative("chewbacca-sender-name-input","change blur focusout",function(b){b=b.data.lineItemIndex;if(da()){var a=C(b);ca(a)}P(b);aa(b);r(V[b],!1);r(R[b],!1)});f.declarative("chewbacca-sender-name-input","keyup",function(b){b=b.data.lineItemIndex;if(da()){var a=C(b);ca(a)}P(b);aa(b);r(V[b],!0);r(R[b],!0)});f.declarative("chewbacca-digital-gift-message-checkbox","change",function(b){b=b.data.lineItemIndex;
0!==E(b).size()&&E(b).isChecked()?(H(O(b)),H(na(b))):(G(O(b)),G(na(b)));r(Q[b],!0)});f.declarative("chewbacca-recipient-contact-details","change blur focusout",function(b){b=b.data.lineItemIndex;ba(O(b));r(Q[b],!1)});f.declarative("chewbacca-recipient-contact-details","keyup",function(b){r(Q[b.data.lineItemIndex],!0)});e.isEGiftOptionsActive()&&f.declarative("chewbacca-egift-recipient-contact-details","change blur focusout",function(b){var a=b.data.lineItemIndex;"change"===b.type&&(ba(N(a)),P(a));
r(W[a],!1)});e.isEGiftOptionsActive()&&t.isEnabled()&&f.declarative("chewbacca-gift-options-contact-picker","click",function(b){var a=b.data.lineItemIndex;b=["emails"];J()&&b.push("phoneNumbers");t.selectContact({contactFields:b,onSuccess:function(b){var c=N(a);c.val(b.value);ba(c);P(a);r(W[a],!1)}})});f.declarative("chewbacca-egift-recipient-contact-details","keyup",function(b){r(W[b.data.lineItemIndex],!0)});f.declarative("chewbacca-gift-options-submit","submit",function(b){if(r(u,!1))h.showPageTransition();
else{b.$event.preventDefault();var a=[];va(u).forEach(function(b){var c=b._domElement.closest(".a-expander-container"),d=c.find(".a-expander-section-header");c.find(".gift-options-expanded-header").hasClass("aok-hidden")&&!a.includes(b.getLineItemIndex())&&(d.click(),a.push(b.getLineItemIndex()))})}});f.declarative("chewbacca-gift-options-popover-submit","submit",function(b){b=b.$target.closest(".a-popover").data("a-popover-id");l.hide(b)});f.on("a:expander:chewbacca-gift-options-expander:toggle:collapse",
function(b){b=b.expander.$expander;var a=b.data("lineitemindex"),c;c=v(a).val();c=!c||10>=c.length?c||"":c.substring(0,10)+"...";var d=0<c.length,a=n.find('input[name\x3d"wrap.'+a+'"]:checked').val()||"";d||a?(F(b.find(".gift-options-summary-header")),K(b.find(".gift-options-expanded-header")),x(b.find(".gift-message-summary"),d),b.find(".gift-message-preview").text(c),K(b.find(".gift-wrap-summary")),F(b.find(".gift-wrap-summary-"+a.replace(/#/g,"\\#")))):oa(b)});f.on("a:expander:chewbacca-gift-options-expander:toggle:expand",
function(b){oa(b.expander.$expander)});f.on("checkout:reload:giftselect",function(){ea()});f.on("checkout:reload:spp-giftoptions",function(){ea()});k.when("giftOptionsPopoverData").execute(function(b){for(var a=0;a<b.lineItemCount;++a)(function(b){f.on("a:popover:show:changeGiftOptionsPopover"+b,function(){ea("#giftOptions-contains"+b)})})(a)});f.declarative("gift-wrap-selected","click",function(b){sa(b.$target.parents("li"),{itemId:b.data.itemId,wrapNo:b.data.wrapId})})});"use strict";k.when("A").register("widgets/giftOptions/giftOptionsSaveControls",
function(f){return function(a){function e(){return a.find(".chewbacca-enabled-save-gift-options-button")}function g(){return a.find(".chewbacca-disabled-save-gift-options-button")}function d(){f.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")}return{disable:function(){g().removeClass("aok-hidden");e().addClass("aok-hidden");d()},enable:function(){e().removeClass("aok-hidden");g().addClass("aok-hidden");d()}}}});k.when("A").register("gift-contact-picker",function(f){function a(a){return a&&
0<=f.indexOfArray(m,a)}function e(a,c,d,e){a.permissions.requireForFeature({featureID:"eshipping",requestID:"eshipping_contacts_permission"}).onPermissionGranted(function(){h(a,c,d,e)}).onPermissionDenied(e)}function g(a,c){var d=[];f.each(c,function(c){f.each(a[c]||[],function(a){d.push(a.value)})});return d}function d(a){function c(){f.delay(function(){e.remove()},100)}if(f.capabilities.android){var d=f.$,e=d('\x3cscript id\x3d"stop-mash-reappear" type\x3d"application/x-amzn-empty" /\x3e');d(document.body).append(e);
f.delay(function(){a(c)})}else a(p)}function h(a,e,h,f){d(function(d){a.showContactPicker({fields:e,successCallback:function(p){d();p=g(p,e);0===p.length?f():1===p.length?h({value:p[0]}):c(a,p,h,f)},failCallback:function(){d();f()}})})}function c(a,c,d,e){a.showChooser({buttonTitles:c,successCallback:function(a){a<c.length&&0<=a?d({value:c[a]}):e()},failCallback:e})}function l(){return f.capabilities.isAmazonApp}var m="phoneNumbers emails ims photos categories urls".split(" "),p=function(){};return{selectContact:function(c){var d=
c.onSuccess,g=c.onError||p,m=f.filter(c.contactFields||[],a);l()&&d&&0!==m.length?k.now("mash").execute(function(a){a?a.permissions&&a.permissions.available?e(a,m,d,g):h(a,m,d,g):g()}):g()},isEnabled:l}});"use strict";k.when("A","jQuery","components/PrimaryActionBlockerCheckbox","weblab-helper","client-side-metrics").register("widgets/purchaseLevelMessages/blockingConfirmationMessages",function(f,a,e,g,d){function h(){g.isPyoClientSideInitiationEnabled()||e.create({$el:a('#purchase-level-messages [data-client-component\x3d"PrimaryActionBlockerCheckbox"]')})}
f.each(["checkout:reload:spc","checkout:reload:spclite","checkout:reload:spp-revieworder","checkout:reload:spp-collapsed"],function(a){f.on(a,h)})});k.when("A","jQuery","components/Component","components/PrimaryActionBlockerCheckbox","verification-checkbox-controller").register("widgets/pyoButton/PyoButton",function(f,a,e,g,d){return e.extend({onInit:function(){var a=g.getState();this.block(a);f.on(g.events.blockingStateChanged,this.block)},block:function(a){a&&d.updatePyo(a)}})});"use strict";k.when("A",
"jQuery","client-side-metrics").register("/widgets/pyoButton/newCheckoutExperience/pyoButton",function(f,a,e){f.declarative("checkout-place-your-order-action",["click"],function(a){e.setCountValue("checkout:newCheckoutExperience:clickPlaceYourOrderButton",1)})});"use strict";k.when("A","jQuery","widgets/subscribeAndSave/snsCommon").execute("widgets/subscribeAndSave/setSnSOptions",function(f,a,e){function g(d,h,c,f,g){var p=e.getSnSItemData(d);d={asin:p.asin,encodedLineItemId:p.lineItemId,encryptedMerchantId:p.encryptedMerchantId,
merchantSku:p.merchantSku,couponId:a("#sns-item-discount-"+d).data("couponId"),redeemCoupon:e.convertToPerlBoolean(f),optedIn:e.convertToPerlBoolean(h),customerSelectedRecurrencePeriod:c};e.updatePurchase([d],D,g)}f.declarative("sns-item-checkbox","change",function(a){var h=a.data.index,c=e.isCustomerOptedIn("#sns-item-checkbox-",h),f=e.getActiveSubscriptionRecurrencePeriod("#sns-recurrence-period-selector-",h);g(h,c,f,!0,a.data.callbackUrl)});f.on("a:accordion:sns-recurrence-period-accordion:select",
function(a){a=a.selectedRow.$row.data();var h=a.index,c=e.isCustomerOptedIn("#sns-item-checkbox-",h);c?g(h,c,a.recurrencePeriod,!1,a.callbackUrl):e.setActiveSubscriptionRecurrencePeriod("#sns-recurrence-period-selector-",a)})});"use strict";k.when("jQuery","page-transition-controller","page-conductor","client-side-metrics").register("widgets/subscribeAndSave/snsCommon",function(f,a,e,g){function d(a){a||(g.increaseCount("checkout:sns:updatePurchaseInvokedWithoutUrl",1),a="/gp/buy/spc/handlers/set-subscribe-and-save-options.html?ref_\x3dchk_spc_set_sns_options");
return a}return{convertToPerlBoolean:function(a){return a?1:0},getSnSItemData:function(a){return document.getElementById("sns-item-"+a).dataset},isCustomerOptedIn:function(a,c){return f(a+c).is(":checked")},updatePurchase:function(h,c,g){var m=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});a.show();f.ajax({type:"POST",url:d(g),contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:{subscriptionParameters:JSON.stringify(h)},dataType:"text",cache:!1,async:!0,headers:m,success:function(d,
f,g){"function"===typeof c&&(c(),a.hide());e.ajaxUpdatePage(d,f,g)},error:function(a,c,d){e.ajaxRedirect(a,c,d)}})},setActiveSubscriptionRecurrencePeriod:function(a,c){f(a+c.index).text(c.recurrencePeriodText).data("activeRecurrencePeriod",c.recurrencePeriod)},getActiveSubscriptionRecurrencePeriod:function(a,c){return f(a+c).data("activeRecurrencePeriod")}}});"use strict";k.when("A","page-spinner-controller").execute(function(f,a){f.declarative("ingress-internal-launch-opt-out","click",function(e){e=
function(a,c,d,e){a=[a+"\x3d"+c];d&&(c=new Date,c.setTime(c.getTime()+864E5*d),a.push("expires\x3d"+c.toGMTString()));a.push("path\x3d/");e&&a.push("domain\x3d"+e);document.cookie=a.join("; ")};var f=function(){var a=/:\/\/([^:/]+)/.exec(z.location.href)[1].split("."),c=a.length-2;"co"!==a[c]&&"com"!==a[c]||c--;for(var d=[];c<a.length;c++)d.push(a[c]);return d.join(".")}(),d=function(a){return(a=(new RegExp(a+"\x3d([^;]+)")).exec(document.cookie))?a[1]:""}("checkout-dyn-config").split("\x26");d[d.length]=
"escapeingress:1";e("checkout-dyn-config","",-1,f);e("checkout-dyn-config",d.join("\x26"),365,f);a.show();location.reload()})});"use strict";k.when("A","jQuery","widgets/installmentsModal/state","installments-service").register("widgets/installmentsModal",function(f,a,e,g){f.on("a:popover:dismiss:installmentsModal",function(a){g.sendReftag("installments_bundle_modal_cancelled_asin_"+e.asin+"_bundle_asin_"+e.bundleAsin)});f.on("a:popover:hide:installmentsModal",function(a){e.$target.prop("checked",
!e.isChecked)});f.declarative("installments-confirm","click",function(a){g.sendReftag("installments_bundle_modal_confirm_removal_asin_"+e.asin+"_bundle_asin_"+e.bundleAsin);g.call(e.itemId,e.programId,e.handlerData);a.$target.closest(".a-popover").find(".a-icon-close").click()});f.declarative("installments-cancel","click",function(a){g.sendReftag("installments_bundle_modal_cancelled_asin_"+e.asin+"_bundle_asin_"+e.bundleAsin);a.$target.closest(".a-popover").find(".a-icon-close").click()})});"use strict";
k.register("widgets/installmentsModal/state",function(){return{asin:"",bundleAsin:"",itemId:"",program:"",handler:null,$target:"",isChecked:""}});"use strict";k.when("A","jQuery","client-side-metrics","a-modal","page-spinner-controller","configurations/keys","configurations/newCheckoutExperienceConfig","utils/pageConductor").register("widgets/itemBlocks/newCheckoutExperience/itemBlocks",function(f,a,e,g,d,h,c,l){function m(c){a(c).closest(w).length?(d.hide(),l.replaceDisplayContent(a(w),c)):p()}function p(){e.setCountValue("checkout:newCheckoutExperience:updateQuantity:failed",
1);l.redirectToGurupa(t)}var t=c.getConfiguration(h.VIEW_TYPE),w=c.getConfiguration(h.CONTAINER_SELECTOR);f.declarative("item-block-change-quantity","click",function(c){e.setCountValue("checkout:newCheckoutExperience:updateQuantity:attempted",1);d.show();var f=c.data;g.get(a("#"+f.modalName)).hide();c.$event.preventDefault();a.ajax({type:"POST",url:f.url,data:{lineItemId:f.lineItemId,quantity:f.quantity},dataType:"html",success:m,error:p})})});"use strict";k.when("A","jQuery","client-side-metrics",
"page-spinner-controller","configurations/keys","configurations/newCheckoutExperienceConfig","utils/pageConductor").register("widgets/itemBlocks/newCheckoutExperience/shipOptions",function(f,a,e,g,d,h,c){function l(d){a(d).closest(t).length?(g.hide(),c.replaceDisplayContent(a(t),d)):m()}function m(){e.setCountValue("checkout:newCheckoutExperience:selectShipOption:failed",1);c.redirectToGurupa(p)}var p=h.getConfiguration(d.VIEW_TYPE),t=h.getConfiguration(d.CONTAINER_SELECTOR);f.declarative("checkout-select-ship-option-radio",
"click",function(c){var d=c.data;c.$event.preventDefault();d.isSelected||(e.setCountValue("checkout:newCheckoutExperience:selectShipOption:attempted",1),g.show(),a.ajax({type:"POST",url:d.setActionUrl,data:d.postData,dataType:"html",success:l,error:m}))})});"use strict";k.when("A","load").register("widgets/itemBlocks/newCheckoutExperience/fastTrackCountdown",function(f){function a(){m.days={plural:l("#checkout-fast-track-days").html(),singular:l("#checkout-fast-track-day").html()};m.hours={plural:l("#checkout-fast-track-hours").html(),
singular:l("#checkout-fast-track-hour").html()};m.minutes={plural:l("#checkout-fast-track-minutes").html(),singular:l("#checkout-fast-track-minute").html()};m.seconds={plural:l("#checkout-fast-track-seconds").html(),singular:l("#checkout-fast-track-second").html()};m.and=l("#checkout-fast-track-and").html()}function e(a,d){var h=Math.round(f.now()/1E3),h=d-h;if(0>=h)a.find(".checkout-fast-track-available").hide(),a.find(".checkout-fast-track-expired").show();else{var l=h,m=Math.floor(l/86400),l=l-
86400*m,k=Math.floor(l/3600),l=l-3600*k,I=Math.floor(l/60),l=l-60*I,S=g(m,k,I,l);a.find('span[data-countdown\x3d"fastTrackCountdown"]').html(S);h=c(h,m,k,I,l);setTimeout(function(){e(a,d)},h)}}function g(a,c,e,f){return 0<a?2<=a?h(a,"days"):d(a,"days",c,"hours"):0<c?d(c,"hours",e,"minutes"):0<e?5<=e?h(e,"minutes"):d(e,"minutes",f,"seconds"):h(f,"seconds")}function d(a,c,d,e){a=h(a,c);0<d&&(a+=" ",0<m.and.length&&(a+=m.and+" "),a+=h(d,e));return a}function h(a,c){return a.toString()+" "+(1<a?m[c].plural:
m[c].singular)}function c(a,c,d,e,f){var g=1;0<c?g=2<=c?g+(a-86400*c):g+(60*e+f):0<d?g+=f:0<e&&5<=e&&(g+=f);return 1E3*g}var l=f.$,m={};(function(){var c=l("#checkout-item-block-panel");0!==c.length&&(c=c.find(".checkout-fast-track-text"),0!==c.length&&(a(),c.each(function(){var a=l(this),c=a.find(".checkout-fast-track-expiration-time");0!==c.length&&(c=parseInt(c.val(),10),isNaN(c)||(a.find(".checkout-fast-track-available").show(),e(a,c)))})))})();return{setTimeUnitStrings:a,getFastTrackCountdownDisplayText:g,
getDelayForCountdownChangeInMilliseconds:c}});"use strict";k.when("A","jQuery","client-side-metrics","configurations/keys","configurations/newCheckoutExperienceConfig","utils/redirectionUtils").register("widgets/paymentMethods/newCheckoutExperience/paymentMethods",function(f,a,e,g,d,h){var c=d.getConfiguration(g.VIEW_TYPE);f.declarative("change-payment-action","click",function(a){e.setCountValue("checkout:newCheckoutExperience:changePaymentMethod",1);h.redirectInCurrentTab(a.data.redirectionUrl,c)});
f.declarative("use-gift-voucher-promo-action","click",function(a){e.setCountValue("checkout:newCheckoutExperience:useGiftVoucherPromo",1);h.redirectInCurrentTab(a.data.redirectionUrl,c)})});"use strict";k.when("A","ready").register("widgets/pointsRedemption/pointsRedemption",function(){});"use strict";k.when("A","jQuery","page-transition-controller","page-conductor","client-side-metrics","ajax-utility","load").register("widgets/pointsRedemption/pointsRedemptionCommon",function(f,a,e,g,d,h){function c(a){a.addClass("aok-hidden")}
function l(a){a.removeClass("aok-hidden")}function m(a){return a.find(".offscreen-points-redemption-error")}function k(){return a("#partial-redemption-points-input").val()}function t(a,c){w();l(a);"mobile"===c&&A("error");c=a.find(".visible-points-redemption-error").text();m(a).text(c)}function w(d){var e=a("#input-points-exceeds-redeemable-error");c(e);m(e).empty();e=a("#input-points-invalid-error");c(e);m(e).empty();"mobile"===d&&A("normal")}function A(c){var d=a("#partial-redemption-points-input").parent(".a-input-text-wrapper");
d&&0<d.length&&("error"===c?d.addClass("a-form-error"):"normal"===c&&d.removeClass("a-form-error"))}function B(c){c.beforeRequest();a.ajax({type:"POST",url:c.url,headers:c.headers,async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",data:a.param(c.data,!0),success:c.onSuccess,error:c.onFailure})}return{hideAllErrors:w,hideFormElement:c,showFormElement:l,getOffscreenErrorMessage:m,isInputPointsValid:function(c,e){var f=k();if(!e.test(f))return d.increaseCount("checkout:pointsRedemption:"+
c+":inputPointsInvalidError",1),t(a("#input-points-invalid-error"),c),!1;if(Number(f)>Number(a("#redeemable-points-amount").val()))return d.increaseCount("checkout:pointsRedemption:"+c+":inputPointsExceedsRedeemableError",1),t(a("#input-points-exceeds-redeemable-error"),c),!1;w(c);return!0},getPartialRedemptionInputValue:k,inputPointsOnInput:function(){w("desktop");c(a("#input-points-apply-success"));l(a("#submit-points-for-redemption"))},emitWidgetLoadMetric:function(a){d.increaseCount("checkout:pointsRedemption:"+
a+":spcWidgetLoad",1)},onSubmitClick:function(c,f){c={url:a("#redemption-option-update-handler-url").val(),headers:{"x-amz-checkout-page":"spc"},data:{jpPointsCustomerRequestedAmount:c,jpPointsPaymentInstrumentId:a("#points-instrument-id").val(),jpPointsTargetCurrencyCode:a("#currency-code").val(),jpPointsAvailablePoints:a("#redeemable-points-amount").val(),isClientTimeBased:a("input[name\x3duseCtb]").val(),hasWorkingJavascript:1},beforeRequest:function(){e.show()},onSuccess:function(a,c,e){d.increaseCount("checkout:pointsRedemption:"+
f+":purchaseDocUpdateSuccess",1);d.increaseCount("checkout:pointsRedemption:"+f+":redirectOnSuccess",1);g.redirect(h.jsonify(a))},onFailure:function(a,c,e){d.increaseCount("checkout:pointsRedemption:"+f+":purchaseDocUpdateFailure",1);g.ajaxRedirect(a,c,e)}};B(c)}}});"use strict";k.when("A","jQuery","a-modal","client-side-metrics").register("widgets/productInformation/quicklookEventHandler",function(f,a,e,g){f.declarative("a-modal","click",function(d){if(d.$target.hasClass("cpx-quicklook-open-link")){g.increaseCount("checkout:quicklook:universal:modalLinkClick",
1);d=d.data;if(!d)throw g.increaseCount("checkout:quicklook:universal:eventDataUndefined",1),Error("[Modal] Event data is undefined");d=d.lineItemIndex;if(!d)throw g.increaseCount("checkout:quicklook:universal:lineItemIndexMissing",1),Error("[Modal] LineItemIndex is missing from event data");f.loadImageManually(a("#quicklook-modal-manual-image-"+d))}})});"use strict";k.when("A","page-transition-controller","page-conductor","client-side-metrics").register("checkout-vas-notification-preferences",function(f,
a,e,g){function d(){m(".notification-preferences-widget :checkbox").change(h)}function h(){this.checked?g.increaseCount(k.CHECKBOX.SELECTED,1):g.increaseCount(k.CHECKBOX.DESELECTED,1);c(m(this),this.checked)}function c(c,d){var f=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"}),h=l(c,d);m.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/notification-preferences.html",headers:f,async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",data:m.param(h,
!0),beforeSend:function(){a.show()},success:function(c,d,e){g.increaseCount(k.PURCHASE_UPDATE.SUCCESS);a.hide()},error:function(e,f,h){g.increaseCount(k.PURCHASE_UPDATE.FAIL);g.logError(h,"notification preference AJAX update call failed","checkout-vas-notification-preferences","ERROR");c.prop("checked",!d);a.hide()}})}function l(a,c){var d={};d[a.closest(".a-checkbox").attr("data-name")]=c?1:0;a.closest(".notification-preferences-widget").find("input:hidden").each(function(){var a=m(this);d[a.attr("data-name")]=
a.val()});return d}var m=f.$,k={CHECKBOX:{SELECTED:"checkout:np:checkbox:selected",DESELECTED:"checkout:np:checkbox:deselected"},PURCHASE_UPDATE:{SUCCESS:"checkout:np:purchaseUpdate:success",FAIL:"checkout:np:purchaseUpdate:fail"}};f.each(["checkout:reload:spc","checkout:reload:spp-revieworder"],function(a){f.off(a,d);f.on(a,d)})});"use strict";k.when("A","jQuery","a-checkbox","client-side-metrics","widgets/invoiceAddress/invoiceAddressSelectCommon").register("widgets/invoiceAddress/invoiceAddressSelect",
function(f,a,e,g,d){var h;a(document.documentElement).delegate('[name\x3d"select_invoice_address"]',"submit",function(a){g.increaseCount("checkout:selectinvoiceaddress:desktop:formsubmit",1);d.handleSelectInvoiceAddressFormSubmit(h)});f.declarative("select_address_in_list","click",function(a){g.increaseCount("checkout:selectinvoiceaddress:desktop:addressselected",1);h=d.getEncryptedTaxId(a.data)})});k.when("A","jQuery","a-checkbox","client-side-metrics","ready").register("widgets/invoiceAddress/invoiceAddressSelectCommon",
function(f,a,e,g){return{handleSelectInvoiceAddressFormSubmit:function(d){var f=a('[name\x3d"select_invoice_address"]'),c=e("#purchaseLevelSetInvoiceAddress").isChecked();g.increaseCount("checkout:selectinvoiceaddress:purchaselevel","true"===c?1:0);if(null!==c||""!==c||"undefined"!==c)c=a("\x3cinput\x3e").attr("type","hidden").attr("name","isPurchaseLevelSetInvoiceAddressSelected").val(c),f.append(c);null!==d||""!==d||"undefined"!==d?(d=a("\x3cinput\x3e").attr("type","hidden").attr("name","encryptedTaxId").val(d),
f.append(d)):g.increaseCount("checkout:selectinvoiceaddress:taxidnotfound",1)},getEncryptedTaxId:function(a){var e=f.state("selectInvoiceAddressParams");if(e===D)return g.increaseCount("checkout:selectinvoiceaddress:getEncryptedTaxId:emptyinvoiceaddressparams",1),"";e=e.taxRegistrations;a=a.stateOrRegion;if(null!==a&&""!==a&&"undefined"!==a)return a=e[a.toUpperCase()],a===D?(g.increaseCount("checkout:selectinvoiceaddress:getEncryptedTaxId:taxidnotfoundforstate",1),""):a;g.increaseCount("checkout:selectinvoiceaddress:getEncryptedTaxId:statenotfound",
1);return""}}});"use strict";k.when("A","jQuery","page-transition-controller","ajax-utility","page-conductor","page-detector","client-side-metrics").register("widgets/financialOfferCheckbox/financingCheckboxCommon",function(f,a,e,g,d,h,c){return{clickFinancingCheckbox:function(f){f.preventDefault();d.isSPP()?(e.blockAllActions(),e.showTransitionInContainer(a("#payment"))):e.show();f={"x-amz-checkout-page":"spc"};var h={paymentMethodId:a("#payment-method-id").val(),paymentMethodType:a("#payment-method-type").val(),
rewardAccountId:a("#reward-account-id").val(),rewardAccountAmount:a("#reward-account-amount").val(),rewardAccountRate:a("#reward-account-rate").val(),useGCBalance:a("#use-gc-balance").val(),financialOfferId:a("#financial-offer-id").val(),returnFullHTML:1,returnjson:1,hasWorkingJavascript:1,isClientTimeBased:a("input[name\x3duseCtb]").val()};f=d.setAjaxTransitionHeader(f);a.ajax({type:"POST",url:"/gp/buy/payselect/handlers/continue.html",data:a.param(h,!0),dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
headers:f,success:function(a,e,f){c.increaseCount("checkout:financingCheckbox:purchaseDocUpdateSuccess",1);f.getResponseHeader("x-amz-checkout-page")?d.ajaxUpdatePage(a,e,f):(a=g.jsonify(a),d.redirect(a))},error:function(a,e,f){c.increaseCount("checkout:financingCheckbox:purchaseDocUpdateFailure",1);d.ajaxRedirect(a,e,f)}})}}});"use strict";k.when("A","jQuery","client-side-metrics","widgets/financialOfferCheckbox/financingCheckboxCommon").execute("widgets/financialOfferCheckbox/financingCheckbox",
function(f,a,e,g){f.declarative("click-financing-checkbox","click",function(a){var f=a.data.click;f&&null!==f&&(e.increaseCount("checkout:spp-payment:clickFinancingCheckbox",1),g.clickFinancingCheckbox(a.$event))})});"use strict";k.when("A","jQuery","page-transition-controller","page-conductor","client-side-metrics").register("widgets/devicePreregistration/devicePreregistration",function(f,a,e,g,d){function h(c,f,h){e.show();a.ajax({type:"POST",url:"/gp/buy/devices/preregistration/handlers/set-item-preregistration.html",
data:{csrfToken:c,lineItemId:f,isChecked:h},dataType:"text",async:!0,cache:!1,headers:g.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"}),success:function(a,c,e){d.increaseCount("checkout:devicePreregistration:ajaxSuccess",1);g.ajaxUpdatePage(a,c,e,{pushNewFrame:"false"})},error:function(a,c,e){d.increaseCount("checkout:devicePreregistration:ajaxError",1);g.ajaxRedirect(a,c,e)}})}f.declarative("mako-rcx-prereg-declarative","change",function(c){var e=a("[name\x3dcsrfToken]").val(),f=null==c.data?
D:c.data.lineItemId;(c=c.$target.is(":checked"))?d.increaseCount("checkout:devicePreregistration:checked",1):d.increaseCount("checkout:devicePreregistration:unchecked",1);h(e,f,c)})});"use strict";k.when("A","jQuery","client-side-metrics","ready").register("widgets/devicePreregistration/reftagHelper",function(f,a,e){function g(c){c&&a.get("/hctp/log/refMarker?ref_\x3d"+c)}function d(){Object.keys(h).forEach(function(a){a="PREREGISTRATION_"+a+"_C_PC_"+h[a];e.increaseCount("checkout:device:preregistration:registerState:success",
1);g(a)})}var h={};return{registerState:function(c,f,k,p){null!=c&&null!=f&&null!=k&&null!=p?(f="E_"+(f?"CHECKED":"UNCHECKED"),k&&(f="D_"+(p?"GIFTED":"OTHER")),k=f,h[c]!==k&&(h[c]=k,g("PREREGISTRATION_"+c+"_C_"+h[c])),a('input[name\x3d"placeYourOrder1"]').unbind("click",d).bind("click",d),e.increaseCount("checkout:device:preregistration:registerState:success",1)):e.increaseCount("checkout:device:preregistration:registerState:failed",1)}}});"use strict";k.when("A","jQuery").register("widgets/customizationDetails/customizationDetails",
function(f,a){f.declarative("additional-customization-details-action","click",function(a){a.$currentTarget.closest(".sc-customization-details-list").find(".sc-customization-details-additional").removeClass("aok-hidden");a.$currentTarget.closest(".sc-customization-details-see-more").hide();a.$event.preventDefault()})})});