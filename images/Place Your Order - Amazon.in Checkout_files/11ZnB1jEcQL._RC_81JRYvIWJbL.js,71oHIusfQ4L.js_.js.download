(function(c){var g=window.AmazonUIPageJS||window.P,h=g._namespace||g.attributeErrors,a=h?h("WidgetStreamer",""):g;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,g,h){c.when("jQuery","widget-streamer-action-ws-append","widget-streamer-action-ws-prepend","widget-streamer-action-ws-update","widget-streamer-action-ws-event").register("widget-streamer-actions",function(a,d,e,b,f){var c={"ws-append":d,"ws-prepend":e,"ws-update":b,"ws-event":f},k={execute:a.noop};
return{create:function(f){var b,e,d;b=k;if(a.isArray(f)&&f.length&&f[0]){b=f[0];e=c[b];d="widget-streamer-action-"+b;if("function"!==typeof e)throw Error("Action: "+b+" is not supported. Register component "+d+" to handle this action");b=e(f)}return b}}});"use strict";c.register("widget-streamer-jquery-action",function(){return function(a,d,e){var b,f;if(!a||3>a.length)throw Error("Can not create update action, insufficient data in chunk: "+JSON.stringify(a));b=a[1];f=a[2];return{execute:function(a){var c=
a._$target.find(b).add(a._$target.filter(b));a._isTargetUpdated?e(c,f):d(c.get(0),f)}}}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-update",function(a){return function(d){return a(d,function(a,b){a.innerHTML=b},function(a,b){a.html(b)})}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-append",function(a){return function(d){return a(d,function(a,b){a.innerHTML+=b},function(a,b){a.append(b)})}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-prepend",
function(a){return function(d){return a(d,function(a,b){a.innerHTML=b+a.innerHTML},function(a,b){a.prepend(b)})}});c.register("widget-streamer-action-ws-event",function(){return function(a){var d=a[1],c;try{c=JSON.parse(a[2])}catch(b){c=null}return{execute:function(a){a._emitEvent(d,c)}}}});"use strict";c.register("widget-streamer-utils",function(){return{isStreamingAjax:function(a){if(a&&"function"===typeof a.getResponseHeader)a=a.getResponseHeader("Content-Type");else if(a&&a.http&&"function"===
typeof a.http.getResponseHeader)a=a.http.getResponseHeader("Content-Type");else throw Error("Unable to retrive headers for the given xhr object: "+a);return"application/json-amazonui-streaming"===a}}});"use strict";c.when("A","jQuery","widget-streamer-actions").register("widget-streamer",function(a,c,e){function b(a){a=a||{};this._$originalTarget=a.$target;this._$target=a.$target.clone();this._actions=[];this._isExecutable="undefined"===typeof a.immediateExecution||a.immediateExecution;this._onUpdate=
a.onUpdate||c.noop;this._hasExecutionStarted=!1;this._events=a.events||{};this._isTargetUpdated=!1;this._updateTriggerEvent=a.updateTriggerEvent;this.chunkHandler=c.proxy(this.chunkHandler,this)}b.prototype.chunkHandler=function(a){a=e.create(a);this._actions.push(a);this.executeActions()};b.prototype.enableExecution=function(){this._isExecutable=!0;this.executeActions()};b.prototype.executeActions=function(){var a;if(this._isExecutable&&this._actions.length)for(this._hasExecutionStarted||(this._hasExecutionStarted=
!0,this._updateTriggerEvent||this._updateTarget()),a=this._actions.shift();a;)a.execute(this),a=this._actions.shift()};b.prototype._emitEvent=function(a,b){var e=(this._events||{})[a]||c.noop;a===this._updateTriggerEvent&&this._updateTarget(b);e.call(this,b)};b.prototype._updateTarget=function(){this._onUpdate.apply(this,arguments);this._$originalTarget.html(this._$target.html());this._$target=this._$originalTarget;this._isTargetUpdated=!0};return function(a){return new b(a)}})});
/* ******** */
(function(q){var p=window.AmazonUIPageJS||window.P,F=p._namespace||p.attributeErrors,pa=F?F("CheckoutCommonAsset",""):p;pa.guardFatal?pa.guardFatal(q)(pa,window):pa.execute(function(){q(pa,window)})})(function(q,p,F){q.register("polyfill-indexof",function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(a,k){if(null==this)throw new TypeError('"this" is null or not defined');var g=Object(this),c=g.length>>>0;if(0===c)return-1;k=+k||0;Infinity===Math.abs(k)&&(k=0);if(k>=c)return-1;for(k=
Math.max(0<=k?k:c-Math.abs(k),0);k<c;){if(k in g&&g[k]===a)return k;k++}return-1})});"use strict";q.register("polyfill-filter",function(){Array.prototype.filter||(Array.prototype.filter=function(a){if(void 0===this||null===this)throw new TypeError;var k=Object(this),g=k.length>>>0;if("function"!==typeof a)throw new TypeError;for(var c=[],d=2<=arguments.length?arguments[1]:void 0,f=0;f<g;f++)if(f in k){var l=k[f];a.call(d,l,f,k)&&c.push(l)}return c})});"use strict";q.register("polyfill-json-stringify",
function(){"object"!==typeof JSON&&(JSON={});(function(){function a(a){return 10>a?"0"+a:a}function k(){return this.valueOf()}function g(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=v[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,h){var d,e,n=b,f,l=h[a];l&&"object"===typeof l&&"function"===typeof l.toJSON&&(l=l.toJSON(a));"function"===typeof u&&(l=u.call(h,a,l));switch(typeof l){case "string":return g(l);case "number":return isFinite(l)?
String(l):"null";case "boolean":case "null":return String(l);case "object":if(!l)return"null";b+=m;f=[];if("[object Array]"===Object.prototype.toString.apply(l)){e=l.length;for(a=0;a<e;a+=1)f[a]=c(a,l)||"null";h=0===f.length?"[]":b?"[\n"+b+f.join(",\n"+b)+"\n"+n+"]":"["+f.join(",")+"]";b=n;return h}if(u&&"object"===typeof u)for(e=u.length,a=0;a<e;a+=1)"string"===typeof u[a]&&(d=u[a],(h=c(d,l))&&f.push(g(d)+(b?": ":":")+h));else for(d in l)Object.prototype.hasOwnProperty.call(l,d)&&(h=c(d,l))&&f.push(g(d)+
(b?": ":":")+h);h=0===f.length?"{}":b?"{\n"+b+f.join(",\n"+b)+"\n"+n+"}":"{"+f.join(",")+"}";b=n;return h}}var d=/^[\],:{}\s]*$/,f=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,l=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,h=/(?:^|:|,)(?:\s*\[)+/g,e=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=k,Number.prototype.toJSON=k,String.prototype.toJSON=k);var b,m,v,u;"function"!==typeof JSON.stringify&&(v={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=
function(a,h,d){var e;m=b="";if("number"===typeof d)for(e=0;e<d;e+=1)m+=" ";else"string"===typeof d&&(m=d);if((u=h)&&"function"!==typeof h&&("object"!==typeof h||"number"!==typeof h.length))throw Error("JSON.stringify");return c("",{"":a})});"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function c(a,h){var d,e,n=a[h];if(n&&"object"===typeof n)for(d in n)Object.prototype.hasOwnProperty.call(n,d)&&(e=c(n,d),e!==F?n[d]=e:delete n[d]);return b.call(a,h,n)}a=String(a);n.lastIndex=0;n.test(a)&&
(a=a.replace(n,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(d.test(a.replace(f,"@").replace(l,"]").replace(h,"")))return a=eval("("+a+")"),"function"===typeof b?c({"":a},""):a;throw new SyntaxError("JSON.parse");})})()});"use strict";q.when("A","jQuery","client-side-metrics","weblab-helper","polyfill-filter","polyfill-json-stringify").register("ajax-wrapper",function(a,k,g,c){function d(a,b){function c(a,b){for(var h=0;h<a._options.length;h++){var d=a._options[h];
if(d=b.call(a,d,"object"===typeof d?d.name:d))return d}}this._options=a instanceof d&&b&&b.length?a._options.concat(b):a instanceof d?a._options:a&&a.length?a:[];this.filter=function(a){var b={};c(this,function(c,d){d in a&&(b[d]=a[d])});return b};this.getOption=function(a){return c(this,function(b,c){if(c===a)return b})};return this}function f(a){this._options=a.allowedOptions;this._messageForViolation=a.messageForViolation;this._messageForViolationWithValue=a.messageForViolationWithValue;this._optionName=
a.optionName;this._valueName=a.valueName;this.validate=function(a){for(var b in a)if(a.hasOwnProperty(b)){var c=this._options.getOption(b);if(!c)throw c=this._messageForViolation.replace(this._optionName,b),Error(c);if("object"===typeof c&&!c.validate(a[b]))throw c=this._messageForViolationWithValue.replace(this._optionName,b),c=c.replace(this._valueName,a[b]),Error(c);}};return this}function l(a){try{E.validate(a)}catch(b){console.error(b)}var c=r.filter(a),c=k.extend(c,h(a));return k.ajax(c)}function h(a){if(a.params){if(a.data&&
a.params)throw Error("The option data can not be present with the emulated params option. Merge both and use just one.");return{data:a.params}}}function e(d){try{G.validate(d)}catch(h){console.error(h)}var e={url:F,options:t.filter(d)},f=new k.Deferred;e.url=d.url;if(d.data){if(d.data&&d.params)throw Error("Unsupported options. 'params' and 'data' options are both specified. Remove one of them.");if("object"===typeof d.data)e.options.params=d.data;else if("string"===typeof d.data)c.isSetParamsFormatAsStirngWeblabOn()?
"GET"===d.type?e.url+="?"+d.data:(e.options.params=d.data,e.options.paramsFormat="string"):e.url+="?"+d.data;else throw Error("Unsupported type provided in the 'data' attribute of an AJAX call");}if(d.type){if(d.type&&d.method)throw Error("Unsupported options. 'type' and 'method' options are both specified. Remove one of them.");e.options.method=d.type}if("crossDomain"in d){if("crossDomain"in d&&"withCredentials"in d)throw Error("Unsupported options. 'crossDomain' and 'withCredentials' options are both specified. Remove one of them.");
e.options.withCredentials=d.crossDomain}e=b(e,d,f);e=n(e,d,f);e=v(e,d,f);e=m(e,d,f);e=u(e,d,f);d.beforeSend&&d.beforeSend(e.options);e=z(e,d,f);d=a.ajax(e.url,e.options);return d=f.promise(d)}function n(a,b,c){var d=a.options.success;a.options.success=function(a,b,e){d&&d(a,b,e);c.resolve(a,b,e)};var e=a.options.error;a.options.error=function(a,b,d){e&&e(a,b,d);c.reject(a,b,d)};var h=a.options.abort;a.options.abort=function(a){h&&h(a);c.reject(a,"abort")};return a}function b(a,b){if(!b.complete)return a;
var c=a.options.success;a.options.success=function(a,d,e){c&&c(a,d,e);b.complete(e,"success")};var d=a.options.error;a.options.error=function(a,c,e){d&&d(a,c,e);b.complete(a,"error")};var e=a.options.abort;a.options.abort=function(a){e&&e(a);b.complete(a,"abort")};return a}function m(a,b){var c=a.options.success;a.options.success=function(a,d,e){c&&("text"===b.dataType&&"object"===typeof a&&(a=JSON.stringify(a)),c(a,d,e))};return a}function v(a,b){if(!b.useXMLHttp)return a;var c=a.options.success;
a.options.success=function(a,b,d){d&&(d=d.http);c(a,b,d)};var d=a.options.error;a.options.error=function(a,b,c){a&&(a=a.http);d(a,b,c)};var e=a.options.abort;a.options.abort=function(a){a&&(a=a.http);e(a)};return a}function u(a,b){var d=a.options.success;a.options.success=function(a,b,c){c&&304===c.http.status?d(a,"notmodified",c):d(a,"success",c)};var c=a.options.error;a.options.error=function(a,b,e){a&&a.http.readyState<B.DONE?c(a,"timeout",e):a&&200<=a.http.status&&300>a.http.status&&a.http.readyState===
B.DONE?d(a.http.responseText,"success",a):a&&0==a.http.status?c(a,"abort",e):c(a,"error",e)};return a}function z(a,b){var c=a.options.success;a.options.success=function(a,b,d){w(d,"success");c(a,b,d)};var d=a.options.error;a.options.error=function(a,b,c){w(a,"error");d(a,b,c)};return a}function w(a,b){a?(g.increaseCount("AUI:Ajax:"+b+":xhr:defined"),a.http?g.increaseCount("AUI:Ajax:"+b+":xhr:http:defined"):a.http===F?g.increaseCount("AUI:Ajax:"+b+":xhr:http:undefined"):null===a.http&&g.increaseCount("AUI:Ajax:"+
b+":xhr:http:null")):a===F?g.increaseCount("AUI:Ajax:"+b+":xhr:undefined"):null===a&&g.increaseCount("AUI:Ajax:"+b+":xhr:null")}var B={UNSET:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},r=new d("accepts async beforeSend cache complete contents contentType context converters crossDomain data dataFilter dataType error global headers ifModified isLocal jsonp jsonpCallback method mimeType password processData scriptCharset statusCode success timeout traditional type url username xhr xhrFields".split(" ")),
t=new d("abort accepts cache chunk contentType error headers indicator method params success timeout withCredentials".split(" ")),H=new d(t,[{name:"async",validate:function(a){return a}},"useXMLHttp","beforeSend","complete","crossDomain","dataType","data","type","url"]),y=new d(r,["params"]),G=new f({allowedOptions:H,messageForViolation:"The option %O is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",
optionName:"%O",valueName:"%V"}),E=new f({allowedOptions:y,messageForViolation:"The option %O is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",optionName:"%O",valueName:"%V"}),I=k("meta[name\x3ddefaultAJAX]").attr("content");"jQuery"!==I&&"AUI"!==I&&(I="jQuery");return{default:function(a){try{G.validate(a),E.validate(a)}catch(b){console.error(b)}if("jQuery"===
I)l(a);else if("AUI"===I)e(a);else throw Error("Unknown AJAX method: "+I);},jQuery:l,aui:e,READY_STATE:B}});"use strict";q.when("jQuery").register("weblab-helper",function(a){return{isAJAXWeblabOn:function(){return"1"===a("meta[name\x3dPAGE_CONDUCTOR_AUI_AJAX]").attr("content")},isAjaxStreamingEnabled:function(){return"1"===a("meta[name\x3dENABLE_AJAX_STREAMING]").attr("content")},isNavCFWeblabOn:function(){return"1"===a("meta[name\x3dEMIT_NAV_CF]").attr("content")},isRemoveOrderSummaryPrimaryActionBtnTextWeblabOff:function(){return"1"!==
a("#is-remove-os-pabt").val()},isSetParamsFormatAsStirngWeblabOn:function(){return"1"===a("meta[name\x3dSET_PARAMS_FORMAT_AS_STRING]").attr("content")},disablePrefetchForScheduledDeliveryWeblabOn:function(){return"1"===a("meta[name\x3dDISABLE_PREFETCH_FOR_SCHEDULED_DELIVERY]").attr("content")},isRemoveAddressFormOnDeleteAddressWeblabOn:function(){return"1"===a("meta[name\x3dREMOVE_ADDRESS_FORM_ON_DELETE_ADDRESS]").attr("content")},isSOSPExclusiveJSHandlerWeblabOn:function(){return"1"===a("meta[name\x3dSOSP_EXCLUSIVE_JS]").attr("content")},
sospPartialAvailabilityWeblabOn:function(){return"1"===a("meta[name\x3dSOSP_PARTIAL_UNAVAILABILITY]").attr("content")},refactorExtractURL:function(){return"1"===a("meta[name\x3dREFACTOR_EXTRACT_URL]").attr("content")},showGiftTextAreaOnWarning:function(){return"1"===a("meta[name\x3dSHOW_GIFT_TEXT_AREA_ON_WARNING]").attr("content")},isInterceptionAddressFormWidthFixEnabled:function(){return"1"===a("meta[name\x3dFIX_FIELD_WIDTH_IN_CHECKOUT_INTERCEPTION_FIX_ENABLED]").attr("content")},removesGiftOptionOnRush:function(){return"1"===
a("meta[name\x3dREMOVE_GIFT_OPTION_RUSH]").attr("content")},isSPCMobileDisplayMoreShipOptionsEnabled:function(){return"1"===a("meta[name\x3dSPC_MOBILE_DISPLAY_MORE_SHIP_OPTIONS]").attr("content")},isMCBMultiTenderWeblabEnabled:function(){return"1"===a("meta[name\x3dMCB_MULTI_TENDER_ENABLED]").attr("content")},isCreateAddressLinkForTaxAddressFormWeblabOn:function(){return"1"===a("meta[name\x3dCREATE_ADDRESS_IN_TAX_COLLECTION_ENABLED]").attr("content")},isMfaPSD2DeviceDescriptionCollectionEnabled:function(){return"1"===
a("meta[name\x3dMFA_PSD2_DEVICE_DESCRIPTION_COLLECTION_ENABLED]").attr("content")},isSospCalendarFixEnabled:function(){return"1"===a("meta[name\x3dSOSP_CALENDAR_FIX]").attr("content")},isUpdateMobileNumberEnabled:function(){return"1"===a("meta[name\x3dUPDATE_MOBILE_NUMBER]").attr("content")},isGILCreditCardEnabled:function(){return"1"===a("meta[name\x3dGIL_CREDIT_CARD_PAYMENT_METHOD]").attr("content")},isPyoClientSideInitiationEnabled:function(){return"1"===a("meta[name\x3dPYO_CLIENT_SIDE_INITIATION]").attr("content")},
isTFXCurrencyToggleOnTabletFixed:function(){return"1"===a("meta[name\x3dTFX_CURRENCY_TOGGLE_ON_TABLET_FIXED]").attr("content")},isTFXGuaranteedExchangeFeeEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TFX_GUARANTEED_EXCHANGE_FEE]").attr("content")},isFreshMobileNoScrollOnRefreshEnabled:function(){return"1"===a("meta[name\x3dF3_CHECKOUT_MOBILE_NO_SCROLL_TO_TOP]").attr("content")},isCSMErrorLoggingEnabled:function(){return"1"===a("meta[name\x3dENABLE_CSM_ERROR_LOGGING]").attr("content")},
isLogAFFNFallbackEnabled:function(){return"1"===a("meta[name\x3dENABLE_AF_FN_FALLBACK]").attr("content")},isExecutionIdInQueryStringEnabled:function(){return"1"===a("meta[name\x3dADD_EXECUTION_ID_TO_QUERY_STRING]").attr("content")},isDigitalAsinIndexingFixedOnSOSPEnabled:function(){return"1"===a("meta[name\x3dDIGITAL_ASIN_INDEXING_FIXED_ON_SOSP]").attr("content")},isCvfOldAmazonUiFixesEnabled:function(){return"1"===a("meta[name\x3dCVF_OLD_AUI_FIXES]").attr("content")},isHeadersCleaned:function(){return"1"===
a("meta[name\x3dCLEAN_UP_HEADERS]").attr("content")},isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled:function(){return"1"===a("#is-item-assoc-delete-confirmation-popover-for-wireless-plans").val()},isSsdMdwEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SSD_MDW]").attr("content")},isSDGoldenCXSPCDesktopEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SD_GOLDEN_CX_DESKTOP_SPC]").attr("content")},isRemoveDigitalFlagForScheduledDeliveryShipmentEnabled:function(){return"1"===
a("meta[name\x3dRCX_CHECKOUT_SD_NOT_DIGITAL]").attr("content")},isMobileBundleDeleteFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_MOBILE_BUNDLE_DELETE]").attr("content")},isEGiftOptionsActive:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_EGIFT_OPTIONS_MOBILE]").attr("content")},isPipelineDispatchSendHeaderEnabled:function(){return"1"===a("meta[name\x3dSEND_HEADER_FOR_PIPELINE_REQUEST]").attr("content")},isIngressEnabled:function(){return"1"===a("meta[name\x3dINGRESS_ENABLED]").attr("content")},
isISPUMasterEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_ISPU_MASTER]").attr("content")},isRushISPUMasterEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_RENDER_RUSH_ISPU_MASTER]").attr("content")},isProgressiveOrderReviewCardAnchorEnabled:function(){return 1===a("#progressive-order-review-card-anchor").length},isTaxExemptionMessagingFixed:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TAX_EXEMPTION_MSGING]").attr("content")},isCachingOfPSPPanelOnTrueSPCDisabled:function(){return"1"===
a("meta[name\x3dRCX_CHECKOUT_SUPPRESS_TRUESPC_PSP_PANEL_CACHING]").attr("content")},isTSPCGoldBoxTimerFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TSPC_GOLD_BOX_COUNTER_FIX]").attr("content")},isProgressiveOrderReviewScrollingFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PROGRESSIVE_SCROLLING_FIX]").attr("content")},isFreshComingledPurchaseEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_FRESH_COMMINGLED_PURCHASE_ENABLED]").attr("content")}}});"use strict";
q.when("A","client-side-metrics").register("weekend-availability-expander-helper",function(a,k){function g(a){return(a=l[a])?f("#weekend-availability-expander-header-text-"+a).text():f("#weekend-availability-default").text()}function c(){return 1==f("input[name\x3d'isBusinessDefaultWeekendDeliveryEnabled']").attr("value")?!0:!1}function d(a,c){return a&&c?"BOTH":a?"SAT":c?"SUN":"NONE"}var f=a.$,l={BOTH:"both",SAT:"sat",SUN:"sun",NONE:"none"};return{isBusinessDefaultWeekendDeliveryViewActive:c,logExpanderState:function(a,
c,d,b){k.increaseCount("checkout:delivery-preferences:"+a+":expander:"+c+":"+(d&&b?"neverExpanded":b?"collapsed":"expanded"),1)},stateToCheckboxes:function(a){var d=!1,n=!1;if(c()){if("BOTH"===a||"SAT"===a)d=!0;if("BOTH"===a||"SUN"===a)n=!0}else{if("BOTH"===a||"OTH"===a||"SAT"===a)d=!0;if("BOTH"===a||"OTH"===a||"SUN"===a)n=!0}return{isSaturdayChecked:d,isSundayChecked:n}},updateAllOptOutMessages:function(a){1==f("input[name\x3d'isSundayDeliveryPreferenceSuppressed']").attr("value")?a.isSaturdayChecked?
f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!0):(f(".weekend-availability-opt-out-message").text(f("#weekend-availability-opt-out-sat-text").text()),f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):a.isSaturdayChecked||a.isSundayChecked?a.isSaturdayChecked?a.isSundayChecked?f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!0):(f(".weekend-availability-opt-out-message").text(f("#weekend-availability-opt-out-sun-text").text()),f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",
!1)):(f(".weekend-availability-opt-out-message").text(f("#weekend-availability-opt-out-sat-text").text()),f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):(f(".weekend-availability-opt-out-message").text(f("#weekend-availability-opt-out-both-text").text()),f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1))},updateAllTitles:function(a){a=d(a.isSaturdayChecked,a.isSundayChecked);f(".sat-sun-expander-heading-text").text(g(a))},updateAllWeekendAvailabilityStates:function(a){a=
d(a.isSaturdayChecked,a.isSundayChecked);f("input[name\x3d'BusinessHours']").attr("value",a)}}});"use strict";q.when("A","loading-spinner-controller","page-transition-controller","page-conductor","checkout-general-utils","address-utilities","page-detector-current-page","client-side-metrics","weblab-helper").register("address-popovers",function(a,k,g,c,d,f,l,h,e){function n(a){(e.isHeadersCleaned()?a.popoverValid:a.getResponseHeader("x-amz-checkout-popover-valid"))||c.redirect({conductoraction:{url:"/gp/cart/view.html",
type:"redirect"}})}function b(b,m,g){d.protectAgainstDoubleAction("show-add-address-popover",200)||(I=b.popover,!E('input[name\x3d"preloadAddressPopover"]').length||m.is(":empty")?(m.empty(),m.css("min-height",397),I.updatePosition(!0),k.showSpinner(m,!1,I),b=(new Date).getTime(),g=l.getCurrentPage(),h.increaseCount("checkout:address-popover-pagetype:".curPage,1),g="itemselect"===g||"spp-itemselect"===g?1:0,e.isHeadersCleaned()?E.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/display.html?cachebuster\x3d"+
b,data:{isBilling:P,isMultiAddress:g},dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"itemselect"},success:function(a,b,c){n(a);m.css("min-height",0);t(m,a.popoverContent)},error:c.ajaxRedirect}):E.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/display.html?cachebuster\x3d"+b,data:{isBilling:P,isMultiAddress:g},async:!0,cache:!1,headers:{"x-amz-checkout-page":"itemselect"},success:function(a,b,c){n(c);m.css("min-height",0);t(m,a)},error:c.ajaxRedirect})):(f.customizeFormFromIdentity(m),
f.countrySpecificPopoverOptimizationCheck(E("html")),g&&a.trigger("identity-assets")))}function m(a,b){if(!d.protectAgainstDoubleAction("add-new-address",200)){h.resetMetrics();var m=!1;E(".identity-protect-from-errant").each(function(){var a=E(this),a=a.is("input")?a:a.find("input:first");-1!==a.val().search(/(\d[ -]?){13}/)&&(m=!0)});if(m){var f=E(".address-form-security-error:first");f.length?alert(f.text()):alert("Please check that the address you have entered is correct.")}else{b.$event.preventDefault();
k.showSpinner(a,!1,I);var g=E("#domestic-address-popover-form, #international-address-popover-form, #address-popover-suggestions-form").filter(":visible"),f=g.serialize(),l=(new Date).getTime();b=b.$currentTarget.find('input[type\x3d"submit"]').attr("name");"useSelectedAddress"===b?f+="\x26fromSuggestionPage\x3d1":"fromAddressEditToContinue"===b&&(f+="\x26fromAddressEditToContinue\x3d1");E("#addAddressOnly").length&&(f+="\x26addOnly\x3d1");P&&(f+="\x26isBilling\x3d1");var r="/gp/buy/addressselect/handlers/popover/new.html";
if(I){if("domestic-address-popover-form"===g.attr("id")&&(g.find(".enterAddressFormField").blur(),g="#"+a.attr("id")+" div[id^\x3donblur-character-validation-error-]",0<E(g).size())){k.hideSpinner(a);return}r+="/ref\x3dchk_addr_editPopoverSubmit";c.isSPP()&&(I.lock(11),setTimeout(function(){I.unlock(12)},2E3))}var u=null!==p&&p!==F&&null!==W&&W!==F;"useSelectedAddress"===b&&!P&&u&&(f+="\x26fromSTMAPopover\x3d1");E("#international-address-popover-form").filter(":visible").length&&(f+="\x26showSecondaryForm\x3d1");
y()&&D?v(a,l,f):e.isHeadersCleaned()?E.ajax({type:"POST",url:r+"?cachebuster\x3d"+l,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:f,dataType:"json",async:!0,cache:!1,error:c.ajaxRedirect,success:function(b,d,e){c.isSPP()&&I.unlock(12);n(b);b.newPopoverType?z(b,d,b):b.reloadPopover?t(a,b.popoverContent):u?w(b):B("added",b.popoverContent)}}):E.ajax({type:"POST",url:r+"?cachebuster\x3d"+l,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:f,async:!0,cache:!1,
error:c.ajaxRedirect,success:function(b,d,e){c.isSPP()&&I.unlock(12);n(e);e.getResponseHeader("x-amz-checkout-open-new-popover")?z(b,d,e):e.getResponseHeader("x-amz-checkout-reload-popover")?t(a,b):u?w(e):B("added",e)}})}}}function v(a,b,h){var m=D.getNewTaxAddressPopoverURL();e.isHeadersCleaned()?E.ajax({type:"POST",url:m+"?cachebuster\x3d"+b,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:h,dataType:"json",async:!0,cache:!1,error:c.ajaxRedirect,success:function(b,e,h){c.isSPP()&&
I.unlock(12);n(b);b.reloadPopover?t(a,b.popoverContent):b.newAddressId&&(E(".a-button-close").trigger("click"),d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"),D.submitTaxAddressFormWithNewAddressId(b.newAddressId))}}):E.ajax({type:"POST",url:m+"?cachebuster\x3d"+b,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:h,async:!0,cache:!1,error:c.ajaxRedirect,success:function(b,e,h){c.isSPP()&&I.unlock(12);n(h);h.getResponseHeader("x-amz-checkout-reload-popover")?
t(a,b):h.getResponseHeader("x-amz-checkout-new-address-id")&&(E(".a-button-close").trigger("click"),d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"),b=h.getResponseHeader("x-amz-checkout-new-address-id"),D.submitTaxAddressFormWithNewAddressId(b))}})}function u(a){if(!d.protectAgainstDoubleAction("show-edit-address-popover",200)){var b=E("#address-suggestions-popover");a.$event.preventDefault();k.showSpinner(b,!1,I);a=E("#address-popover-suggestions-form");var h=a.serialize();a.find('input[type\x3d"radio"]').each(function(){var a=
E(this);a.attr("checked")&&(h+="\x26edit_"+a.val()+"\x3d1")});P&&(h+="\x26isBilling\x3d1");I&&c.isSPP()&&(I.lock(11),setTimeout(function(){I.unlock(12)},2E3));a=(new Date).getTime();e.isHeadersCleaned()?E.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+a,data:h,dataType:"json",async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,b,d){c.isSPP()&&I.unlock(12);n(a);z(a,b,a)}}):E.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+
a,data:h,async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,b,d){c.isSPP()&&I.unlock(12);n(d);z(a,b,d)}})}}function z(b,d,c){E('input[name\x3d"preloadAddressPopover"]').remove();e.isHeadersCleaned()?(d=c.newPopoverType,"suggestions"===d?(E("#address-suggestions-popover").empty().append(c.popoverContent),E("#address-suggestions-popover-link").trigger("click")):"edit"===d&&(d=E("#edit-address-popover"),d.empty().append(c.popoverContent),E("#edit-address-popover-link").trigger("click"),t(d,c.popoverContent))):
(d=c.getResponseHeader("x-amz-checkout-open-new-popover"),"suggestions"===d?(E("#address-suggestions-popover").empty().append(b),E("#address-suggestions-popover-link").trigger("click")):"edit"===d&&(d=E("#edit-address-popover"),d.empty().append(b),E("#edit-address-popover-link").trigger("click"),t(d,b)));a.trigger("identity-assets")}function w(a){a=e.isHeadersCleaned()?a.newAddressId:a.getResponseHeader("x-amz-checkout-new-address-id");var b=(new Date).getTime();E.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html?cachebuster\x3d"+
b,data:{action:"update-address",lineitems:p,quantities:W,addresses:a+".home..",returnHTML:0},async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,b,d){B("applied",d)}})}function B(b,e){var h=(new Date).getTime();E('input[name\x3d"shipToAddress"]').length?(b=function(){c.isSPP()?(g.blockAllActions(),g.shrinkPanel(E(".spp-panel.expanded"),!0)):g.show()},c.isNonBlockingAnimationEnabled()?a.delay(b,0):b(),b=l.getCurrentPage(),c.loadPage(b,"",F,{refTag:"chk_addr_editPopoverSubmit"},F,e)):(e=c.setAjaxTransitionHeader(),
E.ajax({type:"POST",headers:e,url:"/gp/buy/shared/handlers/pipeline-dispatch.html?cachebuster\x3d"+h,data:{useCase:"multiAddress",showAddressAdded:b,page:"itemselect"},dataType:"text",async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,b,e){c.ajaxUpdatePage(a,b,e);E(".a-button-close").trigger("click");d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}}))}function r(a){a=E("#"+a);a.length&&a.empty()}function t(b,d){b.html(d);f.customizeFormFromIdentity(b);I.updatePosition(!0);
a.trigger("identity-assets");f.countrySpecificPopoverOptimizationCheck(E("html"))}function H(a){a=a.$currentTarget.closest(".lineitem");p=a.find('input[name^\x3d"lineItemEntityID."]').val();W=a.find('input[name^\x3d"quantity."]').val();a=E("#add-address-popover-link");a.length?a.trigger("click"):E("#add-new-address-popover").trigger("click")}function y(){return e.isCreateAddressLinkForTaxAddressFormWeblabOn()&&0<E("#isTaxAddress").length}function G(){P=E("#isBilling").length?1:0;if(e.isInterceptionAddressFormWidthFixEnabled()){var a=
E(".enter-address-form");f.customizeFormFromIdentity(a)}}var E=a.$,I,p,W,P=0,D=null;if(!E("html").hasClass("a-ie6"))return a.on("a:popover:show:add-address",function(a){r("edit-address-popover");r("add-billing-address-popover");P=0;b(a,E("#add-address-popover"),!1)}),a.on("a:popover:show:add-billing-address",function(a){r("edit-address-popover");r("add-address-popover");b(a,E("#add-billing-address-popover"),!0)}),a.on("a:popover:show:address-suggestions",function(a){I=a.popover}),a.on("a:expander:delivery-expander:toggle:expand",
function(a){a=E(".a-expander-content");f.fixOverflow(a)}),a.declarative("close-delete-popover",["click","touchend"],function(a){q.when("a-popover-base").execute(function(b){(b=b.get(a.data.popoverName))&&b.hide()})}),a.declarative("rm-address-action",["click","touchend"],function(a){q.when("a-popover-base").execute(function(b){(b=b.get(a.data.popoverName))&&b.hide()});e.isRemoveAddressFormOnDeleteAddressWeblabOn()&&(r("edit-address-popover"),r("add-address-popover"),r("add-billing-address-popover"));
q.when("page-conductor").execute(function(b){b.continueClicked(null,a.$target)})}),a.declarative("select-billing-address-action",["click","touchend"],function(a){q.when("a-popover-base").execute(function(a){a.get("select-billing-address").hide()});q.when("page-conductor").execute(function(b){b.continueClicked(null,a.$target)})}),E(document).delegate("a.prevent-default-marker","click",function(a){a.preventDefault()}),a.declarative("select-billing-address-in-popover",["click","touchend"],function(a){q.when("a-popover-base").execute(function(a){(a=
a.get("select-billing-address"))&&a.hide()})}),a.declarative("trigger-popover-from-link",["click","touchend"],function(a){d.protectAgainstDoubleAction("trigger-popover-from-link",200)||(W=p=null,E("#add-address-popover-link").trigger("click"))}),a.declarative("add-address-popover-submit",["click","touchend"],function(a){m(E("#add-address-popover"),a)}),a.declarative("add-billing-address-popover-submit",["click","touchend"],function(a){m(E("#add-billing-address-popover"),a)}),a.declarative("edit-address-popover-submit",
["click","touchend"],function(a){m(E("#edit-address-popover"),a)}),a.declarative("address-suggestions-submit",["click","touchend"],function(a){m(E("#address-suggestions-popover"),a)}),a.declarative("delete-address-popover-submit",["click","touchend"],function(a){a=E("#delete-address-button");0<a.length&&a.click()}),a.declarative("edit-address-suggestions",["click","touchend"],u),a.declarative("add-address-popover-edit",["click","touchend"],function(a){if(!d.protectAgainstDoubleAction("add-address-popover-edit",
200)){a.$event.preventDefault();var b=E("#add-address-popover");k.showSpinner(b,!1,I);a=E("#address-popover-suggestions-form").serialize()+"\x26"+a.$currentTarget.find('input[type\x3d"submit"]').attr("name")+"\x3d1";var h=(new Date).getTime();e.isHeadersCleaned()?E.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+h,data:a,dataType:"json",async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,d,c){n(a);t(b,a.popoverContent)}}):E.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+
h,data:a,async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,d,c){n(c);t(b,a)}})}}),a.declarative("add-address-popover-toggle",["click","touchend"],function(a){d.protectAgainstDoubleAction("add-address-popover-toggle",200)||(a.$event.preventDefault(),a=a.$currentTarget.closest(".enter-address-form"),f.toggleAddressForm(a,a.siblings(".enter-address-form")))}),a.declarative("select-radio-option",["click","touchend"],function(a){a=a.$currentTarget.find(".radio-option");a.find('input[type\x3d"radio"]').attr("checked",
"checked");a.closest(".radio-option-list").find(".radio-option").removeClass("radio-option-selected");a.addClass("radio-option-selected")}),a.declarative("trigger-address-popover",["click","touchend"],function(a){d.protectAgainstDoubleAction("trigger-address-popover",200)||E("#add-address-popover-link").trigger("click")}),a.on("checkout:reload:spp-shipaddress",G),a.on("checkout:reload:spp-billing-address",G),a.on("checkout:reload:itemselect",G),a.on("checkout:reload:spp-itemselect",G),{actionTriggerPopoverFromDropdown:H,
actionRegisterTaxAddressController:function(a){y()&&!D&&a&&(D=a)}}});"use strict";q.when("A").register("address-book-controller",function(a){function k(){g("div.address-book").unbind("recalculate-address-height").bind("recalculate-address-height",function(){var a,d=g(),f=0,l=g("div.address-book .js-same-height"),h=l.length;l.css({height:"auto"}).each(function(e){var n=g(this);a=a||n.offset().top;a!==n.offset().top&&(d.height(f),d=g(),f=0,a=n.offset().top);var b=n.height();d=d.add(n);b>f&&(f=b);e===
h-1&&0<f&&d.height(f)})}).trigger("recalculate-address-height");g(p).unbind("resize.checkout-as").bind("resize.checkout-as",function(){g("div.address-book").trigger("recalculate-address-height")})}var g=a.$;a.on("checkout:reload:spp-shipaddress",k);a.on("checkout:reload:shipaddressselect",k);a.on("checkout:reload:billingaddressselect",k);a.on("checkout:reload:spp-billing-address",k)});"use strict";q.when("A","client-side-metrics","weblab-helper").register("address-utilities",function(a,k,g){function c(a){a.find("input").each(function(){var a=
h(this),b=a.outerWidth(!0),d=a.parent().outerWidth(!0);b>d&&a.attr("size")&&(document.getElementById(a.attr("id")).removeAttribute("size"),a.width("100%"))})}function d(a){if(h('input[name\x3d"useLiveAUI"]').length)q.when("p-detect").execute(function(b){b.capabilities.inputPlaceholder&&a.find(".field-description").each(function(){var a=h(this),b=a.text(),d=a.closest(".a-col-right").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");d.attr("maxlength")<b.length&&d.attr("size",
b.length);d.attr("placeholder",a.text())})}),a.find("input").each(function(){h(this).outerWidth()}),a.find("input[type\x3d'text'], select").each(function(){var a=h(this).closest(".full-width-config"),b=h(this);0===a.find(".a-popover-trigger").length&&(g.isInterceptionAddressFormWidthFixEnabled()?b.addClass("addressform-textfield-width"):b.width("96%"))});else{q.when("p-detect").execute(function(b){b.capabilities.inputPlaceholder?a.find(".field-description").each(function(){var a=h(this),b=a.text(),
d=a.closest(".a-column").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");d.attr("maxlength")<b.length&&d.attr("size",b.length);d.attr("placeholder",a.text())}):a.find(".field-description").each(function(){var a=h(this);a.find("br").remove();a.show()})});a.find(".popover-field-label").each(function(){var a=h(this);a.find("b").each(function(){var a=h(this);a.text(h.trim(a.text()))});a.find("font").each(function(){var a=h(this);"-2"===a.attr("size")&&a.remove()})});
var d=h(".enter-address-form");c(d);var b=0,d=a.find(".one-new-address-form-field").first();d.length&&d.find(".a-column").each(function(){b+=h(this).outerWidth()});a.width(0<b?b:"")}}function f(d){function c(){w=h.val();(B=l[w])&&f.find(".learn-more a").text(B.popOverLinkText)}var b=p.P&&p.P.AUI_BUILD_DATE,h=d.find("#enterAddressCountryCode"),f=d.find(".country-specific-form-input"),g,l;b?(g=f.find("input"),l=d.find(".country-specific-config").data("popovercountryconfig")):(k.increaseCount("removeauijs2"),
g=f.find("#"+f.data("inputid")),l=f.find(".country-specific-config").data("popovercountryconfig"));if(h.length&&f.length&&g.length&&l){var w=h.val(),B=l[w];h.unbind("change.countryChangeConfigUpdate").bind("change.countryChangeConfigUpdate",c);c();var r=b?"show":"beforeShow";a.on("a:popover:"+r+":checkout-"+f.data("inputid")+"Name",function(a){"beforeShow"===r&&k.increaseCount("removeauijs3");B&&(a.popover.$popover.find(".a-popover-header h4").html(B.popOverTitle),a.popover.$popover.find(".a-popover-inner").html(B.popOverText),
a.popover.updatePosition())})}}function l(a){function d(){var a=c.val();(a=l[a])?(a=(a=a.label)||"",g.attr("placeholder",h("\x3cdiv /\x3e").html(a).text().replace(":","")),f.show()):f.hide()}var b=p.P&&p.P.AUI_BUILD_DATE,c=a.find("#enterAddressCountryCode"),f=a.find(".country-specific-form-input-mobile"),g,l;b?(g=f.find("input"),l=a.find(".country-specific-config").data("labelcountryconfig")):(k.increaseCount("removeauijs3"),g=f.find("#"+f.data("inputid")),l=f.find(".country-specific-config").data("labelcountryconfig"));
c.length&&f.length&&g.length&&l&&(c.unbind("change.countryChangeLabelUpdate").bind("change.countryChangeLabelUpdate",function(){f.hasClass("initial-edit-value")?f.removeClass("initial-edit-value"):g.val("");d()}),d())}var h=a.$;q.when("a-checkbox").execute(function(d){a.declarative("delivery-preferences-weekend-availability-checkbox-triggered","click",function(a){if("undefined"!==typeof a.$target){var b=a.$target.val();a.$target.is(":checked")&&("NONE"===b?(d("#delivery-preferences-weekend-availability-sat").uncheck(),
d("#delivery-preferences-weekend-availability-sun").uncheck()):"SAT"!==b&&"SUN"!==b||d("#delivery-preferences-weekend-availability-none").uncheck())}})});a.declarative("wdp-redesign-addresstype-radio-clicked","click",function(a){var d=a.$target.context.id;a=h(".com-businesshours-text");var b=h("#delivery-preferences-weekend-availability-sat").is(":checked"),c=h("#delivery-preferences-weekend-availability-sun").is(":checked");"devyPrefs_AddressType_COM"===d?(k.increaseCount("WDPTotalCOMClick"),h(".wdp-res").removeClass("a-color-base-background").addClass("a-color-alternate-background"),
h(".wdp-com").removeClass("a-color-alternate-background").addClass("a-color-base-background"),h(".wdp-BusinessHours").removeClass("aok-hidden")):"devyPrefs_AddressType_RES"===d?(k.increaseCount("WDPTotalRESClick"),h(".wdp-com").removeClass("a-color-base-background").addClass("a-color-alternate-background"),h(".wdp-res").removeClass("a-color-alternate-background").addClass("a-color-base-background"),h(".wdp-BusinessHours").addClass("aok-hidden")):"delivery-preferences-weekend-availability-sat"===d?
(k.increaseCount("WDPTotalSATClick"),d=b?c?"BOTH":"SAT":c?"SUN":"OTH",a.addClass("aok-hidden"),h(".com-businesshours-"+d).removeClass("aok-hidden")):"delivery-preferences-weekend-availability-sun"===d&&(k.increaseCount("WDPTotalSUNClick"),d=c?b?"BOTH":"SUN":b?"SAT":"OTH",a.addClass("aok-hidden"),h(".com-businesshours-"+d).removeClass("aok-hidden"))});return{toggleAddressForm:function(a,f){a.hide();f.find("div.a-alert-error:not(.js-originally-shown-imb)").hide();a.find("input[type\x3d'text'], select, input[type\x3d'radio']:checked, input[type\x3d'hidden']").each(function(){var a=
h(this),d=a.attr("name")||a.data("copyto")||a.attr("id");if(!a.is(":disabled")&&!a.find(":selected").is(".js-not-a-value")){var c=f.find("input[name\x3d'"+d+"']");"enterAddressLandmark"===d&&(c=f.find("input[name\x3d'Landmark']"));"Landmark"!==d||c.length||(c=f.find("input[name\x3d'enterAddressLandmark']"));1<c.length&&a.is("input[type\x3d'radio']")?c.filter("[value\x3d'"+a.val()+"']").attr("checked",!0):c.is("select")?c.find("option[value\x3d'"+a.val()+"']").attr("selected",!0):a.is("input[type\x3d'hidden']")||
c.is("input[type\x3d'hidden']")||c.val(a.val())}});f.show();c(f);d(f)},customizeFormFromIdentity:d,fixOverflow:c,countrySpecificLabelOptimizationCheck:function(a){var d=a.find(".enter-address-form");1===d.data("taxidOpt")?setTimeout(function(){l(d)},100):l(d)},countrySpecificPopoverOptimizationCheck:function(a){var d=a.find(".enter-address-form");1===d.data("taxidOpt")?setTimeout(function(){f(d)},100):f(d)}}});"use strict";q.when("A","page-conductor","page-transition-controller","client-side-metrics",
"page-detector-current-page","checkout-general-utils").register("address-form-helper",function(a,k,g,c,d,f){function l(a,b,d){m(".a-button-close").trigger("click");m('\x3cinput name\x3d"addressID"/\x3e').val(a).appendTo(d);m('\x3cinput name\x3d"purchaseId"/\x3e').val(b).appendTo(d);k.continueClicked(null,d)}function h(a,d){d||(d=m("#address-ui-checkout-form"));n(d);var c=(new Date).getTime();m.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html?cachebuster\x3d"+c,data:{action:"update-address",
lineitems:v,quantities:u,addresses:a,returnHTML:0},async:!0,cache:!1,error:function(){b(d);k.ajaxRedirect},success:function(a,b,c){e("applied",d)}})}function e(a,d){var c=(new Date).getTime(),e=k.setAjaxTransitionHeader();m.ajax({type:"POST",headers:e,url:"/gp/buy/shared/handlers/pipeline-dispatch.html?cachebuster\x3d"+c,data:{useCase:"multiAddress",showAddressAdded:a,page:"itemselect"},dataType:"text",async:!0,cache:!1,error:function(){b(d);k.ajaxRedirect},success:function(a,c,e){b(d);k.ajaxUpdatePage(a,
c,e);m(".a-button-close").trigger("click");f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}})}function n(a){k.isSPP()?(g.blockAllActions(),g.showTransitionInContainer(a)):g.show()}function b(a){k.isSPP()?(g.unblockAllActions(),m(a).find("div.section-overwrap").remove()):g.hide()}var m=a.$,v,u;a.on("a:popover:afterUpdatePosition:edit-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:edit-address",b.popover)});a.on("a:popover:afterUpdatePosition:add-address",
function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:add-address",b.popover)});a.on("a:popover:visible:add-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:add-address",b.popover)});a.declarative("itemselect-update-address",["change"],function(a){a=a.$currentTarget.closest(".lineitem");v=a.find('input[name^\x3d"lineItemEntityID."]').val();u=a.find('input[name^\x3d"quantity."]').val()});return{setDestination:function(a,
b){a||(c.increaseCount("checkout:addressForm:setDestination:noRequest",1),a={});var e=a.addressId;e||c.increaseCount("checkout:addressForm:setDestination:noAddressId",1);var f=a.purchaseId||m("input[name\x3d'purchaseId']").val();f||c.increaseCount("checkout:addressForm:setDestination:noPurchaseId",1);a=a.ref||"ox_shipaddress_add_new_addr";var n=d.getCurrentPage();if("itemselect"===n||"spp-itemselect"===n)return h(e,b);m('[name\x3d"isBilling"]')&&1==m('[name\x3d"isBilling"]').val()?(a="ox_billing_continue",
(b=m("input[name\x3d'paymentInstrumentId']").val())||c.increaseCount("checkout:addressForm:setDestination:noPaymentInstrumentId",1),(n=m("input[name\x3d'paymentMethodCode']").val())||c.increaseCount("checkout:addressForm:setDestination:noPaymentMethodCode",1),a=m("\x3cform/\x3e").attr("action","/gp/buy/billingaddressselect/handlers/continue.html/ref\x3d"+a),m('\x3cinput name\x3d"paymentInstrumentId"/\x3e').val(b).appendTo(a),m('\x3cinput name\x3d"paymentMethodCode"/\x3e').val(n).appendTo(a),m('\x3cinput name\x3d"action" value\x3d"select-billing"/\x3e').appendTo(a),
m('\x3cinput name\x3d"isAUIWSAddressCreationWorkflow" value\x3d"1"/\x3e').appendTo(a)):(a=m("\x3cform/\x3e").attr("action","/gp/buy/addressselect/handlers/continue.html/ref\x3d"+a),m('\x3cinput name\x3d"action" value\x3d"select-shipping"/\x3e').appendTo(a));l(e,f,a)},onPageTransitionStart:n,onPageTransitionComplete:b}});"use strict";q.when("A","client-side-metrics","weblab-helper").register("action-logger",function(a,k){var g=a.$;a.declarative("ue-count",["click","touchend"],function(a){k.increaseCount(a.data.countFlag,
a.data.countValue)});return{logUsedPrefetch:function(a,d,f,l){l||(k.increaseCount("Checkout:action-log:MissingRefMarker"),l="");g.ajax({type:"GET",url:"/gp/buy/shared/handlers/log-used-prefetch.html"+l,data:"pageType\x3d"+a+"\x26subPageType\x3d"+d+"\x26relatedRequestId\x3d"+f,dataType:"text",cache:!1})}}});"use strict";q.when("A","weblab-helper").register("ajax-utility",function(a,k){return{jsonify:function(g){var c;if(c=k.isAJAXWeblabOn()){c=g instanceof Function;var d=g instanceof Array,f=g instanceof
String;c=g instanceof Object&&!d&&!c&&!f}if(c)return g;try{g=a.$.parseJSON(g)}catch(l){g=null}return g}}});"use strict";q.when("A","page-conductor","client-side-metrics","weblab-helper").register("button-blocker",function(a,k,g,c){function d(a,b,d,c){k.isSPP()?b.closest("span.a-declarative").data("blockerText",d):b.find("input.a-button-text").data("blockerText",d);f(c);m?(a.addClass("aok-hidden"),b.removeClass("aok-hidden"),l("#hasTVNavigation").length&&q.when("a-tv").execute(function(b){b.remove(a)})):
(g.increaseCount("removeauijs10"),a.hide(),b.show(),b.hasClass("aok-hidden")&&b.removeClass("aok-hidden"))}function f(a){var b=l(".continue-button-blocker-text");b.length&&(a?(b.html(a),b.removeClass("aok-hidden")):(b.addClass("aok-hidden"),b.empty()))}var l=a.$,h={},e=[],n,b,m=p.P&&p.P.AUI_BUILD_DATE,v=!1;c=c.isPyoClientSideInitiationEnabled()?"checkout:unload":"checkout:beforeReload";a.on(c,function(){e=[];h={};n=""});return{show:function(a,b,c){if(!v){var f=l(".continue-button");if(f.length)if(b){var m=
l(".continue-button-blocker");if(m.length){c=c||"";var t=h[a]!==F&&h[a].tooltipText!==b,k=h[a]!==F&&h[a].buttonInlineText!==c;if(0===e.length||!h[a]||t||k)d(f,m,b,c),n=a;h[a]===F&&e.push(a);h[a]={tooltipText:b,buttonInlineText:c}}}else p.console&&p.console.error&&console.error("showBlockerOnContinue should not be called with an empty tooltip."),g.increaseCount("Checkout:ButtonBlocker:EmptyTooltip")}},hide:function(a){if(!v){if(h[a]!==F){delete h[a];var b=l.inArray(a,e);e.splice(b,1)}var c=l(".continue-button");
c.length&&(b=l(".continue-button-blocker"),b.length&&(0===e.length?(f(),m?(b.addClass("aok-hidden"),c.removeClass("aok-hidden"),l("#hasTVNavigation").length&&q.when("a-tv").execute(function(a){a.add(c)})):(g.increaseCount("removeauijs11"),b.hide(),c.show(),c.hasClass("aok-hidden")&&c.removeClass("aok-hidden"))):n===a&&(n=e[0],d(c,b,h[n].tooltipText,h[n].buttonInlineText))))}},lock:function(){v=!0},unlock:function(){v=!1},getButtonBlocker:function(){b||(b=l(".continue-button-blocker"));return b}}});
"use strict";q.when("A","button-blocker","client-side-metrics").register("button-blocker-controller",function(a,k,g){function c(a,b){l[a]!==F&&l[a].state!==b&&(l[a].state=b,d())}function d(){var a=!0,b;f.each(l,function(d,c){b=c.owner;if(c.state===e.DISABLE_CONTINUE)return a=!1,k.show(b,c.toolTipMessage,c.buttonInlineMessage),h||(g.increaseCount("removeauijs12"),f(".continue-button-blocker").css("display","inline-block")),!1});a&&k.hide(b)}var f=a.$,l={},h=p.P&&p.P.AUI_BUILD_DATE,e={ENABLE_CONTINUE:"enableContinue",
DISABLE_CONTINUE:"disableContinue"};a.on("checkout:beforeReload",function(){l={}});return{disableContinue:function(a,b,h,f){f=f||"";l[b]===F&&(h?(l[b]!==F||(l[b]={state:e.ENABLE_CONTINUE,owner:a,toolTipMessage:h,buttonInlineMessage:f}),d()):p.console&&p.console.error&&console.error("_registerElement should not be called with an empty tooltip."));c(b,e.DISABLE_CONTINUE)},enableContinue:function(a){l[a]!==F&&c(a,e.ENABLE_CONTINUE)}}});"use strict";q.when("jQuery").register("cache-page-data-controller",
function(a){var k={};return{clearCache:function(){k={}},setCachedPageData:function(g,c,d,f,l){var h=[],e=!0;a(".cacheable-spp-panel").each(function(){var b=a(this),d;d=!b||b.find(".is-scheduled-delivery").length?!1:!0;if(!d)return e=!1;b.find(".expand-panel-button").removeClass("a-button-focus");h.push({id:b.attr("id"),content:b[0].outerHTML})});if(e){var n={panels:h};a(".cacheable-spp-section").each(function(){var b=a(this);n[b.attr("id")]=b[0].outerHTML});k[g+"-"+c]={curPageData:n,state:p.history?
history.state:d,page:g,title:document.title||f,url:p.location.href||l}}},getCachedPageData:function(a,c){return k[a+"-"+c]}}});"use strict";q.when("A").register("checkout-general-utils",function(a){function k(a,f,l,h){var e=c.getAssocParamValuesFromUrl(a);!l&&h?delete e[f]:e[f]=l;f=0<=a.indexOf("?")?a.substring(0,a.indexOf("?")):a;f=f+"?"+g.param(e,1);(a=c.getFragmentFromUrl(a))&&(f+="#"+a);return f}var g=a.$,c={moveToNextInput:function(a){a=a.nextAll(":visible").find("input").get(0);a!==[]&&a.focus()},
hide:function(a){a.hide()},show:function(a){p.P&&p.P.AUI_BUILD_DATE&&a.hasClass("aok-hidden")&&a.removeClass("aok-hidden");a.show()},getAssocParamValuesFromUrl:function(a){var c={};if("string"!==typeof a||-1===a.indexOf("?"))return c;a=a.slice(a.indexOf("?")+1);if(!a)return c;-1!=a.indexOf("#")&&(a=a.substring(a,a.indexOf("#")));a=a.split("\x26");for(var g=0;g<a.length;g++){var h=a[g].split("\x3d");c[h[0]]=h[1]}return c},addQueryStringParameter:function(a,c,g){return k(a,c,g,!1)},addQueryStringParameterOrDeleteIfEmpty:function(a,
c,g){return k(a,c,g,!0)},getQueryStringParameter:function(a,f){a=c.getAssocParamValuesFromUrl(a);return f in a?a[f]:F},getFragmentFromUrl:function(a){var c=a.indexOf("#");return-1==c?F:a.substring(c+1)},extractURLParts:function(a){if(!a||"string"!==typeof a)return{};a=/(.*html)(\/ref[^?\n]*)?[?]?(.*)/g.exec(a);var c={};a&&(a[1]&&(c.normalizedUrl=a[1]),a[2]&&(c.refMarker=a[2]),a[3]&&(c.query=a[3]));return c},redirectWithJavascript:function(a){p.location=c.addQueryStringParameter(a,"hasWorkingJavascript",
"1")},bindActionEnterKeyOnButton:function(a){a.keyup(function(a){13===a.which&&g(a.target).trigger("click")})},toggleExpanderContent:function(a){a=a.$target.closest(".a-box");a.hasClass("a-single")?a.removeClass("a-single").addClass("a-first"):a.addClass("a-single").removeClass("a-first")},validateNumber:function(a,c,l){g.trim(a);return/^\d+$/.test(a)&&a>=c&&a<=l}};c.protectAgainstDoubleAction=function(){var a={};return function(c,g){if(!c)return p.console&&p.console.error&&console.error("Function is not used properly, use a unique owner to identify the caller."),
!1;if(a.hasOwnProperty(c))return!0;a[c]=1;setTimeout(function(){delete a[c]},g||100);return!1}}();c.logErrorOnLevel=function(a,c){(p.ueLogError||g.noop)({message:a,logLevel:c});if(p.console){var l={FATAL:p.console.error,"default":p.console.warn};c=l[c]||l["default"]}else c=g.noop;c.call(p,a)};c.logError=function(a){c.logErrorOnLevel(a,"FATAL")};c.updateCartByMash=function(a){q.when("safe-mash").execute(function(c){null!==a&&a!==F&&"1"===g("#updateCartByMash").attr("content")&&c&&c.cart&&c.cart.didUpdate&&
c.cart.didUpdate({newCartQuantity:a})})};c.getPosition=function(a,c,g){for(var h=0,e=a.length,n=0;n<e;n++)if(a.charAt(n)===c&&(h++,h===g))return n;return-1};c.limitInputToNumbers=function(a){var c=a.$event.keyCode;-1!==g.inArray(c,[46,8,9,37,39])||-1!==g.inArray(c,[65,67,86])&&!0===a.ctrlKey||(a.$event.shiftKey||(48>c||57<c)&&(96>c||105<c))&&a.$event.preventDefault()};c.nukeDropdowns=function(a){q.when("a-popover-base").execute(function(c){g.each(g(a),function(){c.remove(this.name)})})};a.on("checkout:reload",
function(){g('input[name\x3d"useLiveAUI"]').length||a.defer(function(){g(".a-declarative, .a-button").filter("[data-action]").unbind("keypress.checkout-page").bind("keypress.checkout-page",function(a){13===a.which&&g(this).trigger("click")})})});a.on("checkout:beforeLoadPage",function(){g("div.a-popover").find(".a-declarative:first:[data-action\x3dcustom-popover-close|a-popover-close]").click()});return c});"use strict";q.when("A","weblab-helper").register("client-side-metrics",function(a,k){var g=
a.$,c=null,d=null,f=0,l;a=function(){};var h=p.uet||a,e=p.uex||a,n=!1,b=!1,m=function(a){p.ue&&p.ue.t&&(p.uet(a,c),r("checkout:client-side-metrics:uet:marker:"+a,1,1),null===c&&null===d&&p.ue.isl&&(r("checkout:client-side-metrics:mark:at",1,1),p.uex("at")));"af"===a?n=!0:"fn"===a&&(b=!0)},v=function(a){p.ue&&p.uex&&(p.uex(a,c),r("checkout:client-side-metrics:uex:marker:"+a,1,1))},u=function(a){p.ue&&p.ues&&p.ues("id",c,a)},z=function(){p.ue&&p.ues&&p.ues("ctb",c,"1")},w=function(){p.ue&&p.ues&&(p.ues("t0",
c,(new Date).getTime()),m("ue"),m("bb"))},B=function(a){a?d="ctbajax"+f++:c="ajax"+f++},r=function(a,b,c){"undefined"!==typeof p.ue&&"undefined"!==typeof p.ue.count&&(b=b?b:1,c?p.ue.count(a,(p.ue.count(a)||0)+1):p.ue.count(a,b))},t=function(a){if(a&&a.length){var b=c;c=d;u(a);c=b}},H=function(){l===F&&(l=0<g("#transitionLogging").length);return l},y=function(a,b,c,d){p.ueLogError&&p.ueLogError(a,{message:b,attribution:c,logLevel:d})};return{getscope:function(){return c},getasyncscope:function(){return d},
setmarker:m,sendue:v,setrid:u,setctb:z,resetue:w,createscope:B,setscope:function(a){c=a},increaseCount:r,resetMetrics:function(){c=d;z();w()},setAsyncRequestId:t,sendUEPageLoadStats:function(){!k.isCSMErrorLoggingEnabled()||n&&b||y({message:"Logged ld without both af and fn logged first af:"+n+" fn:"+b},"","checkout-client-side-metrics","WARN");k.isLogAFFNFallbackEnabled()&&(!0===n&&r("checkout:client-side-metrics:page-load-stats:earlyaf",1),r("checkout:client-side-metrics:page-load-stats:af",1),
m("af"));k.isLogAFFNFallbackEnabled()&&(!0===b&&r("checkout:client-side-metrics:page-load-stats:earlyfn",1),r("checkout:client-side-metrics:page-load-stats:fn",1),m("fn"));v("ld");B(1);b=n=!1},isTransitionLoggingEnabled:H,logPageTransition:function(a,b,c,d){if(H()){var e=(new Date).getTime();g.ajax({type:"POST",url:"/gp/buy/shared/handlers/log-page-transition.html?cachebuster\x3d"+e,data:{fromPage:a,toPage:b},async:!0,cache:!1,timeout:1E3,success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-requestid");
t(e);c&&c.call(this,a,b,d)},complete:function(a,b){d&&d.call(this,a,b)}})}},logError:y,startWidgetTiming:function(a){h("bb",a,{wb:1})},finishWidgetTiming:function(a){e("ld",a,{wb:1})},setMarkerForWidget:function(a,b){h(a,b,{wb:1})},emitNexusMetrics:function(a,b,c){"undefined"!==typeof p.ue&&"undefined"!==typeof p.ue.event&&p.ue.event(a,b,c)}}});"use strict";q.register("currency-formatter",function(){function a(k,g){isNaN(g)||(k=Number(k).toFixed(g));k=k.toString();g=0<=k.lastIndexOf(".")?k.lastIndexOf("."):
k.length;return 3>=g?k:a(k.substring(0,g-3),0)+","+k.substring(g-3)}return{getNumberWithSeparators:a}});"use strict";q.when("A","client-side-metrics","page-conductor","page-detector").register("delivery-preferences-csm-helper",function(a,k,g,c){function d(a){var d=g.isSPP()?"spp":"mpp",f="desktop";c.isMobile()?f="mobile":c.isTablet()&&(f="tablet");k.increaseCount("checkout:delivery-preferences:"+f+":"+d+":"+a,1)}function f(a){return 0===a.length?"NoValueSet":a}var l=a.$;return{recordCSM:d,recordCSMWithCurrentFieldValues:function(a,
c,g){c=l("input[name\x3d"+c+"]:checked");c.length&&(c=c.val(),d(a+":preference:"+f(c)));g=l("input[name\x3d"+g+"]");g.length&&d(a+":set-as-default:"+(g.is(":checked")?"yes":"no"))},recordCSMForEligiblePages:function(a){a=a||"";d(a+"eligible-page-displayed");var c=l("input[name\x3ddelivery-preferences-preference-set]");c.length&&d(a+"summary-displayed:preference:"+f(c.val()))}}});"use strict";q.when("page-detector-current-page","A").register("error-feature-detection",function(a,k){function g(a){p.errorFeatureDetection&&
p.errorFeatureDetection.safelyLogError?p.errorFeatureDetection.safelyLogError(a):(p.ueLogError&&p.ueLogError(a),p.console&&p.console.error&&console.error(a))}try{k.on("page-detector:page-changed",function(){var c=a.getCurrentPage();if(c&&"spc"===c)try{p.errorFeatureDetection&&p.errorFeatureDetection.enableErrorHandling&&p.errorFeatureDetection.enableErrorHandling()}catch(d){g(d)}else try{p.errorFeatureDetection&&p.errorFeatureDetection.disableErrorHandling&&p.errorFeatureDetection.disableErrorHandling()}catch(d){g(d)}})}catch(c){g(c)}return{registerFeature:function(a,
d){try{p.errorFeatureDetection&&p.errorFeatureDetection.registerFeature&&p.errorFeatureDetection.registerFeature(a,d)}catch(f){g(f)}},markFeatureAvailable:function(a){try{p.errorFeatureDetection&&p.errorFeatureDetection.markFeatureAvailable&&p.errorFeatureDetection.markFeatureAvailable(a)}catch(d){g(d)}},markFeatureUnavailable:function(a){try{p.errorFeatureDetection&&p.errorFeatureDetection.markFeatureUnavailable&&p.errorFeatureDetection.markFeatureUnavailable(a)}catch(d){g(d)}}}});q.when("error-feature-detection").execute(function(a){a.registerFeature("continue-action",
0);a.markFeatureAvailable("javascript-detection");a.markFeatureAvailable("continue-action")});"use strict";q.when("A","loading-spinner-controller","ajax-utility","currency-formatter","page-conductor","page-transition-controller").register("inline-points-register-controller",function(a,k,g,c,d,f){function l(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,
String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))}function h(a){var b=u.$popover.find(".rewards-registration");k.hideSpinner(b);b.children("div").hide();b=b.find(".rewards-registration-error");a&&a.error?(a=b.find("[data-error\x3d'"+a.error+"']"),a.length?a.show():b.find("[data-error\x3d'rewards_SystemUnavailable']").show()):b.find("[data-error\x3d'rewards_SystemUnavailable']").show();b.fadeIn(300)}function e(a){u=a.popover;var b=u.$popover.find(".rewards-registration");
k.showSpinner(b,!1,u);a=b.data("issuer-id");var c=b.data("program-id"),d=b.data("cc-issuer"),e=b.data("cc-brand"),b=b.data("parent-payment-method-id"),f="/gp/buy/payselect/handlers/get-rewards-configuration.html?cachebuster\x3d"+(new Date).getTime();v.ajax({type:"POST",url:f,data:"programid\x3d"+c+"\x26partner\x3d"+a+"\x26ccpaymentinstrumentid\x3d"+b+"\x26issuer\x3d"+d+"\x26brand\x3d"+e+"\x26hasWorkingJavascript\x3d1",dataType:"text",async:!0,cache:!1,dataFilter:function(a){return g.jsonify(a)},success:function(a,
b,c){b=u.$popover.find(".rewards-registration");k.hideSpinner(b);c=a.fields||{};for(var d in c)if(c.hasOwnProperty(d)){var e=c[d],h=b.find("[data-field\x3d'"+e.type+"']");e.value&&h.filter("input").attr("value",e.value);h.parents(".rewardsfield").show()}a.termshtml&&b.find(".rewardstermstext").html(l(a.termshtml));a.billingzip&&b.find("[data-field\x3dBILLING_POSTAL_CODE]").attr("value",a.billingzip);if(a.displaydata){d=b.find("[data-field]");for(var f in a.displaydata)a.displaydata.hasOwnProperty(f)&&
d.filter("[data-field\x3d"+f+"]").html(a.displaydata[f])}a.marketinglink&&b.find("[data-field\x3d'rewards_marketing_link']").html(a.marketinglink);b.find("#rewards-registration-image").show();b.find(".rewards-registration-main").fadeIn(300);u.updatePosition(!0)},error:function(a){h(a)}})}function n(){if(u){var a=u.$popover.find(".rewards-registration");k.hideSpinner(a);a.find(".rewards-registration-success").hide();a=a.find(".rewards-registration-error");a.hide();a.find("h4").hide();z&&(f.show(),
d.isSPP()?d.reloadPage():v("div.pay").length?d.loadPage("payselect","payselect"):v("div.spc").length&&d.loadPage("spc","spc"))}}function b(a){return a.is("input")?a:a.find("input")}function m(){if(u){var a=u.$popover.find(".rewards-registration");a.find(".rewards-registration-main").hide();a.find("#rewards-registration-image").hide();k.showSpinner(a,!1,u);var d=(new Date).getTime(),e="programid\x3d"+encodeURIComponent(a.data("programId")),e=e+("\x26paymentinstrumentid\x3d"+encodeURIComponent(a.data("parent-payment-method-id"))+
"\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26cachebuster\x3d"+d),f=a.find("[data-field]");f.each(function(){var a=v(this).attr("data-field");if("CVV2"===a)e+="\x26registerRewardsCreditCardVerificationNumber\x3d"+encodeURIComponent(v(this).val());else if(v(this).data("entryindex")){if(1===v(this).data("entryindex")){var c=f.filter("[data-field\x3d"+a+"]").sort(function(a,b){return Number(v(a).data("entryindex"))-Number(v(b).data("entryindex"))});e+="\x26"+a+"\x3d";c.each(function(){e+=encodeURIComponent(v(this).val())})}}else"TERMS_AND_CONDITIONS"===
a?b(v(this)).is(":checked")&&(e+="\x26"+a+"\x3dtrue"):e+="\x26"+a+"\x3d"+encodeURIComponent(v(this).val())});d="ox_pay_page_swp_reg_popover_submit";a.data("programId")&&(d+="_"+a.data("programId"));a="/gp/buy/payselect/handlers/register-rewards-account.html/ref\x3d"+d+"?cachebuster\x3d"+(new Date).getTime();v.ajax({type:"POST",url:a,data:e,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return g.jsonify(a)},success:function(a,b,d){a?a&&0===a.success?h(a):u&&(b=u.$popover.find(".rewards-registration-success"),
b.find(".customername").text(a.customername),a.dollarbalancedisplay&&a.pointsbalance&&(b.find("[data-field\x3d'rewardsamount']").html(a.dollarbalancedisplay),b.find("[data-field\x3d'pointsamount']").html(c.getNumberWithSeparators(a.pointsbalance,a.rewardsdecimalplaces)),b.find(".rewardsuccessbalance").show()),a.showwarnmessage&&b.find(".warnmessage").show(),z=!0,b.fadeIn(300),k.hideSpinner(u.$popover.find(".rewards-registration"))):h()},error:function(a){h(a)}})}}var v=a.$,u,z=!1;a.on("a:popover:show:rewards-registration",
e);a.on("a:popover:hide:rewards-registration",n);a.declarative("close-rewards",["click"],function(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")});a.declarative("rewards-signup",["click"],function(a){a.$event.preventDefault();m(a)});a.declarative("toggle-reward-signup-button","change",function(a){a=a.$target;var b=u.$popover.find(".rewards-registration");a&&a.is(":checked")?(b.find("#reward-signup-button").removeClass("aok-hidden"),b.find("#disabled-reward-signup-button").addClass("aok-hidden")):
(b.find("#reward-signup-button").addClass("aok-hidden"),b.find("#disabled-reward-signup-button").removeClass("aok-hidden"))});a.on("a:popover:beforeShow:cvv2helpcontent",function(a){a.popover.$popover.find(".a-popover-inner").html(v(".cvv2helpcontent").text());a.popover.updatePosition()});return{displayRewardsRegister:e,hideRewardsRegister:n}});"use strict";q.when("A","error-feature-detection","safe-mash","ready").register("shared-kitchensink",function(a,k,g){var c=a.$;a.on("checkout:reload",function(){(c("body.a-touch").length||
c("div.a-touch:first").length)&&c("html").addClass("a-touch");c("form").each(function(){var a=c(this).find('input[name\x3d"hasWorkingJavascript"]');a&&0<a.length?a.val("1"):c(this).append('\x3cinput type\x3d"hidden" name\x3d"hasWorkingJavascript" value\x3d"1" /\x3e')});g&&(c("div.checkout-tablet a[target\x3d'AmazonHelp']").each(function(){var a=c(this).attr("href"),a=a+(0<=a.indexOf("?")?"\x26app-nav-type\x3dmodal":"?app-nav-type\x3dmodal"),a=a.replace("#","");c(this).attr("href",a);c(this).removeAttr("data-action");
c(this).removeAttr("data-help-popup");c(this).removeAttr("onclick")}),c("div.checkout.mobile a[target\x3d'AmazonHelp']").each(function(){var a=c(this).attr("href"),a=a.replace("#","");c(this).attr("href",a);c(this).removeAttr("data-help-popup");c(this).removeAttr("onclick");c(this).addClass("a-declarative help-popup");c(this).attr("data-action","help-popup")}));if(0<c("div.checkout-tablet").length)for(var a=document.getElementsByTagName("a"),f=0;f<a.length;f++)a[f].href||(a[f].href="#")});c(document).bind("jsdetection",
function(){k.markFeatureAvailable("javascript-detection")})});q.when("A","safe-mash","ready").execute(function(a,k){var g=a.$;a.declarative("mash-navigate",["click"],function(a){a=a.$currentTarget.attr("href");k&&k.navigate?k.navigate({url:a}):p.location.href=a});a.declarative("expander-scroll-there",["click"],function(a){if("false"!==a.$currentTarget.closest(".a-expander-container").find(".a-expander-content").attr("aria-expanded")){var d=g(p),f=g(document),l=a.$currentTarget.offset().top,h=0,e=
0,n=function(){p.setTimeout(function(){d.scrollTop(l);h===f.height()?e++:(e=0,h=f.height());10>e&&n()},10)};n()}})});p.amz_js_PopWin=function(a,k,g){(a=p.open(a,k,g))&&a.focus&&a.focus();return!1};var pa=!1;p.confirmPurchase_onSubmit||(p.confirmPurchase_onSubmit=function(){return pa?!1:pa=!0});"use strict";q.when("A","error-feature-detection","loading-spinner-spp-controller","loading-spinner-aui-controller").register("loading-spinner-controller",function(a,k,g,c){function d(){return l("#checkout-spinner").length}
function f(a){if(h&&e){var b,c,d;m&&z?(a=m.getContent(),b=a.innerHeight(),c=a.innerWidth()):(b=a.height(),c=a.width());d=a.offset();a=e.width();var f=e.height();if(n)d="1"===l("input[name\x3dfromAnywhere]").val()?l(document).height():l(p).height(),h.width(l(document).width()).height(d).css("left","0px").css("z-index",2E3),e.css("left",c/2-a/2+"px").css("top",b/2-f/2+"px").css("z-index",4E3).show();else{var g=l(p),k=z?g.scrollLeft():0;h.css("position","fixed").width(c).height(b).css("z-index",3E3).css("left",
d.left-k).css("top",d.top-g.scrollTop());v?e.css("position","fixed").css("left",d.left-k+(c/2-a/2)+"px").css("top",d.top-g.scrollTop()+(b/2-f/2)+"px").css("z-index",4E3).show():e.css("left",c/2-a/4+"px").css("top",b/2-f/4+"px").css("z-index",4E3).show()}}}var l=a.$,h,e,n,b,m,v=!1,u=!1,z=!1,w=!1;a.on("a:popover:positionUpdated",function(a){if(z&&m&&m.name===a.popover.name&&h&&e){var b=m.getContent();a=b.innerHeight();var c=b.innerWidth(),b=b.offset(),d=l(p);h.width(c).height(a).css("left",b.left-d.scrollLeft()).css("top",
b.top-d.scrollTop());e.css("left",b.left-d.scrollLeft()+(c/2-e.width()/2)+"px").css("top",b.top-d.scrollTop()+(a/2-e.height()/2)+"px")}});a.on("checkout:reload",function(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",c=l("#first-pipeline-load-page-spinner-img");c.length&&(a=l.trim(c.attr("src")));1>l("#loading-spinner-blocker-doc").length&&(a=l(['\x3cdiv class\x3d"template loading-spinner" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-inner"\x3e',
'\x3cimg id\x3d"loading-spinner-img" class\x3d"loading-spinner-img" src\x3d"'+a+'"/\x3e','\x3c/div\x3e\x3c/div\x3e\x3cdiv id\x3d"loading-spinner-blocker-doc" class\x3d"loading-spinner-blocker" style\x3d"display:none;"\x3e\x3c/div\x3e\x3cdiv id\x3d"spinner-anchor" class\x3d"spinner-anchor" style\x3d"display:none"\x3e\x3c/div\x3e'].join("")),e=h=b=null,"1"===l("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),l("body").prepend(a));l("input[name\x3duseModifiedSpinnerResizeFn]").length&&
(v=!0);l("#useRelativeSpinner").length&&(u=!0);l("#modifiedBlockerDivSize").length&&(z=!0)});return{showSpinner:function(a,r,t){if(u&&!r&&z&&v&&t)return w=!0,g.showSpinner(a,t);d()?c.showSpinner():(w=!1,0!==a.length&&(m=(n=r)?F:t,b||(b=l(".loading-spinner.template").clone().removeClass("template"),b.show()),a.append(b),n?(h=l("#loading-spinner-blocker-doc"),a.find(".loading-spinner-blocker").hide()):h=a.find(".loading-spinner-blocker"),h.show(),n&&k.markFeatureUnavailable("continue-action"),e=a.find(".loading-spinner-inner"),
f(a)))},hideSpinner:function(a,e){if(d())return c.hideSpinner();if(w)return w=!1,g.hideSpinner(a,e);w=!1;h&&(n&&(h.hide(),k.markFeatureAvailable("continue-action")),b.detach());e&&a.hide()},adjustSize:function(a){return d()?c.adjustSize():w?g.adjustSize():f(a)}}});"use strict";q.when("A","error-feature-detection").register("loading-spinner-spp-controller",function(a,k){function g(){if(d&&f){var a=h.innerHeight(),b=h.innerWidth();d.width(b).height(a);f.css("left",b/2-f.width()/2+"px").css("top",a/
2-f.height()/2+"px")}}var c=a.$,d,f,l,h,e;a.on("a:popover:positionUpdated",function(a){e&&e.name===a.popover.name&&g()});a.on("checkout:reload",function(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",b=c("#first-pipeline-load-page-spinner-img");b.length&&(a=c.trim(b.attr("src")));1>c(".loading-spinner-spp").length&&(a=c(['\x3cdiv class\x3d"template loading-spinner-spp" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-spp-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-spp-inner"\x3e',
'\x3cimg class\x3d"loading-spinner-spp-img" src\x3d"'+a+'"/\x3e',"\x3c/div\x3e\x3c/div\x3e"].join("")),f=d=l=null,"1"===c("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),c("body").prepend(a))});return{showSpinner:function(a,b){0!==a.length&&(e=b,h=a,l||(l=c(".loading-spinner-spp.template").clone().removeClass("template"),l.show()),b.getContent().before(l),h.prepend(l),d=h.find(".loading-spinner-spp-blocker"),d.show(),f=h.find(".loading-spinner-spp-inner"),
g())},hideSpinner:function(a,b){d&&l.detach();b&&a.hide()},adjustSize:g}});"use strict";q.when("A","error-feature-detection").register("loading-spinner-aui-controller",function(a,k){function g(){return c("#checkoutDisplayPage").outerHeight()}var c=a.$;return{showSpinner:function(){k.markFeatureUnavailable("continue-action");var d=c("#checkout-spinner");a.show(c("#checkout-spinner-overwrap").height(g()));d.attr("aria-busy","true");a.show(d)},hideSpinner:function(){k.markFeatureAvailable("continue-action");
var d=c("#checkout-spinner");a.hide(c("#checkout-spinner-overwrap"));d.attr("aria-busy","false");a.hide(d)},adjustSize:function(){var d=c("#checkout-spinner-overwrap");d.is(":visible")&&a.show(d.height(g()))}}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils","client-side-metrics","safe-mash","cache-page-data-controller","ajax-wrapper","widget-streamer","widget-streamer-utils","weblab-helper","temporary-preference-indicator").register("page-conductor",
function(a,k,g,c,d,f,l,h,e,n,b,m,v){function u(a){p.ueLogError&&p.ueLogError({message:a},{logLevel:"WARN",attribution:"CheckoutCommonAsset-PageConductor"})}function z(a){ja&&(a?(a["x-amz-checkout-transition"]||(a["x-amz-checkout-transition"]="ajax"),a["x-amz-checkout-type"]||(a["x-amz-checkout-type"]="spp")):a={"x-amz-checkout-transition":"ajax","x-amz-checkout-type":"spp"});m.isPipelineDispatchSendHeaderEnabled()&&(a?a["x-amz-checkout-transition"]||(a["x-amz-checkout-transition"]="ajax"):a={"x-amz-checkout-transition":"ajax"});
return a}function w(){na=!1;ca=null;sa=0;T=!1;qa=ua=va=null}function B(a){var b=parseInt(Q("#checkoutDisplayPage").data("delaySetTitle"),10)||0;b?p.setTimeout(function(){document.title=a},b):document.title=a}function r(b){"function"===typeof a.state.parse&&a.state.parse();a.trigger("checkout:beforeReload");a.trigger("checkout:reload");b&&("spp-revieworder"===b?a.trigger("checkout:reload:spc"):a.trigger("checkout:reload:"+b));a.trigger("checkout:afterReload")}function t(a){k.show();var b="/gp/buy/addtocart/handlers/display.html";
a&&(b+="?errorType\x3d"+a);p.location=b}function H(b){(b=Q("#pageTypeRedirectedTo").text())&&a.trigger("checkout:reload:"+b)}function y(b,c){var d;if(c.getResponseHeader("x-amz-force-full-page-update"))G(b);else{if(c.getResponseHeader("x-amz-checkout-redirect-addtocart")){(c=g.jsonify(b))?t(c.errorCode):t();return}d=ha(b)}b=Q("#pipelinedPageTitle").text();B(b);var e=c.getResponseHeader("x-amz-checkout-page");ja?a.delay(function(){r(e)},d):r(e)}function G(a){var b=document.open("text/html","replace");
b.write(a);b.close()}function E(a,b){try{if(b.getResponseHeader("x-amz-force-full-page-update"))G(a);else{if(!wa)throw Error("Member _updateDisplayPageContent not set in page-conductor. Make sure 'initFunc' is called.");wa(a)}}catch(c){a="Error while replacing page content.",c.message&&(a+="  Error message: "+c.message),q.error(a,"page-conductor","replaceDisplayPage",c)}a=Q("#pipelinedPageTitle").text();B(a);b=b.getResponseHeader("x-amz-checkout-page");r(b)}function I(a){var b=parseInt(Q("#showPageTransition").attr("content"),
10);(b=isNaN(b)?1:b)||k.hide();b="/gp/buy/shared/handlers/dispatch.html";a&&(a.conductoraction&&a.conductoraction.url?b=a.conductoraction.url:a.pipedata&&a.pipedata.conductoraction&&a.pipedata.conductoraction.url&&(b=a.pipedata.conductoraction.url));b=0<b.indexOf("?")?b+"\x26":b+"?";Q("input[name\x3dfromAnywhere][value\x3d1]").length&&(b+="fromAnywhere\x3d1");b=A(b);l&&Q("html").hasClass("a-tablet")&&-1<b.indexOf("/gp/cart/view.html")&&(b="/gp/aw/c?app-action\x3dcart");p.location=b}function da(a,
b,c,d,e){d=d||{};d.pushNewFrame=d.pushNewFrame||"true";d.anchor=d.anchor||F;w();"true"===d.pushNewFrame&&l&&l.navigate&&Q("#checkoutDisplayPage").data("useMashNavigateForTransitions")?l.navigate({url:null,transitionEffect:"slide",successCallback:function(){D(a,b,c,d,e)},failCallback:function(a){}}):D(a,b,c,d,e);d.keepCachedPagesData||h.clearCache()}function W(){var a=Q("input#isPipelinedPage");return 0<a.length&&"1"===a.val()}function P(a){return m.isExecutionIdInQueryStringEnabled()?a?a.getResponseHeader("x-amz-checkout-executionid"):
d.getQueryStringParameter(p.location.href,"executionId"):Q("input#executionId").val()}function D(d,e,h,n,t){function l(a){var b=h.getResponseHeader(a);null==b&&(f.increaseCount("Checkout:PageConductor:Ajax:Update:MissingHeader"),f.increaseCount("Checkout:PageConductor:Ajax:Update:MissingHeader:"+a),u("performUpdatePageFromResponse is missing required header "+a));return b}function k(a){var b=/^\s*\<(?:!doctype|html)/;if("string"===typeof a&&a.match(b)){var b=(new DOMParser).parseFromString(a,"text/html"),
c=Q(b).find("#checkoutDisplayPage");if(0<c.length)return f.increaseCount("Checkout:PageConductor:Ajax:Update:CenterContentExtracted"),c[0].outerHTML;b=Q(b).find("body");if(0<b.length)return f.increaseCount("Checkout:PageConductor:Ajax:Update:BodyExtracted"),b[0].outerHTML}return a}n=n||{};n.pushNewFrame=n.pushNewFrame||"true";n.anchor=n.anchor||F;var ga=l("x-amz-checkout-page"),v=l("x-amz-checkout-requestid");c.setCurrentPage(ga);if(n.freshLoad)n.freshLoad=!1,q.when("first-load-dependencies").execute(function(a){D(d,
e,h,n)});else if(ga){Q("head .aui-page-asset").removeAttr("disabled");Q("head .old-pipeline-asset").removeAttr("disabled");f.setAsyncRequestId(v);var Z=h.getResponseHeader("x-amz-checkout-redirect");if(Z)I({conductoraction:{url:Z,type:"redirect"}});else{m.isIngressEnabled()&&(d=k(d));if(m.isAJAXWeblabOn()&&b.isStreamingAjax(h))m.isAjaxStreamingEnabled()?r(ga):(H(h),U(d,ga));else if(a.trigger("checkout:unload"),0<Q("#checkoutDisplayPage").length?E(d,h):y(d,h),m.isAjaxStreamingEnabled()&&W()){var Z=
Q("#pipelinedPageTitle").text(),B=l("x-amz-checkout-url"),G=h.getResponseHeader("x-amz-checkout-additional-page-args");N(ga,Z,B,P(h),G,n.anchor,n.pushNewFrame)}!m.isAjaxStreamingEnabled()&&W()&&(Z=Q("#pipelinedPageTitle").text(),B=l("x-amz-checkout-url"),G=h.getResponseHeader("x-amz-checkout-additional-page-args"),N(ga,Z,B,P(h),G,n.anchor,n.pushNewFrame));n.anchor&&(ga=Q(n.anchor),0===ga.length&&(ga=n.anchor.replace("#",""),ga=Q(document.getElementsByName(ga))),ga.length&&Q(document).scrollTop(ga.offset().top));
n.logUsedPrefetch&&q.when("action-logger").execute(function(a){a.logUsedPrefetch(l("x-amz-checkout-page-type"),l("x-amz-checkout-sub-page-type"),v,t)})}}else{if(p.getOldAjaxSuccessCallback)return p.getOldAjaxSuccessCallback("ajaxConductor","generalErrorHandling","generalErrorHandling")(d,e,h);d=g.jsonify(d);I(d)}}function N(a,b,c,e,h,f,g){b&&c&&p.history&&p.history.pushState&&(m.isExecutionIdInQueryStringEnabled()?"true"!==g||history.state&&history.state.page===a||(c=A(c),f&&(c+=f),e&&(c=d.addQueryStringParameterOrDeleteIfEmpty(c,
"executionId",e)),history.pushState({page:a,additionalURLArgs:h},b,c)):(c=A(c),f&&(c+=f),e&&(c=d.addQueryStringParameter(c,"executionId",e)),"true"===g&&history.state&&history.state.page!==a&&history.pushState({page:a,additionalURLArgs:h},b,c)))}function U(a,b){a.executeActions();a=Q("#pipelinedPageTitle").text();B(a);r(b)}function x(){p.location=Fa?"/gp/buy/addtocart/handlers/display.html":"/gp/buy/payselect/handlers/error.html"}function L(c,d,h,f,g,n){f=f||{};f.refTag=f.refTag||"";f.pushNewFrame=
f.pushNewFrame||"true";f.anchor=f.anchor||F;f.refTag&&0!==f.refTag.indexOf("/ref\x3d")&&(f.refTag="/ref\x3d"+f.refTag);c="fromPage\x3d"+c+"\x26page\x3d"+d;(n=P(n))&&(c+="\x26executionId\x3d"+n);h&&(c+="\x26"+h);h=function(){};n=function(){};var t;"function"===typeof f.resultscallback?(d=function(a,b,c){f.resultscallback(a,b,c)},t=function(a,b,c){f.resultscallback(F,b,a)}):(h=function(b){a.trigger("checkout:beforeLoadPage");K&&K.abort();K=b},d=function(a,c,d){m.isAJAXWeblabOn()&&b.isStreamingAjax(d)||
f.callbackBeforePageUpdate&&f.callbackBeforePageUpdate();da(a,c,d,f);f.callbackAfterPageUpdate&&f.callbackAfterPageUpdate()},t=function(a,b,c){"abort"!==b&&("error"===b&&a.readyState===e.READY_STATE.UNSET?q.when("a-tv","mash").execute(function(a,b){p.cordova.exec(null,null,"MASHDisplayErrorPlugin","execute",{})}):(ba(a,b),x()))},n=function(a){K=null});g={type:"GET",url:(g?g:"/gp/buy/shared/handlers/pipeline-dispatch.html")+f.refTag,data:c,dataType:"text",async:!0,beforeSend:h,success:d,error:t,complete:n,
cache:!1};if(ja||m.isPipelineDispatchSendHeaderEnabled())g.headers=z({"x-amz-checkout-transition":"ajax"});return m.isAJAXWeblabOn()?(g.useXMLHttp=!0,g=m.isAjaxStreamingEnabled()?O(g,f.callbackBeforePageUpdate,f.anchor,f.pushNewFrame):O(g,f.callbackBeforePageUpdate),e.aui(g)):Q.ajax(g)}function O(d,e,h,f){d.timeout=5E4;d.data=V(d.data,"acceptsStreaming\x3d1");var g;g=d.data.match(/.*isAsync=1.*/)?!0:!1;M=n({$target:Q("#checkoutDisplayPage"),updateTriggerEvent:"pageReady",immediateExecution:!g,updateTarget:Q("#checkoutDisplayPage"),
onUpdate:function(b){"function"===typeof e&&e();a.trigger("checkout:unload");B(b.title);N(b.page,b.title,b.url,b.executionId,b.additionalURLArgs,h,f||"true");c.setCurrentPage(b.page)}});d.chunk=M.chunkHandler;if(!m.isAjaxStreamingEnabled()){var t=d.success;d.success=function(a,c,d){t&&b.isStreamingAjax(d)?t(M,c,d):t&&t(a,c,d)}}return d}function V(a,b){return a?a+"\x26"+b:b}function ba(a,b){f.increaseCount("Checkout:PageConductor:Ajax:Error");m.isAJAXWeblabOn()?(a?(f.increaseCount("Checkout:AUI:Ajax:jqXHR:defined"),
u("jqXHR defined throw CheckoutErrorAW under AJAX Weblab, textStatus:"+b+" stateCode:"+a.state+" readyState:"+a.readyState)):a===F?(f.increaseCount("Checkout:AUI:Ajax:jqXHR:undefined"),u("jqXHR undefined throw CheckoutErrorAW under AJAX Weblab")):null===a&&(f.increaseCount("Checkout:AUI:Ajax:jqXHR:null"),u("jqXHR null throw CheckoutErrorAW under AJAX Weblab")),f.increaseCount("Checkout:AUI:Ajax:Error:textStatus:"+b),f.increaseCount("Checkout:AUI:Ajax:Error:statusCode:"+a.status),f.increaseCount("Checkout:AUI:Ajax:Error:readyState:"+
a.readyState)):(a?(f.increaseCount("Checkout:jQuery:Ajax:jqXHR:defined"),u("jqXHR defined throw CheckoutErrorAW using jQuery, textStatus:"+b+" stateCode:"+a.state+" readyState:"+a.readyState)):a===F?(f.increaseCount("Checkout:jQuery:Ajax:jqXHR:undefined"),u("jqXHR undefined throw CheckoutErrorAW using jQuery")):null===a&&(f.increaseCount("Checkout:jQuery:Ajax:jqXHR:null"),u("jqXHR null throw CheckoutErrorAW using jQuery")),f.increaseCount("Checkout:jQuery:Ajax:Error:textStatus:"+b),f.increaseCount("Checkout:jQuery:Ajax:Error:statusCode:"+
a.status),f.increaseCount("Checkout:jQuery:Ajax:Error:readyState:"+a.readyState))}function fa(a,b,c,h){var g=a;b=V(b,"isClientTimeBased\x3d1");var n;if(m.refactorExtractURL()){n=d.extractURLParts(a);a=n.normalizedUrl;if(!a)return f.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:T1"),u("Unable to normalize url ["+g+"]. Ajax request aborted."),!1;var t=a.indexOf("/gp/buy/");0<t?(a=a.substring(t),f.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:T1")):f.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:T1");
n.query?(b+="\x26"+n.query,f.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:T1")):f.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:T1");n=n.refMarker;n||(f.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:T1"),n="");n&&-1===n.indexOf("ref\x3d")&&(f.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:T1"),n="")}else{var l=a.indexOf("?");0<l?(b+="\x26"+a.substring(l+1),a=a.substring(0,l),f.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:C")):
f.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:C");t=a.indexOf("/gp/buy/");0<t?(a=a.substring(t),f.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:C")):f.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:C");if(l=-1!=a.indexOf("/checkout/p/p-"))a=a.slice(a.indexOf("/checkout/p/p-")),f.increaseCount("Checkout:PageConductor:submitAjax:url:chewbacca:C");else{if(-1===a.indexOf(".html"))return f.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:C"),
u("url ["+g+"] is missing html extension and not a chewbacca call. Ajax request aborted."),!1;g=a.indexOf(".html");n=a.substring(g+5);a=a.substring(0,g+5)}n||f.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:C");n&&-1===n.indexOf("ref\x3d")&&(f.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:C"),n="")}b+="\x26handler\x3d"+a;a={type:"POST",url:l?a:"/gp/buy/shared/handlers/async-continue.html"+n,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
headers:z({"x-amz-checkout-transition":"ajax"}),data:b,dataType:"text",async:!0,success:c,error:function(a,b,c){"abort"!==b&&("error"===b&&a.readyState===e.READY_STATE.UNSET?q.when("a-tv","mash").execute(function(a,b){p.cordova.exec(null,null,"MASHDisplayErrorPlugin","execute",{})}):"function"===typeof h&&(ba(a,b),h()))},cache:!1};return m.isAJAXWeblabOn()?(a.useXMLHttp=!0,O(a),e.aui(a)):Q.ajax(a)}function aa(a,b,c,d,e){e=e&&e.action?e.action:a.attr("action");a=a.serialize();d&&(a+="\x26isAsync\x3d1");
return fa(e,a,b,c)}function X(a,b,c,d){a=A(a.attr("href"));d&&(a+="\x26isAsync\x3d1");return fa(a,"",b,c)}function ea(a){a=a||{};a.logUsedPrefetch=1;da(ca.data,ca.status,ca.response,a,ca.refMarker)}function A(a){-1===a.toLowerCase().indexOf("hasworkingjavascript")&&(a+=(0<=a.indexOf("?")?"\x26":"?")+"hasWorkingJavascript\x3d1");return a}function Y(a){T=!1;var b=c.getCurrentPage(),d=qa-ua,e=sa;xa&&clearTimeout(xa);if(a.is("form"))Z(a)?(ea(),f.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+
e+":Success"),f.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+e+":TimeSaved",d)):(aa(a,da,x),f.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+e+":Failure:Invalid"));else if(a.is("a"))if(ka(a)){var h;1===parseInt(a.data("keepCachedPagesData"),10)&&(h={keepCachedPagesData:1});ea(h);f.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+e+":Success");f.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+e+":TimeSaved",d)}else X(a,da,x),f.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+
e+":Failure:Invalid");else f.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+e+":Failure:NoTrigger"),q.error("function called without a trigger","page-conductor","handleContinueAction")}function Z(a){return a.is("form")&&null!==ca&&ca.serializedValue===a.serialize()}function ka(a){return a.is("a")&&null!==ca&&A(ca.serializedValue)===A(a.attr("href"))}function ga(a){return ia&&(a.is("form")&&ia!==a.serialize()||a.is("a")&&A(ia)!==A(a.attr("href")))}function R(a,e,h,n,t){function l(c,d,v){var E=
!0;if("success"===d){if(!m.isAJAXWeblabOn()||!b.isStreamingAjax(v)){var B=g.jsonify(c);null!==B&&B&&B.result&&"noPrefetch"===B.result&&(ca=null,E=!1)}E&&(ca={},ca.serializedValue=Z,ca.data=c,ca.status=d,ca.response=v,ca.refMarker=ga,null==qa&&(qa=(new Date).getTime()))}else ca=null,f.increaseCount("Checkout:"+k+":PageConductor:Prefetch:"+sa+":Failure:Response");na=!1;ja&&q.when("spp-button-blocker").execute(function(a){a.hideDefaultContinueBtnBlocker()});if(T)return Y(va),!0;if(E){var u=function(){n?
R(a,e,h,!0,t):ra(a)};if(null===ca||"form"===r&&ca.serializedValue!==a.serialize())return u(),!0;e&&(0===e?f.increaseCount("checkoutPrefetchTimeoutSetToZero",1):xa=setTimeout(function(){ca=null;u()},1E3*e))}return!0}if(!W()||0===a.length)return!1;var r=a.get(0).tagName.toLowerCase();if("form"!==r&&"a"!==r||"function"===typeof t&&!t(r))return!1;e=e||0;h=h||0;n=n||!1;if(na||sa>=h)return!1;na=!0;ja&&q.when("spp-button-blocker").execute(function(a){a.showDefaultContinueBtnBlocker()});sa++;var k=c.getCurrentPage();
ua=(new Date).getTime();qa=null;f.increaseCount("Checkout:"+k+":PageConductor:Prefetch:"+sa+":Attempted");xa&&clearTimeout(xa);var ga=d.extractURLParts("form"===r?a.attr("action"):a.attr("href")).refMarker,v,Z=null;"form"===r?(Z=a.serialize(),v=m.isAJAXWeblabOn()?aa(a,l,l,!0):aa(a,null,null,!0)):"a"===r&&(Z=A(a.attr("href")),v=m.isAJAXWeblabOn()?X(a,l,l,!0):X(a,null,null,!0));m.isAjaxStreamingEnabled()&&Z&&(ia=Z);"object"!==typeof v||"function"!==typeof v.always||m.isAJAXWeblabOn()||v.always(l)}function ra(a){var b=
parseInt(a.data("prefetchTimeout"),10),c=parseInt(a.data("maxPrefetches"),10);return R(a,b,c,!1,function(b){if(a.find("input:checked").hasClass("no-prefetch"))return!1;if(m.disablePrefetchForScheduledDeliveryWeblabOn()){var c=a.find("div.one-shipment:not(:hidden)").find("input:checked");if(c.parents('[data-a-input-name\x3d"'+c.attr("name")+'"]').hasClass("no-prefetch"))return!1}return"1"===Q("input#block-prefetch").val()||"1"===Q("input#block-all-prefetch").val()||"form"===b&&!a.data("checkoutFormReady")?
!1:!0})}function ta(){var a=c.getCurrentPage();return"payselect"===a||"spp-payment"===a||"pay"===a}function S(b,c){na&&null==qa&&(qa=(new Date).getTime());b&&b.preventDefault();v.isTemporaryPaymentPreferenceFeatureEnabled&&v.isTemporaryPaymentPreferenceFeatureEnabled()&&ta()&&v.hasActiveTemporaryPreference&&v.hasActiveTemporaryPreference()&&w();var d=b?Q(b.currentTarget):c;b=function(){if(ja){k.blockAllActions();var a=d.data("shrink-panel"),b=d.data("loading-text");(a=Q("#"+a))&&a.length?a.hasClass("expanded")||
k.shrinkPanel(Q(".spp-panel.expanded"),!1):a=Q(".spp-panel.expanded");k.shrinkPanel(a,!0,b)}else k.show()};f.resetMetrics();!ya||Z(d)||ka(d)?b():a.delay(b,0);try{T=!0,va=d,m.isAjaxStreamingEnabled()&&M&&!ga(d)&&M.enableExecution(),na||Y(d)}catch(e){b="An error occured while click on the continue button.",e.message&&(b+="  Error message: "+e.message),q.error(b,"page-conductor","continueClicked",e)}}function Ba(){Q("#checkout-btf-spinner").addClass("aok-hidden")}var Q=a.$,na,ua,qa,K,ca,sa,T,va,xa,la,
wa,ia,ha=function(a){if(!la)throw Error("Member _updatePageContent not set in page-conductor. Make sure 'initFunc' is called.");return la(a)},ja=!1,Fa=!1,oa=!1,ya=!1,za=!1,M;w();a.declarative("page-transit-no-update-action","click",function(b){if(!oa){b.$event.preventDefault();f.resetMetrics();var d=b.data.targetDeclarativeActionId;if(d&&(d=Q("#"+d),d.length)){d.trigger("click");return}var e=b.data.toPage,d=b.data.fromPage||c.getCurrentPage(),g=b.data.refTag||"chk_"+d+"_cancel_pri",n=b.data.args,
t=b.$currentTarget.find("a.checkout-pipeline-pref-link");ja&&(m.isCachingOfPSPPanelOnTrueSPCDisabled()&&"spp-payment"===d?f.increaseCount("checkout:trueSPC:disableCachingPSP:"+e,1):h.setCachedPageData(d,e));if(h.getCachedPageData(e,d)){f.increaseCount("checkout:"+d+":cancelpri",1);g=h.getCachedPageData(e,d);w();c.setCurrentPage(g.page);var l;l=m.isAJAXWeblabOn()?ha(g.curPageData):ha(JSON.stringify(g.curPageData));if(ja)if(f.isTransitionLoggingEnabled()){var ga=(new Date).getTime();f.logPageTransition(d+
"-cached",e,F,function(b){b=(new Date).getTime()-ga;b<l?a.delay(function(){r(e)},l-b):r(e)})}else a.delay(function(){r(e)},l);else r(e);g.title&&g.url&&p.history&&p.history.pushState&&history.state&&history.state.page!==g.page&&history.pushState(g.state,g.title,g.url)}else t.length?S(null,t):(f.increaseCount("checkoutSPPCancelNoCachedData",1),t=function(){if(ja)if(k.blockAllActions(),b.data.noShrink)k.show();else{var a=b.data.loadingText,c=Q("#"+b.data.shrinkPanel);c.length||(c=b.$currentTarget.closest("div.spp-panel"));
k.shrinkPanel(c,!0,a)}else k.show()},ya?a.delay(t,0):t(),L(d,e,n,{refTag:g,keepCachedPagesData:1}))}});m.isAjaxStreamingEnabled()&&(a.on("checkout:page:atf",function(){k.hide();Q("#checkout-btf-spinner").removeClass("aok-hidden")}),a.on("checkout:page:end",function(){Ba()}));a.on("ready",function(){ya=0<Q("#executeNonBlockingAnimations").length;za=0<Q("#prefetchFromAddressEnabled").length});a.on("checkout:afterReload",function(){k.hide();m.isAjaxStreamingEnabled()&&Ba();a.delay(f.sendUEPageLoadStats);
if(W()){var b=Q("form.checkout-page-form:not(:disabled):first"),c=Q("a.checkout-continue-link:not(:disabled):first");Q("#useFirstActivePrefetch").length&&(c=Q("a.checkout-continue-link:not(:disabled)").filter(function(){return 0<(parseInt(Q(this).data("maxPrefetches"),10)||0)}).first());var d=!1;b.length&&(d=ra(b));!d&&c.length&&(d=ra(c));!d&&ja&&(b=Q("a.checkout-pipeline-pref-link:not(:disabled):first"),b.length&&(c=b.data("fromPage"),d=b.data("toPage"),h.getCachedPageData(d,c)||(d=ra(b))))}});return{ajaxUpdatePage:da,
ajaxRedirect:I,ajaxSorryPage:x,isPageLoadRequestInProgress:function(){return K?1:0},submitFormAjax:aa,reloadPage:function(){var a=c.getCurrentPage();L(a,a)},loadPage:L,usePrefetch:ea,makePrefetch:ra,makePrefetchWithParams:R,isPrefetchValidFor:function(a){if(null!==ca){var b=ca.response.getResponseHeader("x-amz-checkout-page");return a===b}return!1},redirect:I,continueClicked:S,initFunc:function(a,b){la=a;wa=b},overrideIsSPP:function(a){ja=a},isSPP:function(){return ja},overrideAddToCart:function(a){Fa=
a},isAnimating:function(){return oa},overrideIsAnimating:function(a){oa=a},setAjaxTransitionHeader:z,isPipeliningOn:W,disablePageNoUpdateTransition:function(){za&&q.when("a-button").execute(function(a){var b=Q(".spp-panel.expanded").data("stepIndex");Q(".expand-collapsed-panel-trigger").each(function(){var c=Q(this),d=c.parents(".spp-panel").data("stepIndex");if(!b||!d||d>b)c.filter(".clickable-heading").removeClass("clickable-heading").addClass("off-clickable-heading"),a(c.filter(".expand-panel-button")).disable(),
c.filter("a.expand-panel-button").addClass("disabled-link"),c.parents(".a-declarative").addClass("off-declarative").removeClass("a-declarative")});Q(".panel-cancel-row").hide()})},enablePageNoUpdateTransition:function(){za&&q.when("a-button").execute(function(a){Q(".off-clickable-heading").addClass("clickable-heading").removeClass("off-clickable-heading");a(".expand-collapsed-panel-trigger.expand-panel-button").enable();Q(".off-declarative").addClass("a-declarative").removeClass("off-declarative")})},
isNonBlockingAnimationEnabled:function(){return ya},isPrefetchFromAddressEnabled:function(){return za},getExecutionId:P,isPrefetchRequestInProgress:function(){return na}}});q.when("jQuery","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils","page-conductor","cache-page-data-controller","client-side-metrics","weblab-helper","ready").execute(function(a,k,g,c,d,f,l,h,e){if(f.isPipeliningOn()){p.history&&a(p).bind("popstate",function(){var b=this.history.state,
d=c.getCurrentPage();b&&b.page&&d&&(b.page!==d||f.isPageLoadRequestInProgress())&&(k.show(),d=a("#checkoutDisplayPage"),d.data("wipeOnPipelineBackTransition")&&d.empty(),h.resetMetrics(),a("#useFastBackButton").length&&f.isPrefetchValidFor(b.page)?f.usePrefetch({pushNewFrame:!1}):(d="spc"===b.page?"":b.page,f.loadPage(c.getCurrentPage(),d,b.additionalURLArgs,{refTag:"pipelinedBackButton",pushNewFrame:"false"})))});a(document).delegate("form.checkout-page-form","change",function(b){a(b.target).parent().hasClass("no-prefetch-on-change")||
(b=a(b.currentTarget),f.makePrefetch(b))});a(document).delegate("form.checkout-page-form","submit",function(a){f.continueClicked(a)});a(document).delegate("a.checkout-continue-link","click",function(a){f.continueClicked(a)});a(document).delegate("form.checkout-page-form .submit-button-with-name","click",function(b){b=a(b.currentTarget);a("\x3cinput\x3e").attr({type:"hidden",name:b.attr("name"),value:b.val()}).appendTo(b.closest("form.checkout-page-form"))});var n=!1;a(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a",
"touchmove",function(a){n=!0});a(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a","click keypress touchend",function(b){if(n)n=!1,b.preventDefault();else if(d.protectAgainstDoubleAction("pipeline-link"))b.preventDefault();else if("keypress"!==b.type||13===b.which){var c=a(b.currentTarget),e=c.data("pipelineLinkFromPage"),g=c.data("pipelineLinkToPage"),z=c.data("pipelineLinkAnchor"),w=c.data("pipelineLinkRef");w||((w=d.extractURLParts(c.attr("href")).refMarker)?h.increaseCount("Checkout:PageConductor:LoadPage:AddedRefMarker"):
h.increaseCount("Checkout:PageConductor:LoadPage:NoRefMarkerInUrl"));c=c.data("pipelineLinkArgs");g&&(h.resetMetrics(),b.preventDefault(),f.isSPP()&&l.setCachedPageData(e,g),k.show(),b={refTag:w,anchor:z},f.isSPP()&&(b.keepCachedPagesData=1),f.loadPage(e,g,c,b))}});a(document).delegate("a.spclite-dispatch-link","click keypress touchend",function(b){if("keypress"!==b.type||13===b.which){var c=a(b.currentTarget),d=c.data("spcliteLinkFromPage"),e=c.data("spcliteLinkToPage");c.data("spcliteLinkAnchor");
var h=c.data("spcliteLinkRef"),c=c.data("spcliteLinkArgs"),g=a("input#executionId").val(),c=c?c+("\x26executionId\x3d"+g):"executionId\x3d"+g;e&&(b.preventDefault(),k.show(),f.loadPage(d,e,c,{refTag:h},"/gp/buy/shared/handlers/spclite-dispatch.html"))}})}a(document).delegate("input.submit","click touchend",function(){h.resetMetrics()});a(document).delegate("form","submit",function(){h.resetMetrics()});a(document).delegate(".panel-cancel-row a, .clickable-heading","click",function(){h.isTransitionLoggingEnabled()&&
h.resetMetrics()});e.isExecutionIdInQueryStringEnabled()&&(a.ajaxSetup({beforeSend:function(a,c){c.url&&(a=d.getQueryStringParameter(p.location.href,"executionId"),c.url=d.addQueryStringParameterOrDeleteIfEmpty(decodeURIComponent(c.url),"executionId",a));return!0}}),a(document).ajaxSuccess(function(a,c,e){if(e&&e.url&&e.url.match(/\/async-continue|\/set-|\/update-|\/new/i)&&(a=c.getResponseHeader("x-amz-checkout-sub-page-type")||"Unknown",!a.match(/^p-/))){e=f.getExecutionId(c);if(p.history&&p.history.replaceState){var g=
d.addQueryStringParameterOrDeleteIfEmpty(p.location.href,"executionId",e,!0);p.history.replaceState(p.history.state,"",g)}else h.increaseCount("Checkout:PageConductor:NoReplaceState");e||(c=c.getResponseHeader("x-amz-checkout-page-type")||"Unknown",h.increaseCount("Checkout:PageConductor:"+(null===e?"ExecutionIdIsNotSet":"ExecutionIdIsEmpty")+":"+c+":"+a,1))}}))});"use strict";q.when("A","a-popover-base","a-popover-util").register("checkout-modal-popover",function(a,k,g){function c(b){return b.disableHide?
function(){}:function(){var c=this;c.animating=!0;a.fadeOut(this.$popover,250);b.secondaryPopover||e("#a-popover-modal").hide();a.delay(function(){c.animating=!1},250)}}function d(a,b){var d=c(b);a=a.$event.triggerPositioningElement?a.$event.triggerPositioningElement:a.$declarativeParent;(n=k.show({$trigger:a,name:b.name,skin:m(b.header,b.closeButton,b.closeTextOverride),content:b.content,url:b.url,data:b.data,update:u,alone:b.alone?"true"===b.alone:!0,position:b.position||"triggerVertical",hide:d}))&&
n.$trigger!==a&&(n.$trigger=a,n.updatePosition())}function f(a,d){d.disableHide=!0;var h=c(d);b=!1;(d=k.show({$trigger:a.$declarativeParent,skin:v(d.header,d.footer,d.closeButton,d.contentClass),name:d.name,requestURL:d.url,position:"windowCenter",update:u,data:d.data,updatePosition:d.allowScrollOnPage?z:w,modal:!0,alone:d.alone?"true"===d.alone:!0,show:function(){this.animating=!0;this.$popover.show();e("#a-popover-modal").show();this.animating=!1},hide:h}))&&d.$trigger!==a.$declarativeParent&&(d.$trigger=
a.$declarativeParent,d.updatePosition())}function l(b){var c=b.$declarativeParent;a.delay(function(){h(b,c)},250)}function h(b,c){n&&(g.eventOccursWithin(b,c)||g.eventOccursWithin(b,n.$popover))?a.delay(function(){h(b,c)},250):k.hide(c)}var e=a.$,n,b=!1,m=function(a,b,c){return function(d){var h=c;c===F&&(h=e("input#closeButtonText").val()||"");var f="";h&&(f='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+h+"\x3c/a\x3e\x26nbsp;");h="false"===
b?"":['\x3cdiv class\x3d"popover-close-section"\x3e',f,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");return['\x3cdiv class\x3d"a-popover"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',a||h?['\x3cdiv class\x3d"a-popover-header"\x3e\x3ch4\x3e',a,"\x3c/h4\x3e",h,"\x3c/div\x3e"].join(""):"",'\x3cdiv class\x3d"a-popover-inner"\x3e',d,'\x3c/div\x3e\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}},
v=function(a,b,c,d){return function(h){var f=e("input#closeButtonText").val()||"",g="";f&&(g='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+f+"\x3c/a\x3e\x26nbsp;");f="false"===c?"":['\x3cdiv class\x3d"popover-close-section"\x3e',g,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");f=a||f?['\x3cdiv class\x3d"a-popover-header huawei-device-header-fix"\x3e\x3ch4\x3e',
a,"\x3c/h4\x3e",f,"\x3c/div\x3e"].join(""):"";g="";if(b){var n=e("#a-popover-footer-"+b);0<n.length&&(g=['\x3cdiv class\x3d"a-popover-footer"\x3e',n.html(),"\x3c/div\x3e"].join(""))}return['\x3cdiv class\x3d"a-popover a-popover-modal"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',f,'\x3cdiv class\x3d"a-popover-inner ',d,'"\x3e',h,"\x3c/div\x3e",g,'\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}};a.declarative("custom-popover-close",
["click","touchend"],function(b){b.$event.preventDefault();var c=b.$target;e("html").hasClass("a-ie6")||e("html").hasClass("a-ie7")||e("html").hasClass("a-ie8")?c.closest(".a-popover").hide():a.fadeOut(c.closest(".a-popover"),250);e("#a-popover-modal").hide();a.trigger("a:declarative:a-popover-close:click",{$target:c,$event:b.$event,$currentTarget:b.$currentTarget})});a.on("a:popover:positionUpdated",function(a){a=a.popover.$popover;0>a.offset().left&&a.offset({left:0});0>a.offset().top&&a.offset({top:0})});
a.on("a:popover:show",function(a){if(a.popover&&a.popover.$trigger){var b=a.popover.$trigger.data("aCheckoutModalPopover");b&&b.allowScrollOnPage&&a.popover.$popover.css("position","absolute")}});var u=function(a){e(".a-popover-inner",this.$popover).html(a)},z=function(a){if(!b||a)w.call(this,!0),b=!0},w=function(a){var b=e(p),c=b.height()/2,d=b.width()/2,h=this.$popover.height()/2,f=this.$popover.width()/2,c=c-h;if(a||"fixed"!==this.$popover.css("position"))c+=b.scrollTop();a=Math.max(0,d-f);c=Math.max(0,
c);this.$popover.css({top:c,left:a})};a.declarative("a-checkout-popover",["click","mouseenter","mouseleave","keyup","touchend"],function(a){a.data.showOnHover&&"touchend"!==a.type?"mouseenter"===a.type||"click"===a.type?d(a,a.data):"mouseleave"===a.type&&l(a):("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&d(a,a.data)});a.declarative("a-checkout-modal-popover",["click","keyup","touchend"],function(a){("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&
f(a,a.data)});a.on("checkout:reload",function(){a.defer(function(){0===e("#a-popover-modal").length&&e("body").append('\x3cdiv id\x3d"a-popover-modal" /\x3e')})});return{hideById:function(a){k.hide(a)},createModal:f}});"use strict";(function(){var a=!1;q.when("A").register("page-detector",function(k){function g(){return c("checkout-as")}function c(a){h||(h={});h.hasOwnProperty(a)||(h[a]=0<l("div."+a).length);return h[a]}function d(){return c("checkout.pay")}function f(){return c("checkout.spc")}var l=
k.$,h;k.on("checkout:reload",function(){h={};a||q.when("page-detector-current-initializer").execute(function(a){a.initializeDetectorWithCurrentPage(null)})});return{isAddressSelect:g,isAddressTranslation:function(){return c("translate-address-form")},isDesktopPayment:function(){return d()&&c("pay-desktop")},isDesktopSpc:function(){return f()&&c("spc-desktop")},isMobileAddressSelect:function(){return g()&&c("checkout-as-mobile")},isMobilePayment:function(){return d()&&c("pay-mobile")},isMobileSpc:function(){return f()&&
c("spc-mobile")},isTabletAddressSelect:function(){return g()&&c("checkout-as-tablet")},isTabletPayment:function(){return d()&&c("pay-tablet")},isTabletSpc:function(){return f()&&c("spc-tablet")},isSpcLite:function(){return f()&&c("spclite")},isPayment:d,isSosp:function(){return c("checkout.sosp")},isSpc:f,isMobile:function(){return c("checkout.mobile")},isTablet:function(){return c("checkout.tablet")}}});q.register("page-detector-current-initializer",function(){return{initializeDetectorWithCurrentPage:function(k){if(!a){var g=
k;q.register("page-detector-current-page",function(){return{getCurrentPage:function(){return g},setCurrentPage:function(a){var d=g;g=a;q.when("A").execute(function(f){f.trigger("page-detector:page-changed",d,a)})}}});a=!0}}}})})();"use strict";q.when("jQuery","loading-spinner-controller").register("page-spinner-controller",function(a,k){function g(){"function"===typeof z.blockAllActions&&z.blockAllActions()}function c(){"function"===typeof z.unblockAllActions&&z.unblockAllActions()}function d(a){"function"===
typeof z.showTransitionInContainer&&z.showTransitionInContainer(a)}function f(){var b=a(p).width(),c=a(p).height(),d=a(p),e=0;null!==u&&(e=u.outerHeight()-a(p).scrollTop(),0>e&&(e=0));m.css("top",d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(b).height(c);"1"!==a("input[name\x3dfromAnywhere]").val()&&a("#loading-spinner-blocker-doc").css("top",d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(b).height(c)}function l(){var b;b=document.activeElement?a(document.activeElement):
a(":focus:first");b.is("button, a, input:enabled")&&b.blur()}function h(){if(w){g();q.when("spp-button-blocker").execute(function(a){a.hideContinueBtnBlocker()});var c=a(".spp-panel.expanded");if(0<c.length&&c.is(":visible")){d(c,1);return}}if(v)return m.length&&m.find(".loading-spinner-inner").show(),!1;v=!0;l();m=a("#spinner-anchor");m.find(".loading-spinner-inner").show();a("#unblockHeader").length&&(u=a("#header"));n=m.css("z-index");a(p).unbind("scroll.checkout-page-spinner").bind("scroll.checkout-page-spinner",
function(a){b&&p.clearTimeout(b);b=setTimeout(function(){f();b=null},50)});a(p).unbind("resize.checkout-page-spinner").bind("resize.checkout-page-spinner",function(){f();k.adjustSize(m)});a(p).unbind("orientationchange.checkout-page-spinner").bind("orientationchange.checkout-page-spinner",function(){f();k.adjustSize(m)});f();m.show();m.css("z-index",2E3);k.showSpinner(m,!0);return!0}function e(){if(w)c(),"function"===typeof z.hideSpinner&&z.hideSpinner();else{a("#first-pipeline-load-page-spinner").remove();
if(!v)return!1;v=!1;m.length&&m.find(".loading-spinner-inner").show();m&&(a(p).unbind(".checkout-page-spinner"),m.hide(),m.css("z-index",n),k.hideSpinner(m));return!0}}var n,b=null,m,v=!1,u=null,z={},w=!1;return{show:h,showPageTransition:function(){return"0"===a("#showPageTransition").attr("content")?!1:h()},hide:e,hidePageTransition:function(){"0"===a("#showPageTransition").attr("content")&&e();return!0},hideAnimatedSpinnerImage:function(){m.length&&m.find(".loading-spinner-inner").hide()},initFunc:function(a){null!==
a&&(z=a,w=!0)},blockAllActions:g,unblockAllActions:c,showTransitionInContainer:d,shrinkPanel:function(a,b,c){"function"===typeof z.shrinkPanel&&z.shrinkPanel(a,b,c)},clearFocus:l}});"use strict";q.when("A").execute(function(a){a=a.$;var k="",k="mash-transitions"===a("input[name\x3dpageTransitionType]").val()?"page-mash-transition-controller":"page-spinner-controller";q.when(k).register("page-transition-controller",function(a){q.when("A").execute(function(c){c.declarative("page-spinner-show",["click"],
{allowLinkDefault:!0},function(c){c=c.$target;c.hasClass("a-button-disabled")||c.closest(".a-button-disabled").length||a.showPageTransition()})});q.when("A").execute(function(c){c.declarative("page-spinner-show-on-submit",["submit"],{allowLinkDefault:!0},function(c){a.showPageTransition()})});return{show:a.show,hide:a.hide,showPageTransition:a.showPageTransition,hidePageTransition:a.hidePageTransition,blockAllActions:a.blockAllActions,unblockAllActions:a.unblockAllActions,showTransitionInContainer:a.showTransitionInContainer,
shrinkPanel:a.shrinkPanel}})});"use strict";q.when("A","page-conductor","client-side-metrics","page-detector-current-page","a-popover","ready").execute(function(a,k,g,c){function d(a,c,d){k.isSPP()&&g.setmarker&&g.setmarker("af");g.sendUEPageLoadStats()}var f=a.$,l=!1;a.on("a:popover:afterHide",function(a){a.popover&&(l=!1)});a.on("a:popover:beforeShow",function(a){var c=a.popover;c&&(l=!0,c.$trigger.find(".modal-parameters").each(function(){f.each(f(this).data(),function(a,b){c.attrs(a,b)})}))});
a.on("a:popover:dismiss",function(a){a=a.popover;if(g.isTransitionLoggingEnabled()&&a&&l){l=!1;var e,f;"prime-acquisition-spc-popover"===a.name&&(e="prime-acquisition",f=c.getCurrentPage());e||f||!a.attrs||(e=a.attrs("returnfrom"),f=a.attrs("returnto"));e&&f&&(g.resetMetrics(),g.logPageTransition(e,f,d))}})});"use strict";q.when("A","page-detector-current-page","checkout-general-utils","client-side-metrics").register("first-load-dependencies-base",function(a,k,g,c){function d(){"function"===typeof p.uet&&
"function"===typeof p.uex&&(p.uet("cf","first-load-dependencies-ready",{wb:1}),p.uex("ld","first-load-dependencies-ready",{wb:1}));c.startWidgetTiming("first-load-dependencies:checkout:beforeReload");a.trigger("checkout:beforeReload");c.finishWidgetTiming("first-load-dependencies:checkout:beforeReload");c.startWidgetTiming("first-load-dependencies:checkout:reload");a.trigger("checkout:reload");c.finishWidgetTiming("first-load-dependencies:checkout:reload");var d;l&&(d="spp-revieworder"===l?"spc":
l);d&&(c.finishWidgetTiming("first-load-dependencies:checkout:reload:"+d),a.trigger("checkout:reload:"+d),c.finishWidgetTiming("first-load-dependencies:checkout:reload:"+d));c.startWidgetTiming("first-load-dependencies:checkout:afterReload");a.trigger("checkout:afterReload");c.finishWidgetTiming("first-load-dependencies:checkout:afterReload");setTimeout(function(){var a=f("#first-pipeline-load-page-spinner");a.is(":visible")&&(a.remove(),c.increaseCount("checkout:pageload:timeout"),g.logError("The page has taken more than 90 seconds to load, or there was a JS error preventing it from loading, hiding page spinner."))},
9E4)}var f=a.$,l=k.getCurrentPage();"function"===typeof p.uet&&p.uet("bb","first-load-dependencies-ready",{wb:1});return{allDependenciesCheck:function(a){if(a&&a.length){var e=!1,n={};f.each(a,function(a,b){c.startWidgetTiming("checkout:dependency:"+b+":ready");n[b]=1;q.when(b).execute(function(){c.finishWidgetTiming("checkout:dependency:"+b+":ready");delete n[b]})});var b=function(a){a="Page ("+l+") is missing dependencies ["+a.join(", ")+"] after 5 secs.";c.increaseCount("checkout:dependency:missed:regular-page:error");
g.logErrorOnLevel(a,"ERROR")},m=setTimeout(function(){if(!e){var a=[];f.each(n,function(b){c.increaseCount("checkout:dependency:"+b+":missed");a.push(b)});c.increaseCount("checkout:dependency:missed");0<f("#assets-prefetch").length?c.increaseCount("checkout:dependency:missed:assets-prefetch"):(c.increaseCount("checkout:dependency:missed:regular-page"),b(a));d()}},5E3);q.when.apply(q,a).execute(function(){e=!0;p.clearTimeout&&m&&p.clearTimeout(m);d()})}else d()}}});"use strict";q.when("A","page-detector",
"client-side-metrics").register("gift-utility",function(a,k,g){var c=a.$,d=/[^\s\u0020-\u007E\u00A0-\u00FF]/g,f=p.P&&p.P.AUI_BUILD_DATE,l=/((?:file|https?|ftps?|sip):\/\/)/im,h=/((?:\b|[\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?])www\.(?:(?:[^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?]+\.[^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?]+))+)(?:[\s!@#$%^&*()_=+[\]{}\|;:'",<>\?]|$|\b)/im,e=/([^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?\/]+\.(?:[a-z][a-z]|aero|arpa|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|om|pro|qa|tel|travel|xxx)(?:\b|$))/im,
n=/^\S+\@\S+\.\S+$/im;return{getInput:function(a){return a.is("input")?a:a.find("input")},getCharCount:function(a,c){return c?p.unescape(encodeURIComponent(a)).length:a.length},getLineCount:function(a,c){var d=a.split("\n").length;c=Math.floor(c);a=a.split("\n");for(var e=0;e<a.length;e++)a[e].length>c&&(d+=Math.floor(a[e].length/c),0===a[e].length%c&&d--);return d},getNameWithNoTitle:function(a){var c=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&(c=!0);c&&
a.shift();return a.join(" ")},getFirstName:function(a){var c=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&(c=!0);c&&a.shift();return a.shift()},toggleGiftMessageWarning:function(a,e){var h=e.find(".gift-message-warning");if(d.test(a.val())){var n=e.find(".gift-message-preview-trigger"),l=a.val().replace(d,"?");f?q.when("a-popover").execute(function(a){var b=a.get(n);b?b.update({content:l}):a.create(n,{inlineContent:l,position:"triggerVertical",closeButton:"false"})}):
(g.increaseCount("removeauijs13"),n.unbind("click.preview").bind("click.preview",function(a){q.when("a-popover-base").execute(function(b){var d=c(a.target);d.data("popoverid")&&(b=b.get(d.data("popoverid")))&&(b.update(l),b.updatePosition())})}));a.addClass("a-form-error");h.show()}else a.removeClass("a-form-error"),h.hide()},valueContainsUrl:function(a){return l.test(a)||h.test(a)||e.test(a)},isValidEmail:function(a){return n.test(""+a)}}});"use strict";q.when("A","page-detector","safe-mash","client-side-metrics").register("help-popup",
function(a,k,g,c){function d(){if(f("div#help-popover").length){f(p).unbind("resize.checkout-help-popover");var a=f("#help-popover-frame")[0];f(a.contentWindow?a.contentWindow:a.contentDocument.defaultView).undelegate("a","click");f("div#help-popover").remove()}}var f=a.$;k=k.isMobile();c=f("input#isPipelinedPage");c=0<c.length&&"1"===c.val();var l=k&&c&&g&&g.navigate;a.declarative("help-popup",["click"],function(a){if(!f(".a-touch").length||l){a.$event.preventDefault();a.data&&"1"===a.data.stopPropagation&&
a.$event.stopPropagation();var c=a.$target.closest("a").attr("href");a=a.data;l?g.navigate({url:c,transitionEffect:"slide"}):(a.width||(a.width="340"),a.height||(a.height="340"),p.open(c,"AmazonHelp","width\x3d"+a.width+",height\x3d"+a.height+",left\x3d10,top\x3d10,resizable\x3dyes,scrollbars\x3dyes,menubar\x3dno,toolbar\x3dyes,location\x3dno,directories\x3dno,status\x3dyes"))}else p.open(a.$target.closest("a").attr("href"),"AmazonHelp")});if(l)a.on("checkout:reload",d)});"use strict";q.execute("persistent-order-controller",
function(){return{}});"use strict";q.when("jQuery","page-conductor").register("quantity-service",function(a,k){function g(c,d){d=d||{};var f;d.additionalData&&(f=d.additionalData);var g="/gp/buy/pipeline/handlers/update-quantity.html",h={returnFullHTML:1,cachebuster:(new Date).getTime(),isClientTimeBased:0,hasWorkingJavascript:1};f&&f.deletePrimeMembership&&f.primeMembershipASIN&&(h.deletePrimeMembershipItemIn=f.deletePrimeMembership,h.deletedPrimeMembershipASINIn=f.primeMembershipASIN);d.ref&&(g+=
"/ref\x3d"+d.ref,delete d.ref);f=d.success;delete d.success;var e=k.ajaxRedirect;d.error&&(e=d.error,delete d.error);a.extend(h,d);d=[];for(var n in c)c[n]!==F&&(d.push(n),h[n]=c[n]);h.entityids=d;c=k.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});a.ajax({type:"POST",url:g,data:a.param(h,!0),dataType:"text",async:!0,cache:!1,headers:c,success:f,error:e})}return{callBatch:function(a,d){g(a,d)},call:function(a,d,f){var l={};l[a]=d;g(l,f)}}});"use strict";q.when("jQuery").register("scroll-controller",
function(a){return{scrollToTop:function(){a(p).scrollTop(0)},toggleScrollOn:function(){a(document).unbind("touchmove")},toggleScrollOff:function(){a(document).bind("touchmove",function(a){a.preventDefault()})}}});"use strict";q.when("A","checkout-general-utils","ready").execute(function(a,k){a.$("#checkout-mash-will-load").length?q.when("mash").execute(function(a){var c;"object"===typeof a?c=a:p.amazon&&p.amazon.mash&&(c=p.amazon.mash);"object"!==typeof c?k.logError("MASH is expected but can't be found"):
q.register("safe-mash",function(){return c})}):q.register("safe-mash",function(){})});"use strict";q.when("A","scheduled-delivery-external-interface","shipping-speed-selection-controller","page-detector","ready").register("scheduled-delivery-controller",function(a,k,g,c){var d=a.$,f={};g=function(){f={};d("div.fake-label input[type\x3d'radio']:checked").each(function(){var a=d(this),c=a.closest("div.fake-label");(c=k.getSdWidgetRootId(c))&&(f[a.attr("name")]=c)})};a.on("checkout:reload:shipoptionselect",
g);a.on("checkout:reload:spp-revieworder",g);c.isSosp()&&g();d(document).delegate("div.fake-label","click",function(){if(c.isSosp()){var g=d(this),h=g.find("input[type\x3d'radio']");h.attr("disabled")||(h=h.attr("name"),g=k.getSdWidgetRootId(g),a.trigger("scheduled-delivery:ship-option-changed",{current:g,previous:f[h]}),f[h]=g)}});d(document).delegate(".ship-option.is-scheduled-delivery","click",function(){if(c.isSpc()){var f=d(this);f.find("input[type\x3d'radio']").attr("disabled")||(f=k.getSdWidgetRootId(f))&&
a.trigger("scheduled-delivery:ship-option-changed",{current:f,previous:null})}});a.on("scheduled-delivery:unblock-continue",function(){q.when("button-blocker").execute(function(a){a.hide("scheduled-delivery")})});a.on("scheduled-delivery:block-continue",function(a){q.when("button-blocker").execute(function(c){c.show("scheduled-delivery",a)})});a.on("scheduled-delivery:disable-ship-option",function(a,f){var e;a=d("#"+a);if(0!==a.length){if(c.isSpc())a=a.closest(".shipping-speed");else if(c.isSosp())a=
a.closest("div.fake-label.a-box");else return;e=a.find("input[type\x3d'radio']");e.attr("disabled",!0);e.is(":checked")&&f&&(f=d("input[name\x3d"+e.attr("name")+"]:radio:not(:disabled):first"),f.prop("checked",!0),f.trigger("change"));a.addClass("sd-disabled")}});a.on("scheduled-delivery:enable-ship-option",function(a){var f;a=d("#"+a);if(0!==a.length){if(c.isSpc())a=a.closest(".shipping-speed");else if(c.isSosp())a=a.closest("div.fake-label.a-box");else return;f=a.find("input[type\x3d'radio']");
f.removeAttr("disabled");a.removeClass("sd-disabled")}})});"use strict";q.when("A","ready").register("mobile-nav-bar-back-controller",function(a){a.capabilities.history&&(a=a.$,a=a("#mobile-top-bar-navigation-back"),1<=a.length&&a.click(function(a){a.preventDefault();p.history.back()}))});"use strict";q.when("A","page-spinner-controller","page-detector","page-conductor","weblab-helper","ready").execute(function(a,k,g,c,d){function f(a,b){var c=[];a.addressId||c.push("addressId");a.slotKey||c.push("slotKey");
a.shippingOfferingId||c.push("shippingOfferingId");a.conflictItems&&!m.isArray(a.conflictItems)&&c.push("conflictItems");if(0<c.length){a="Error calling fresh widget callback on "+b+": Bad or Missing Input: "+c[0];for(b=1;b<c.length;b++)a+=", "+c[b];console.error(a);return 0}return 1}function l(){m("#freshSlotKey").val("");m("#freshAddressId").val("");m("#freshReservationToCancel").val("");m("#freshConflictingItems").val("");m("#freshShipOfferingId").val("")}function h(a){var b="",c=d.sospPartialAvailabilityWeblabOn();
if(a&&m.isArray(a)&&0<a.length)for(var b=a[0].asin+":"+a[0].merchantId+(c?"|"+a[0].maxQtyAvailable:""),e=1;e<a.length;e++)b+="-"+a[e].asin+":"+a[e].merchantId+(c?"|"+a[e].maxQtyAvailable:"");return b}function e(a){var b;b="page\x3dspc\x26returnFullHTML\x3d1\x26callSetters\x3d1\x26freshSlotKey\x3d"+a.addressId;b+="\x26freshAddressId\x3d"+a.slotKey;a.reservationToCancel&&(b+="\x26freshReservationToCancel\x3d"+a.reservationToCancel);(a=h(a.conflictItems))&&(b+="\x26freshConflictingItems\x3d"+a);a=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});
k.show();m.ajax({type:"POST",url:"/gp/buy/shared/handlers/handle-fresh-widget-results.html/ref\x3dset-fresh-information",data:b,dataType:"text",async:!0,cache:!1,headers:a,success:function(a,b,d){return d.getResponseHeader("x-amz-checkout-page")?c.ajaxUpdatePage(a,b,d):c.redirect(a)},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}function n(){m(".sosp-continue-button").removeClass("js-hide").removeClass("aok-hidden");m(".continue-button-blocker").addClass("aok-hidden")}function b(){m(".sosp-continue-button").addClass("aok-hidden");
m(".continue-button-blocker").removeClass("aok-hidden")}var m=a.$;a.on("handle-fresh-results",function(a){if(m("#isfresh").val())if(a)if(g.isSosp())if(f(a,"sosp")){m("#freshSlotKey").val(a.slotKey);m("#freshAddressId").val(a.addressId);m("#freshReservationToCancel").val(a.reservationToCancel);var d=h(a.conflictItems);m("#freshConflictingItems").val(d);m("#freshShipOfferingId").val(a.shippingOfferingId);d&&0<d.length?m("input#block-prefetch").val(1):m("input#block-prefetch").val(0);d=m("#shippingOptionFormId");
a.conflictItems&&0<a.conflictItems.length||c.makePrefetch(d);n()}else l(),b();else g.isSpc()?f(a,"spc")&&e(a):console.error("remote fresh widget JS callback called on unsupported page.");else console.error("remote fresh widget JS callback called with empty data.");else console.error("remote fresh widget JS callback called without isfresh flag on page")});a.on("block-continue",function(a){m("#isfresh").val()?a?"undefined"===typeof a.blockContinue?console.error("block continue callback - missing blockContinue"):
g.isSosp()?1===a.blockContinue?(b(),l()):0===a.blockContinue?n():console.error("block continue callback - invalid value"):console.error("block continue callback called on unsupported page."):console.error("block continue callback called with no argument"):console.error("block continue callback called without isfresh flag on page")});a.on("confirm-and-continue",function(){m("div.sosp-fresh #shippingOptionFormId").submit()});a.on("redirect-to-spc",function(){c.redirect({conductoraction:{url:'/gp/buy/spc/handlers/display.html/ref\x3d"cancel-fresh-address-select"',
type:"redirect"}})})});"use strict";q.when("A","ready").execute(function(a){function k(){(0<g(".change-preference-block").length||0<g(".mobile-change-preference-block").length)&&!1===c&&(q.register("loadVasRcxCheckoutAsset",function(){}),c=!0)}var g=a.$,c=!1;k();a.on("checkout:reload:spc",k);a.on("checkout:reload:shipoptionselect",k);a.on("checkout:reload:spp-revieworder",k)});"use strict";q.register("time-left-formatter",function(){function a(a,c,d,f,l){return 0>=c?a:a+c+" "+(1===c?l.HOUR:l.HOURS)+
(!f&&0<d?" "+l.AND+" ":"")}function k(a,c,d,f,l){return 0>=c?a:a+c+" "+(1===c?l.MINUTE:l.MINUTES)+(!f&&1>d?" "+l.AND+" ":"")+(1===f&&1>d?" ":"")}return{getTimeLeftFormatted:function(g,c,d){var f="",l=86400<g?(g-g%86400)/86400:0,h=3600<g?(g-g%3600)/3600:0;g-=3600*h;var e=60<g?(g-g%60)/60:0;g-=60*e;if(c&&0<l)return f+l+" "+(1===l?d.DAY:d.DAYS);if(c&&0<h)return a(f,h,e,c,d);if(c&&5<=e)return k(f,e,h,c,d);f=a(f,h,e,c,d);f=k(f,e,h,c,d);1<=h||(f=f+g+" "+(1===g?d.SECOND:d.SECONDS));return f}}});"use strict";
q.register("email-validation",function(){function a(a){if(1!==a.length)throw Error("Invalid length for character");return a}var k={isISOControl:function(g){"string"===typeof g&&(a(g),g=g.charCodeAt(0));return 31>=g||127===g},isWhitespace:function(g){g=a(g);return null!==g.match(/\s/g)},isLetterOrDigit:function(g){g=a(g);return null!==g.match(/[A-Za-z0-9]/g)}};return function(a){var c;if(!a||64<a.length)return!1;for(c=0;c<a.length;c++)if(127<a.charCodeAt(c))return!1;c=a.indexOf("@");if(c!==a.lastIndexOf("@")||
1>c||c===a.length-1)return!1;var d=a.substring(0,c),f=a.substring(c+1);if("."===f.charAt(0)||"."===f.charAt(f.length-1)||f.match(/[a-zA-Z\d\-.]+/)[0]!==f)return!1;for(c=0;c<f.length;c++)if(a=f.charAt(c),c<f.length-1&&"."===a&&"."===f.charAt(c+1))return!1;if(-1===f.indexOf("."))return!1;var l=f=!1;for(c=0;c<d.length;c++)if(a=d.charAt(c),f){switch(a){case "\\":l=!l;break;case '"':l||(f=!1);break;default:if(l&&!k.isLetterOrDigit(a))return!1;l=!1;if(k.isISOControl(a))return!1}if(!f&&('"'===d.charAt(c-
1)||d.length-1!==c&&"."!==d.charAt(c+1)))return!1}else switch(a){case '"':if(0!==c&&"."!==d.charAt(c-1))return!1;f=!0;break;case ".":if(0===c)return!1;break;case "(":case ")":case "\x3c":case "\x3e":case "[":case "]":case "\\":case ":":case ";":case ",":return!1;default:if(k.isISOControl(a)||k.isWhitespace(a))return!1}return!0}});"use strict";q.when("A","page-transition-controller","checkout-general-utils","page-detector","page-detector-current-page","safe-mash","loading-spinner-controller","weblab-helper").register("shipoptionselect-controller",
function(a,k,g,c,d,f,l,h){function e(a){var b=w(".delivery-window-groups .more-window");l.showSpinner(b,!1);a=a.$currentTarget.closest(".delivery-window-groups").data("orderid");b=w("input[name\x3dlineItemEntityIds_"+a+"]").attr("value");w.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/long-calendar-content.html",data:"lineitemids\x3d"+b+"\x26orderid\x3d"+a+"\x26isMobile\x3d1\x26fromPage\x3dsosp",dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:function(a){l.hideSpinner();
if(a&&a.deliveryWindowGroups){var b=w(".delivery-window-groups .a-box-group");b.empty();w.each(a.deliveryWindowGroups,function(a,c){b.append(c)});a=w(".delivery-window-groups .selected-group");a.length&&a.trigger("click")}}})}function n(a,b){var c=w("div.one-shipment:visible");a=y?w("div.one-shipment").slice(parseInt(a,10),parseInt(b,10)+1):w("div.one-shipment#"+a);r&&0!==a.size()&&c.last().attr("id")!==a.last().attr("id")&&(c.hide(),a.show(),w(p).scrollTop(0))}function b(){if(r){var a=(location.hash?
location.hash.replace("#",""):"0-"+H).split("-");2===a.length&&n(a[0],a[1])}}function m(){function e(a,b){w.ajax({type:"POST",url:"/gp/buy/gift/handlers/remove-gift-option.html",data:b,dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:a,error:function(a,b,c){k.hide()}})}function g(a){var b=a.closest("div."+l);a.is(":checked")?(b.siblings("div."+l+".selected").removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),
b.addClass("selected").find(".a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active")):b.removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");u("triggerChangeEvent",[a])}0<w(".prime-calendar-container").length&&w(".prime-calendar-container").contents().each(function(a,b){8===b.nodeType&&w(b).replaceWith(b.nodeValue)});var m=w(".delivery-window-groups .selected-group");
m.length&&m.trigger("click");B=w(".sosp-continue-button");r="1"===w("#isClientSidePagingEnabled").val()?1:0;H=h.isDigitalAsinIndexingFixedOnSOSPEnabled()?(w("div.shipment-with-ship-options:visible").length-1).toString():(w("div.one-shipment:visible").length-1).toString();t="1"===w("#useMashNavigateForClientSidePaging").val()?1:0;y="1"===w("#collapseDigitalShipmentsEnabled").val()?1:0;var l=(m=p.P&&p.P.AUI_BUILD_DATE)?"selectable-box":"fake-label";r&&(w(".one-shipment:gt("+H+")").hide(),b());B.bind("click",
function(b){function e(a,b){var c=d.getCurrentPage();if(p.history&&p.history.pushState){var f=location.href;0<f.indexOf("#")&&(f=f.substring(0,f.indexOf("#")));f+="#"+a.attr("id")+"-"+b.attr("id");history.pushState({page:c,id:a.attr("id")},w("title"),f)}}if(h.isFreshComingledPurchaseEnabled()){var g=w("div.one-shipment:visible input[id\x3d'fresh-block-continue']");if(g){if("1"===g.val())return a.trigger("f3:fresh-sosp-continue:blocked"),b.preventDefault(),!1;"0"===g.val()&&a.trigger("f3:fresh-sosp-continue:allowed")}}var m=
!1;w("div.one-shipment:visible input[type\x3d'radio'][checked]").each(function(){if(w(this).data("blockingOn"))return alert(w(this).data("blockingOn")),b.preventDefault(),m=!0,!1});if(m)return!1;if(h.removesGiftOptionOnRush()&&c.isMobile()&&null!=G){var g=w("div.one-shipment:visible"),l=g.find("input[type\x3d'radio']:checked").closest(".shipping-option");if("1"===g.find("input[type\x3dhidden][name\x3disGiftWrapped]").attr("value")&&1===l.data("nosupportforgiftoption"))return G.show(),!1}v();g=w("div.one-shipment:visible");
l=g.nextAll("div.one-shipment:hidden");if(0<l.length){b.preventDefault();var k=l.first(),r=k;y&&(r=l.filter(".shipment-with-ship-options"),r=1<r.length?r.eq(1).prev():l.last());t&&f&&f.navigate?f.navigate({url:null,transitionEffect:"slide",successCallback:function(){e(k,r)},failCallback:function(a){}}):e(k,r);n(k.attr("id"),r.attr("id"));a.trigger("active-shipment-changed")}z("logInlineCalMetrics",[g])});w(".gift-option-removal-cancel-button").bind("click",function(a){G.hide()});w(".gift-option-removal-confirm-button").bind("click",
function(a){k.show();G.hide();a="lineItemsToRemoveGiftOptionFrom\x3d"+w("div.one-shipment:visible").find("input[name^\x3dlineItemEntityIds_]").attr("value");var b=w("div.one-shipment:visible"),c=b.nextAll("div.one-shipment:hidden");e(function(a,d,e){b.find("input[type\x3dhidden][name\x3disGiftWrapped]").each(function(){w(this).remove()});0<c.length?(B.click(),k.hide()):w(".checkout-page-form").submit()},a)});w(p).bind("popstate",function(a){c.isSosp()&&b()});w(document).delegate("div."+l,"click",
function(a){a=w(this);a.find("input[type\x3d'radio']").trigger("change",["setActive"]);a.parent().hasClass("timeslot-picker")&&(a=a.find(".a-button-selected").length,B&&B.length&&(a?B.removeClass("a-button-disabled").addClass("a-button-primary").find("input").prop("disabled",!1):B.removeClass("a-button-primary").addClass("a-button-disabled").find("input").prop("disabled",!0)))});var q;a.declarative("faster-than-same-day-sosp-save",["click","submit"],function(){var b="lineItemsToRemoveGiftOptionFrom\x3d"+
q.closest(".one-shipment").find("input[name^\x3dlineItemEntityIds_]").attr("value");a.$("div.a-popover button.a-button-close").trigger("click");k.show();e(function(a,b,c){q.closest(".one-shipment").find(".isGiftWrapped").each(function(){w(this).remove()});q.attr("checked",!0);g(q);k.hide()},b)});w(document).delegate("div."+l+" input[type\x3d'radio']","change",function(a,b){a=w(this);if("setActive"===b&&!a.attr("disabled")&&h.removesGiftOptionOnRush()&&0<a.closest(".one-shipment").find(".isGiftWrapped").length&&
1==a.data("nosupportforgiftoption"))q=a,a.is(":checked")&&(b=a.closest("div."+l).siblings("div."+l+".selected").find('input[type\x3d"radio"]'),q.attr("checked",!1),b.attr("checked",!0)),setTimeout(function(){w("#faster-than-same-day-sosp-popover").trigger("click")},10);else{if("setActive"===b){if(a.attr("disabled"))return;a.attr("checked",!0)}if("disabling"===b)if(a.attr("disabled",!0),a.is(":checked"))a.removeAttr("checked");else return;g(a)}});w("div."+l+" input[type\x3d'radio']:checked").change();
w("h3").children().removeAttr("style");0===w("div."+l+".scheduled-delivery").length&&w("form.checkout-page-form").data("checkoutFormReady",!0).change();m&&w(document).delegate(".a-touch-radio a","click",function(a){if(!h.isSOSPExclusiveJSHandlerWeblabOn()||c.isSosp()){var b=w(a.target).attr("href");!b||b.startsWith("#")||b.toLowerCase().startsWith("javascript:")||(f&&f.navigate?f.navigate({url:b,transition:"slide"}):a.preventDefault=!1)}})}function v(){if(1===w("div.store-upsell-ship-options").length){var a=
"/gp/buy/shared/handlers/store-upsell-async.html",b="ox_store_upsell_continue_",c=w("div.ship-speed, div.store-upsell-ship-options").find("input.shipping-option, input.store-upsell-ship-option"),d=[],e;w.each(c,function(a,c){a=w(c);c=a.attr("value");d.push(c.toLowerCase());a.is(":checked")&&(e=a.attr("value"),b=a.hasClass("store-upsell-ship-option")?b+"success":b+"failure")});a=g.addQueryStringParameter(a,"ref",b);w.ajax({url:a,type:"POST",async:!0,data:{shown:d.toString(),clicked:e}})}}function u(a,
b){q.when("checkout-federation-wrapper","shipspeed-provider").execute(function(c,d){c.wrap(function(){d&&!w.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,b)},"VasCheckoutShipSpeedProvider")})}function z(a,b){q.when("checkout-federation-wrapper","sd-methods").execute(function(c,d){c.wrap(function(){d&&!w.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,b)},"CricketInlineCalendarHeavyBulkyIN")})}var w=a.$,B,r,t,H,y=0,G;a.declarative("sosp-change-quantity-link",["click"],function(a){var b=
a.$currentTarget,c=w("\x3cinput type\x3d'hidden' /\x3e").attr("name","change-quantities-or-delete").val("1");b.hasClass("pipeline-link")?(a.$event.preventDefault(),b.closest("form").removeClass("checkout-page-form").append(c).find(".sosp-continue-button:first").trigger("click")):b.closest("form").removeClass("checkout-page-form").append(c).find(".sosp-continue-button:first").trigger("click").end().trigger("submit")});q.when("A","a-sheet").register("shipoptionselect-gift-removal-controller-mobile",
function(a,b){G=b.create({name:"gift-removal-popover",height:220,preloadDomId:"gift-option-removal-message",closeType:"icon",sheetType:"web"})});a.declarative("sosp-extender-toggle",["click","touchend"],function(a){if(!g.protectAgainstDoubleAction("sosp-extender-toggle")){var b=a.$target.closest("a"),c=w(".delivery-window-groups .a-box-group").find(".lazy-loaded");if(b.hasClass("aui-extender"))c.length?c.remove():e(a);else{var d=b.find("i"),b=b.closest("div.extender-section");d.hasClass("a-icon-extender-expand")?
(b.find(".collapsed").hide(),b.find(".expanded").slideDown("fast"),d.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse"),e(a)):(b.find(".collapsed").show(),b.find(".expanded").slideUp("fast"),d.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"),c.length&&c.remove())}}});a.declarative("sosp-select-prime-slot",["click","touchend"],function(a){if(!g.protectAgainstDoubleAction("sosp-select-prime-slot")){a=a.$currentTarget;var b=a.closest(".valid-slot");if(b.closest(".prime-calendar").hasClass("long-calendar")){var c=
b.closest(".prime-calendar").data("orderid"),d=w("#calendar-"+c),c=w("#calendar-delivery-message-"+c),e=a.closest(".long-calendar");e.find(".selected-slot").removeClass("selected-slot");0<b.length&&b.addClass("selected-slot");w(".a-button-close").trigger("click");b=a.data("slotid");b=d.find(".slot-"+b);if(0<b.length)d.show(),c.parent().hide(),b.closest(".prime-calendar").find(".selected-slot").removeClass("selected-slot"),b.closest(".valid-slot").addClass("selected-slot");else{var f=a.parent()[0],
h=a.parent().parent().find(".rhead")[0],b=h.innerText;b||(b=h.textContent);f=f.cellIndex;e=e.find("th")[f];f=e.innerText;f||(f=e.textContent);c.text(f+" "+b);d.hide();c.parent().show()}}else c=b.closest(".prime-calendar-container").data("orderid"),d=w("#calendar-"+c).find(".selected-slot"),0<d.length&&(d.removeClass("selected-slot"),0<b.length&&b.addClass("selected-slot"));d=a.closest(".prime-calendar-container").data("orderid");a.data("key")&&w("#order_"+d+"_ShippingSpeed").val(a.data("key"));a.data("isscheduleddeliveryslot")&&
w("#sdData"+d).val(a.data("sddatastring"))}});a.declarative("sosp-select-delivery-window",["click","touchend"],function(a){if(!g.protectAgainstDoubleAction("sosp-select-delivery-window")){a=a.$currentTarget;a.length&&!a.hasClass("dwg-button")&&(a=a.find(".dwg-button"));w(".dwg-button").removeClass("selected-dwg-button");a.addClass("selected-dwg-button");var b=a.closest(".delivery-window-groups").data("orderid"),c=a.data("key");!c&&a.find("button").length&&(c=a.find("button").data("key"));c&&w("#order_"+
b+"_ShippingSpeed").val(c);c=a.data("isscheduleddeliveryslot");!c&&a.find("button").length&&(c=a.find("button").data("isscheduleddeliveryslot"));c&&(c=a.data("sddatastring"),!c&&a.find("button").length&&(c=a.find("button").data("sddatastring")),w("#sdData"+b).val(c))}});a.on("checkout:reload:shipoptionselect",m);a.on("checkout:reload:spp-shipoption",m);if(h.isFreshComingledPurchaseEnabled())a.on("checkout:reload:spp-f3-sosp",m)});q.when("jQuery","page-detector").register("deliv-prefs-sosp",function(a,
k){function g(){a(".sosp .order-delivery-time-preference").each(function(){var c=a(this);c.bind("selectionChanged",function(){0===c.find(".delivery-time-preference-group").length?c.hide():(c.show(),0===c.find("input:checked").length&&c.find("input:first").trigger("change",["setActive"]))}).bind("empty",function(){c.find(".delivery-time-preference-group").detach()});var d=c.closest(".one-shipment").find("input.shipping-option");c.find(".delivery-time-preference-group").each(function(){var d=a(this),
g=d.data("shippingoptionid"),g=a("#"+g);d.is(".template")&&d.detach().removeClass("template");g.change(function(){c.trigger("empty");d.appendTo(c);c.trigger("selectionChanged")}).addClass("hasDeliveryTimePreference")});d.not(".hasDeliveryTimePreference").change(function(d,g){"disabling"===g||a(this).is(":disabled")||(c.trigger("empty"),c.trigger("selectionChanged"))});c.trigger("selectionChanged")})}q.when("A").execute(function(a){a.on("checkout:reload:shipoptionselect",g)})});q.when("A","shipoptionselect-controller").execute(function(a){var k=
a.$,g={},c={};a.on("checkout:reload:shipoptionselect",function(){var a=k("#shippingOptionFormId"),f=a.find("input[name\x3dtrialKey]");if(1===f.length){for(var l in g)g.hasOwnProperty(l)&&(g[l].abort(),delete g[l]);g={};c={};var h=function(a){return a.join("::").replace(/\s+/g,"_")},e=function(){return k.map(a.find("input[type\x3dradio]:checked"),function(a){return a.name})},n=function(){return k.map(a.find("input[type\x3dradio]:checked"),function(a){return a.value})},b=function(a,b){if(g.hasOwnProperty(a)||
c.hasOwnProperty(a))return!1;console.debug('initiating ajax call for trial key "'+a+'"');b=k.ajax({type:"POST",url:"/gp/buy/shipoptionselect/handlers/launch-delivery-trial.html",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:{"x-amz-checkout-transition":"ajax"},data:b,dataType:"json",async:!0,success:function(b){b?console.debug('trial "'+a+'" success'):console.debug('trial "'+a+'" failed');c[a]=b;delete g[a]},error:function(b,c,d){delete g[a];"abort"!==d&&(console.debug("trial "+
a+" error"),q.error("issue with set-delivery-options trial: "+c,d))},cache:!1});g[a]=b;return!0},m=function(){for(var a=n(),a=h(a),b=Object.keys(g),c=0;c<b.length;++c){var d=b[c];d!==a&&(console.debug('removing ajax call for trial key "'+d+'"'),g[d].abort(),delete g[d])}};k(document).delegate("#shippingOptionFormId","change",function(c){c=n();if(h(c)!==f.val())a:{m(),c=e();var g=n(),l=h(g);f.val(l);var w=b(l,a.serialize()),l=0;w&&++l;for(var B=0;B<c.length;++B)for(var r=a.find('input[type\x3dradio][name\x3d"'+
c[B]+'"][value!\x3d"'+g[B]+'"]'),t=0;t<r.length;++t){var H=r[t],w=g.slice(0);w[B]=H.value;for(var w=h(w),y=H.name,H=H.value,G=a.serializeArray(),E=0;E<G.length;++E)G[E].name===y&&(G[E].value=H),"trialKey"===G[E].name&&(G[E].value=w);y=k.param(G);if((w=b(w,y))&&5===++l)break a}}});k(document).delegate("#shippingOptionFormId","submit",function(a){m()})}})});q.when("A","button-blocker","page-detector").register("scheduled-delivery-readiness-checker",function(a,k,g){function c(){g.isMobile()&&g.isSosp()&&
l("div.scheduled-delivery").length&&(l(document).delegate("div."+e+":visible input[type\x3d'radio'].shipping-option","change",function(){f(l(this).closest("div."+e))}),a.on("active-shipment-changed",f))}function d(a){h||(a.hasClass("scheduled-delivery-loading")?h=a.find(".loading-tooltip").text():a.hasClass("scheduled-delivery-picking")&&(h=a.find(".picking-tooltip").text()))}function f(a){h=null;a?d(a):l("div.one-shipment:visible div."+e+".scheduled-delivery").each(function(){var a=l(this);a.find("input").is(":checked")&&
d(a)});h?k.show("scheduled-delivery",h):k.hide("scheduled-delivery")}var l=a.$,h,e=p.P&&p.P.AUI_BUILD_DATE?"selectable-box":"fake-label";if(g.isMobile())a.on("checkout:reload:shipoptionselect",c);return{check:f}});"use strict";q.when("A","quantity-service","page-conductor","page-detector","ajax-utility","page-transition-controller","gift-utility","client-side-metrics").register("gift-form-base-controller",function(a,k,g,c,d,f,l,h){function e(a){a.is(":checked")||(Y?a.is(":checked")||a.closest("label").click():
(h.increaseCount("removeauijs4"),a.attr("checked",!0).trigger("change")))}function n(a){a.attr("disabled","disabled");Y&&a.closest("div").bind("click.disable",function(a){a.stopPropagation()})}function b(a){a.removeAttr("disabled");Y&&a.closest("div").unbind("click.disable")}function m(){q.when("a-dropdown").execute(function(a){var b=A(".select-recipient");b.empty();for(var c=0;c<aa.length;c++){var d=A("\x3coption/\x3e").attr({value:aa[c].value}).text(aa[c].text);b.append(d)}b.each(function(){var b=
A(this).closest(".gift-connection-section"),c=b.find(".include-gift-connection-checkbox").is(":checked"),d=b.find(".item-id").val(),e=b.find(".item-giftlist-type-id").val(),f;!e||"0"!==e&&"1"!==e&&"2"!==e?e&&"3"===e&&(f=b.find(".item-giftlist-id").val()):f=e;!f&&c&&(c=b.find(".item-registry-id").val())&&ea&&ea[c]&&(f=ea[c]);f&&(a.setValue(A(this).attr("id"),f),(e&&"1"===e||"2"===e)&&b.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show(),H(d))})})}function v(){A(".gift-connection-recipient-section").unbind("click").bind("click",
function(){if(!X)return A(this).find(".select-recipient-spinner").removeClass("aok-hidden").show(),!1});A(".select-recipient").each(function(){A(this).unbind("change").bind("change",function(){var a=A(this),b=a.next().find(".a-dropdown-prompt"),c=A("\x3cdiv/\x3e").html(a.find(":selected").text()).clone().html();setTimeout(function(){b.html(c)},0)})});q.when("a-dropdown").execute(function(a){A(".gift-connection-section").each(function(){var b=A(this),c=b.find(".item-id").val(),d=b.find(".item-giftlist-type-id").val();
b.find(".item-giftlist-id").val();var e=b.find(".item-occasion-id").val(),f=b.find(".item-occasion-month").val(),h=b.find(".item-occasion-day").val(),g=b.find(".item-age").val();b.find("#input-recipient-first-name-"+c).unbind("keyup").keyup(function(){H(c)});b.find("#input-recipient-last-name-"+c).unbind("keyup").keyup(function(){H(c)});if("1"===d||"2"===d)a.setValue(b.find(".select-recipient").attr("id"),d),b.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show();a.setValue(b.find(".select-occasion").attr("id"),
e);a.setValue(b.find(".select-occasion-month").attr("id"),f);a.setValue(b.find(".select-occasion-day").attr("id"),h);a.setValue(b.find(".select-occasion-age").attr("id"),g);if("1"===e||"2"===e)b.find(".gift-connection-occasion-extra").removeClass("aok-hidden").show(),"2"===d&&b.find(".select-occasion-age-row").removeClass("aok-hidden").show();"1"!==e&&"2"!==e&&"3"!==e&&H(c)})});var a="/gp/buy/pipeline/handlers/list-of-giftlists.html",b=A(".item-registry-id").map(function(){if(A(this).val())return A(this).val()}).get().join();
b&&(a+="?fromRegistryIds\x3d"+b);aa?(m(),A(".select-recipient-spinner").hide(),X=!0):(X=!1,A.ajax({type:"POST",url:a,dataType:"json",async:!0,cache:!1,timeout:5E3,success:function(a){!aa&&a.options&&0<a.options.length&&(aa=a.options);a.registryIdMapping&&(ea=a.registryIdMapping);aa&&m();A(".select-recipient-spinner").hide();X=!0},error:function(a,b,c){A(".select-recipient-spinner").hide();X=!0}}))}function u(){ba=[];a.state("giftNotificationEmailConstraints",[]);a.state("giftDeliveryDateConstraints",
[]);A('[data-action\x3d"gift-form-element"]').each(function(){var a=A(this);a.is("span")?a.find("input, textarea, select:first").trigger({type:"change",isInit:!0}):a.trigger({type:"change",isInit:!0})});A("textarea").unbind("keyup.gift-textarea click.gift-textarea").bind("keyup.gift-textarea click.gift-textarea",function(){A(this).trigger("change")});0<A(".enable-gift-connections").length&&v()}function z(a,b){var c=31;if("1"===b)c=0===a%4&&0!==a%100||0===a%400?29:28;else if("3"===b||"5"===b||"8"===
b||"10"===b)c=30;return c}function w(a,b,c){a=d.jsonify(a);g.redirect(a)}function B(a){q.when("a-dropdown").execute(function(b){A(".gift-connection-recipient-extra-"+a).hide();b.setValue("select-recipient-"+a,"0");A("#input-recipient-first-name-"+a).val("");A("#input-recipient-last-name-"+a).val("")})}function r(a){q.when("a-dropdown").execute(function(b){A(".gift-connection-occasion-extra-"+a).hide();b.setValue("select-occasion-"+a,"0");b.setValue("select-occasion-month-"+a,"0");b.setValue("select-occasion-day-"+
a,"0");b.setValue("select-occasion-age-"+a,"-1");A("#occasion-has-reminder-checkbox-"+a).attr("checked",!0)})}function t(a,b){q.when("a-dropdown").execute(function(c){for(var d=0;d<aa.length;d++)b&&b===aa[d].value&&aa[d].bMonth&&aa[d].bDay&&(c.setValue("select-occasion-month-"+a,aa[d].bMonth),c.setValue("select-occasion-day-"+a,aa[d].bDay))})}function H(a){q.when("a-dropdown").execute(function(b){var c=A("#select-recipient-"+a).find(":selected").val();"0"!==c&&("1"!==c&&"2"!==c||A("#input-recipient-first-name-"+
a).val()||A("#input-recipient-last-name-"+a).val())?b.updateSelect("select-occasion-"+a,{status:"enabled"}):(r(a),b.updateSelect("select-occasion-"+a,{status:"disabled"}))})}function y(a,b,c){"1"===b&&"2"===c?A("#select-occasion-age-row-"+a).removeClass("aok-hidden").show():A("#select-occasion-age-row-"+a).hide()}function G(){var a=A("#hidePricesCheckbox"),b=A("#kindle-reg-radio-your-account");Y?b.is(":checked")?A("#kindle-reg-radio-another-account").closest("label").click():a.is(":checked")||a.closest("label").click():
(h.increaseCount("removeauijs6"),a.is(":checked")||a.attr("checked","checked").trigger("change"),b.is(":checked")&&(b.removeAttr("checked").trigger("change"),A("#kindle-reg-radio-another-account").attr("checked","checked").trigger("change")))}function E(){var a=A("#hidePricesCheckbox"),b=A("#kindle-reg-radio-another-account");Y?b.is(":checked")?A("#kindle-reg-radio-your-account").closest("label").click():a.is(":checked")&&a.closest("label").click():(h.increaseCount("removeauijs7"),a.is(":checked")&&
a.removeAttr("checked").trigger("change"),b.is(":checked")&&(b.removeAttr("checked").trigger("change"),A("#kindle-reg-radio-your-account").attr("checked","checked").trigger("change")))}function I(){A("#hidePricesCheckboxLabel").hide();var a=A("#hidePricesCheckbox");Y&&(a.is(":checked")||a.closest("label").click());a.attr("disabled",!0).hide().trigger("change");A("#kindle-reg-radio-another-account").attr("disabled",!0).trigger("change");A("#kindle-reg-radio-your-account").attr("disabled",!0).trigger("change");
A("#hidePricesDisabledMessage").show();A("#hidePricesDisabledMessage").removeClass("aok-hidden");Y&&(A("label.a-touch-checkbox.hide-prices-checkbox").addClass("a-touch-selector-disabled").bind("click.disable",function(a){a.stopPropagation()}),A("label.a-touch-radio.kindle-reg-option").addClass("a-touch-selector-disabled").bind("click.disable",function(a){a.stopPropagation()}))}function da(a){var b=!1;A(".afn-wrap-checkbox").each(function(){var a=A(this),a=a.is("input")?a:a.find("input");if(a.is(":checked"))return b=
!0,!1});A(".mfn-no-wrap-radio").each(function(){var a=A(this),a=a.is("input")?a:a.find("input");if(!a.is(":checked"))return b=!0,!1});if(b)G(),I();else if(A("#hidePricesCheckbox").is(":disabled"))A("#hidePricesCheckboxLabel").show(),A("#hidePricesCheckbox").removeAttr("disabled").show().trigger("change"),A("#kindle-reg-radio-another-account").removeAttr("disabled").trigger("change"),A("#kindle-reg-radio-your-account").removeAttr("disabled").trigger("change"),A("#hidePricesDisabledMessage").hide(),
Y&&(A("label.a-touch-checkbox.hide-prices-checkbox").removeClass("a-touch-selector-disabled").unbind("click.disable"),A("label.a-touch-radio.kindle-reg-option").removeClass("a-touch-selector-disabled").unbind("click.disable"));else if(a.is("input")||(a=a.find("input")),"hidePricesCheckbox"===a.attr("id"))a.is(":checked")?G():E();else if("kindle-reg-radio-another-account"===a.attr("id")||"kindle-reg-radio-your-account"===a.attr("id"))A("#kindle-reg-radio-your-account").is(":checked")?E():G()}function W(a){var b=
A("#giftwrap-carousel-wrap-pane-"+a+" ul li").size();b&&(A("#giftwrap-carousel-wrap-holder-"+a).css("width",90*b),A("#giftwrap-carousel-wrap-pane-"+a).css("width",90*fa));P(a)}function P(a){A("#giftwrap-carousel-wrap-holder-"+a).find("ul li, ol li").each(function(b,c){b=A(c);b.find("input").is(":checked")&&D(b,{itemId:a})})}function D(a,b){a.parent().find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".giftwrap-carousel-item-image").addClass("selected-giftwrap-image");
a.parent().find(".wrap.a-button-selected").removeClass("a-button-selected");a.addClass("a-button-selected");var c=b.itemId;b=b.wrapNo;var d=g.isSPP(),e=a.find("input[type\x3dradio]");e.attr("checked",!0);d||(d=a.data("giftwrap-id"),e.val(d).change());var e=a.data("wrap-no"),d=A("#giftwrap-option-preview-imagearea-default-"+c),f=A("#giftwrap-option-preview-imagearea-image-"+c),h=A(".selectedWrapLargeLink","#item-"+c),c=A(".wrapNo-"+c+"-"+b);a.hasClass("none-wrap")?(d.removeClass("aok-hidden"),f.addClass("aok-hidden"),
h.length&&(h.addClass("aok-hidden"),h.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),f.find("img").attr("src",a),d.addClass("aok-hidden"),f.removeClass("aok-hidden"),h.length&&(h.addClass("aok-hidden"),h.removeClass("selectedWrapLargeLink")),c.length&&(c.addClass("selectedWrapLargeLink"),c.removeClass("aok-hidden")));a=A(".selectedWrapLargeLink");c=A(".larger-image-link-carousel-"+e);a.removeClass("selectedWrapLargeLink").addClass("aok-hidden");c.removeClass("aok-hidden").addClass("selectedWrapLargeLink")}
function N(a,b){var c;c=b.itemId;b=A("#giftwrap-option-preview-imagearea-default-"+c);c=A("#giftwrap-option-preview-imagearea-image-"+c);a.hasClass("none-wrap")?(b.removeClass("aok-hidden"),c.addClass("aok-hidden")):(a=a.find("img").attr("src"),c.find("img").attr("src",a),b.addClass("aok-hidden"),c.removeClass("aok-hidden"))}function F(a,b){var c=b.itemId;b=A("#giftwrap-option-preview-imagearea-default-"+c);c=A("#giftwrap-option-preview-imagearea-image-"+c);if(a.parent().find(".selected-giftwrap-image").parents("li").hasClass("none-wrap"))b.removeClass("aok-hidden"),
c.addClass("aok-hidden");else{var d=".selected-giftwrap-image img";g.isSPP()&&(d="img.selected-giftwrap-image");a=a.parent().find(d).attr("src");c.find("img").attr("src",a);b.addClass("aok-hidden");c.removeClass("aok-hidden")}}function x(a,b){var c=a.find(".empty-message-warning"),d=a.find(".no-receipt-warning"),e=a.find("textarea");a=a.find(".message-counter");b&&!d.is(":visible")?(a.hide(),c.show(),e.addClass("gift-warning")):(c.hide(),e.removeClass("gift-warning"),a.show())}function L(a){var b=
A("#"+a.id),c=l.getCharCount(b.val(),a.useByteSize),b=l.getLineCount(b.val(),a.maxChars/a.maxLines);return{length:c,charDelta:a.maxChars-c,lineDelta:a.maxLines-b}}function O(a,b){b=A("#item-"+b.itemId);var c=a.is(":checked")&&!a.hasClass("mfn-no-wrap-radio");g.isSPP()&&A("#carouselGiftWrap").length&&(c=!a.hasClass("mfn-no-wrap-radio"));c?(b.find(".gift-message-pslip").hide(),b.find(".gift-message-card").show()):(b.find(".gift-message-card").hide(),b.find(".gift-message-pslip").show())}function V(b,
c){var d=c.itemId;c=g.isSPP()?c.currentTab:b.data("current-tab");var e=A("#afn-gift-options-wrapper-"+d).data("active-tab");c!==e&&(b.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),b.addClass("selected-giftwrap-tab"),A("#afn-gift-options-wrapper-"+d).data("active-tab",c),b="#item-"+d,e=g.isSPP()?A("#giftwrap-carousel-wrap-holder-"+d,b):b,e.length&&a.trigger("checkout:gift:changeCarouselWrapOptions",e,c,d),c=A(".none-wrap",A(b)).find("input"),c.prop("checked",!0),c.val("").change(),
g.isSPP()?(c=A("#afn-gift-options-wrapper-"+d),c.length&&(c=c.data("active-tab"),a.trigger("checkout:gift:adaptCarouselGiftPanel",d,c))):a.trigger("checkout:gift:adaptCarousel",d),A("#giftwrap-carousel-wrap-holder-"+d).removeClass("a-button-selected").find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),A("#giftwrap-carousel-item-image-"+d).addClass("selected-giftwrap-image").parents(".wrap").addClass("a-button-selected"),A("#giftwrap-option-preview-imagearea-default-"+d).removeClass("aok-hidden"),
A("#giftwrap-option-preview-imagearea-image-"+d).addClass("aok-hidden"),c=A(".selectedWrapLargeLink"),c.length&&(c.addClass("aok-hidden"),c.removeClass("selectedWrapLargeLink")),c=g.isSPP(),b="#item-"+d,A("#gift-message-noshi-warning-"+d).addClass("aok-hidden"),A("#includeMessageCheckbox-"+d).removeAttr("disabled"),c?A("#afn-message-span-"+d,A(b)).removeClass("aok-hidden"):(A("#afn-message-span",A(b)).removeClass("disable-message-area").addClass("enable-message-area"),A("#gift-message-heading-"+d).removeClass("disable-message-area").addClass("enable-message-area"),
A("#message-area-"+d).removeAttr("disabled")))}var ba,fa=4,aa,X=!1,ea,A=a.$,Y=p.P&&p.P.AUI_BUILD_DATE&&c.isMobile(),Z=l.getInput;a.declarative("save-gift-for-later",["click"],function(a){f.show();a=a.$currentTarget.data("entityId")||a.data.entityId;k.call(a,0,{success:w})});q.register("gift-base/init-carousel",function(){return W});q.register("gift-base/set-carousel-size",function(){return function(a){fa=a}});var ka={toggleGiftDataAndDeliveryOptions:function(a){a=a.closest(".gift-options-wrapper");
var b=Z(a.find(".includeMessageCheckbox"));b&&b.is(":checked")?(a.find(".gift-delivery-option").show(),a.find(".item-wrap-span").show(),a.find(".item-wrap-row").show(),a.find(".item-gift-message-span").show()):(a.find(".gift-delivery-option").hide(),a.find(".item-wrap-span").hide(),a.find(".item-wrap-row").hide(),a.find(".item-gift-message-span").hide())},toggleGiftDeliveryOptions:function(a){var b=a.closest(".gift-options-wrapper");a.is("input[type\x3dcheckbox]")?a.is(":checked")?b.find(".gift-notification-email").removeClass("a-form-disabled"):
b.find(".gift-notification-email").addClass("a-form-disabled"):(b.find(".gift-notification-email").removeClass("a-form-disabled"),a=b.find(".includeMessageCheckbox"),e(a.find("input[type\x3dcheckbox]")),Y&&(a=a.find("i.a-icon"),a.length&&(a.removeClass("a-icon-checkbox-inactive"),a.removeClass("a-icon-touch-checkbox-inactive"),a.addClass("a-icon-checkbox-active"),a.addClass("a-icon-touch-checkbox-active"))))},initGiftNotificationEmail:function(b){var c=a.state("giftNotificationEmailConstraints");
c.push({id:b.attr("id")});a.state("giftNotificationEmailConstraints",c)},initGiftDeliveryDate:function(b){var c=a.state("giftDeliveryDateConstraints");b.hasClass("year-select")||(b=b.parents("div.del-opt-date-section").find("select.year-select:first"));c.push({id:b.attr("id")});a.state("giftDeliveryDateConstraints",c)},updateDateDropdown:function(a){var b=a.closest(".gift-options-wrapper");a=b.find(".month-select").val();var c=b.find(".day-select");c.val();var b=b.find(".year-select").val(),d=z(b,
a);if(c.hasClass("a-native-dropdown"))q.when("a-dropdown").execute(function(a){a=a.getSelect(c);if(a.getOptions().size()>d)for(var b=a.getOptions().size()-1;b>=d;b--)a.removeOption(b);else for(b=a.getOptions().size();b<d;b++)a.addOption({text:b+1,value:b+1},b)});else{if(c.find("option").length>d)c.find("option:gt("+(d-1)+")").remove();else for(a=c.find("option").length+1;a<=d;a++)c.append(A("\x3coption\x3e",{value:a}).text(a));c.trigger("change")}},initSelectedTabAndWrapHolderWidth:W,initGiftMessage:function(a,
b){Y&&!a.is("textarea")&&(a=a.find("textarea"));ba.push({id:a.attr("id"),maxChars:parseInt(b.maxChars,10),maxLines:parseInt(b.maxLines,10),useByteSize:b.useByteSize});Z(a.closest(".gift-options-wrapper").find(".includeMessageCheckbox")).is(":checked")||a.addClass("a-form-disabled");"1"===A("#multipleAFNGiftWrapOption").val()&&(a=a.attr("id").substring(a.attr("id").lastIndexOf("-")+1,a.attr("id").size),W(a))},enforceSelectorParity:da,enforceGiftReceiptParity:function(a,c){a=A("#item-"+c.itemId);if(0!==
a.length){c=a.find(".item-receipt-row label");var d=Z(a.find(".includeReceiptCheckbox")),f=a.find(".mfn-hide-price-row label"),h=Z(a.find(".mfnHidePriceCheckbox")),g=a.find(".item-message-row label"),m=Z(a.find(".includeMessageCheckbox")).is(":checked"),t=!1;0<a.find(".afn-wrap-checkbox").length?Z(a.find(".afn-wrap-checkbox")).is(":checked")&&(t=!0):0<a.find(".mfn-no-wrap-radio").length&&(Z(a.find(".mfn-no-wrap-radio")).is(":checked")||(t=!0));if(t||m)e(d),e(h);t||m&&g.is(":visible")?(n(d),c.addClass("checkout-gift-option-disabled"),
n(h),f.addClass("checkout-gift-option-disabled")):(b(d),b(h),c.removeClass("checkout-gift-option-disabled"),f.removeClass("checkout-gift-option-disabled"))}},enforceHidePriceParity:function(a){var b=!1;A(".includeReceiptCheckbox").each(function(){if(Z(A(this)).is(":checked"))return b=!0,!1});var c=!1;A(".mfnHidePriceCheckbox").each(function(){if(Z(A(this)).is(":checked"))return c=!0,!1});b||c?(G(),A(".kindle-reg-msg-your-account").hide(),A(".kindle-reg-msg-another-account").show()):(E(),A(".kindle-reg-msg-another-account").hide(),
A(".kindle-reg-msg-your-account").show())},toggleNoReceiptWarning:function(a){var b=Z(a).is(":checked"),c=a.closest(".gift-options-wrapper");a=c.find(".no-receipt-warning");var d=c.find(".empty-message-warning"),c=c.find(".item-message-row").find(".includeMessageCheckbox"),f=Z(c);b?(a.hide(),c.is(":visible")||e(f)):(d.hide(),a.show(),f.is(":checked")&&(Y?f.is(":checked")&&f.closest("label").click():(h.increaseCount("removeauijs5"),f.removeAttr("checked").trigger("change"))))},toggleMessageArea:function(a){var b=
a.closest(".gift-options-wrapper");if(a.is("textarea"))b=Z(b.find(".includeMessageCheckbox")),e(b);else{a=Z(b.find(".includeMessageCheckbox")).is(":checked");var c=b.find(".item-message-row label").is(":visible"),d=0<b.find(".empty-message-warning").length,f=b.find("textarea"),h=f.data("default-text"),g=0<f.val().length;a?(b.find(".gift-message-edit").show(),b.find(".gift-message-label").removeClass("a-color-secondary"),f.removeClass("a-form-disabled"),h&&f.val(h)):(c&&b.find(".gift-message-edit").hide(),
b.find(".gift-message-label").addClass("a-color-secondary"),f.addClass("a-form-disabled"),h&&f.val(""));d&&(a&&g?x(b,!1):x(b,!0))}},toggleMessageLocationText:O,toggleMessageBoxDisplay:function(c,d){var f=A("#item-"+d.itemId);if(0!==f.length){var h=f.find(".item-message-row");d=f.find(".item-receipt-row");var g=f.find(".gift-message-on-card"),m=f.find(".gift-message-on-receipt"),t=h.find("label"),h=Z(h.find(".includeMessageCheckbox")),l=a.trim(f.find(".gift-message-default-placeholder").text()),k=
a.trim(f.find(".gift-message-with-wrap-placeholder").text()),f=f.find("textarea"),r=c.hasClass("mfn-no-wrap-radio")||c.closest("div").hasClass("mfn-no-wrap-radio");Z(c).is(":checked")&&!r?(m.hide(),g.show(),f.attr("placeholder",k),d.is(":visible")&&(e(h),t.is(":visible")&&(n(h),t.addClass("checkout-gift-option-disabled")))):(g.hide(),m.show(),f.attr("placeholder",l),b(h),t.removeClass("checkout-gift-option-disabled"))}},updateContinueButtons:function(){for(var b=!0,c,d=0;d<ba.length;d++)if(c=A("#"+
ba[d].id),c.closest(".gift-options-wrapper").find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]').is(":checked")&&(c=L(ba[d]),0>c.charDelta||0>c.lineDelta))b=!1;b?(A(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").show(),A(".save-gift-button-box span.a-button-disabled").hide()):(A(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").hide(),b=A(".save-gift-button-box span.a-button-disabled"),b.removeClass("aok-hidden"),b.show());a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")},
updateMessageCounter:function(a){Y&&!a.is("textarea")&&(a=a.find("textarea"));for(var b,c=0;c<ba.length;c++)a.attr("id")===ba[c].id&&(b=L(ba[c]));if(b){a=a.closest(".gift-options-wrapper");c=a.find(".message-counter");c.find(".remaining-count").hide();if(0<a.find(".empty-message-warning").length){if(0===b.length){x(a,!0);return}x(a,!1)}(-1>b.charDelta?c.find(".remaining-char-over-multiple").show():0>b.charDelta?c.find(".remaining-char-over-single").show():1===b.charDelta?c.find(".remaining-char-single").show():
c.find(".remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(b.charDelta));(-1>b.lineDelta?c.find(".remaining-line-over-multiple").show():0>b.lineDelta?c.find(".remaining-line-over-single").show():1===b.lineDelta?c.find(".remaining-line-single").show():c.find(".remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(b.lineDelta));c.show()}},updateSelectedGiftWrap:D,clearGiftConnection:function(a,b){A("#include-gift-connection-checkbox-"+b.itemId).is(":checked")||
(B(b.itemId),H(b.itemId))},toggleGiftConnectionAgeDropdown:y,toggleGiftConnectionRecipientArea:function(a,b){a=A("#select-recipient-"+b.itemId).find(":selected").val();var c=A("#select-occasion-"+b.itemId).find(":selected").val();!a||"1"!==a&&"2"!==a?(A(".gift-connection-recipient-extra-"+b.itemId).hide(),"1"===c&&a&&t(b.itemId,a)):A(".gift-connection-recipient-extra-"+b.itemId).removeClass("aok-hidden").show();y(b.itemId,c,a);H(b.itemId)},toggleGiftConnectionOccasionArea:function(a,b){a=A("#select-occasion-"+
b.itemId).find(":selected").val();var c=A("#select-recipient-"+b.itemId).find(":selected").val();!a||"1"!==a&&"2"!==a?A(".gift-connection-occasion-extra-"+b.itemId).hide():("1"===a&&c&&"1"!==c&&"2"!==c&&t(b.itemId,c),A(".gift-connection-occasion-extra-"+b.itemId).removeClass("aok-hidden").show());y(b.itemId,a,c)},includeGiftConnection:function(a,b){(a=A("#select-recipient-"+b.itemId).find(":selected").val())&&"0"===a||A("#include-gift-connection-checkbox-"+b.itemId).attr("checked",!0)},updateGiftOptionsTabSelection:V,
updatePreviewImageOnMouseEnter:N,updatePreviewImageOnMouseLeave:F,toggleGiftMessageWarning:function(a){var b=A("#"+a.attr("id"));l.toggleGiftMessageWarning(b,a.closest(".item-gift-message-span"))}};a.declarative("gift-form-element",["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(ka[b[c]])ka[b[c]](a.$target,a.data)});a.declarative("gift-form-element","click mouseenter mouseleave",function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",
mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(ka[b[c]])ka[b[c]](a.$currentTarget,a.data,a)});a.declarative("select-gift-wrap","click",function(a){D(a.$target.parents("li"),{itemId:a.data.itemId,wrapNo:a.data.wrapNo});da(a.$target);var b=a.$target.parents("li").find(".gift-hidden-radio");O(b,{itemId:a.data.itemId})});a.declarative("select-gift-wrap","mouseenter",function(a){N(a.$target.parents("li"),a.data)});a.declarative("select-gift-wrap","mouseleave",function(a){F(a.$target.parents("li"),
a.data)});a.declarative("update-gift-options-tab-selection",["click"],function(a){var b=a.$target.parents("li");b.attr("data",a.data);V(b,a.data)});a.on("checkout:reload:giftselect",u);a.on("checkout:reload:spp-giftoptions",u);return{extendFunctions:function(a){A.extend(ka,a)}}});"use strict";q.when("A","page-transition-controller","page-conductor").register("gift-form-del-opt-controller",function(a,k,g){function c(a){var c=a.closest(".expando-box");c&&(c=c.find(".a-expander-header"),a.closest(".expando-content").is(":hidden")&&
c.click())}function d(a){var c=a.closest(".gift-options-wrapper"),b=c.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(b&&!b.is(":checked"))return!0;b=c.find(".email-error-selector");c.find(".gift-notification-email-error").hide();b.removeClass("a-form-error");if(64<p.unescape(encodeURIComponent(a.val())).length)return b.addClass("a-form-error"),c.find(".gift-notification-email-length-exceeded-error").removeClass("aok-hidden").show(),!1;if(/^\S+[@]\S+[.]\S+$/.test(a.val()))return!0;
b.addClass("a-form-error");c.find(".gift-notification-invalid-email-error").removeClass("aok-hidden").show();return!1}function f(){h("#giftForm").find(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").unbind("click").bind("click",function(a){a.preventDefault();l(a)});h(".checkout-gift-image-preview-trigger \x3e a").show();h("#gift-kindle-imb").show()}function l(e){e=h("#giftForm");var f=e.find('input[name\x3d"hidePrices"]'),b=f.is(":disabled");b&&f.removeAttr("disabled");for(var m=
!0,l=a.state("giftNotificationEmailConstraints"),u=a.state("giftDeliveryDateConstraints"),z=0;z<l.length;z++){var w=h("#"+l[z].id);d(w)||(m=!1,c(w))}for(l=0;l<u.length;l++){z=h("#"+u[l].id);var w=z.closest(".gift-options-wrapper"),B=w.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(B&&!B.is(":checked"))w=!0;else{var r=w.find(".month-select").val(),t=w.find(".day-select").val(),B=w.find(".year-select"),H=B.val(),y=w.find("#current-date").val().split("-"),r=new Date(H,r,t),y=new Date(y[0],
y[1]-1,y[2]),t=new Date(y.getTime());t.setMonth(t.getMonth()+12);w.find(".gift-delivery-date-error").hide();H=w.find(".date-error-selector");B=B.hasClass("a-native-dropdown")?"error-border a-form-error":"a-form-error";H.removeClass(B);r>=t||r<y?(w.find(".gift-delivery-date-error").removeClass("aok-hidden").show(),H.addClass(B),w=!1):w=!0}w||(m=!1,c(z))}a.state("continueAction",{enable:m});if(a.state("continueAction").enable)g.isSPP()||k.showPageTransition(),e.submit();else return h("html, body").animate({scrollTop:h(".a-form-error").closest("div").offset().top},
500),!1;b&&f.attr("disabled",!0)}var h=a.$;a.declarative("submit-gift-options","click",function(a){l(a)});a.declarative("discard-gift-options","click",function(a){h('#giftForm input[type\x3d"checkbox"]').prop("checked",!1);h("#giftForm textarea").addClass("a-form-disabled");l(a)});a.on("checkout:reload:giftselect",f);a.on("checkout:reload:spp-giftoptions",f)});"use strict";q.when("A").register("teen-message-controller",function(a){var k=a.$;a.declarative("teen-message-form-element","click keyup",
function(a){a=a.data.maxChars;var c=k("#teen-message-box").val(),d=c.match(/(\r\n|\n|\r)/g),f=0;d&&(f=d.length);c=c.length+f;k(".remaining-char").text(Math.max(a-c,0))});k("#aui-teen-message-box").length&&k(".remaining-char").length&&q.when("A").execute(function(a){function c(a){a=a.val();var c=(a.match(/(\r\n|\n|\r|\n\r)/g)||{}).length||0;return a.length+c}a=a.$;var d,f,l;d=a("#aui-teen-message-box");d.bind("change keypress",function(a){return c(d)>=l?(a.preventDefault(),!1):!0});d.bind("paste",
function(a){if(a&&a.originalEvent&&a.originalEvent.clipboardData&&a.originalEvent.clipboardData.getData("Text")){var e=a.originalEvent.clipboardData.getData("Text"),f=c(d);if(f+e.length>=l)return e=e.substring(0,l-f),e=d.val()+e,d.attr("value",e),a.preventDefault(),!1}return!0});d.bind("click keyup",function(){var a=Math.max(l-c(d),0);f.text(a)});f=a(".remaining-char");l=d.parent().data("maxchars")})});"use strict";q.when("A","page-transition-controller","page-conductor","loading-spinner-controller",
"client-side-metrics").register("concealment-form-del-opt-controller",function(a,k,g,c,d){function f(a){var c=h("#concealmentForm");c.find("input:checked").length?(a=a.data.saveConcealmentRefTag,d.increaseCount("CPEX.Checkout.Select.Concealment",1)):(a=a.data.cancelConcealmentRefTag,d.increaseCount("CPEX.Checkout.Cancel.Concealment",1));c.find("input[name\x3dref]").val(a);c.attr("action",c.attr("action")+"/ref\x3d"+a)}function l(a){a=h("#concealmentForm");g.isSPP()||k.showPageTransition();a.submit()}
var h=a.$;a.declarative("submit-concealment-options","click",function(a){f(a);l(a)});a.declarative("discard-concealment-options","click",function(a){h('#concealmentForm input[type\x3d"checkbox"]').prop("checked",!1);f(a);l(a)});a.declarative("submit-concealment-form","click",function(a){f(a);a.$target.closest(".a-button").addClass("a-button-disabled");c.showSpinner(a.$target.closest("form"))})});"use strict";q.when("A","page-transition-controller","page-conductor","address-popovers","checkout-general-utils",
"a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-address-controller",function(a,k,g,c,d,f,l,h,e){function n(){u(".lineitem").each(function(a,b){a=u(b);a.find(".no-js-address-dropdown").remove();a.find(".no-js-address-select").remove();a.find(".js-address-dropdown").prop("disabled",!1);a.find(".address-dropdown").removeClass("a-button-disabled")});u("#suppressAddAddressPopover").val()&&u('select[name^\x3d"addressID."]').find("option").each(function(){var a=u(this);
"New"===a.val()&&a.closest("optgroup").remove()})}function b(a){var b=(new Date).getTime(),c=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});h.isHeadersCleaned()?u.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+b,data:a,dataType:"text",headers:c,error:g.ajaxRedirect,success:function(a,b,c){var f=c.getResponseHeader("x-amz-checkout-fatal-error");if(null!==f&&f!==F)p.location=f;else if(m(a)){a=e.jsonify(a);v(a,c);var h;
c=r.find('input[name^\x3d"previousAddress."]');if(null!==c||c!==F)h=w||c.val();var n=r.find('select[name^\x3d"addressID."]');null===n&&n===F||q.when("a-dropdown").execute(function(a){a.setValue(n.attr("id").replace(/\./g,"\\."),h);n.find("option").removeAttr("selected");n.find('option[value\x3d"'+h+'"]').attr("selected","selected")});k.hide()}else g.ajaxUpdatePage(a,b,c),d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}}):u.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+
b,data:a,dataType:"text",headers:c,error:g.ajaxRedirect,success:function(a,b,c){var e=c.getResponseHeader("x-amz-checkout-fatal-error");if(null!==e&&e!==F)p.location=e;else if(m(c)){v(a,c);var f;a=r.find('input[name^\x3d"previousAddress."]');if(null!==a||a!==F)f=w||a.val();var h=r.find('select[name^\x3d"addressID."]');null===h&&h===F||q.when("a-dropdown").execute(function(a){a.setValue(h.attr("id").replace(/\./g,"\\."),f);h.find("option").removeAttr("selected");h.find('option[value\x3d"'+f+'"]').attr("selected",
"selected")});k.hide()}else g.ajaxUpdatePage(a,b,c),d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}})}function m(a){var b;if(h.isHeadersCleaned()){if(a=e.jsonify(a))b=a.showAddonWarning}else b=a.getResponseHeader("x-amz-checkout-show-addon-warning");return null!==b&&b!==F}function v(a,b){h.isHeadersCleaned()?(b=a.showAddonWarning,a=a.asins):b=b.getResponseHeader("x-amz-checkout-show-addon-warning");u(".item-list").hide();a.trim().split(",").forEach(function(a){u('[data-asin\x3d"'+
a+'"]').show()});a=u("#addon-warning-"+b+"-launcher");a.length&&(u(".delete-title").hide(),u(".reduce-title").hide(),u(".select-address-title").show(),u("input[name\x3duseLiveAUI]").length?f.get(a).attrs({$trigger:B,position:"triggerHorizontal"}).show():(b=u.Event("keyup",{triggerPositioningElement:B,manualTrigger:!0}),a.trigger(b)))}var u=a.$,z,w,B,r;a.declarative("itemselect-get-address",["click","touchend"],function(a){d.protectAgainstDoubleAction("itemselect-get-address",200)||(w=a.$currentTarget.find(".js-address-dropdown").val())});
a.declarative("itemselect-update-address",["change"],function(a){if(!d.protectAgainstDoubleAction("itemselect-update-address",200)){l.resetMetrics();var e=a.$currentTarget.is("select")?a.$currentTarget:a.$currentTarget.find("select");z=e.val();if("New"===z)c.actionTriggerPopoverFromDropdown(a),q.when("a-dropdown").execute(function(a){a.setValue(e.attr("id").replace(/\./g,"\\."),w)});else{k.show();r=e.closest(".lineitem");var f,h;if(r){var g=r.find('input[name^\x3d"lineItemEntityID."]');g&&(f=g.val());
(g=r.find('input[name^\x3d"quantity."]'))&&(h=g.val());(g=r.find(".js-address-dropdown"))&&(z=g.val())}B=a.$currentTarget.is("select")?a.$currentTarget.closest(".address-dropdown"):a.$currentTarget;a=0;g=u("#addon-indicator");g.length&&"true"===g.attr("data-has-addon-items")&&(a=1);b({lineitems:f,addresses:z,quantities:h,isTrial:a})}}});a.declarative("itemselect-update-pantry-address",["change"],function(a){if(!d.protectAgainstDoubleAction("itemselect-update-pantry-address",200)){z=a.$currentTarget.val();
k.show();var c="";a=a.$currentTarget.closest(".pantry-row");u(a).find(".pantry-item").each(function(a,b){a=u(b);c+="lineitems\x3d"+a.find('input[name^\x3d"lineItemEntityID."]').val()+"\x26";c+="addresses\x3d"+z+"\x26";c+="quantities\x3d"+a.find('input[name^\x3d"quantity."]').val()+"\x26"});b(c)}});a.declarative("addon-delete-items",["click","touchend"],function(a){if(B!==F&&null!==B&&!d.protectAgainstDoubleAction("itemselect-delete-addons",200)){u(".a-button-close").trigger("click");k.show();a=(new Date).getTime();
var b=u("#useCase").val(),c=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"}),e=r.find('input[name^\x3d"lineItemEntityID."]').val(),f=r.find('input[name^\x3d"quantity."]').val();u.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+a,data:{lineitems:e,addresses:z,quantities:f,isTrial:0,deleteAddons:1,returnHTML:1,useCase:b},headers:c,error:g.ajaxRedirect,success:function(a,b,c){var e=c.getResponseHeader("x-amz-checkout-redirect-to-cart");
null!==e&&e!==F?p.location=e:(e=c.getResponseHeader("x-amz-checkout-fatal-error"),null!==e&&e!==F?p.location=e:(g.ajaxUpdatePage(a,b,c),d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});a.on("checkout:reload:itemselect",n);a.on("checkout:reload:spp-itemselect",n)});"use strict";q.when("A","page-transition-controller","page-conductor","checkout-general-utils","a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-delete-controller",function(a,
k,g,c,d,f,l,h){function e(a,b){n(a,null===b||b===F?a.$currentTarget.closest(".lineitem"):b)}function n(a,b){a.$event.preventDefault();if(!c.protectAgainstDoubleAction("itemselect-delete-single-item",200)){f.resetMetrics();k.show();w=b;r=a.$currentTarget.is("select")?a.$currentTarget.closest(".quantity-dropdown"):a.$currentTarget;a=w.find('input[name^\x3d"lineItemEntityID."]').val();b=0;(new Date).getTime();var d=z("#addon-indicator");d.length&&"true"===d.attr("data-has-addon-items")&&(b=1);m({lineitems:a,
isTrial:b})}}function b(a,b){a.$event.preventDefault();if(!c.protectAgainstDoubleAction("itemselect-delete-multiple-items",200)){k.show();B=b;r=a.$currentTarget;var d="";a=0;b=z("#addon-indicator");b.length&&"true"===b.attr("data-has-addon-items")&&(a=1);b=B.hasClass("pantry-row")?!0:!1;B.find(b?".pantry-item":".lineitem").each(function(a,b){d+="lineitems\x3d"+z(b).find('input[name^\x3d"lineItemEntityID."]').val()+"\x26"});m(d+"isTrial\x3d"+a)}}function m(a){var b=(new Date).getTime(),c=z('input[name\x3d"useCase"]').val(),
d=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});z.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3ddelete\x26useCase\x3d"+c+"\x26cachebuster\x3d"+b,data:a,dataType:"text",headers:d,error:g.ajaxRedirect,success:v})}function v(a,b,d){var e;e=d.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==e&&e!==F?(p.location=e,e=!0):e=!1;if(!e)if(e=d.getResponseHeader("x-amz-checkout-fatal-error"),null!==e&&e!==F)p.location=e;else{var f;if(l.isHeadersCleaned()){if(e=
h.jsonify(a))f=e.showAddonWarning}else f=d.getResponseHeader("x-amz-checkout-show-addon-warning");f=null!==f&&f!==F?!0:!1;f?(u(a,d),k.hide()):(g.ajaxUpdatePage(a,b,d),c.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}}function u(a,b){l.isHeadersCleaned()?(a=h.jsonify(a),b=a.showAddonWarning,a=a.asins):b=b.getResponseHeader("x-amz-checkout-show-addon-warning");z(".item-list").hide();a.trim().split(",").forEach(function(a){z('[data-asin\x3d"'+a+'"]').show()});a=z("#addon-warning-"+
b+"-launcher");a.length&&(z(".delete-title").show(),z(".reduce-title").hide(),z(".select-address-title").hide(),z("input[name\x3duseLiveAUI]").length?d.get(a).attrs({$trigger:r,position:"triggerHorizontal"}).show():(b=z.Event("keyup",{triggerPositioningElement:r,manualTrigger:!0}),a.trigger(b)))}var z=a.$,w,B,r;a.declarative("itemselect-delete-item",["click","touchend"],e);a.declarative("itemselect-delete-item-row",["click","touchend"],function(a){b(a,a.$currentTarget.closest(".item-row"))});a.declarative("addon-delete-items",
["click","touchend"],function(a){if(r!==F&&!c.protectAgainstDoubleAction("itemselect-delete-addons",200)){z(".a-button-close").trigger("click");k.show();var b="";null!==B&&B!==F?(a=B.hasClass("pantry-row")?B.find(".pantry-item"):B.find(".lineitem"),z(a).each(function(a,c){b+="lineitems\x3d"+z(c).find('input[name^\x3d"lineItemEntityID."]').val()+"\x26"})):null!==w&&w!==F&&(b+="lineitems\x3d"+w.find('input[name^\x3d"lineItemEntityID."]').val()+"\x26");m(b+"isTrial\x3d0\x26deleteAddons\x3d1")}});a.declarative("itemselect-delete-pantry-item",
["click","touchend"],function(a){n(a,a.$currentTarget.closest(".pantry-item"))});a.declarative("itemselect-delete-pantry",["click","touchend"],function(a){b(a,a.$currentTarget.closest(".pantry-row"))});a.declarative("itemselect-delete-popover-item",["click","touchend"],function(a){var c=a.$currentTarget.data("entityidtodelete");b(a,z('a[data-entityid\x3d"'+c+'"]').closest(".item-row"))});return{actionDeleteItem:e}});"use strict";q.when("A","page-transition-controller","page-conductor","itemselect-delete-controller",
"checkout-general-utils","a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-quantity-controller",function(a,k,g,c,d,f,l,h,e){function n(){B(".lineitem, .pantry-item").each(function(a,b){a=B(b);a.find(".no-js-quantity").remove();b=a.find(".quantity-dropdown");b.is(":visible")?(a.find(".js-select").prop("disabled",!1),b.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))})}function b(a){a.find(".quantity-input").val(a.find('input[name^\x3d"previousQuantity."]').val())}
function m(a){var c=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),d=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val(),e;e="itemselect-show-update-pantry-button"===a.action?".pantry-item":".lineitem";0===parseInt(d,10)||""===d?("change"===a.type&&b(a.$currentTarget.closest(e)),c.hide()):(a=a.$currentTarget.closest(e).find('input[name^\x3d"previousQuantity."]').val(),d!==a?c.show():c.hide())}function v(a){a.$event.preventDefault();
if(!d.protectAgainstDoubleAction("itemselect-update-quantity",200)){l.resetMetrics();H=a.$currentTarget.closest("itemselect-update-pantry-quantity"===a.action||"itemselect-update-pantry-quantity-text-field"===a.action?".pantry-item":".lineitem");var f=H.find(".js-address-dropdown").val(),n=a.$currentTarget.find("select"),m=n.length?n:a.$currentTarget;r=m.is("select")?m.val():H.find(".quantity-input").val();if(0===parseInt(r,10)||""===r)b(H);else if("Delete"===r)q.when("a-dropdown").execute(function(a){a.setValue(m.attr("id").replace(/\./g,
"\\."),t)}),c.actionDeleteItem(a,H);else{k.show();a=H.find('input[name^\x3d"lineItemEntityID."]').val();var n=0,v=(new Date).getTime(),P=B("#useCase").val(),D=B("#addon-indicator");y=m.is("select")?m.parent():H.find(".quantity-input");D.length&&"true"===D.attr("data-has-addon-items")&&(n=1);D=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});h.isHeadersCleaned()?B.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+v,data:{lineitems:a,
quantities:r,address:f,isTrial:n,returnHTML:1,useCase:P},dataType:"text",headers:D,error:g.ajaxRedirect,success:function(a,b,c){var f=c.getResponseHeader("x-amz-checkout-fatal-error");null!==f&&f!==F?p.location=f:z(a)?(a=e.jsonify(a),w(a,c),u(t===F?H.find('input[name^\x3d"previousQuantity."]').val():t,c),k.hide()):(g.ajaxUpdatePage(a,b,c),d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}}):B.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+
v,data:{lineitems:a,quantities:r,address:f,isTrial:n,returnHTML:1,useCase:P},dataType:"text",headers:D,error:g.ajaxRedirect,success:function(a,b,c){var e=c.getResponseHeader("x-amz-checkout-fatal-error");null!==e&&e!==F?p.location=e:z(c)?(w(a,c),u(t===F?H.find('input[name^\x3d"previousQuantity."]').val():t,c),k.hide()):(g.ajaxUpdatePage(a,b,c),d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}})}}}function u(a,b){10>a?(q.when("a-dropdown").execute(function(b){var c=H.find('select[name^\x3d"quantity."]');
b.setValue(c.attr("id").replace(/\./g,"\\."),a);c.find("option").removeAttr("selected");c.find('option[value\x3d"'+a+'"]').attr("selected","selected")}),H.find(".quantity-dropdown").show(),H.find(".quantity-text-field").hide(),H.find(".js-select").prop("disabled",!1),H.find(".quantity-input").prop("disabled",!0)):(H.find(".quantity-dropdown").hide(),H.find(".quantity-text-field").show(),H.find(".update-quantity-link").hide(),H.find(".js-select").prop("disabled",!0),H.find(".quantity-input").prop("disabled",
!1));H.find(".quantity-input").val(a);H.find('input[name^\x3d"previousQuantity."]').val(a)}function z(a){var b;if(h.isHeadersCleaned()){if(a=e.jsonify(a))b=a.showAddonWarning}else b=a.getResponseHeader("x-amz-checkout-show-addon-warning");return null!==b&&b!==F?!0:!1}function w(a,b){h.isHeadersCleaned()?(b=a.showAddonWarning,a=a.asins):b=b.getResponseHeader("x-amz-checkout-show-addon-warning");B(".item-list").hide();a.trim().split(",").forEach(function(a){B('[data-asin\x3d"'+a+'"]').show()});a=B("#addon-warning-"+
b+"-launcher");a.length&&0<a.length&&(B(".reduce-title").show(),B(".delete-title").hide(),B(".select-address-title").hide(),B("input[name\x3duseLiveAUI]").length?f.get(a).attrs({$trigger:y}).show():(b=B.Event("keyup",{triggerPositioningElement:y,manualTrigger:!0}),a.trigger(b)))}var B=a.$,r,t,H,y;a.declarative("itemselect-get-quantity",["click","touchend"],function(a){d.protectAgainstDoubleAction("itemselect-get-quantity",200)||a.$currentTarget.find("select").length&&(t=a.$currentTarget.find("select").val())});
a.declarative("itemselect-update-quantity",["change"],v);a.declarative("itemselect-update-pantry-quantity",["change"],v);a.declarative("addon-delete-items",["click","touchend"],function(a){if(y!==F&&!d.protectAgainstDoubleAction("itemselect-delete-addons",200)){B(".a-button-close").trigger("click");k.show();a=H.find('input[name^\x3d"lineItemEntityID."]').val();var b=(new Date).getTime(),c=B("#useCase").val(),e=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});B.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+
b,data:{lineitems:a,quantities:r,isTrial:0,deleteAddons:1,returnHTML:1,useCase:c},headers:e,error:g.ajaxRedirect,success:function(a,b,c){var e=c.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==e&&e!==F?p.location=e:(e=c.getResponseHeader("x-amz-checkout-fatal-error"),null!==e&&e!==F?p.location=e:(g.ajaxUpdatePage(a,b,c),d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});a.declarative("itemselect-sanitize-input",["keydown"],function(a){d.limitInputToNumbers(a)});
a.declarative("itemselect-update-quantity-text-field",["click","touchend"],v);a.declarative("itemselect-update-pantry-quantity-text-field",["click","touchend"],v);a.declarative("itemselect-show-update-button",["change","keyup"],m);a.declarative("itemselect-show-update-pantry-button",["change","keyup"],m);a.on("checkout:reload:itemselect",n);a.on("checkout:reload:spp-itemselect",n)});"use strict";q.when("A","page-transition-controller","page-conductor","checkout-general-utils","client-side-metrics").register("itemselect-ship-to-multiple-controller",
function(a,k,g,c,d){var f=a.$;a.declarative("itemselect-ship-to-multiple",["click","touchend"],function(a){a.$event.preventDefault();d.resetMetrics();if(!c.protectAgainstDoubleAction("itemselect-ship-to-multiple",200)){k.show();var h=null,e=null,n=null;a.$currentTarget.closest(".item-row").find(".lineitem").each(function(a,b){a=f(b);b=a.find('select[name^\x3d"quantity."]');var c=a.find('input[type\x3d"number"]');if(a.find(".quantity-dropdown").is(":visible")&&1<b.val())return h=a.find('input[name^\x3d"lineItemEntityID."]').val(),
e=b.val(),n=a.find(".js-address-dropdown").val(),!1;if(a.find(".quantity-text-field").is(":visible")&&1<c.val())return h=a.find('input[name^\x3d"lineItemEntityID."]').val(),e=c.val(),n=a.find(".js-address-dropdown").val(),!1});if(null!==h){a=(new Date).getTime();var b=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});f.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dship-to-multiple\x26cachebuster\x3d"+a,data:{lineitem:h,quantity:e,address:n},headers:b,dataType:"text",
error:g.ajaxRedirect,success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-fatal-error");null!==e&&e!==F?p.location=e:(g.ajaxUpdatePage(a,b,d),c.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}})}}})});"use strict";q.when("A").register("safe-apx-helper",function(a){var k={},g=a.$;return{get:function(a){return k[a]},set:function(){1===arguments.length?k=g.extend(k,arguments[0]):2===arguments.length?k[arguments[0]]=arguments[1]:p.console&&p.console.error&&p.console.error("Unexpected number of arguments: %d. Expected 1 or 2.",
arguments.length)}}});"use strict";q.when("A","weblab-helper").register("mobile-carrier-billing-util",function(a,k){var g=!1;return{determineIsMCBEnabled:function(a){g=0<a.paymentRows.find('input[type\x3d"radio"][name\x3dpaymentMethod]').filter("[value^\x3dMCB]").size()},toggleGCForMCB:function(a,d){if(!k.isMCBMultiTenderWeblabEnabled()&&g&&(a=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]'),a.length)){var f=d.paymentRows.find('input[type\x3d"checkbox"][name\x3duseAvailableBalance]'),f=d.existingBalance||
f,l=0<d.paymentRows.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length,h="paymentsForm"in d&&0<d.paymentsForm.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length,l=l||h;0<a.filter("[value^\x3dMCB]").size()&&l?(f.length&&(f.prop("checked",!1),f.prop("disabled",!0)),d.mcbBalanceWarning&&d.mcbBalanceWarning.show()):(f.length&&f.prop("disabled",!1),d.mcbBalanceWarning&&d.mcbBalanceWarning.hide())}},showMCBWarningMessageForPoints:function(a){g&&a.mcbPointsWarning&&a.mcbPointsWarning.show()},
hideMCBWarningMessageForPoints:function(a){g&&a.mcbPointsWarning&&a.mcbPointsWarning.hide()}}});"use strict";q.when("A").register("emi-utils",function(a){var k=a.$;return{addEMIMenuSelectionAttributes:function(){var a=k("#emiPaymentMethodsSelectList").val();k("#pmEmiPaymentOptions").val(a);var c=a.split(".");1<c.length&&(a=c[1]);var a=k("."+a),d;a&&(d=a.find("#emiMenuIdentifier"));d&&(d.attr("name","isFromEMIMenu"),d.attr("value","1"))},removeEMIMenuSelectionAttributes:function(){var a=k("#selectedSectionEmiPaymentMethod").find("#emiMenuIdentifier");
a.removeAttr("name");a.removeAttr("value")},isEMIPaymentInstrument:function(a){return 1==a.length&&1==k(a[0]).find("#pmEmiPaymentOptions").length?!0:!1},getEMIMenuSelectedCardSection:function(){var a=k("#emiPaymentMethodsSelectList").val(),c=a.split(".");1<c.length&&(a=c[1]);return k("."+a)}}});"use strict";q.when("A","emi-utils").register("emi-helper",function(a,k){function g(){k.addEMIMenuSelectionAttributes()}function c(){k.removeEMIMenuSelectionAttributes()}function d(a){var c;if("CreditCard"===
a)c=f(l.newEMI).find(".new-emi-card-fields").hide();else if(a=a.split("."),1<a.length){var d=a[0];if("emiCreditCard"===d||"netbankingEMI"===d)c=f(l.newEMI).find("."+a[1]).hide()}return c}var f=a.$,l={selectedEMIMenuSection:"#selectedSectionEmiPaymentMethod",emiDisabledText:"#emiDisabledText",emiDisabledWhy:"#emiDisabledWhy",newEMI:"#newEmiCard"};return{addEMIMenuSelectionAttributes:g,removeEMIMenuSelectionAttributes:c,disableEMIPaymentMethods:function(a){a.prop("disabled",!0);a.is(":checked")&&(a.prop("checked",
!1),f(l.newEMI).find(".payment-selected").removeClass("payment-selected"));a.parent().siblings().addClass("a-color-secondary");f(l.selectedEMIMenuSection).hide();f(l.emiDisabledText).show();f(l.emiDisabledWhy).show()},enableEMIPaymentMethods:function(a){a.prop("disabled",!1);a.parent().siblings().removeClass("a-color-secondary");a.is(":checked")&&f(l.selectedEMIMenuSection).show();f(l.emiDisabledText).hide();f(l.emiDisabledWhy).hide()},isEMIPaymentInstrument:function(a){return k.isEMIPaymentInstrument(a)},
getEMIMenuSelectedCardSection:function(){return k.getEMIMenuSelectedCardSection()},showPaymentOptionBlock:d,toggleEMIMenu:function(a){var e=f(l.newEMI).find("#emiPaymentMethodsSelectList").find("option:selected").val(),n;a.find("#emiPaymentMethodsSelectList").length?(a.find("#emiMenuErrors_VCC").length&&a.find("#emiMenuErrors_VCC").hide(),f(l.newEMI).find(".section-emi-payment-method").show(),"SelectOption"===e?f(l.newEMI).find("#selectedSectionEmiPaymentMethod").show():n=d(e),n&&(g(),f(l.newEMI).find("#selectedSectionEmiPaymentMethod").show(),
n.show())):(c(),f(l.newEMI).find("#selectedSectionEmiPaymentMethod").hide())}}});"use strict";q.when("A","pay-common-util").register("instant-bank-discount-helper",function(a,k){var g={instantBankDiscountAmazonPaySelectedText:".instant-bank-discount-apay-selected",instantBankDiscountAmazonPayDeselectedText:".instant-bank-discount-apay-deselected"};return{showInstantBankDiscountAmazonPayDeselected:function(){var a=k.getElements(g);a.instantBankDiscountAmazonPaySelectedText.addClass("aok-hidden");a.instantBankDiscountAmazonPayDeselectedText.removeClass("aok-hidden")},
showInstantBankDiscountAmazonPaySelected:function(){var a=k.getElements(g);a.instantBankDiscountAmazonPayDeselectedText.addClass("aok-hidden");a.instantBankDiscountAmazonPaySelectedText.removeClass("aok-hidden")}}});"use strict";q.when("A","page-detector","checkout-general-utils").register("pay-common-lib",function(a,k,g){function c(a,b){b.attr("name")&&(a[b.attr("name")]=b.val());b.attr("id")&&(a[b.attr("id")]=b.val())}function d(a,b){if(!b)return a;for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);
return a}function f(a,b,c){l.each(b,function(b,d){a[b]=c?c.find(d):l(d)})}var l=a.$,h="checkbox hidden password radio text number tel month".split(" "),e={};a.declarative("move-to-next-field",["keypress"],function(a){13===a.$event.charCode&&(g.moveToNextInput(a.$declarativeParent),a.$event.preventDefault())});a.declarative("scroll-to-input",["keypress"],function(a){13===a.$event.charCode&&(l(p).scrollTop(a.$declarativeParent.offset().top),a.$event.preventDefault())});return{getAttributeData:function(a,
b){if(a)return a.attr(b)||a.attr("data-"+b)||a.data(b)},getElements:function(a,b){var c={};f(c,a,b);return c},getInputValues:function(a){var b=a.find(".data-row").data()||{};a.find("input").each(function(){var a=l(this),d=a.attr("type");("radio"!==d&&"checkbox"!==d||a.is(":checked"))&&-1<l.inArray(d,h)&&c(b,a)});a.find("select").each(function(){c(b,l(this))});return b},isDesktopCX:k.isDesktopPayment,isMobileCX:k.isMobilePayment,isPayPage:k.isPayment,isTouchCX:k.isTabletPayment,mergeFrom:function(a,
b){b=d({},b);return d(b,a)},prop:function(a,b,c){if(a){if(1<arguments.length)return b===F?delete e[a]:e[a]={isOneTime:c?1:0,value:b},b;var d=e[a];if(d)return d.isOneTime&&delete e[a],d.value}},refreshElements:f,scrollTopTo:function(a){a&&a.length&&l("html,body").animate({scrollTop:a.offset().top-20},"fast")},selectDefaultPaymentMethodIfNotSelected:function(){var a=l("#existing-payment-methods .payment-row").find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),b=a.closest("div.payment-selected");
b&&0<b.length||(a=a.closest("div.default-payment-marker"))&&a.length&&(a.addClass("payment-selected"),a.find("[name\x3dpaymentMethod]").attr("checked",!0))},processSubmissionParameters:function(a){for(var b={},c=0;c<a.length;c++)b[a[c].name]=a[c].value;return b}}});"use strict";q.when("A","pay-common-lib","a-popover-base","ajax-utility","loading-spinner-controller","page-conductor","page-transition-controller").register("pay-desktop-util",function(a,k,g,c,d,f,l){function h(a){a.$event.preventDefault();
a.$target.closest(".a-popover").hide();a.$target.siblings("span.error-message").hide()}function e(a){a.preventDefault();var b=t(a.currentTarget),c=b.closest("div.expando-section");a=c.find("div.expando-content");var c=c.find("div.expando-reverse-content"),d=a.is(":visible"),e=function(){var a=b.find("i");a.hasClass("a-icon-collapse")||a.hasClass("a-icon-expand")?d?(a.removeClass("a-icon-collapse").addClass("a-icon-expand"),b.find("div.expando-toggle-text-show").show(),b.find("div.expando-toggle-text-hide").hide()):
(a.removeClass("a-icon-expand").addClass("a-icon-collapse"),b.find("div.expando-toggle-text-show").hide(),b.find("div.expando-toggle-text-hide").show()):d?(a.removeClass("a-icon-section-collapse").addClass("a-icon-section-expand"),b.find("div.expando-toggle-text-show").show(),b.find("div.expando-toggle-text-hide").hide()):(a.removeClass("a-icon-section-expand").addClass("a-icon-section-collapse"),b.find("div.expando-toggle-text-show").hide(),b.find("div.expando-toggle-text-hide").show())};d?(c.slideDown("fast"),
a.slideUp("fast",e)):(c.slideUp("fast"),a.slideDown("fast",e))}function n(a){var b=a.$target.closest("a");a=b.closest("div.extender-section");b=b.find("i");b.hasClass("a-icon-extender-expand")?(a.find(".collapsed").hide(),a.find(".expanded").slideDown("fast"),b.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse")):(a.find(".collapsed").show(),a.find(".expanded").slideUp("fast"),b.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"))}function b(a){I.msgPopovers.filter(":visible").hide();
a.$event.preventDefault();a.$event.stopPropagation();a=a.$target.parent().find(".a-popover");a.is(":visible")||a.show()}function m(a,b,c){var d=a||{},e="string"===typeof a;c=c&&c.useSif?t('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():0;e?(d+="\x26ajaxResponse\x3d1\x26returnjson\x3d1",c&&(d+="\x26isAmazonApp\x3d1")):(d.ajaxResponse=1,d.returnjson=1,c&&(d.isAmazonApp=1));for(c=0;c<E.length;c++){var f=E[c],h=t("input[name\x3d"+f+"]").val();e?-1===b.search(f)&&-1===a.search(f)&&(d=d+"\x26"+
f+"\x3d"+h):d[f]=h}return d}function v(a,b){if(0>a)return 0;isNaN(b)||(a=Number(a).toFixed(b));a=a.toString();b=0<=a.lastIndexOf(".")?a.lastIndexOf("."):a.length;return 3>=b?a:v(a.substring(0,b-3),0)+","+a.substring(b-3)}function u(a,b,c,d){a="timeout"===b?"pay-ajax-timeout":"abort"===b?"pay-ajax-abort":"abort-for-cleanup"===b?"pay-ajax-abort-for-cleanup":"parsererror"===b?"pay-ajax-parsererror":500===a.status?"pay-ajax-500":"pay-ajax-error";if(c){a=c=-1===c.lastIndexOf(".html?")?c+("?ref\x3d"+a):
c+("\x26ref\x3d"+a);I.pageContainer.find("#tempForm").remove();c=t('\x3cform id\x3d"#tempForm" method\x3d"post"\x3e\x3c/form\x3e');c.attr("action",a);if("string"===typeof d){a={};b=d.split("\x26");for(var e=0;e<b.length;e++){var f=b[e].split("\x3d");2===f.length&&(a[f[0]]=f[1])}}else a=d;for(var h in a)"ajaxResponse"!==h&&"returnjson"!==h&&(a=t('\x3cinput type\x3d"hidden"/\x3e').attr("name",h).val(d[h]),c.append(a));I.pageContainer.append(c);c.submit()}}function z(a,b,d,e){var h=f.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"}),
h={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:m(b,a,e),dataType:"text",headers:h,timeout:y,type:"POST",url:a,beforeSend:function(a,b){d&&d.beforeHandler&&d.beforeHandler(a,b)},complete:function(a,b){d&&d.completeHandler&&d.completeHandler(a,b)},error:function(c,e){d&&d.errorHandler?d.errorHandler(c,e):u(c,e,a,b)},success:function(a,b,e){var h=e.getResponseHeader("x-amz-checkout-page");if("payselect"!==h&&"spp-payment"!==h)return a=c.jsonify(a),f.redirect(a);d&&d.successHandler?
d.successHandler(a,b,e):f.ajaxUpdatePage(a,b,e)}};t.extend(h,e);p.push(t.ajax(h))}function w(a,b,c,d){var e=f.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"}),e={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:m(b,a,d),dataType:"text",headers:e,timeout:y,type:"POST",url:a,error:function(d,e){c&&c.errorHandler?c.errorHandler(d,e):u(d,e,a,b)},success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-page");"payselect"!==e&&"spp-payment"!==e&&c&&c.pageUpdater?
c.pageUpdater(a):f.ajaxUpdatePage(a,b,d)}};t.extend(e,d);p.push(t.ajax(e))}function B(){y=parseInt(t("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),10);y=isNaN(y)?1E4:y;k.isMobileCX()?H&&(H=!1):(I=k.getElements(q),H&&(a.declarative("close-popover",["click"],h),a.declarative("toggle-msg-popover",["click"],b),a.declarative("a-extender-toggle",["click"],n),H=!1),I.pageContainer.undelegate(".expando-link","click").delegate(".expando-link","click",e),I.pageContainer.find("form select.a-touch-select-input").unbind("change",
r).bind("change",r),t(".a-dropdown-container").each(function(){g.remove(t(this).find("select").attr("name"))}),t(document).bind("click",function(a){a.isPropagationStopped()||0===t(a.target).closest(".pay-popover-msg").length&&I.msgPopovers.filter(":visible").hide()}))}function r(a){var b=t(a.currentTarget);a=b.siblings("a.a-placeholder");b=b.find(":selected").text();a.html(b);return!1}var t=a.$,H=!0,y,p=[],E=["forceResponsive","fromAnywhere","hasWorkingJavascript"],I={},q={msgPopovers:"div.pay-popover-msg",
pageContainer:"div.a-container"};a.on("checkout:reload:payselect",B);a.on("checkout:reload:spp-payment",B);return k.mergeFrom({decodeJSONResponse:function(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:I,getNumberWithSeparators:v,handleForm:function(a,b,c){a.$event.preventDefault();
var d=a.$declarativeParent;d.is("span")&&(d=d.find("form"));d=d.serializeArray();d=k.processSubmissionParameters(d);z(a.data.action,d,b,c)},makeAjaxCall:z,handleAjaxError:u,handlePaymentsPortalForm:function(a,b,c,d){a=k.processSubmissionParameters(a.submissionParameters);z(b,a,c,d)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,b,c,d){a=k.processSubmissionParameters(a.submissionParameters);a.embedOnlyData=1;w(b,a,c,d)}},k)});"use strict";q.when("A","pay-common-lib","page-transition-controller").register("pay-mobile-util",
function(a,k,g){function c(a,b,c){a=a||{};var d=z.fromAnywhereField.val(),e=c&&c.useSif?m('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():0,f=l();"string"===typeof a?(a=a+"\x26ajaxResponse\x3d1\x26currentPage\x3d"+f,-1===b.search("fromAnywhere")&&-1===a.search("fromAnywhere")&&(a=a+"\x26fromAnywhere\x3d"+d),e&&(a+="\x26isAmazonApp\x3d1")):(a.ajaxResponse=1,a.currentPage=f,-1===b.search("fromAnywhere")&&(a.fromAnywhere=d),e&&(a.isAmazonApp=1),c&&c.isAddCardAndContinueEnabled&&(a.isHideSpinnerDisabled=
!0));return a}function d(){v&&v.abort("abort-for-cleanup");v=null}function f(a,b,c,d){a=a&&a.status;b="timeout"===b?"pay-ajax-timeout":"abort"===b?"pay-ajax-abort":"abort-for-cleanup"===b?"pay-ajax-abort-for-cleanup":"parsererror"===b?"pay-ajax-parsererror":500===a?"pay-ajax-500":"unknown"===a?"pay-unknown-page":"pay-ajax-error";c&&(c=-1===c.lastIndexOf(".html?")?c+("?ref\x3d"+b):c+("\x26ref\x3d"+b),n(c,d))}function l(){var a;m.each(u,function(b,c){if(c.pageId&&m(c.pageId).is(":visible"))return a=
b,!1});return a}function h(a){(a=u[a]&&u[a].componentId)&&q.when(a).execute(function(a){a.init&&a.init()})}function e(a,b,d,e,n){n&&n.suppressSpinner||g.show();n={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:c(b,a,e),dataType:"text",timeout:r,type:"POST",url:a,beforeSend:function(a,b){d&&d.beforeHandler&&d.beforeHandler(a,b)},complete:function(a,c){d&&d.completeHandler&&d.completeHandler(a,c);b&&b.isHideSpinnerDisabled||g.hide()},error:function(c,e){d&&d.errorHandler?d.errorHandler(c,
e):f(c,e,a,b)},success:function(c,e,g){var n=g.getResponseHeader("x-amz-checkout-pay-page-name");if(n){var m=g.getResponseHeader("x-amz-checkout-pay-page-title");m&&z.pageTitle.text(decodeURIComponent(m));d&&d.successHandler?d.successHandler(c,e,g):z.pageContainer.html(c);h(n)}else f(null,"unknown",a,b)}};m.extend(n,e);v=m.ajax(n)}function n(a,b,c){var d=m("#tempForm",z.pageContainer);0<d.length&&d.remove();d=m('\x3cform method\x3d"post"\x3e\x3c/form\x3e');d.attr("action",a);c&&c.target&&d.attr("target",
c.target);if("string"===typeof b)for(a=b.split("\x26"),b=0;b<a.length;b++)c=a[b].split("\x3d"),2===c.length&&"ajaxResponse"!==c[0]&&(c=m('\x3cinput type\x3d"hidden"/\x3e').attr("name",c[0]).val(c[1]),d.append(c));else for(var e in b)"ajaxResponse"!==e&&d.append(m('\x3cinput type\x3d"hidden"/\x3e').attr("name",e).val(b[e]));z.pageContainer.append(d);d.submit()}function b(a,b,d,e,n){n&&n.suppressSpinner||g.show();n={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:c(b,a,e),dataType:"text",
timeout:r,type:"POST",url:a,complete:function(a,b){d&&d.completeHandler&&d.completeHandler(a,b);g.hide()},error:function(c,e){d&&d.errorHandler?d.errorHandler(c,e):f(c,e,a,b)},success:function(a,b,c){var e=c.getResponseHeader("x-amz-checkout-pay-page-name");if(!e&&d&&d.pageUpdater)d.pageUpdater(a);else{var f=c.getResponseHeader("x-amz-checkout-pay-page-title");f&&z.pageTitle.text(decodeURIComponent(f));d&&d.successHandler?d.successHandler(a,b,c):z.pageContainer.html(a);h(e)}}};m.extend(n,e);v=m.ajax(n)}
var m=a.$,v=null,u={main:{componentId:"page-main",pageId:"#select-payments-view"},"credit-card-rewards":{componentId:"page-rewards",pageId:"#select-payment-rewards-view"},"financial-offer":{componentId:"page-financial-offer",pageId:"#select-payment-financial-offer-view"},"new-payment-methods":{pageId:"#new-payments-view"},"gil-estimates":{pageId:"#gil-estimates-subpage"}},z={},w={cvvHelper:"div#cvv-help-popover",fromAnywhereField:"input[name\x3dfromAnywhere]",jppoints:"div#jppoints",pageContainer:"div#page-container",
pageTitle:"head title"},B=!0,r;return k.mergeFrom({decodeJSonResponse:function(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:z,getCurrentPage:function(){return z.pageContainer.children("div.page").filter(":visible")},getCurrentPageName:l,getPageId:function(a){a=
a.getResponseHeader("x-amz-checkout-pay-page-name");return u[a]&&u[a].pageId},handleForm:function(a,b,c){a.$event.preventDefault();e(a.data.action,a.$target.serialize(),{successHandler:function(a,c,d){b(a,c,d)}},c)},submitFormRequest:n,init:function(){k.isMobileCX()&&(p.onbeforeunload=d,k.refreshElements(z,w),r=parseInt(m("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),10),r=isNaN(r)?1E4:r,B&&(B=!1,m("div.pay-mobile").bind("keypress",function(a){k.prop("activeGoElement",13===a.keyCode?
document.activeElement:null,!0)})))},makeAjaxCall:e,handleAjaxError:f,pages:u,handlePaymentsPortalForm:function(a,b,c,d){a=k.processSubmissionParameters(a.submissionParameters);e(b,a,c,d)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,c,d,e){a=k.processSubmissionParameters(a.submissionParameters);a.embedOnlyData=1;b(c,a,d,e)}},k)});"use strict";q.when("page-detector","pay-desktop-util","pay-mobile-util").register("pay-common-util",function(a,k,g){return a.isMobile()?g:k});"use strict";
q.when("A","pay-common-util","pay-rewards-currency","checkout-federation-wrapper","safe-apx-helper","weblab-helper").register("pay-validator",function(a,k,g,c,d,f){function l(){function a(b,c,d,e){X.push({identifier:b,priority:d||100,target:c,isPincodeError:e})}function m(a){if(!a)return null;var b=new RegExp(String.fromCharCode(32),"g"),c=new RegExp(String.fromCharCode(45),"g");return a.replace(b,"").replace(c,"")}function l(){return 0<X.length}function u(a){if(!a||0===a.length)return!1;for(var b=
0,c=!1,d=a.length-1;0<=d;--d){var e=a.charAt(d);c&&(e*=2,9<e&&(e-=9));b+=parseInt(e,10);c=!c}return 0===b%10}function z(a,b){return a&&a.match(/^[0-9]+$/)&&a.length===b}function w(a,b,c){return a&&a.match(/^[0-9A-Za-z]+$/)&&a.length>=b&&a.length<=c}function B(a,b){if(!a||!b)return!1;a=parseInt(a,10);b=parseInt(b,10);return r(a,b)}function r(a,b){var c=new Date,d=c.getFullYear();return b>d||b===d&&a>=c.getMonth()+1}function t(a){a=a.val();return!a||0===a.length}function p(){var c=h("#pm_pay_by_check").is(":checked"),
d=h("#existing-balance [paymentmethodid\x3d'availablebalance'] input").is(":checked");c&&d&&a("continue_BadCombinationCheckExistingBalance")}function y(c){if(h("#jppoints").length){var d,e=!1;1===c.length&&"jppoints"===c.attr("id")?(d=c,e=!0):d=c.filter("#jppoints");if(d&&d.find("#redeemPoints").is(":checked")){c=d.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val();c=parseInt(c,10);h('input[type\x3d"checkbox"][name\x3d"useAvailableBalance"]').is(":checked")&&(c-=parseInt(d.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),
10));var f=parseInt(d.find("#redeemableAmount").text(),10),g=d.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');d.find("#jpPointsMax").is(":checked")?d=f:(d=parseInt(g.val(),10))||(d=0);d>f?a("continue_jpPointsExceedsRedeemableAmount",g):e&&d<c?a("continue_notEnoughJPPoints"):d>c&&a("continue_jpPointsExceedsTotalPurchase")}}}function G(c){c&&(c=c.find(".pci-blocking-cvv"),c.length&&c.is(":visible")&&a("PCI_Block_CVV"))}function E(c){var d=c.find(".currency-list");d.length&&d.is(":visible")&&
(c=d.find("[type\x3dradio]:checked").val(),d=d.find("#cardCurrencyDropDown option:selected").val(),c&&("Other"!==c||"-1"!==d&&"-2"!==d)||a("continue_SelectCardCurrency"))}function I(c){var d=c.find("#existingCvvNum");if(0!==d.length){var f=d.val();c=e?c.data("validcvvlength"):c.attr("validcvvlength");z(f,parseInt(c,10))||a("continue_BadSecurityCode",d)}}function da(c){var d=c.find('input[name\x3d"paymentMethod"]').val();/^creditCard/.test(d)&&c.find("#savedCardSuppressed").length&&a("continue_BankTemporarilyNotAvailable")}
function W(c){c=c.find("#existingPincodeNum");if(0!==c.length){var d=c.val();d?w(d,4,8)||a("existingCreditCard_PincodeInvalid",c,null,!k.isMobileCX()):a("continue_EmptyPincode",c)}}function P(c){if(c&&c.length)for(var d=0;d<c.length;d++){var e=h(c[d]);G(e.parent());I(e);W(e);"netBanking"===e.find('input[name\x3d"paymentMethod"]').val()&&(h("#netBanking_select").val(),h("#net-banking-list").find("option:selected").data("isdisabled")&&a("continue_BankTemporarilyNotAvailable"));da(e);var f=e;f.find('input[name\x3d"paymentMethod"]').val();
f.find("#vdcBanksSelect").val();h("#vdcBanksSelect").find("option:selected").data("isdisabled")&&a("continue_BankTemporarilyNotAvailable");aa(e);e=e.siblings("#upi-acceptance-input").find("#vpaCollect");if(!e||e.length)(f=e.val())&&f.match(/.+@.+/)||a("continue_BadVpaForUpi",e)}}function D(c){var d=c.find("#newMonth"),e=c.find("#newYear");c=c.find("#newExpDate");!(d=d.length&&!B(d.val(),e.val()))&&(d=c.length)&&((c=c.val())?(d=c.split("-"),c=parseInt(d[0],10),d=parseInt(d[1],10),c=r(d,c)):c=!1,d=
!c);d&&a("continue_BadExpiration")}function N(c){"domesticCards"===c.find('input[name\x3d"paymentMethod"]').val()&&((c=c.find("select").val())&&c.match(/^[0-9]*$/)||a("continue_BlankSlate"))}function U(c){var d=h("#existing-balance input[name\x3duseFlexiblePayments]").is(":checked");c=k.getAttributeData(c,"paymentmethodtype");d&&"creditCard"!==c&&a("continue_FlexiblePaymentsNeedsCreditCard")}function x(c){"thirdPartyAccounts"===c.find('input[name\x3d"paymentMethod"]').val()&&((c=c.find("select").val())&&
0!==c.length||a("continue_BlankSlate"))}function L(c){var d=c.find(".rewards-list");if(d.length&&d.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")){c=d.find("input.custom-rewards-input");var e=c.val();if(d.hasClass("show-currency-input-widget-new")){var d=c.data("country-code"),f=g.getCurrencyFormatByCountryCode(d),d=c.data("min"),e=g.getAmount(e,f.decimalPlace);e<d&&a("continue_BadRewardsMin")}else/^\s*$/.test(e)||isNaN(e)?a("continue_BadRewardsValue"):(e=parseFloat(c.val()),
d=c.data("min"),0>=e||e<d?a("continue_BadRewardsMin"):e>c.data().max&&a("continue_BadRewardsMax"))}}function O(c){var d=c.find('input[name\x3d"paymentMethod"]').val();"verifiedCreditCard"===d?a("continue_BlankSlate"):"verifiedDebitCard"===d&&(d=c.find("#vdcBanksSelect").val(),(""===d||"OtherBanks"===d||"1"===h("#save_citi_card").val()&&"CIT"===d)&&a("continue_BlankSlate"),c.find("option:selected").prop("disabled")&&a("continue_BankTemporarilyNotAvailable"))}function V(c){"cashOnDeliveryCash"===c.find('input[name\x3d"paymentMethod"]').val()&&
c.find(".phonenumberNotVerified").length&&a("continue_OTPforCOD")}function ba(c){if("netBanking"===c.find('input[name\x3d"paymentMethod"]').val()){var d=c.find("#net-banking-select-list").val();c=c.find("option:selected").prop("disabled");""===d&&a("continue_BlankSlate");c&&a("continue_BankTemporarilyNotAvailable")}}function fa(c){"morePaymentMethod"===c.find('input[name\x3d"paymentMethod"]').val()&&""===c.find("#more-payment-methods-select-list").val()&&a("continue_BlankSlate")}function aa(c){var d=
c.find('input[name\x3d"paymentMethod"]').val();if("StandaloneInstallment"===d||"StandaloneCreditCardInstallment"===d||"StandaloneReusableCreditLineInstallment"===d)c.find('input[name\x3d"gilShowContinueBlocker"]').val()&&("StandaloneCreditCardInstallment"===d?a("continue_GilCCContinueError"):"StandaloneReusableCreditLineInstallment"===d?a("continue_GilRCLContinueError"):a("continue_GilContinueError")),c.find('input[name\x3d"showIneligibleItemSubpage"]').val()&&("StandaloneCreditCardInstallment"===
d?a("continue_GilCCContinueErrorIneligibleItems"):"StandaloneReusableCreditLineInstallment"===d?a("continue_GilRCLContinueErrorIneligibleItems"):a("continue_GilContinueErrorIneligibleItems")),c.find('input[name\x3d"gilShowContinueBlockerIfPromotions"]').val()&&0<h("#existing-balance input[name\x3duseAvailableBalance]:checked").length&&("StandaloneCreditCardInstallment"===d?a("continue_GilCCContinueErrorPromotions"):"StandaloneReusableCreditLineInstallment"===d?a("continue_GilRCLContinueErrorPromotions"):
a("continue_GilContinueErrorPromotions"))}var X=[],ea=null,A=null,Y=function(a){n=a};n||(k.isMobileCX()?q.when("rewards-section-mobile").execute(Y):q.when("rewards-section-desktop").execute(Y));return{displayErrors:function(a,b){(ea=a)&&ea.hide().find(".error-message").hide().addClass("hidden");(A=b)&&A.find(".a-form-error").removeClass("a-form-error");if(l()){for(a=0;a<X.length;a++){b=X[a];if(b.target){var c=b.target.parent();c.hasClass("a-input-text-wrapper")&&!c.hasClass("a-form-error")?c.addClass("a-form-error"):
b.target.hasClass("a-form-error")||b.target.addClass("a-form-error")}b=b.identifier;(ea&&ea.length?ea.find("#"+b):h("#"+b)).show().removeClass("hidden")}ea&&ea.length&&ea.show()}},getHighestErrorId:function(){for(var a={priority:100},b=0;b<X.length;b++){var c=X[b],d;(d=c.identifier)?(d=ea&&ea.length?ea.find("#"+d):h("#"+d),d=parseInt(k.getAttributeData(d,"priority"),10),d=isNaN(d)?100:d):d=100;d<=a.priority&&(a={identifier:c.identifier,priority:d,isPincodeError:c.isPincodeError,target:c.target})}return a},
hasErrors:l,isValidCardCVV:z,isValidCardPincode:w,validateBankAccountNum:function(c,d){t(c)&&a("addBankAccount_NoAccountNumber",d)},validateBankAccountNumConfirm:function(c,d,e){c.val()!==d.val()&&a("addBankAccount_AccountNumberMismatch",e)},validateBankDriverLicense:function(c,d){t(c)&&a("addBankAccount_NoDLNumber",d)},validateBankDriverLicenseState:function(c,d){c.val()!==F&&""!==c.val()&&"0"!==c.val()||a("addBankAccount_NoDLState",d)},validateBankHolderName:function(c,d){t(c)&&a("addBankAccount_NoName",
d)},validateBankRoutingNum:function(c,d){9!==c.val().length&&a("addBankAccount_ShortRoutingNumber",d)},validateCreditCardCVV2:function(c,d,e){e="true"===c.attr("isaddresschallenge")?c.attr("issuer"):e&&e.charAt(0);"R"!==e&&(c=c.val(),z(c,"A"===e?4:3)||a("addCreditCard_BadSecurityCode",d))},validateCreditCardDate:function(c,d,e,f){B(c.val(),e.val())||(a("addCreditCard_BadExpiration",d),a("addCreditCard_BadExpiration",f))},validateCreditCardMobile:function(c,d){c=c.val();f.isUpdateMobileNumberEnabled()?
c&&c.replace(/[^0-9]/g,"").match(/^1[0-9]{10}$/)||a("addCreditCard_BadMobileNumber",d):c&&c.replace(/[^0-9]/g,"").match(/^1[34578]{1}[0-9]{9}$/)||a("addCreditCard_BadMobileNumber",d)},validateCreditCardPincode:function(c,d){(c=c.val())&&c.match(/^[a-zA-Z0-9]{4,8}$/)||a("addCreditCard_BadPincode",d)},validateCreditCardName:function(c,d){t(c)&&a("addCreditCard_NoName",d)},validateCreditCardNumber:function(c,d){var e=m(c.val());e&&10<e.length&&u(e)||a("addCreditCard_BadNumber",d);e=h("#creditCardIssuersBlocked").val();
c=c.data("issuer");e&&""!==e&&c&&""!==c&&-1<h.inArray(c,e.split(","))&&a("addCreditCard_IssuerUnsupported",d)},validateSBIMaestroCardNumberLength:function(c,d){19!==m(c.val()).length&&a("addCreditCard_SBIMaestro_BadNumberLength",d)},isAMEXCreditCard:function(a){a=m(a.val());return null!==a?0===a.indexOf("37")||0===a.indexOf("34"):!1},validateCreditCardTail:function(c,d){var f=m(c.val());f&&10<f.length&&u(f)?(c=(k.isMobileCX()&&e?c.parent().data():c.data()).tail+"",f.substr(f.length-c.length)!==c&&
a("addCreditCard_NotMatch",d)):a("addCreditCard_NotMatch",d)},validateCreditCardType:function(c,d){c.is(":visible")&&((c=c.val())&&c.match(/^[A-Z][0-9]*$/)||a("addCreditCard_NoType",d))},validateRegistrationResult:function(c){c.cardStatus?1===c.checkStatusCount&&a("addCreditCard_RegisterFailed"):0<c.errors.length&&a("addCreditCard_RegisterFailed")},validateDirectDebitAccountName:function(c,d){t(c)&&a("addDirectDebit_NoAccountOwnerName",d)},validateDirectDebitAccountNum:function(c,d){t(c)&&a("addDirectDebit_NoAccountNumber",
d)},validateDirectDebitRoutingNum:function(c,d){t(c)&&a("addDirectDebit_NoRoutingNumber",d)},validateInvoiceFirstName:function(c,d){t(c)&&a("addInvoiceAccount_NoFirstName",d)},validateInvoiceLastName:function(c,d){t(c)&&a("addInvoiceAccount_NoLastName",d)},validateLocName:function(c,d){t(c)&&a("addLoc_NoName",d)},validateLocNumber:function(c,d){t(c)&&a("addLoc_BadNumber",d)},validateNewGiftPromotion:function(c,d){t(c)&&a("addGiftCardOrPromo_NoCode",d)},validatePayment:function(d){if(k.isMobileCX())P(d),
n&&c.wrap(function(){n.validatePaymentRewardsInRewardsSection(a)},"shopwithpointsmobile");else if(p(),d&&d.length){for(var e=0;e<d.length;e++){var f=h(d[e]);"true"===k.getAttributeData(f,"isaddresschallenge")&&a("continue_AddressChallenge");"true"===k.getAttributeData(f,"isverifiedfail")&&a("continue_VerifiedFail");"true"===k.getAttributeData(f,"iscupcardexpired")&&a("continue_CUPExpired");G(f);E(f);I(f);W(f);D(f);N(f);U(f);x(f);L(f);O(f);ba(f);fa(f);aa(f);V(f);da(f)}n&&c.wrap(function(){n.validatePaymentRewardsInRewardsSection(a)},
"shopwithpoints");y(d)}else a("continue_BlankSlate")},validateGetCreditCardTypeResult:function(c){if(c.errors&&0<c.errors.length)for(var d=0;d<c.errors.length;d++)a(c.errors[d])},validateEMIMenuForContinueButton:function(c){var d=c.find("#emiPaymentMethodsSelectList").find("option:selected").val();if("CreditCard"===d||"SelectOption"===d)a("continue_BlankSlate");else if(d=d.split("."),1<d.length){var e=d[0];if("emiCreditCard"===e||"netbankingEMI"===e)c=c.find("."+d[1]),c=c.find(".emiMenuTenuresDropDown"),
c.length&&!c.find("option:selected").val()&&a("continue_BlankSlate")}},apxValidatePayment:function(a,b){var c=d.get("payselect");c&&c.validatePayments(this,b,a)},addError:a,errors:X,validatePCICVVBlock:G}}var h=a.$,e=p.P&&p.P.AUI_BUILD_DATE,n=F;return{create:function(){return new l}}});"use strict";q.when("A","ajax-utility","pay-common-util","pay-validator").register("pay-credit-card",function(a,k,g,c){function d(a,c,b,d){a&&a.length&&(c=b+"-"+c,(b=g.prop(c))&&(a=a.find(d).val(b))&&a.length&&(g.isMobileCX()?
a.closest(".card-cvv-field").hide().data("isHidden",1):a.closest(".a-column").hide(),g.prop(c,F)))}var f=a.$,l={cc:!1,vcc:!1,vdc:!1},h=p.P&&p.P.AUI_BUILD_DATE;return{confirmCreditCard:function(a,c,b){a.currentPaymentInstrumentID=a.paymentmethodid;a.recommendedPaymentMethodId=a.paymentmethodid;if(a.newMonth&&a.newYear)a.month=a.newMonth,a.year=a.newYear;else if(a.newExpDate){var d=a.newExpDate.split("-");a.year=parseInt(d[0],10);a.month=parseInt(d[1],10)}else a.expmonth&&a.expyear&&(a.month=a.expmonth,
a.year=a.expyear);(d="existingCvvNum"in a?a.addCreditCardVerificationNumber=a.existingCvvNum:a.addCreditCardVerificationNumber)&&g.prop("cvv-"+a.paymentmethodid,d);(d="existingPincodeNum"in a?a.addCreditCardPincode=a.existingPincodeNum:a.addCreditCardPincode)&&g.prop("pincode-"+a.paymentmethodid,d);g.makeAjaxCall(b,a,{successHandler:c,errorHandler:function(b,c){a.handler="confirm-credit-card";g.handleAjaxError(b,c,"/gp/buy/payselect/handlers/submit.html",a)}},{useSif:!0})},handleCreditCardType:function(a,
d){var b=a.$target,f=a.data.type,h=c.create();a.$currentTarget.data("issuer","");h.validateCreditCardNumber(b,b);h.hasErrors()||(l[f]=!0,g.makeAjaxCall(a.data.url,{addCreditCardNumber:b.val(),returnjson:1},{completeHandler:function(){l[f]=!1},successHandler:function(b){b=k.jsonify(b);d(b,f);a.$currentTarget.data("issuer",b.issuer)}},{useSif:!0},{suppressSpinner:!0}))},isWaitingForType:function(a){return l[a]},runConfirmCardValidator:function(a,d){var b=a.find("#existingCvvNum"),b=b.length?b:a.find("#addCreditCardVerificationNumber"),
f=a.find("#addCreditCardNumber"),h=a.find("#newMonth"),g=a.find("#newYear"),l=c.create();l.validateCreditCardTail(f,f);h.length&&g.length&&l.validateCreditCardDate(h,h.closest(".card-date").find(".a-button"),g,g.closest(".card-date").find(".a-button"));b.length&&(f=(f=a.find("#issuer"))&&f.val(),l.validateCreditCardCVV2(b,b,f));l.displayErrors(d,a);return l.hasErrors()},setDateSelectorStatus:function(a,c){var b=c.find(".card-date").find("select");b&&b.length&&q.when("a-dropdown").execute(function(c){b.each(function(){var b=
f(this).attr("id");c.updateSelect(b,{status:"21"===a.brand&&"G"===a.issuer?"disabled":"enabled"})})})},setNewCardCVVInputStatus:function(a){(g.prop("cvv-newcard")||g.prop("pincode-newcard"))&&a.each(function(){var a=f(this);if("1"===(h?a.data("isnewcard")+"":a.attr("isnewcard")))return d(a,"newcard","cvv","#existingCvvNum"),d(a,"newcard","pincode","#existingPincodeNum"),!1})},setCardPasswordInputStatus:d}});"use strict";q.when("A","ajax-utility","pay-common-util","pay-validator","page-transition-controller",
"page-conductor","pay-credit-card").register("pay-credit-card-reregistration",function(a,k,g,c,d,f,l){function h(a,d){var e=c.create(),f=n("#cupMobileNumber-"+a),h=n("#cupSecurityCode-"+a),g=n("#reRegisterCCErrors-"+a);a=n("#reRegisterCCInputs-"+a);e.validateCreditCardCVV2(h,h,d);e.validateCreditCardMobile(f,f);e.displayErrors(g,a);return e.hasErrors()}function e(a,c,d){f.ajaxUpdatePage(a,c,d)}var n=a.$;return{actionReregisterCardInBox:function(a){a.$event.preventDefault();d.show();var c=a.data.type,
f=n("#cupMobileNumber-"+a.data.paymentMethodID).val(),u=n("#cupSecurityCode-"+a.data.paymentMethodID).val();h(a.data.paymentMethodID,c)?d.hide():(c={isReregistering:a.data.isReregistering,currentPaymentInstrumentID:a.data.paymentMethodID,name:a.data.holderName,year:a.data.expiredYear,month:a.data.expiredMonth,addCreditCardMobileNumber:f,addCreditCardVerificationNumber:u},f={useSif:g.isMobileCX()?!0:!1,success:function(a,c,b){a=k.jsonify(a);c=n("#reRegisterCCErrors-"+a.paymentInstrumentId);l.waitForCreditCardStatus(a,
e,c)}},a.$event.preventDefault(),g.makeAjaxCall(a.data.url,c,null,f))}}});"use strict";q.when("A","client-side-metrics","ajax-utility","pay-common-util","pay-validator","existing-payments","page-conductor","checkout-modal-popover","page-transition-controller","pay-credit-card","pay-gil","new-verified-debit-card","emi-helper").register("new-payments",function(a,k,g,c,d,f,l,h,e,n,b,m,v){function u(a){a.$event.preventDefault();var b=a.data.type;if(n.isWaitingForType(b))e.show(),setTimeout(function(){u(a)},
50);else{var d;d="vdc"===b?S.newVDC:"emi"===b?S.newEMI:S.newVCC;if(ka(d,b))e.hide();else{e.show();var f=c.getInputValues(d),h="vdc"===b?"_VDC":"_VCC";d=f["addCreditCardVerificationNumber"+h];var g=f["addCreditCardPincode"+h],b={addCreditCardNumber:f["addCreditCardNumber"+h],addCreditCardVerificationNumber:d,addCreditCardPincode:g,handler:f["handler"+h],month:f["month"+h],name:f["name"+h],newPaymentType:b,year:f["year"+h],cctype:f["cctype"+h],isSBIInternationalMaestroSelected:f["isSBIInternationalMaestroSelected"+
h],isCardSavedFromEMIMenu:f["isCardSavedFromEMIMenu"+h]};c.prop("cvv-newcard",d);g&&c.prop("pincode-newcard",g);c.makeAjaxCall(a.data.url,b,{successHandler:function(a,c,b){I(a,c,b);n.setNewCardCVVInputStatus(S.paymentRows)}},{useSif:!0})}}}function z(a){a.$event.preventDefault();var b=a.data.type;if(n.isWaitingForType(b))e.show(),setTimeout(function(){z(a)},50);else{var d=S.newCCFormContent;if(ka(d,b))e.hide();else{e.show();b=c.getInputValues(d);b.handler=b.handler_addCCInBox;var d=a.data.url,f={};
R("#cupSecurityCode").is(":visible")&&R("#cupMobileNumber").is(":visible")?(d="/gp/buy/payselect/handlers/add-credit-card.html",f={successHandler:function(a){a=g.jsonify(a);W(a)}}):f={successHandler:I};c.makeAjaxCall(d,b,f,{useSif:!0})}}}function w(a){a.$event.preventDefault();var b=R("#new-giftcard-promotion"),b=c.getInputValues(b);R("input[name\x3disUnifiedActionsDesignEnabled]").length&&B(a)||(b.handler=b.handler_addGCInBox,a=a.data.url,e.show(),c.makeAjaxCall(a,b,{successHandler:function(a,b,
d){l.ajaxUpdatePage(a,b,d);ta||c.scrollTopTo(R("#existing-balance"))}},{useSif:!0}))}function B(a){a=a.$declarativeParent;var b=R("#gcpromoinput"),c=d.create();c.validateNewGiftPromotion(b,b);c.displayErrors(S.newGCErrors,a);return c.hasErrors()}function r(a){var b=R(a.currentTarget).parents("div.new-payment-line").find(".card-date select");if(b&&b.length){var c=R(a.currentTarget).val();q.when("a-dropdown").execute(function(a){b.each(function(){var b=R(this).attr("id");a.updateSelect(b,{status:"G21"===
c?"disabled":"enabled"})})})}}function t(a){var b=S.newVDC.find(".vdc-form-fields"),c=S.newVDC.find("#vdc-logo-prompt"),d=S.newVDC.find(".top-cell");a?b.show():b.hide();a?c.show():c.hide();a?d.addClass():d.removeClass()}function p(a){var b=R(a.currentTarget).val(),c=S.newVDC.find("#suppressedVerifiedDebitCard").hide(),d=S.newVDC.find(".vdc-selected-bank-prompt").hide();t(!1);var e="1"===S.newVDC.find("#isRupayAsSavedCardEnabled").val()&&"URP"===b;"OtherBanks"===b||"1"===R("#save_citi_card").val()&&
"CIT"===b||e?(t(!0),R.isEmptyObject(m)||m.showExpiryDateAndCvv()):"SMP"!==b||R.isEmptyObject(m)?""!==b&&(b=R(a.currentTarget).find("option:selected").prop("disabled"),a=R(a.currentTarget).find("option:selected").text(),b?c.show().find(".suppressed-card-text").html(a):d.show().find(".bank-name-text").html(a)):(t(!0),m.hideExpiryDateAndCvv())}function y(a,b){if(!R.isEmptyObject(v)&&a)return a(b)}function G(a){y(v.removeEMIMenuSelectionAttributes);S.newEMI.find(".emi-group").hide();a=R(a.currentTarget).find("option:selected").val();
S.newEMI.find("#emiMenuErrors_VCC").length&&S.newEMI.find("#emiMenuErrors_VCC").hide();if(a=y(v.showPaymentOptionBlock,a))y(v.addEMIMenuSelectionAttributes),a.show()}function E(a){n.handleCreditCardType(a,ga)}function I(a,b,d){l.ajaxUpdatePage(a,b,d);ta||c.scrollTopTo(f.getSelectedPayment())}function da(a){a.$event.preventDefault();var b=a.data.type;n.isWaitingForType(b)?(e.show(),setTimeout(function(){da(a)},50)):ka(a.$declarativeParent,b)?e.hide():(ca&&ca.hide(),Q&&Q.hide(),e.show(),R("#cupSecurityCode").is(":visible")&&
R("#cupMobileNumber").is(":visible")?(b=a.$declarativeParent.serializeArray(),b=c.processSubmissionParameters(b),c.makeAjaxCall("/gp/buy/payselect/handlers/add-credit-card.html",b,{successHandler:function(a){a=g.jsonify(a);W(a)}},{useSif:!0})):c.handleForm(a,{successHandler:I},{useSif:!0}))}function W(a){var b={};b.paymentInstrumentId=a.paymentInstrumentId;a.checkStatusCount&&(b.checkStatusCount=a.checkStatusCount);var f={successHandler:function(a){a=g.jsonify(a);var b=d.create();"VERIFIED"===a.cardStatus?
c.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{newPaymentMethodId:a.paymentInstrumentId},{successHandler:I}):"PENDING"===a.cardStatus?(a.checkStatusCount?(a.checkStatusCount=parseInt(a.checkStatusCount,10),isNaN(a.checkStatusCount)&&(a.checkStatusCount=1)):a.checkStatusCount=3,b.validateRegistrationResult(a),1===a.checkStatusCount?(e.hide(),b.displayErrors(S.newCCErrors)):(--a.checkStatusCount,W(a))):(b.validateRegistrationResult(a),e.hide(),b.displayErrors(S.newCCErrors))}};setTimeout(function(){c.makeAjaxCall("/gp/buy/payselect/handlers/check-credit-card-status.html",
b,f)},2500)}function P(a){a.$event.preventDefault();var b=a.$declarativeParent,f=b.find("#loc-name"),h=b.find("#loc-number"),g=d.create();g.validateLocName(f,f);g.validateLocNumber(h,h);g.displayErrors(b.find("#error-box-new-loc"),b);g.hasErrors()||(ua&&ua.hide(),e.show(),c.handleForm(a,{successHandler:I}))}function D(a){a.$event.preventDefault();var b=a.$declarativeParent,f=b.find("#gcpromoinput");b.find("#gcpromosuccessblock").hide();var h=d.create();h.validateNewGiftPromotion(f,f);h.displayErrors(S.newGCErrors,
b);h.hasErrors()||(e.show(),c.handleForm(a,{successHandler:function(a,b,d){l.ajaxUpdatePage(a,b,d);ta?S.newGCErrors.is(":visible")&&R("#gc-link-expander").trigger("click"):c.scrollTopTo(R("#existing-balance"))}}))}function F(a){a.$event.preventDefault();R("#ccAddCard").trigger("submit")}function U(a){a.$event.preventDefault();R("#bank-address-popover-submit").trigger("submit")}function x(a){a.$event.preventDefault();R("#direct-debit-popover-submit").trigger("submit")}function L(a){a.$event.preventDefault();
R("#new-loc-popover-submit").trigger("submit")}function O(a){a.$event.preventDefault();R("#new-invoice-popover-submit").trigger("submit")}function V(a){a.$event.preventDefault();R("#brdcAddCard").trigger("submit")}function ba(a){a.$event.preventDefault();var b=a.$declarativeParent,f=d.create(),h=b.find("#bank-name"),g=b.find("#bank-routing-number"),l=b.find("#bank-account-number"),n=b.find("#bank-account-number-confirm"),m=b.find("#bank-dl"),k=b.find("#bank-dl-state");f.validateBankHolderName(h,h);
f.validateBankRoutingNum(g,g);f.validateBankAccountNum(l,l);f.validateBankAccountNumConfirm(l,n,n);f.validateBankDriverLicense(m,m);f.validateBankDriverLicenseState(k,k.parents("div.a-button-dropdown"));f.displayErrors(b.find("#new-bank-error-box"),b);f.hasErrors()||(na&&na.hide(),e.show(),c.handleForm(a,{successHandler:I}))}function fa(a){a.$event.preventDefault();var b=a.$declarativeParent,f=d.create(),h=b.find("#debit-bank-routing-number"),g=b.find("#debit-account-number"),l=b.find("#debit-account-name");
f.validateDirectDebitRoutingNum(h,h);f.validateDirectDebitAccountNum(g,g);f.validateDirectDebitAccountName(l,l);f.displayErrors(b.find("#new-direct-debit-error"),b);f.hasErrors()||(qa&&qa.hide(),e.show(),c.handleForm(a,{successHandler:I}))}function aa(a){a.$event.preventDefault();var b=a.$declarativeParent,f=d.create(),h=b.find("#invoice-first-name"),g=b.find("#invoice-last-name");f.validateInvoiceFirstName(h,h);f.validateInvoiceLastName(g,g);f.displayErrors(b.find("#new-invoice-error-box"),b);f.hasErrors()||
(K&&K.hide(),e.show(),c.handleForm(a,{successHandler:I}))}function X(a){a=R("#order-summary-total");var b=R("#order-summary-container");a.prev().addClass("a-first");b.addClass("a-box-group");a.show();c.isTouchCX()&&b.parent().find(".bottom-order-summary").show();S.newCCFormContent.is(":visible")||R("#wrapper-new-cc").find("a.a-link-expander").trigger("click");R("#ecard-help-link").show()}function ea(a){var b="Unknown";c.isDesktopCX()?b="Desktop":c.isMobileCX()?b="Mobile":c.isTouchCX()&&(b="Tablet");
k.increaseCount("PayPage-ClientSide-AddCupClick-"+b,1);b=R("#cupForm");if(0<b.length)b.submit();else{var d=R("\x3cform\x3e\x3c/form\x3e");d.attr({target:"_blank",method:"POST",action:a.data.url});R("#cup-dc").find("input").each(function(){var a=R(this);"hidden"===a.attr("type")&&a.clone().appendTo(d)});R("body").append(d);d.submit();d.remove()}}function A(b){var d=b.$target.closest(".a-popover"),f=d.data("a-popover-id");h.hideById(f);d.hide();R("#a-popover-modal").hide();e.show();c.makeAjaxCall(b.data.url,
void 0,{successHandler:function(b){R("#existing-payment-methods").replaceWith(R(b).find("#existing-payment-methods"));a.trigger("checkout:reload:payselect");e.hide()}})}function Y(a){a.$event.preventDefault();a=a.data;e.show();b.submitNewGilPayment(a.subtype)}function Z(){if(!c.isMobileCX()){0===R("#form-add-credit-card").length&&(R("#ccAddCard").parents("div.cc-submit").hide(),R("#ccAddCardWithButton").parents("div.cc-submit").show());R("html").hasClass("a-ie6")&&(R("#cup-mbdc").show(),R(".mbdc-link").attr("data-action",
"redirect-cup"));S=c.getElements(Ba);S.bankNumberConfirm.show();S.newVDC.find(".payment-row").data("hasstatus")||S.newVDC.find(".vdc-form-fields").hide();S.newVDC.find("#suppressedVerifiedDebitCard").hide();S.newCCFormContent.find(".cup-card-field").hide();S.newPayments.find("#cupInfoMessage").hide();S.newPayments.find("#use-ecard-link").show();S.newPayments.find(".mbdc-link").show();S.newPayments.find(".mbdc-button").hide();ta=!1;S.newPayments.each(function(){var a=R(this),b=a.data();b&&0===b.hasstatus?
(a.find("a.a-link-expander i.js-hide").remove(),a.find("a.a-link-section-expander i.js-hide").remove()):b&&1===b.hasstatus&&!ta&&(c.scrollTopTo(a),ta=!0)});var b=S.newVCC.find("#requireCVVOrPincode");b&&b.length&&b.val("1");ra&&(a.declarative("new-cc",["submit"],da),a.declarative("new-brdc",["submit"],da),a.declarative("new-loc",["submit"],P),a.declarative("show-card-image",["change"],E),a.declarative("new-giftcard-promotion",["submit"],D),a.declarative("new-verified-card",["click"],u),a.declarative("new-cc-in-dashboard",
["click"],z),a.declarative("new-gc-in-dashboard",["click"],w),a.declarative("add-bank-account",["submit"],ba),a.declarative("add-direct-debit",["submit"],fa),a.declarative("add-invoice",["submit"],aa),a.declarative("show-order-summary",["click"],X),a.declarative("redirect-cup",["click"],ea),a.declarative("cup-popover-close",["click"],A),a.declarative("add-new-debit-and-cc-popover-submit",["click"],F),a.declarative("add-bank-account-popover-submit",["click"],U),a.declarative("add-loc-account-popover-submit",
["click"],L),a.declarative("new-gil-payment",["click"],Y),a.declarative("add-direct-debit-popover-submit",["click"],x),a.declarative("add-invoice-account-popover-submit",["click"],O),a.declarative("add-new-br-debit-card-popover-submit",["click"],V),ra=!1);S.cardTypeDropdown.unbind("change",r).bind("change",r);S.vdcBankDropdown.unbind("change",p).bind("change",p);S.emiCardsDropdown.unbind("change",G).bind("change",G);R("div.pay-desktop a.a-link-expander").unbind("keypress");R("div.pay-desktop .a-declarative, div.pay-desktop .a-button").filter("[data-action\x3da-checkout-modal-popover]").unbind("keypress");
a.on("a:popover:show:add-new-debit-cc-modal",function(a){Q=a.popover});a.on("a:popover:show:add-new-bank-account-modal",function(a){na=a.popover});a.on("a:popover:show:add-new-direct-debit-modal",function(a){qa=a.popover});a.on("a:popover:show:add-new-loc-account-modal",function(a){ua=a.popover});a.on("a:popover:show:add-invoice-account-modal",function(a){K=a.popover});a.on("a:popover:show:add-br-debit-card-modal",function(a){ca=a.popover})}}function ka(a,b){var c,f,e,h,g,l,n,m,k,r,t;"vcc"===b?(c=
"#vccCVVNum",b="#newVCCErrors",f="#vccMonth",e="#vccName",h="#newVerifiedCreditCardNumber",g="#vccType",l="#vccYear",n="#vccPincode",t=r=k=m=void 0):"vdc"===b?(c="#vdcCVVNum",b="#newVDCErrors",f="#vdcMonth",e="#vdcName",h="#newVerifiedDebitCardNumber",g="#vdcType",l="#vdcYear",m="#isSBIMaestroAsSavedCardEnabled",k="#isSBIInternationalMaestroSelected",t=r=n=void 0):"emi"===b?(c="#vccCVVNum",b="#newEMIErrors",f="#vccMonth",e="#vccName",h="#newVerifiedCreditCardNumber",g="#vccType",l="#vccYear",n="#vccPincode",
t=r=k=m=void 0):"brdc"===b?(b="#newBRDCErrors",f="#brdcMonth",e="#brdcName",h="#addCreditCardNumber_BRDC",l="#brdcYear",t=r=k=m=n=g=c=void 0):(r="#cupSecurityCode",t="#cupMobileNumber",c="#ccCVVNum",b="#newCCErrors",f="#ccMonth",e="#ccName",h="#addCreditCardNumber",g="#ccType",l="#ccYear",k=m=n=void 0);c=a.find(c);r&&0===c.length&&a.find(r).is(":visible")&&(c=a.find(r));m="1"===a.find(m).val()&&"1"===a.find(k).val();e=a.find(e);h=a.find(h);t=t?a.find(t):null;f=a.find(f);g=a.find(g);l=a.find(l);var u;
n&&a.find(n).is(":visible")&&(u=a.find(n));n=g.val();k=d.create();k.validateCreditCardName(e,e);k.validateCreditCardNumber(h,h);m&&k.validateSBIMaestroCardNumberLength(h,h);m=f.parent();m=m.hasClass("a-button")?m:m.find(".a-button");e=l.parent();e=e.hasClass("a-button")?e:e.find(".a-button");"G21"!==n&&k.validateCreditCardDate(f,m,l,e);k.validateCreditCardType(g,g.closest(".card-type-field").find(".a-button"));l=n?n.substr(0,1):"";c.length&&"R"!==l&&c.is(":visible")&&k.validateCreditCardCVV2(c,c,
n);t&&t.length&&t.is(":visible")&&k.validateCreditCardMobile(t,t);u&&u.length&&k.validateCreditCardPincode(u,u);k.displayErrors(R(b),a);return k.hasErrors()}function ga(a,b){if(a){"1"===a.isDebitCard?S.newCCWarnings.show().removeClass("hidden"):S.newCCWarnings.hide().addClass("hidden");if("1"===a.hasErrors){var e=d.create();e.validateGetCreditCardTypeResult(a);if(e.hasErrors()){e.displayErrors(S.newCCErrors);return}}b="vcc"===b?S.newVCC:"vdc"===b?S.newVDC:"emi"===b?S.newEMI:"brdc"===b?S.newBRDCFormContent:
S.newCCFormContent;var e=a.specificFields,f=b.find(".cup-card-field");0!==f.length&&(e&&1===e.securityCode&&1===e.mobileNumber?(c.isTouchCX()&&b.find("#addCreditCardNumber").closest(".a-input-text-wrapper").removeClass("last-child"),f.show()):f.hide());e=a.specificFields;f=b.find(".amex-field");if(0!==f.length){var h=b.find(".cvv-field");0!==h.length&&(e&&1===e.pincode?(h.hide(),f.show()):e&&0===e.pincode&&0===e.securityCode?(f.hide(),h.hide()):(f.hide(),h.show()))}e=b.find(".card-images");e.find("img").hide();
h=a.installmentProgram;f=!1;h&&(h=e.find('img[data-installmentprogram\x3d"'+h+'"]'),0!==h.length&&(h.show(),f=!0));f||(a.issuerdisplayimage?e.find("img[data-issuer\x3dATM]").attr("src",a.issuerdisplayimage).show():(f=a.issuer+a.brand,e.find("img[data-issuer\x3d"+f+"]").show(),b.find(Ba.cardTypeDropdown).val(f).trigger("change")));n.setDateSelectorStatus(a,b)}}var R=a.$,ra=!0,ta=!1,S={},Ba={bankNumberConfirm:"#wrapper-bank-account-number-confirm",btnAddCard:"#ccAddCard",btnAddLoc:"#button-new-loc",
btnAddGC:"#button-add-gcpromo",btnAddBank:"#button-add-bank-account",btnAddDirectDebit:"#button-add-direct-debit",btnAddInvoice:"#button-add-invoice",cardImages:"#newCreditCardImages",cardTypeDropdown:".card-type-dropdown select",newCCFormContent:"#new-cc",newBRDCFormContent:"#new-brdc",newGCErrors:"#gcpromoerrorblock",newGCFormContent:"#gc_entry",newPayments:"div.new-payment-line",newVCC:"#new-verified-credit-cards-table",newVDC:"#new-verified-debit-cards-table",newEMI:"#newEmiCard",paymentRows:"#existing-payment-methods .payment-row",
vdcBankDropdown:"#vdcBanksSelect",emiCardsDropdown:"#emiPaymentMethodsSelectList",cardList:"#existing-credit-cards-box",newCCErrors:"#newCCErrors",newCCWarnings:"#newCCWarnings"},Q,na,ua,qa,K,ca;a.on("checkout:reload:payselect",Z);a.on("checkout:reload:spp-payment",Z);return{actionShowOrderSummary:X,handleFormHandlerScrollToSelected:I}});q.when("A","page-detector","client-side-metrics","ready").execute(function(a,k,g){function c(a,c,h,e){a=d(c).is(":checked");p.P&&p.P.AUI_BUILD_DATE?a?d(h).val(d(h).parent().data("account-name")):
d(h).val(""):(g.increaseCount("removeauijs8"),a?(d(e).removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active"),d(h).val(d(h).data("account-name"))):(d(e).removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),d(h).val("")));h="undefined"!==typeof p.ue&&"undefined"!==typeof p.ue.count;e=k.isMobilePayment()?"mobile":"tablet";a=d("#showNameOnCardCheckbox").is(":checked");h&&p.ue.count(e+"NameOnCardCheckBox"+(a?"Checked":"Unchecked"),1)}var d=
a.$;a.declarative("show-card-name",["click"],function(a){c(a,"#showNameOnCardCheckbox","#ccName","#showNameOnCardIcon")});a.declarative("show-br-debit-card-name",["click"],function(a){c(a,"#showNameOnCardCheckbox_BRDC","#brdcName","#showNameOnCardIcon_BRDC")})});"use strict";q.when("A").register("pay-rewards-currency",function(a){var k=function(a,c){c=Math.pow(10,c);a=a.replace(/[^0-9]/g,"");return parseFloat(a)/c},g={CA:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2},DE:{groupingSeparator:".",
decimalSeparator:",",decimalPlace:2},GB:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2},JP:{groupingSeparator:",",decimalSeparator:".",decimalPlace:0},US:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2}},c=function(a,c,d,e,g){this.groupingSeparator=a;this.decimalSeparator=c;this.currencyDecimalPlace=d;this.pointsDecimalPlace=e;this.ratio=g;this.getCurrencyAmount=function(a){return k(a,this.currencyDecimalPlace)};this.getPointsAmount=function(a){return this.getCurrencyAmount(a)/
this.ratio};this.format=function(a,c){var d=parseInt(a,10);a=parseFloat(a-d).toFixed(c);a=this.decimalSeparator+a.slice(2);d=d.toString();c=3<d.length?d.length%3:0;d=(0<c?d.substr(0,c)+this.groupingSeparator:"")+d.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+this.groupingSeparator);return a===F||a===this.decimalSeparator?d:d+a};this.formatCurrency=function(a){return this.format(a,d)};this.formatPoints=function(a){return this.format(a,e)}},d=function(c,d,h,e){this.maxAmount=e;this.rewardsFormatter=h;this.currencyElement=
c;this.pointElement=d;var g=this;this.isControlKey=function(a){switch(a.which){case 8:case 46:return!0;case 86:case 88:return a.ctrlKey;default:return!1}};this.isNavigationKey=function(a){switch(a.which){case 9:case 16:case 17:case 35:case 36:case 37:case 39:return!0;case 65:case 67:return a.ctrlKey;default:return!1}};this.isValidKey=function(a){var c=a.which;return 48<=c&&57>=c||96<=c&&105>=c||8===a.which||46===a.which};this.getCaret=function(){var a=g.currencyElement,c=a.get(0),d=0,e=0;if("number"===
typeof c.selectionStart&&"number"===typeof c.selectionEnd)d=c.selectionStart,e=c.selectionEnd;else{var f=document.selection.createRange();if(f!==F&&f.parentElement()===c){var a=a.val(),e=a.length,h=c.createTextRange();h.moveToBookmark(f.getBookmark());c=c.createTextRange();c.collapse(!1);-1<h.compareEndPoints("StartToEnd",c)?d=e:(d=-h.moveStart("character",-e),d+=a.slice(0,d).length-1,-1<h.compareEndPoints("EndToEnd",c)||(e=-h.moveEnd("character",-e),e+=a.slice(0,e).length-1))}}return{start:d,end:e}};
this.setCaret=function(a){var c=g.currencyElement.get(0);c.setSelectionRange?c.setSelectionRange(a,a):c.createTextRange&&(c=c.createTextRange(),c.collapse(!0),c.moveStart("character",a),c.moveEnd("character",a),c.select())};this.bind=function(){g.currencyElement.unbind();g.currencyElement.bind("keydown",function(a){g.isNavigationKey(a)||g.isControlKey(a)||g.isValidKey(a)||a.preventDefault()});g.currencyElement.bind("keyup",function(b){if(!g.isNavigationKey(b)){b=g.getCaret();var c=g.currencyElement.val().length;
g.format();var d=g.currencyElement.val().length;b.start===b.end&&g.setCaret(Math.min(b.start+(d-c),d));a.trigger("inlineFormatter:formattingCompleted",g)}})};this.unbind=function(){g.currencyElement.unbind("keydown keyup")};this.format=function(a){a=g.currencyElement.val();a=g.rewardsFormatter.getCurrencyAmount(a);isNaN(a)&&(a=0);a>g.maxAmount&&(a=g.maxAmount);a=g.rewardsFormatter.formatCurrency(a);g.currencyElement.val(a)}};a.on("inlineFormatter:formattingCompleted",function(a){var c=a.pointElement,
d=a.currencyElement.val(),d=a.rewardsFormatter.getPointsAmount(d);a=a.rewardsFormatter.formatPoints(Math.round(d));c.html(a)});return{getCurrencyFormatByCountryCode:function(a){(a=g[a])||(a=g["default"]);return a},getAmount:k,initializeInlineFormatting:function(f,g,h){var e=f.maxAmount;h=new c(h.groupingSeparator,h.decimalSeparator,h.decimalPlace,g.decimalPlace,g.ratio);f=new d(f.$element,g.$element,h,e);f.bind();f.format(0);a.trigger("inlineFormatter:formattingCompleted",f)}}});"use strict";q.when("A",
"pay-common-util","pay-validator","page-conductor","mobile-carrier-billing-util","weblab-helper").register("jppoints",function(a,k,g,c,d,f){function l(){!k.isMobileCX()&&p("#jppoints").length&&(y=k.getElements(G),m())}function h(){var a=y.paymentRows.find('input[type\x3d"radio"][name\x3d"paymentMethod"]');a.closest("div.payment-selected").removeClass("payment-selected");a.attr("checked",!1);k.isTouchCX()&&e(a,"radio")}function e(a,b){a.siblings("i").removeClass("a-icon-touch-"+b+"-active").addClass("a-icon-touch-"+
b+"-inactive")}function n(a,b){a.is(":disabled")||a.siblings("i").removeClass("a-icon-touch-"+b+"-inactive").addClass("a-icon-touch-"+b+"-active")}function b(){return p('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]').is(":checked")}function m(){if(y.jppoints&&y.jppoints.length){b()&&v();y.jppoints.show();var a=y.jppoints.find("#redeemPoints");k.isTouchCX()?a.parents("label").bind("click",w):a.bind("click",w);y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("click",
function(){var a=y.jppoints.find("#jpPointsCustom");a.attr("checked",!0);var b=y.jppoints.find("#redeemPoints");b.attr("checked",!0);k.isTouchCX()&&(n(a,"radio"),e(y.jppoints.find("#jpPointsMax"),"radio"),n(b,"checkbox"))});y.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]').bind("click",u);y.jppoints.find("#jpPointsCustom").bind("click",function(){y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').focus()});y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("keyup",
t)}}function v(){var a=y.jppoints.find("#redeemPoints"),b=y.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),d=y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),f=y.jppoints.find("#redeemableAmount"),h=y.jppoints.find("#redeemableValue");a.attr("checked",!1);a.attr("disabled",!0);b.attr("checked",!1);b.attr("disabled",!0);y.jppoints.find("#jpPointsError").hide();d.val("");d.removeClass("a-form-error");d.attr("disabled",!0);h.text(y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val());
f.text(y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val());c.isSPP()&&(y.jppoints.find("label").addClass("disabled-color"),y.jppoints.removeClass("payment-selected"));k.isTouchCX()&&(e(a,"checkbox"),e(b,"radio"),a.siblings("i").addClass("a-button-disabled"),b.siblings("i").addClass("a-button-disabled"))}function u(b){var c=b.currentTarget,d=y.jppoints.find("#redeemPoints");d.attr("checked",!0);if(k.isTouchCX()){n(p("#"+c.id),"radio");var f;f="jpPointsMax"===c.id?y.jppoints.find("#jpPointsCustom"):
y.jppoints.find("#jpPointsMax");e(f,"radio");n(d,"checkbox")}"true"===c.value&&(y.jppoints.find("#jpPointsError").hide(),c=y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),c.removeClass("a-form-error"),c.val(""),d=y.jppoints.find("#redeemableAmount"),f=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10),c=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),d=parseInt(d.text(),10)*f,p('input[name\x3d"useAvailableBalance"]').is(":checked")&&
(f=y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),c-=parseInt(f.val(),10)),d>=c&&h());q.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",p(b.currentTarget))})}function z(a){var b=y.jppoints.find("#redeemableAmount"),c=y.jppoints.find("#redeemableValue"),d=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),f;a.is(":checked")?(a=y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val(),
f=y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val(),d-=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),10)):(a=y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),f=y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val());var g=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10)*a;b.text(a);c.text(f);0>=parseInt(a,10)?
(b=y.jppoints.find("#redeemPoints"),b.attr("checked",!1),c=y.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),c.attr("checked",!1),k.isTouchCX()&&(e(b,"checkbox"),e(c,"radio"))):y.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"][value\x3d"true"]').is(":checked")?g>=d&&h():t()}function w(){var d=y.jppoints.find("#redeemPoints");if(!d.is(":disabled")){d=d.is(":checked");if(k.isTouchCX())d?(e(y.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),
r()):(n(y.jppoints.find("#jpPointsMax"),"radio"),e(y.jppoints.find("#jpPointsCustom"),"radio"),B());else if(d)B(),c.isSPP()&&y.jppoints.addClass("payment-selected");else if(r(),c.isSPP()){y.jppoints.removeClass("payment-selected");if(b())return;k.selectDefaultPaymentMethodIfNotSelected()}q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",y.jppoints)})}}function B(){var a=y.jppoints.find("#jpPointsMax");a.attr("checked",!0);
var b=parseInt(y.jppoints.find("#redeemableAmount").text(),10),d=y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),f=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10);k.isTouchCX()&&(e(y.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),n(a,"radio"));y.jppoints.find("#jpPointsMax").is(":checked")&&(b>=f?h():c.isSPP()&&y.paymentRows.find("#gcPromo, input[name\x3d'useAvailableBalance']").is(":checked")&&(a=y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),
f-=parseInt(a.val(),10),d>=f&&h()))}function r(){var a=y.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]');a.attr("checked",!1);var b=y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');b.val("");b.removeClass("a-form-error");y.jppoints.find("#jpPointsError").hide();k.isTouchCX()&&e(a,"radio")}function t(){var b=y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),c=parseInt(b.val(),10);!c||0>c?(b.val(""),y.jppoints.find("#jpPointsError").hide(),y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error")):
(b.val(c),parseInt(y.jppoints.find("#redeemableAmount").text(),10)<c?(y.jppoints.find("#jpPointsError").show(),y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').addClass("a-form-error")):(y.jppoints.find("#jpPointsError").hide(),y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error"),b=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),
10),c>=b&&h(),q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleJPPointsSection",c)})))}var p=a.$,y={},G={paymentRows:"#existing-payment-methods .payment-row",jppoints:"#jppoints",mcbPointsWarning:"#mcbPointsWarning"};a.on("checkout:reload:payselect",l);a.on("checkout:reload:spp-payment",l);return{handleJPPointsOnPaymentRows:function(a){a=p(a.currentTarget);if("jppoints"!==a.attr("id"))if("useAvailableBalance"===a.attr("name"))z(a);else{f.isMCBMultiTenderWeblabEnabled()||
d.hideMCBWarningMessageForPoints(y);var b=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]');if(!f.isMCBMultiTenderWeblabEnabled()&&b.length&&0<b.filter("[value^\x3dMCB]").size())d.showMCBWarningMessageForPoints(y),v();else if("availablebalance"===a.attr("value")||a.find("#pm_300")&&"availablebalance"===a.find("#pm_300").attr("value"))v();else{a=y.jppoints.find("#redeemPoints");var b=y.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),e=y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),
h=y.jppoints.find("#redeemableAmount"),g=y.jppoints.find("#redeemableValue");c.isSPP()&&y.jppoints.find("label").removeClass("disabled-color");a.attr("disabled",!1);b.attr("disabled",!1);e.attr("disabled",!1);p('#existing-balance input[type\x3d"radio"][value\x3d"availablebalance"]').length&&(h.text(y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val()),g.text(y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val()));k.isTouchCX()&&(a.siblings("i").removeClass("a-button-disabled"),
b.siblings("i").removeClass("a-button-disabled"))}}},handleJPPointsWithGC:z}});"use strict";q.when("A","ajax-utility","client-side-metrics","pay-common-util","pay-validator","page-transition-controller","page-conductor","a-popover-position","inline-points-register-controller","jppoints","pay-credit-card","checkout-general-utils","a-popover-base","a-dropdown","pay-rewards-currency","cache-page-data-controller","pay-credit-card-reregistration","mobile-carrier-billing-util","emi-helper","instant-bank-discount-helper",
"recommendation-helper","safe-apx-helper","apb-limit-messaging-helper").register("existing-payments",function(a,k,g,c,d,f,l,h,e,n,b,m,v,u,z,w,B,r,t,H,y,G,E){function I(){return C.paymentRows.filter(function(){return J(this).hasClass("payment-selected")||J(this).find("#redeemPoints").is(":checked")})}function da(a){f.show();a.$event.preventDefault();var b=I().find(".card-unreg-rewards").data();b.recommendedPaymentMethodId=b.paymentinstrumentid;c.makeAjaxCall(a.$target.attr("href"),b)}function F(b){b=
J(b.currentTarget);var d=b.data();if(!(0>=d.ratio)){var e=b.val()/d.ratio;if(!isNaN(e)){var f=b.val();f<d.min&&(e=0);b=c.getNumberWithSeparators(e,d.decimalplaces);I().find(".custom-reward-points").html(b);q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleRewardsSection",f)})}}}function P(a){1===a.data.refresh&&(f.show(),c.makeAjaxCall(a.data.url))}function D(a){Ca(a)?(a=C.continueBtns,a.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),
a.find(".a-button-disabled").removeClass("aok-hidden")):J("#payPageContinueBtnStateFixEnabled").length&&V(a)}function N(a){c.isTouchCX()&&(Ca()?a.$event.preventDefault():(C.continueErrPopover.hide().find(".error-message").hide(),f.show()))}function U(a){c.isTouchCX()&&(Ca()||C.continueErrPopover.hide().find(".error-message").hide())}function x(a){a=J(a.currentTarget);a.click();a=a.closest(".payment-container");a.find("#cc-errors").is(":visible")?a.find(".tv-update .a-button-primary").focus():a.click()}
function L(a){a.$event.preventDefault();var d=I();if(!b.runConfirmCardValidator(d,d.find("#cc-errors"))){f.show();var e=(d=c.getInputValues(d))||{},h=c.getInputValues(C.hiddenFormFields),g;for(g in h)h.hasOwnProperty(g)&&(e[g]=h[g]);b.confirmCreditCard(d,K,a.data.url)}}function O(){C.continueErrPopover.filter(":visible").length&&C.continueErrPopover.hide()}function V(){C.continueErrPopover.filter(":visible").length&&C.continueErrPopover.hide().find(".error-message").hide();var a=I();C.disableSubmitButtons.length?
a.find(".no-address").length||(a.find(".continue-center").removeClass("aok-hidden"),a.find(".a-button-disabled").addClass("aok-hidden")):(C.continueBtns.find(".a-button-primary:not(.a-button-disabled)").removeClass("aok-hidden"),C.continueBtns.find(".a-button-disabled").addClass("aok-hidden"));if(a){var b=a.find(".a-form-error");b&&b.length&&(b.removeClass("a-form-error"),(a=a.find(".pincode-err-block").filter(":visible"))&&a.length&&(C.continueErrPopover.hide().find(".error-message").hide(),C.continueBtns.find(".a-button-primary").removeClass("aok-hidden"),
C.continueBtns.find(".a-button-disabled").addClass("aok-hidden"),a.hide()))}}function ba(){C.continueErrPopover.filter(":visible").length||C.continueBtnTop.trigger("click")}function fa(a){if(13===a.which){var b=J(document.activeElement),d=b.closest("div.payment-row"),e=b.closest(".a-button"),b=b.get(0).tagName;if(d.length&&!e.length&&"A"!==b&&"a"!==b)return d=d.find('input[type\x3d"submit"]'),d.length?d.trigger("click"):(C.continueErrPopover.filter(":visible").length&&C.continueErrPopover.hide(),
Ca(a)?(c.isTouchCX()||(C.continueBtns.find(".a-button-primary").addClass("aok-hidden"),C.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")),a.preventDefault()):C.continueBtnTop.trigger("click")),!1}}function aa(a){f.show();var b=I(),d=b.find("input[type\x3dradio][name\x3dpaymentMethod]").val(),e=b.find(".card-unreg-rewards").data(),b=c.isTouchCX()?b.find(".flag-register-rewards"):C.rewardsRegister,b=c.getInputValues(b);b.programid=e.programid;b.paymentinstrumentid=e.paymentinstrumentid;
b.CARD_EXPIRATION_DATE=e.expiredate;b.CARD_HOLDER_NAME=e.holdername;b.returnRefreshedPage=a.data.returnRefreshedPage;b.rewardsdateofbirthmonth&&b.rewardsdateofbirthday&&(b.DATE_OF_BIRTH=b.rewardsdateofbirthmonth+b.rewardsdateofbirthday);-1===a.data.url.toLowerCase().indexOf("cachebuster")&&(a.data.url=m.addQueryStringParameter(a.data.url,"cacheBuster",(new Date).getTime()));c.makeAjaxCall(a.data.url,b,{successHandler:function(a,b,e){f.hide();if(a){a=k.jsonify(a);C.rewardsRegister.find(".register-content").hide();
var h=c.isTouchCX()?I().find(".register-error"):C.rewardsRegister.find(".register-error");h.hide();a.error?h.show().find(".error-message").hide().filter("#"+a.error).show():(l.ajaxUpdatePage(a.refreshedPage,b,e),b=C.paymentRows.find('input[type\x3dradio][name\x3dpaymentMethod][value\x3d"'+d+'"]').closest(".payment-row"),b.trigger("click"),c.scrollTopTo(b))}}})}function X(a){a=J(a.currentTarget).parents("div.currency-list");var b=a.find("label.a-touch-radio");b.length?b.trigger("click"):a.find("input[type\x3dradio][value\x3dOther]").trigger("click")}
function ea(a){a=a.$target.closest("div.payment-row");var b=a.find(".currency-list");if(l.isSPP()){var d=u.getSelect(b.find("select"));null!==d&&d.setValue("")}a.find(".change-currency").hide();b.show();c.isTouchCX()&&(a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"),a.find(".bottom-cell").show());ca();Aa()}function A(a){a=a.$target.closest("div.payment-row");a.find(".expire-info, .expire-date").hide();a.find(".enter-date, .expire-date-fields").show();ca();sa()}function Y(a){var b=
a.$target.closest("div.payment-row"),d="true"===c.getAttributeData(b,"isaddresschallenge")?1:0;b.find(".expire-date-fields").length?(A(a),b.find("#newExpDate").focus()):d&&b.find("#addCreditCardNumber").focus()}function Z(a){setTimeout(function(a){var b=J(a.target);a=document.createEvent("UIEvents");a.initUIEvent("DOMActivate",!0,!0,p,1);b.get(0).dispatchEvent(a)},0,a)}function ka(a){var b=J(a.target).closest("div.payment-row");""!==J(a.target).val()&&("true"===c.getAttributeData(b,"isaddresschallenge")?
b.find("#addCreditCardNumber").focus():ba())}function ga(){var a=I();a.find("div.flag-register-rewards").is(":visible")?(a.find(".bottom-cell").hide(),a.find(".top-cell").removeClass("bottom-line"),a.find(".card-unreg-rewards").show()):(a.find(".card-unreg-rewards").hide(),a.find(".bottom-cell").show(),a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"))}function R(){ga()}function ra(a){a.$event.preventDefault();if("1"===I().find("div.flag-register-rewards").attr("cached"))ga();
else{var b=a.$target.attr("href");-1===b.toLowerCase().indexOf("cachebuster")&&(b=m.addQueryStringParameter(b,"cacheBuster",(new Date).getTime()));f.show();c.makeAjaxCall(b,a.data,{successHandler:function(a){f.hide();var b=k.jsonify(a);a=c.decodeJSONResponse(b.widgetHTML);var d=I();d.find("div.flag-register-rewards").html(a);d.find("div.flag-register-rewards").attr("cached",1);d.find("div.flag-register-rewards .error-message").each(function(){var a=J(this),c=a.data("errorid");a.html(b.displaydata[c])});
ga()}})}}function ta(b){var d=J(b.target);if(!d.is(":visible"))return b.preventDefault(),b.stopPropagation(),!1;l.isSPP()&&(l.isPrefetchFromAddressEnabled()?l.disablePageNoUpdateTransition():J("#payment").find(".panel-cancel-row").hide(),w.clearCache());var e=J(b.currentTarget);C.jppoints.length&&n.handleJPPointsOnPaymentRows(b);var f=e.find("[name\x3duseAvailableBalance]");if("useAvailableBalance"!==b.target.name&&!f.length)if(Ba(e),r.toggleGCForMCB(e,C),S(e),e.hasClass("payment-selected")||e.hasClass("payment-label"))C.disableSubmitButtons.length&&
(na(e,e,!1),!d.hasClass("continue-center")&&e.find(".continue-center").length||ba());else if(b=e.find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),b.length&&"disabled"!==b.attr("disabled")){ab();b=I();l.isSPP()?b.filter(function(){var a=J(this).attr("id");return"gcPromo"===a?(a=J(this).find('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]'))&&a.length:"jppoints"!==a}).removeClass("payment-selected"):b.removeClass("payment-selected");b.find("[name\x3dpaymentMethod]").attr("checked",
!1);b.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");b.find(".top-cell").removeClass("bottom-line");T(b);c.isTouchCX()&&(b.find(".bottom-cell").hide(),b.find(".card-unreg-rewards").show());e.addClass("payment-selected");e.find("[name\x3dpaymentMethod]").attr("checked",!0);e.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active");var d="true"===c.getAttributeData(e,
"isaddresschallenge")?1:0,f=e.find('.rewards-list input[type\x3d"radio"]').length,h="1"===c.getAttributeData(e,"hasDerivedCurrency")?1:0,g=e.find(".vcc-form-fields").length,k=e.find(".card-ref-num").length;c.isTouchCX()&&(d||f||g||k||h)&&(e.find(".top-cell").removeClass("align-top bottom-line").addClass("bottom-line"),e.find(".bottom-cell").show());q.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:select-payment-row",e,Aa)});Ga(e);Ma(e);Oa(e);Pa(e);bb(e);"1"===
J("#suppressionMessageFixEnabledStatus").val()&&cb(e);db(e);Qa(e);Ra(e);Sa(e);eb(e);fb(e);Ta(e);Da(t,t.toggleEMIMenu,e);Ua(e);gb();ua(e);Ya();ca();sa();U();ha();qa(e,b);La();J.isEmptyObject(y)||y.toggleCustomerNudgingMessage(e);C.hideInputBoxes.length&&(Na(e,b),Ia(e));C.disableSubmitButtons.length&&na(e,b,!0);Ha();Aa();C.disableSubmitButtons.length&&!e.find(".continue-center").length&&ba()}}function S(a){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=J("input[type\x3d'hidden'][name\x3d'paySelectLocale']");
b.length&&"IN"===b.val()&&a.length&&q.when("client-side-metrics").execute(function(a){a.increaseCount("PayPage-COD-NonMobile",1)})}function Ba(a){var b=J("#isGlobalCODEligible").val();if(b&&"0"!==b){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=J("#button-add-gcpromo"),c=J("#button-add-gcpromo").parent().parent();a.length?(c.addClass("a-button-disabled"),b.attr("disabled","disabled")):(c.removeClass("a-button-disabled"),b.removeAttr("disabled"))}}function Q(a){q.when("A",
"a-tv").execute(function(b,c){b=b.$;var d=b(a);d.length&&(b(".tv-lastSelected").removeClass("tv-lastSelected"),d.addClass("tv-lastSelected"),c.select(d))})}function na(a,b,c){c&&b.find(".billing-address, .cc-continue-button").hide();if(a.find(".tv-update").length)Na(a,b),Ia(a);else{var d=a.find(".billing-address, .cc-continue-button");if(d.length&&!d.is(":visible")){var e=!1;a.find(".no-address").length&&(e=!0,a.find(".a-button-primary").addClass("aok-hidden"),a.find(".a-button-disabled").removeClass("aok-hidden"));
q.when("a-tv").execute(function(f){c&&(b.find(".payment-container").hasClass(".a-tv-navigate")||f.add(b.find(".payment-container")));f.remove(a.find(".payment-container"));f=e?a.find(".billing-address-link"):d.find(".continue-center");Q(f)});d.show()}}}function ua(a){var b=J("#one-click-final-review-message");b.length&&(a.find("#canTryTFX").length?b.removeClass("aok-hidden"):b.addClass("aok-hidden"))}function qa(a,b){if(c.isTouchCX()&&(b&&b.find(".top-cell .data-row").children(".a-column").height("auto"),
a)){a=a.find(".top-cell .data-row");var d=a.find(".addr-challenge-card-scan .a-box");if(d.length){b=a.height();var d=d.height(),e=a.children(".a-column:first");a.children(".a-column").height(d);e.height(b);e.children(".vertical-center-grid:first").height(d)}else a.children(".a-column").height(a.height())}}function K(d){f.hide();var e=k.jsonify(d);e.imbWidgetHTML&&J("#imb-wrapper").html(c.decodeJSONResponse(e.imbWidgetHTML));if(e.cardWidgetHTML&&(d=I(),d.replaceWith(c.decodeJSONResponse(e.cardWidgetHTML)),
null!=e.rewardsAccountsWidgetHTML&&q.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:refresh-rewards-section",c.decodeJSONResponse(e.rewardsAccountsWidgetHTML))}),a.trigger("checkout:reload"),a.trigger("checkout:reload:payselect"),d=I(),"true"!==c.getAttributeData(d,"isaddresschallenge"))){b.setCardPasswordInputStatus(d,e.newpaymentmethodid,"cvv","#existingCvvNum");b.setCardPasswordInputStatus(d,e.newpaymentmethodid,"pincode","#existingPincodeNum");if(C.cvvColumnLabel.length){var h=
!1;C.paymentRows.each(function(){if("true"===c.getAttributeData(J(this),"isaddresschallenge"))return h=!0,!1});h||C.cvvColumnLabel.hide()}C.disableSubmitButtons.length&&ba()}}function ca(){C.paymentRows.each(function(){var a=J(this),b=a.find('.currency-list input[type\x3d"radio"]').length,d=a.find('.rewards-list input[type\x3d"radio"]').length,e=a.find(".card-reg-info").is(":visible"),f=a.find(".expire-date-fields").is(":visible"),h=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),
g=a.find(".bottom-cell .inner-grid-left"),l=a.find(".bottom-cell .inner-grid-right");f?b||d||e?(g.removeClass("hidden a-span10 a-span12").addClass("a-span8"),l.removeClass("a-span12 a-span2 hidden").addClass("a-span4")):(g.removeClass("a-span8 a-span10 a-span12").addClass("hidden"),l.removeClass("a-span4 a-span2 hidden").addClass("a-span12")):h?(g.removeClass("a-span12 a-span8 hidden").addClass("a-span10"),l.removeClass("hidden a-span4 a-span12").addClass("a-span2")):(g.removeClass("a-span10 a-span8 hidden").addClass("a-span12"),
l.removeClass("a-span2 a-span4 a-span12").addClass("hidden"));!c.isTouchCX()&&h&&(b||d||e)&&a.find(".bottom-cell").removeClass("align-top").addClass("align-top")});var a=I(),b=a.find("a[data-action\x3dshow-expire-date-fields]").filter(":visible").length,d=a.find(".top-cell.bottom-line").length;b&&!d||a.find(".bottom-cell").removeClass("align-top")}function sa(){c.isTouchCX()&&C.paymentRows.each(function(){var a=J(this),b="true"===c.getAttributeData(a,"isaddresschallenge")?1:0,d=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),
e=a.find(".expire-date-fields").is(":visible"),f=a.find(".card-reg-info").is(":visible"),h=a.find(".rewards-info").is(":visible"),g=a.find(".change-currency").is(":visible");d?a.find(".top-cell .second-row").addClass("align-top"):a.find(".top-cell .second-row").removeClass("align-top");b=b||g||f||h;f=e||d;h=a.find(".top-cell .inner-grid-left");a=a.find(".top-cell .inner-grid-right");b||(h.removeClass("a-span6 a-span8 a-span12").addClass("hidden"),a.removeClass("a-span4 a-span6 hidden").addClass("a-span12"));
f||(h.removeClass("a-span6 a-span8 hidden").addClass("a-span12"),a.removeClass("a-span4 a-span6 a-span12").addClass("hidden"));b&&d&&(h.removeClass("a-span6 a-span12 hidden").addClass("a-span8"),a.removeClass("a-span6 a-span12 hidden").addClass("a-span4"));b&&e&&(h.removeClass("a-span6 a-span8 hidden").addClass("a-span6"),a.removeClass("a-span4 a-span12 hidden").addClass("a-span6"))})}function T(a){var b=a.find(".currency-list");if(b.length){var c=b.find("[type\x3dradio]:checked").val(),b=b.find("#cardCurrencyDropDown option:selected").val();
"Other"!==c||"-1"!==b&&"-2"!==b||a.find(".currency-list input[type\x3dradio][value!\x3dOther]").attr("checked",!0)}}function va(a){var b=J(a.currentTarget);a=b.find("option:selected");if(""===a.val())b.parents("div.selected-section").find(".selected-note-content").hide();else{var c=a.prop("disabled"),b=b.parents("div.selected-section"),d=b.find("#active-bank-content"),e=b.find("#disable-bank-content");c?(e.show(),d.hide()):(d.show(),e.hide());b.find("span.selected-note-bank").text(a.text()).show()}}
function xa(a){var b=J(a.currentTarget);a=b.find("option:selected");""===a.val()?b.parents("div.selected-section-more-payment-method").find(".selected-more-payment-content").hide():(b=b.parents("div.selected-section-more-payment-method"),b.find("span.selected-payment-option").text(a.text()).show(),b.find("span.selected-more-payment-content").show())}function la(a){(C.continueErrPopover.filter(":visible").length||Ca())&&a.$event.preventDefault()}function wa(b){b=J(b.currentTarget);var c=b.find("input[type\x3dcheckbox]");
c.attr("checked")?(c.attr("checked",!1),b.find(".checked-checkbox").addClass("aok-hidden"),b.find(".empty-checkbox").removeClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").addClass("aok-hidden")):(c.attr("checked",!0),b.find(".checked-checkbox").removeClass("aok-hidden"),b.find(".empty-checkbox").addClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").removeClass("aok-hidden"));q.when("a-tv").execute(function(b){setTimeout(function(){b.select(".tv-lastSelected")},500);a.trigger("a:tv:resize")})}
function ia(a){a=J(a.currentTarget);"1"===a.attr("isclicked")?a.attr("isclicked",0):a.attr("isclicked",1);ha()}function ha(a){var b=J("#pm_promo");a=J("#pm_gc_radio");var d=J("#pm_gc_checkbox"),e;J("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").length&&(e=J("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").val());if(a&&a.length||d&&d.length){var f=J("input[name\x3dgcBalanceRaw]").val();J("input[name\x3damBalanceRaw]").length&&(f=J("input[name\x3damBalanceRaw]").val());
var h=J("input[name\x3disAPBLimitMessagingLaunchWeblabEnabled]").val(),g=J("input[name\x3dhasAPBRedeemableLimitExhausted]").val(),l=J("input[name\x3damAvailableBalanceRaw]").val(),n=J("input[name\x3dremainingBalanceRaw]").val(),k=J("input[name\x3dpurchaseTotalRaw]").val(),m,r,t=J(".purchase-total").length;t?(r=J(".purchase-total").html(),m=J(".remaining-balance").html()):(r=J("input[name\x3dpurchaseTotal]").val(),m=J("input[name\x3dremainingBalance]").val());var ma=J(".balance-applied");t?ma.html(r):
ma.text(r);(c.isTouchCX()&&"checkbox"===b.attr("type")?"1"===b.closest(".a-control-row").attr("isclicked"):b.is(":checked"))?(b=n,0<b&&(t?ma.html(m):ma.text(m))):b=k;h&&E.renderAPBMessagingRemainingBalance({purchaseTotal:r,remainingBalance:m,balanceApplied:ma,isPurchaseTotalInSpan:t},f,k,l);m=a.closest(".radio-col");r=d.closest(".radio-col");n=J(".amazon-money-limit-breached");t=J(".long");ma=J(".short");"1"===h&&"1"===g?E.displayAPBRedeemableLimitExhaustedMessaging({gcRadioContainer:m,gcCheckboxContainer:r,
gcCheckbox:d,gcRadio:a,shortMsg:ma,longMsg:t,amazonMoneyLimitBreachedMsg:n}):0<=f-k?("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),m.removeClass("hidden"),a.is(":checked")&&m.trigger("click"),r.addClass("hidden"),d.attr("disabled","disabled"),0==f-k?(t.hide(),ma.show()):(t.show(),ma.hide())):0<f-b?0>=b?(r.removeClass("hidden"),d.attr("disabled","disabled"),c.isTouchCX()&&r.find("i").addClass("a-button-disabled checkbox-disabled"),m.addClass("hidden"),a.attr("disabled","disabled"),ma.show(),
t.hide()):("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),m.removeClass("hidden"),a.is(":checked")?m.trigger("click"):c.isTouchCX()&&m.find("i").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),r.addClass("hidden"),d.attr("disabled","disabled"),t.show(),ma.hide()):("disabled"===d.attr("disabled")&&(d.removeAttr("disabled"),c.isTouchCX()&&r.find("i").removeClass("a-button-disabled checkbox-disabled")),r.removeClass("hidden"),(g=r.closest(".payment-row"))&&
g.hasClass("payment-selected")&&g.removeClass("payment-selected"),m.addClass("hidden"),a.attr("disabled","disabled"),"1"===h?E.renderAPBInsufficientMessaging({shortMsg:ma,longMsg:t},f,l):(ma.show(),t.hide()));"1"===e&&(a.attr("disabled","disabled"),d.attr("disabled","disabled"),(g=r.closest(".payment-row"))&&g.hasClass("payment-selected")&&g.removeClass("payment-selected"))}}function ja(b){var c=I().find(".enter-custom-rewards");if("rewardscustom"===J(b.currentTarget).children('input[type\x3d"radio"]').val()){c.show();
var d=c.find("input.custom-rewards-input");d.focus();C.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")&&(c=d.val().length,d=d.get(0),d.setSelectionRange?d.setSelectionRange(c,c):d.createTextRange&&(d=d.createTextRange(),d.collapse(!0),d.moveStart("character",c),d.moveEnd("character",c),d.select()))}else c.hide();q.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",J(b.currentTarget))});Aa()}function Fa(a){a=
a.$target||J(a.currentTarget);oa(a)}function oa(b){if(b.length){var c=C.paymentRows.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]'),d=C.paymentRows.find(".installments-select.a-row"),e=d.siblings(".installments-message"),f=d.siblings(".card-offers"),h=C.paymentRows.find('input[type\x3d"radio"][value\x3d"morePaymentMethod"]'),g=C.installmentsOnlyCards,l=C.paymentRows.find('input[type\x3d"radio"][id\x3d"pmEmiPaymentOptions"]'),n=C.paymentRows.find('input[type\x3d"radio"][value\x3d"amazonBusinessCredit"]');
if(c.length){var k=c.closest(".payment-row"),m=h.closest(".payment-row"),r=l.closest(".payment-row"),ma=n.closest(".payment-row");b.is(":checked")?(c.prop("disabled",!0),c.is(":checked")&&(c.prop("checked",!1),k.removeClass("payment-selected")),c.parent().siblings().addClass("a-color-secondary"),Da(t,t.disableEMIPaymentMethods,l),q.when("abc-helper").execute(function(b){a.trigger("abc-helper:disable-payment",n)}),H.showInstantBankDiscountAmazonPaySelected(),za(h,m),(b=d.find("select"))&&b.each(function(){var a=
this.id.replace(/\./g,"\\.");u.setValue(a,"")}),d.find(".installments-enabled-text").hide(),e.find(".installments-enabled-text").hide(),f.find(".installments-enabled-text").hide(),d.find(".installments-disabled-text").show(),e.find(".installments-disabled-text").show(),f.find(".installments-disabled-text").show(),J("#isGurupaPspToggleGcBugfixEnabled").length&&"1"===J("#isGurupaPspToggleGcBugfixEnabled").val()?g.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").filter(":checked").removeAttr("checked"):
g.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").removeAttr("checked"),g.removeClass("payment-selected")):(k.find(".payment-invalid").length||(c.prop("disabled",!1),c.parent().siblings().removeClass("a-color-secondary")),m.find(".payment-invalid").length||ya(h,m),r.find(".payment-invalid").length||Da(t,t.enableEMIPaymentMethods,l),ma.find(".payment-invalid").length||q.when("abc-helper").execute(function(b){a.trigger("abc-helper:enable-payment",n)}),H.showInstantBankDiscountAmazonPayDeselected(),
d.find(".installments-disabled-text").hide(),e.find(".installments-disabled-text").hide(),f.find(".installments-disabled-text").hide(),d.find(".installments-enabled-text").show(),e.find(".installments-enabled-text").show(),f.find(".installments-enabled-text").show(),g.find("input[name\x3dpaymentMethod]").removeAttr("disabled"))}}}function ya(a,b){a.prop("disabled",!1);a.parent().siblings().removeClass("a-color-secondary");b.find(".selected-section-more-payment-method").show();b.find(".more-payment-gc-disabled-text").hide()}
function za(a,b){a.prop("disabled",!0);a.is(":checked")&&(a.prop("checked",!1),b.removeClass("payment-selected"));a.parent().siblings().addClass("a-color-secondary");b.find(".selected-section-more-payment-method").hide();b.find(".more-payment-gc-disabled-text").show()}function M(a){var b=a.$target||J(a.currentTarget);a=b.closest(".currency-list");b=b.val();!0===(c.isTouchCX()?"Other"===b:"Other"!==b)?(a.find("select").attr("disabled",!0),a.find(".a-button.a-button-dropdown").addClass("a-button-disabled"),
a.find(".a-button.a-touch-select").addClass("a-button-disabled")):(a.find("select").attr("disabled",!1),a.find(".a-button.a-button-dropdown").removeClass("a-button-disabled"),a.find(".a-button.a-touch-select").removeClass("a-button-disabled"));Aa()}function ma(a){B.actionReregisterCardInBox(a);c.scrollTopTo(I())}function Wa(a){Aa()}function Xa(){C.paymentRows.each(function(){var a=J(this),b=".card-ref-num, .addr-challenge, .addr-challenge-msg, .cup-expired-msg, .enter-date, .expire-date-fields, .rewards-static-help-link, .verified-fail-msg, .tv-update, .billing-address, .cc-continue-button",
d=".card-info, .card-name, .card-reg-info, .expire-info, .rewards-err-msg, .rewards-list label, .rewards-list div.a-radio, .rewards-dynamic-help-link, .financial-offer-err-detail";a.hasClass("payment-selected")&&("1"===c.getAttributeData(a,"hasDerivedCurrency")||"1"===c.getAttributeData(a,"hasPreferredCurrency")&&"1"===c.getAttributeData(a,"isNewCard"))||(b+=", .currency-list");"1"===c.getAttributeData(a,"hasPreferredCurrency")&&"1"!==c.getAttributeData(a,"isNewCard")&&(d+=", .change-currency");a.find(b).hide();
a.find(d).show()})}function Ya(){C.paymentRows.each(function(){var a=J(this),b="#cc-errors, .enter-date, .expire-date-fields",d=".expire-info";if(a.hasClass("payment-selected")&&"1"===c.getAttributeData(a,"hasDerivedCurrency"))b+=", .change-currency",d+=", .currency-list";else{var e=a.find(".currency-list"),f=e.find("[type\x3dradio]:checked").val();if(f){var h;if("Other"!==f)h=e.find(".currencyNameLabel").html();else{var f=e.find("#cardCurrencyDropDown option:selected"),g=f.val();"-1"!==g&&"-2"!==
g&&(h=f.text())}h&&(d+=", .change-currency",e.closest("div.payment-row").find(".change-currency .currencyNameLabel").html(h))}b+=", .currency-list"}a.find(b).hide();a.find(d).show()})}function Za(){var a=J("#aan-ads-box");if(a.length){var b=a.data("adsendpoint"),c=a.data("adsclient"),d="https://"+b+"/2009-09-09/ad/",b="/jsc?pt\x3dstatic\x26slot\x3dlib\x26pt2\x3daanjs";a.data("useaannojq")&&(b+="-nojq");J.getScript(d+c+b,function(){p.d16g&&p.d16g.requestAanAd({elemId:"aan-ads-box",baseUrl:d,afterOnload:!0,
client:c,pt:"checkout",slot:"display-ad-right",pt2:"payselect"})})}}function $a(){Va&&(a.declarative("auto-rewards-reg",["click"],da),a.declarative("complete-rewards-register",["click"],P),a.declarative("confirm-card",["click"],L),a.declarative("register-card-rewards",["click"],aa),a.declarative("cancel-register-card-rewards",["click"],R),a.declarative("show-currencies",["click"],ea),a.declarative("show-expire-date-fields",["click"],A),a.declarative("focus-cc-update-fields",["click"],Y),a.declarative("show-rewards-reg",
["click"],ra),a.declarative("submit-payment-form",["submit"],la),a.declarative("toggle-tfx-option",["click"],M),a.declarative("reregister-cc-in-dashboard",["click"],ma),a.declarative("modify-expire-date-fields",["change"],Wa),c.isTouchCX()&&a.declarative("continue-button",["click"],N),Va=!1);C.paymentRows.unbind("click").has("input[name\x3dpaymentMethod]:enabled").bind("click",ta);q.when("apx-payselect-helper").execute(function(){var a=G.get("payselect");a&&a.initEvents(C.paymentRows,Aa)});C.paymentRows.find("input[name\x3dusePromoBalance]").unbind("change",
ha).bind("change",ha);C.disableSubmitButtons.length&&C.paymentRows.has("input[type\x3dcheckbox]:enabled").unbind("click",wa).bind("click",wa);C.existingPincodeNum.unbind("click",Ja).bind("click",Ja);C.paymentRows.find("select#cardCurrencyDropDown").unbind("change",X).bind("change",X);C.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")?C.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ja).each(function(b,c){c=a.$(c);b=c.find("input.custom-rewards-input");
c=c.find(".custom-reward-points");var d=a.$(b);b={$element:d,maxAmount:d.data("max")};c={$element:a.$(c),decimalPlaces:d.data("decimalplaces"),ratio:d.data("ratio")};d=d.data("country-code");d=z.getCurrencyFormatByCountryCode(d);z.initializeInlineFormatting(b,c,d)}):C.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ja).undelegate("input.custom-rewards-input","keyup").delegate("input.custom-rewards-input","keyup",F);if(c.isTouchCX())C.pageContainer.find("#existing-payment-methods").find("select, input[type\x3dtext], input[type\x3dpassword]").unbind("change",
U).bind("change",U),C.pageContainer.find("#existing-payment-methods").find("div.currency-list label.a-touch-radio").unbind("click").bind("click",M),C.pageContainer.find("#existing-payment-methods").find("label.promoLabel").unbind("click").bind("click",ia);else if(!l.isSPP()){var b=C.continueBtns.find(".a-button-text");J("#payPageContinueBtnStateFixEnabled").length?b.filter('input[type\x3d"button"]').unbind("mouseenter",Ea).bind("mouseenter",Ea).unbind("focus",Ea).bind("focus",Ea).unbind("mouseleave",
O).bind("mouseleave",O).unbind("blur",O).bind("blur",O):(b.filter('input[type\x3d"submit"]').unbind("mouseenter").bind("mouseenter",D).unbind("focus").bind("focus",D),b.filter('input[type\x3d"button"]').unbind("mouseleave").bind("mouseleave",V).unbind("blur").bind("blur",V))}C.netBankingSelect.unbind("change",va).bind("change",va);C.morePaymentMethodsSelect.unbind("change",xa).bind("change",xa);C.continueBtnBottom.unbind("click").bind("click",ba);0<J("input[name\x3d'needDisableCODandEMIforGC']").length&&
(b=J("input#pm_300[type\x3d'checkbox'], #pm_gc_checkbox"),b.length&&(b.bind("change",Fa),b.is(":checked")&&oa(b)));C.jppoints.length&&C.paymentRows.find('input[name\x3d"useAvailableBalance"]').bind("click",n.handleJPPointsOnPaymentRows);q.when("installments-payselect").execute(function(){a.trigger("installments-payselect:initEvents")});C.hideInputBoxes.length&&(C.paymentRows.find("#confirm-card").unbind("focus").bind("focus",x),C.paymentRows.find("#newExpDate").unbind("focus").bind("focus",Z),C.paymentRows.find("#newExpDate").unbind("change").bind("change",
ka))}function Ha(){var a=d.create();a.validatePayment(I());a.hasErrors()||l.makePrefetch(C.existingPaymentForm)}function Ja(a){a=C.showAmexWarning;null!==a&&(a.removeClass("hidden"),a.removeClass("amex_display"))}function pa(){if(!c.isMobileCX()){C=c.getElements(hb);C.paymentRows.filter(".payment-selected-marker").removeClass("payment-selected-marker").addClass("payment-selected");var b=I();q.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:page-load",Aa)});q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:page-load")});
Pa(b);Ra(b);ua(b);Xa();Ga(b);Ma(b);Oa(b);Sa(b);Ta(b);Ua(b);Qa(b);ha();La();J.isEmptyObject(y)||y.toggleCustomerNudgingMessage(b);J(document).undelegate("div.pay-desktop .checkout-page-form","keypress").delegate("div.pay-desktop .checkout-page-form","keypress",fa);J(document).undelegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup").delegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup",Aa);C.addressChallengeCardList.length&&C.addressChallengeCardList.show();
C.paymentRows.find('input[type\x3d"radio"][value\x3d"rewardsmax"]').each(function(){J(this).siblings('[type\x3d"checkbox"]').remove()}).removeClass("hidden");sa();ca();$a();C.existingPaymentForm.data("checkoutFormReady",!0);Ha();Za();C.orderSummaryBottom.show();qa(b);U();Aa();Ba(b);r.determineIsMCBEnabled(C);r.toggleGCForMCB(b,C);J(".a-popover-preload").each(function(){var b=J(this).find(".rewards-registration").data("parentPaymentMethodId");b&&(a.off("a:popover:show:rewards-registration-"+b,e.displayRewardsRegister),
a.off("a:popover:hide:rewards-registration-"+b,e.hideRewardsRegister),a.on("a:popover:show:rewards-registration-"+b,e.displayRewardsRegister),a.on("a:popover:hide:rewards-registration-"+b,e.hideRewardsRegister))});q.when("a-tv").execute(function(c){a.trigger("a:tv:resize");b.find(".a-tv-navigate").length&&na(b,b,!1)})}}function Aa(b){l.isSPP()?(Ca()?C.disableSubmitButtons.length?(b=I(),b.find(".continue-center").addClass("aok-hidden"),b.find(".a-button-disabled").removeClass("aok-hidden")):(C.continueBtns.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),
C.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")):V(),a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")):J("#payPageContinueBtnStateFixEnabled").length&&D(b)}function Ka(a,b){a=J(a.target).closest(".order-summary-box").find(".continue-button-errors");a.length&&b.length&&(b=h.triggerLeft(a,b),a.show(),a.offset(b))}function Ea(a){if((!C.continueErrPopover.filter(":visible").length||c.isTouchCX())&&C.continueErrPopover.find(".error-message:not(.hidden)").length&&a&&
("mouseenter"===a.type||"focus"===a.type)){var b=J(a.target).closest(".continue-buttons").find(".a-button-disabled");Ka(a,b)}}function Ca(a){if(C.continueErrPopover.filter(":visible").length&&!c.isTouchCX())return!0;var b=I(),e=d.create();Da(t,t.isEMIPaymentInstrument,b)&&(e.validateEMIMenuForContinueButton(b),b=Da(t,t.getEMIMenuSelectedCardSection));e.validatePayment(b);e.apxValidatePayment(b,C.paymentRows);e=e.getHighestErrorId();if(!e||!e.identifier)return!1;C.continueErrPopover.find(".error-message").hide();
b=b.find(".pincode-err-block");b.hide();b&&b.length&&e.target&&e.target.length&&e.target.addClass("a-form-error");e.isPincodeError?(b.show(),b.addClass("a-form-error")):(C.continueErrPopover.find("#"+e.identifier).show(),C.continueErrPopover.find("#"+e.identifier).removeClass("hidden"),!a||"mouseenter"!==a.type&&"focus"!==a.type?l.isSPP||C.continueBtns.find(".a-button input").filter(":visible").each(function(){var a=J(this).closest(".order-summary-box").find(".continue-button-errors"),b=h.triggerLeft(a,
J(this));a.show();a.offset(b)}):(b=J(a.target).closest(".continue-buttons").find(".a-button-primary"),Ka(a,b)));return!0}function Ga(b){C.paymentRows.find(".addr-challenge, .addr-challenge-msg").hide();C.hideInputBoxes.length?C.paymentRows.find(".card-name").show():C.paymentRows.find(".card-info").show();if("true"===c.getAttributeData(b,"isaddresschallenge")){var d=b.find(".addr-challenge, .addr-challenge-msg");0===d.length&&g.increaseCount("Checkout:Payment:AddressChallengeMissingInputAndMsg");d.show();
C.hideInputBoxes.length?b.find(".card-name").hide():b.find(".card-info").hide();b=b.attr("paymentmethodid")?b.attr("paymentmethodid"):b.attr("data-paymentmethodid");a.trigger("checkout:payment:challenge:log",b)}}function Ia(a){C.paymentRows.find(".expire-date-fields").hide();a=a.find(".expire-date-fields");a.length&&a.show()}function La(){C.paymentRows.find(".pci-blocking-cvv").length&&C.paymentRows.each(function(){var a=J(this),b=a.find(".pci-blocking-cvv");a.find("[type\x3dradio]:checked").val()&&
b.length?b.show():b.length&&b.hide()})}function Na(a,b){q.when("a-tv").execute(function(c){c.add(b.find(".payment-container"));b.find(".tv-update").hide();var d=a.find(".tv-update");d.length&&(c.remove(a.find(".payment-container")),d.show(),Q(d.find(".a-button-primary")))})}function Ma(a){C.paymentRows.find(".verified-fail-msg").hide();"true"===c.getAttributeData(a,"isverifiedfail")&&a.find(".verified-fail-msg").show()}function Oa(a){C.paymentRows.find(".cup-expired-msg").hide();"true"!==c.getAttributeData(a,
"iscupcardexpired")&&"true"!==c.getAttributeData(a,"iscupcardexpiringsoon")||a.find(".cup-expired-msg").show()}function Pa(b){C.paymentRows.find(".rewards-list").hide();C.paymentRows.find(".top-cell .inner-grid-left").show().find(".rewards-info").show();var d=b.find('.rewards-list input[type\x3d"radio"]'),e=d.filter(":checked");C.paymentRows.find('.rewards-list input[type\x3d"radio"]').prop("checked",!1);0<e.length?e.prop("checked",!0):b.find(".rewards-list").hasClass("apply-by-default")?d.filter('[value\x3d"rewardsmax"]').prop("checked",
!0):d.filter('[value\x3d"rewardsnone"]').prop("checked",!0);d=b.find(".rewards-list").show();d.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")&&d.children(".enter-custom-rewards").show();c.isTouchCX()&&d.length&&(b.find(".rewards-info").hide(),b.find(".top-cell").addClass("bottom-line"),b.find(".bottom-cell").show());q.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",b)})}function Ra(a){C.paymentRows.find(".financial-offer-list").hide();
C.paymentRows.find(".financial-offer-err-detail").hide();var b=a.find('.financial-offer-list input[type\x3d"radio"]'),d=b.filter(":checked");b.prop("checked",!1);0<d.length?d.prop("checked",!0):b.first().prop("checked",!0);b=a.find(".financial-offer-list").show();a.find(".financial-offer-err-detail").show();c.isTouchCX()&&b.length&&(a.find(".top-cell").addClass("bottom-line"),a.find(".bottom-cell").show())}function ab(){J(document.body).find(".a-dropdown").each(function(){v.hide(J(this))})}function bb(a){C.paymentRows.find(".installments-select").hide();
C.paymentRows.find(".installments-message").show();a.find(".installments-select").show();a.find(".installments-message").hide()}function cb(a){C.paymentRows.find("#savedCardSuppressed").hide();a.find("#savedCardSuppressed").show()}function db(a){C.paymentRows.find(".installments-list").hide();a.find(".installments-list").show()}function Qa(a){C.paymentRows.find(".card-ref-num, .selected-note, .selected-more-payment-option").hide();C.paymentRows.find(".card-benefit").show();a.find(".card-ref-num, .selected-note, .selected-more-payment-option").show();
a.find(".card-benefit").hide()}function eb(a){C.paymentRows.find(".otpBlock").hide();a.find(".otpBlock").show()}function fb(a){C.paymentRows.find(C.ovdWidgetSection).hide();a.find(C.ovdWidgetSection).show()}function Sa(a){C.paymentRows.find(".vcc-info-prompt,.vcc-form-fields").hide();a.find(".vcc-info-prompt,.vcc-form-fields").show()}function Ta(a){var b=C.newVDC.find("#vdcBanksSelect"),c=C.newVDC.find(".vdc-selected-bank-prompt").hide(),d=C.newVDC.find("#suppressedVerifiedDebitCard").hide(),e=b.val(),
f="1"===J("#save_citi_card").val()?"CIT"!==e:!0,h="1"===J("#save_citi_card").val()&&"CIT"===e;a.find("#vdcBanksSelect").length?""!==e&&"OtherBanks"!==e&&f&&(C.newVDC.find("option:selected").prop("disabled")?(d.show(),c.hide()):(d.hide(),c.show())):(("OtherBanks"===e||h)&&b.val(b.children("option").first().val()).trigger("change"),c.hide())}function Da(a,b,c){if(!J.isEmptyObject(a)&&b)return b(c)}function Ua(a){var b=J("#cash-back-ineligible-for-cod-message");b&&b.length&&((a=a.find("#cashOnDeliveryCash"))&&
a.length?b.removeClass("hidden"):b.addClass("hidden"))}function gb(){var a=J("#imb-wrapper");if(a.length&&a.is(":visible")){var b=a.find(".defaultPaymentMethodExpired"),c=a.find(".codUnavailable"),d=a.find("p").length;0===b.length&&0===c.length||1!==d||a.hide()}}var J=a.$,Va=!0,C={},hb={cardImages:"#newCreditCardImages",continueBtns:".continue-buttons:not(.place-order-button)",continueBtnTop:"#continue-top",continueBtnBottom:"#continue-bottom",continueErrPopover:".continue-button-errors",cvvColumnLabel:"#cvvColumnLabel",
existingPaymentForm:"form.checkout-page-form",netBankingSelect:"#net-banking-select-list",morePaymentMethodsSelect:"#more-payment-methods-select-list",newVDC:"#new-vdc",newEMI:"#newEmiCard",orderSummaryBottom:"#order-summary-bottom",pageContainer:"div.a-container",paymentRows:"#existing-payment-methods .payment-row",rewardsRegister:"#rewards-register",addressChallengeCardList:".address-challenge-card",hiddenFormFields:"#hiddenFormFields",jppoints:"#jppoints",gcpromo:"#gcPromo",disableSubmitButtons:"#disableSubmitButtons",
hideInputBoxes:"#hideInputBoxes",showAmexWarning:"#showAmexWarning",existingPincodeNum:"#existingPincodeNum",mcbBalanceWarning:"#mcbBalanceWarning",installmentsOnlyCards:".installments-only-card",ovdWidgetSection:"#ovdWidgetSection"};a.on("checkout:reload:payselect",pa);a.on("checkout:reload:spp-payment",pa);return{getSelectedPayment:I}});"use strict";q.when("A","page-detector").register("wechat-detector",function(a,k){var g=a.$,c=function(a){a&&!1!==a.isWeChatInstalled&&(a=g("#wechat_payment"),a.length&&
a.show())},d=function(a){},f="MShopWeChatPayment";a.on("checkout:reload:payselect",function(){g("#wechat_payment").length&&(g("#mShopWeChatApiName").length&&(f=g("#mShopWeChatApiName").val()),q.when("safe-mash").execute(function(a){p.cordova.require("cordova/exec")(c,d,f,"isWeChatInstalled",[])}))})});"use strict";q.when("A","page-main","client-side-metrics","ready").register("otp-for-cod",function(a,k,g){function c(){z=u("#cashOnDeliveryCash");if(z.length&&(w=z.find(x.verifyOTP),B=z.find(x.sendOTP),
I=w.length&&B.length,da=u(x.payMobile).length?1:0,I&&(r=z.find(x.submitSendOTP),t=z.find(x.submitVerifyOTP),p=z.find(x.submitResendOTP),y=z.find(x.changeOTPNumber),q=z.find(x.OTPPhoneNumber),E=z.find(x.otpCode),r.length&&t.length&&p.length&&y.length))){W=z.find(x.addURLHash).length;g.increaseCount(O.metricPrefix+O.block,1,1);r.click(function(){v();g.increaseCount(O.metricPrefix+O.send,1,1)});t.click(function(){P=q.val();U=E.val();m();var a=f(P),c;c=/^\d{6}$/;c=U&&c.test(U);a&&c&&""!==D?b("VerifyOTP",
D):c?a||z.find(x.otpServiceFailed).removeClass(x.aokHidden):z.find(x.invalidOTPError).removeClass(x.aokHidden);g.increaseCount(O.metricPrefix+O.verify,1,1)});if(W&&location.hash&&location.hash.length){for(var a=location.hash,a=a.replace("#",""),a=a.split(";"),c=0;c<a.length;c++)0<=a[c].indexOf(L.codehandle)&&(D=a[c].replace(L.codehandle,"")),0<=a[c].indexOf(L.contactid)&&(N=a[c].replace(L.contactid,"")),0<=a[c].indexOf(L.phonenumber)&&(P=a[c].replace(L.phonenumber,""),q.val(P));""!==D&&""!==N&&""!==
P&&h()}p.click(function(){g.increaseCount(O.metricPrefix+O.resend,1,1);v()});y.click(function(){w.addClass(x.aokHidden);B.removeClass(x.aokHidden);d(p,!1);d(t,!1);m();g.increaseCount(O.metricPrefix+O.changeNumber,1,1)})}}function d(a,b){b?a.addClass(x.aButtonDisabled):a.removeClass(x.aButtonDisabled);da?a.find("button").prop("disabled",b):a.find("input").prop("disabled",b)}function f(a){var b=/^\d{10}$/;return a&&b.test(a)}function l(){z.find(x.otpServiceFailed).removeClass(x.aokHidden)}function h(){var a=
z.find(x.verifyOTPPhoneNumber);z.find(x.invalidPhoneNumber).addClass(x.aokHidden);B.hasClass(x.aokHidden)?z.find(x.otpResentSuccess).removeClass(x.aokHidden):da&&z.find(x.otpSentSuccess).removeClass(x.aokHidden);B.addClass(x.aokHidden);w.removeClass(x.aokHidden);var b=P.substr(0,2)+"*****"+P.substr(7,9);a.text(b);d(p,!1)}function e(a){if(a!==F&&"object"!==typeof a)try{a=u.parseJSON(a)}catch(b){a={}}a=a||{};var c,d=W&&location.hash?location.hash:"#";W&&location.hash&&";"!==d.slice(-1)&&(d+=";");c=
a.status;a.codeHandle&&null!==a.codeHandle&&(D=a.codeHandle,W&&"SEND-SUCCESS"===c&&(d=n(d,L.codehandle,D)));a.contactId&&null!==a.contactId&&(N=a.contactId,W&&"SEND-SUCCESS"===c&&(d=n(d,L.contactid,N),d=n(d,L.phonenumber,P)));W&&(location.hash=d);z.find(x.otpAlertClass).addClass(x.aokHidden);if(V[c])V[c]();else V.DEFAULT()}function n(a,b,c){var d=a.indexOf(b);if(0<=d){var e=a.indexOf(";",d),e=0<=e?e:a.length;a=a.substring(0,d)+a.substring(e+1,a.length+1)}return a+b+c+";"}function b(b,c){a.ajax("/gp/buy/payselect/handlers/otpAjaxHandler.html",
{method:"get",params:{phoneNumber:P,method:b,codeHandle:c,contactId:N,otp:U},success:e,error:function(){e({status:"SERVICE-FAILED"})}})}function m(){E.val("");z.find(x.otpAlertClass).addClass(x.aokHidden)}function v(){m();P=q.val();f(P)?b("SendOTP",D):z.find(x.invalidPhoneNumber).removeClass(x.aokHidden)}var u=a.$,z,w,B,r,t,p,y,q,E,I,da,W,P="",D="",N="",U="",x={aokHidden:"aok-hidden",aRadio:".a-radio",aButtonHidden:"a-button-hidden",aButtonDisabled:"a-button-disabled",payMobile:".pay-mobile",invalidOTPError:".invalidOTPError",
verifyOTP:"#verifyOTP",sendOTP:"#sendOTP",submitSendOTP:"#submitSendOTP",submitVerifyOTP:"#submitVerifyOTP",submitResendOTP:"#submitResendOTP",changeOTPNumber:"#changeOTPNumber",OTPPhoneNumber:"#OTPPhoneNumber",otpCode:"#otpCode",cashOnDeliveryCash:"#cashOnDeliveryCash",invalidPhoneNumber:".invalidPhoneNumber",otpServiceFailed:".otpServiceFailed",enterOTPLabel:"#enterOTPLabel",reEnterOTPLabel:"#reEnterOTPLabel",maxOTPError:".maxOTPError",numberAlreadyUsed:".numberAlreadyUsed",verifiedOTPSuccess:".verifiedOTPSuccess",
verifyOTPPhoneNumber:"#verifyOTPPhoneNumber",otpResentSuccess:".otpResentSuccess",otpSentSuccess:".otpSentSuccess",otpAlertClass:".otpAlertClass",phonenumberNotVerified:"phonenumberNotVerified",addURLHash:".addURLHash"},L={codehandle:"codehandle:",contactid:"contactid:",phonenumber:"phonenumber:"},O={metricPrefix:"PayPage-COD-OTP-",block:"Block",send:"Send",verify:"Verify",resend:"ReSend",changeNumber:"ChangeNumber"},V={"SERVICE-FAILED":l,"SEND-SUCCESS":h,"VERIFY-SUCCESS":function(){B.addClass(x.aokHidden);
w.addClass(x.aokHidden);z.find(x.verifiedOTPSuccess).removeClass(x.aokHidden);z.find("."+x.phonenumberNotVerified).removeClass(x.phonenumberNotVerified);da&&k.setContinueButtonStatus(!0)},"INVALID-NUMBER":function(){z.find(x.invalidPhoneNumber).removeClass(x.aokHidden)},"NUMBER-ALREADY-USED":function(){d(p,!0);d(t,!0);z.find(x.numberAlreadyUsed).removeClass(x.aokHidden)},"MAX-OTP-REACHED":function(){z.find(x.maxOTPError).removeClass(x.aokHidden);d(p,!0)},"INVALID-OTP":function(){z.find(x.invalidOTPError).removeClass(x.aokHidden);
E.val("");da?E.attr("placeholder","Re-enter OTP"):(z.find(x.enterOTPLabel).addClass(x.aokHidden),z.find(x.reEnterOTPLabel).removeClass(x.aokHidden))},DEFAULT:l};a.on("checkout:reload:payselect",c);a.on("checkout:reload:spp-payment",c)});"use strict";q.when("A","pay-common-util","ready").execute(function(a,k){var g={productGls:"#productGls",gcTypes:"#gcDeliveryTypes",device:"#device"},c=k.getElements(g);a.on("checkout:payment:challenge:log",function(d){var f={},l;for(l in g)g.hasOwnProperty(l)&&c[l]&&
c[l].val()&&(f[l]=c[l].val());d&&(f.paymentInstrumentId=d);Object.keys&&Object.keys(f).length&&a.ajax("/gp/buy/payselect/handlers/log-payment-challenge.html?ref_\x3dcheckout-payment-challenge",{method:"POST",params:f,timeout:1E3,cache:!1})})});"use strict";q.when("A","page-spinner-controller","page-main","page-transition-controller","page-conductor","client-side-metrics","button-blocker","ready").register("pay-auth",function(a,k,g,c,d,f,l){function h(){var a=m("#otp_id").val(),b=/^\d{6}$/;a&&b.test(a)?
l.hide("pay-auth-otp-checks"):(a=m("#otp_invalid_msg").val(),l.show("pay-auth-otp-checks",a))}function e(b,c){k.show();a.ajax("validate-otp.html",{method:"post",params:{otp_name:b,paystationRequestId:c},success:function(a){!a||"APPROVED"!==a.status&&"PENDING"!==a.status?(m("#otp_id").addClass("a-form-error"),m("#otpBadCode").removeClass("hidden"),k.hide()):(m("#isFormValidated").val("1"),u.submit())},error:function(a){k.hide()}})}function n(){m("#otp_id").removeClass("a-form-error");m("#otpBadCode").addClass("hidden")}
function b(){f.increaseCount(z.metricPrefix+z.resend,1,1);var b="1"===m("#isPaystationFlow").val(),c;b?(c="resend-otp.html?returnHtml\x3d0\x26isPaystationFlow\x3d1",k.show()):c="resend-otp.html?returnHtml\x3d0";a.ajax(c,{method:"get",success:function(a){b&&(a&&1===a.successful&&(m("#authSourceId").val(a.authSourceId),m("#paystationRequestId").val(a.paystationRequestId)),k.hide())},error:function(a){b&&k.hide()}})}var m=a.$,v,u,z={metricPrefix:"Payauth-",resend:"Resend"};a.on("checkout:reload:payauth",
function(){v=m("#resend_form");u=m("#otp_form");u.submit(function(a){var b=m(a.currentTarget);if("1"===b.find('input[id\x3d"isPaystationFlow"]').val()&&(n(),"1"!==b.find('input[id\x3d"isFormValidated"]').val()))return a=b.find('input[id\x3d"otp_id"]').val(),b=b.find('input[id\x3d"paystationRequestId"]').val(),e(a,b),!1});v.submit(function(a){"1"===m("#isPaystationFlow").val()&&n();b();return!1});h();m("#otp_id").unbind("keyup").bind("keyup",h)})});"use strict";q.when("A","ajax-utility","client-side-metrics",
"loading-spinner-controller","pay-common-lib","pay-common-util","page-conductor","page-transition-controller","quantity-service","weblab-helper").register("pay-gil",function(a,k,g,c,d,f,l,h,e,n){function b(a){G=a.popover;var b=r(G);q("#gil-estimates-popover-"+b+" .gil-popover-content").html("");q("#gil-estimates-popover-"+b+" .gil-popover-error").html("");a.popover.updatePosition(!0)}function m(a){G=a.popover;var b=r(G),d=q("#gil-estimates-popover-"+b);d.find("input[name\x3dgil-subtype]").val(b);
c.showSpinner(d,!1,G);a="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime();var e="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(b);q.ajax({type:"POST",url:a,data:e,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return k.jsonify(a)},success:function(a,e,f){r(G)===b&&(g.increaseCount("Checkout:GIL:"+b+":IneligiblePopoverSuccess",1),e=G,c.hideSpinner(d),a&&a.errors&&0<a.errors.length?d.find(".gil-popover-error").show():a&&a.widgetHTML?
d.find(".gil-popover-content").html(decodeURIComponent(a.widgetHTML)):d.find(".gil-popover-error").show(),e.updatePosition(!0))},error:function(a){r(G)===b&&(g.increaseCount("Checkout:GIL:"+b+":IneligiblePopoverError",1),a=G,c.hideSpinner(d),d.find(".gil-popover-error").show(),a.updatePosition(!0))}})}function v(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")}function u(a){a.$event.preventDefault();var b=r(G),d=q("#gil-estimates-popover-"+b);c.showSpinner(d,
!1,G);var f=z(a.$currentTarget.parents("#gil-estimates-popover-"+b));c.showSpinner(d,!1,G);e.callBatch(f,{success:function(c,d,e){r(G)===b&&(g.increaseCount("Checkout:GIL:"+b+":SubmitIneligiblePopoverSuccess",1),v(a),h.show(),1==parseInt(q("input[name\x3d'gil-rendered-using-apx']").val(),10)&&n.isGILCreditCardEnabled()?(c=q(".pmts-select-payment-instrument-form"),d=G,"APX_PSP_TO_RCX_SPC"==(d.attrs?d.attrs("data").onSubmit:d.data.onSubmit)&&c&&0<c.length?l.continueClicked(null,c):g.increaseCount("Checkout:GIL:"+
b+"Popover:ErrorRedirectingToSPC",1)):B(b))},error:function(a){r(G)===b&&(g.increaseCount("Checkout:GIL:"+b+":SubmitIneligiblePopoverError",1),a=G,c.hideSpinner(d),d.find(".gil-popover-error").show(),a.updatePosition(!0))},isTrial:0})}function z(a){var b={};a.find(".gil-ineligible-items").children(".gil-ineligible-item").each(function(a,c){a=q(c).find('input[name^\x3d"ineligible-item"]').val();b[a]=0});return b}function p(a){a.$event.preventDefault();var b=q("#gil-ineligible-"+a.data.subtype).find(".gil-ineligible-items"),
c=b.data("index"),d=b.data("size"),c=(c+("next"===a.data.direction?1:-1)+d)%d,d=(c+1)%d;b.find(".gil-ineligible-item").addClass("aok-hidden").removeClass("a-span-last");a=b.find("#gil-ineligible-item-"+c);d=b.find("#gil-ineligible-item-"+d);a.removeClass("aok-hidden");d.addClass("a-span-last").removeClass("aok-hidden");b.data("index",c)}function B(b){f.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{handler:"new-gil-payment",subtype:b},{successHandler:function(c,d,e){g.increaseCount("Checkout:GIL:"+
b+":NewToExistingSuccess",1);l.ajaxUpdatePage(c,d,e);f.scrollTopTo(q("#existing-payment-methods [value\x3d"+b+"]"));if(l.isSPP())a.on("checkout:afterReload",function D(){q("#existing-gil input[value\x3d"+b+"]").trigger("click");a.off("checkout:afterReload",D)});else q("#existing-gil input[value\x3d"+b+"]").trigger("click")},errorHandler:function(a,c,d){g.increaseCount("Checkout:GIL:"+b+":NewToExistingError",1);l.ajaxUpdatePage(a,c,d)}})}function r(a){return a.attrs?a.attrs("data").subtype:a.data.subtype}
function t(){y&&(a.declarative("gil-close-popover",["click"],v),a.declarative("gil-submit-popover",["click"],u),a.declarative("gil-ineligible-pagination",["click"],p));q("#gil-cc-payment-type").length&&(a.off("a:popover:beforeShow:gil-estimates",b),a.off("a:popover:show:gil-estimates",m),a.on("a:popover:beforeShow:gil-estimates",b),a.on("a:popover:show:gil-estimates",m));q("#gil-payment-type").length&&(a.off("a:popover:beforeShow:gil-si-estimates",b),a.off("a:popover:show:gil-si-estimates",m),a.on("a:popover:beforeShow:gil-si-estimates",
b),a.on("a:popover:show:gil-si-estimates",m));y=!1}var q=a.$,y=!0,G;a.on("checkout:reload:payselect",t);a.on("checkout:reload:spp-payment",t);return{submitNewGilPayment:B,displayGILEstimatesMobile:function(a,b,c){var d="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime(),e="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(a);f.makeAjaxCall(d,e,{successHandler:function(c,d,e){var f=k.jsonify(c);f&&!f.errors&&f.widgetHTML?g.increaseCount("Checkout:GIL:"+
a+":Mobile:IneligibleSubPageSuccess",1):g.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageError",1);b(c,d,e)},errorHandler:function(b){g.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageError",1);c(b)}})},actionCloseGilMobileSubpage:function(a){a.$event.preventDefault();q("#gil-estimates-subpage").remove();q(f.pages.main.pageId).show()},actionSubmitGilMobileSubpage:function(a,b,c){a.$event.preventDefault();q("#gil-ineligible-view");var d=z(a.$currentTarget.parents("#gil-ineligible-view"));
e.callBatch(d,{success:function(c,d,e){g.increaseCount("Checkout:GIL:"+a.data.subtype+":Mobile:SubmitIneligibleSubPageSuccess",1);b(c,d,e)},error:function(b){g.increaseCount("Checkout:GIL:"+a.data.subtype+":Mobile:SubmitIneligibleSubPageError",1);c(b)},isTrial:0})}}});"use strict";q.when("A","pay-common-util","page-detector").register("new-verified-debit-card",function(a,k,g){function c(){d=g.isMobile()?k.getElements(f):k.getElements(l);h=d.newVDC.find("#expirationInput");e=d.newVDC.find("#vdcCvvNumInput");
n=d.newVDC.find("#vdcYear");b=d.newVDC.find("#vdcMonth");m=new Date;v=m.getFullYear()+20;u=m.getMonth();0===u&&(u=12,v--)}var d={},f={newVDC:"#new-verified-debit-card"},l={newVDC:"#new-verified-debit-cards-table"},h,e,n,b,m,v,u;return{showExpiryDateAndCvv:function(){c();n.find("option:selected").removeAttr("selected");b.find("option:selected").removeAttr("selected");d.newVDC.find("#isSBIInternationalMaestroSelected").val("0");h.show();e.show()},hideExpiryDateAndCvv:function(){c();var a=b.val(u).find("option[value\x3d"+
u+"]"),f=n.val(v).find("option[value\x3d"+v+"]");a.attr("selected",!0);f.attr("selected",!0);d.newVDC.find("#isSBIInternationalMaestroSelected").val("1");h.hide();e.hide()}}});"use strict";q.when().register("recommendation-helper",function(){return{}});"use strict";q.when("A").register("apb-limit-messaging-helper",function(a){var k=a.$;return{renderAPBMessagingRemainingBalance:function(a,c,d,f){var l=k(".am-balance").html(),h=a.remainingBalance,e=a.purchaseTotal,n=a.isPurchaseTotalInSpan;0<c-d?h=
e:0>c-f&&(h=l);n?a.balanceApplied.html(h):a.balanceApplied.text(h)},displayAPBRedeemableLimitExhaustedMessaging:function(a){a.gcRadioContainer.addClass("hidden");a.gcCheckboxContainer.addClass("hidden");a.gcCheckbox.attr("disabled","disabled");a.gcRadio.attr("disabled","disabled");a.shortMsg.hide();a.longMsg.hide();a.amazonMoneyLimitBreachedMsg.removeClass("hidden");a.amazonMoneyLimitBreachedMsg.show()},renderAPBInsufficientMessaging:function(a,c,d){c==d?(a.shortMsg.show(),a.longMsg.hide()):(a.longMsg.show(),
a.shortMsg.hide())}}});"use strict";q.when("A","jQuery","client-side-metrics","ready").register("temporary-preference-indicator",function(a,k,g){function c(){d()&&k.ajax({type:"GET",url:"/gp/shopwithpoints/temporaryPreference/has-active-temporary-preference.html",async:!0,dataType:"json",success:function(a){a.hasOwnProperty("Result")?(f=a.Result,g.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::Ajax::Success",1),g.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::TPPCheckBackendCall::Success",
1)):g.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::TPPCheckBackendCall::Failure",1)},error:function(){g.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::Ajax::Failure",1)}})}function d(){return"1"===k("meta[name\x3dSWP_TPP_FEATURE_ENABLED]").attr("content")}var f="False";a.on("checkout:reload:payselect",c);a.on("checkout:reload:spp-payment",c);a.on("checkout:reload:pay",c);return{hasActiveTemporaryPreference:function(){return"True"===f},isTemporaryPaymentPreferenceFeatureEnabled:d}});
q.when().register("rentals-ineligible-util",function(){return{}});q.when().register("rentals-ineligible",function(){return{}});"use strict";q.when("A","cvf","page-detector","weblab-helper","ready").register("cvf-old-amazon-aui-fixes",function(a,k,g,c){function d(){a.$(".cvf-widget-form .a-button-dropdown .a-button-text").css("text-overflow","unset")}function f(){var a=m(this).parent(),b=a.find(".a-native-dropdown option")[0];if(b&&b.hasAttribute("data-a-html-content")){var c=[];a.find(".cvf-widget-input.a-native-dropdown option").each(function(){c.push({phone_country_code:m(this).data("a-html-content"),
country_iso:m(this).val()})});var d=setInterval(function(){if(m(".a-popover-inner ul").length){var a="rtl"===m("html").attr("dir");m(".a-popover-inner ul").addClass("a-cvf-list-link");m.each(c,function(b,c){if(b=c.phone_country_code){if(a){b=b.split("+");var d=b[1];b=b[0].trim()+" "+d+"+"}m(".a-popover-inner [data-value\x3d'"+c.country_iso+"']").html(b)}});clearInterval(d)}},0)}m(".cvf-widget-form .a-button-dropdown").die("click")}function l(){var a=m(this).data("value");m(".cvf-widget-form .a-native-dropdown.cvf-widget-input").val(a).change()}
function h(){var a=m(this).parent().find(".a-dropdown-prompt"),b=m(this).find("option:selected").html().trim(),c=setTimeout(function(){a.html(b);clearTimeout(c)},0)}function e(){a.$(".cvf-widget-form .a-alert-inline.cvf-hidden").remove()}function n(){0===m(".cvf-widget-form").length&&(m("#apx-content .a-alert-info").first().remove(),m("[data-testid\x3d'pmts-cod-cash-description']").closest(".pmts-portal-component").find(".a-radio input").trigger("click"))}function b(){if(!v)if(u)a.on("a:pageUpdate a:ajax:complete",
e);else a.on("a:pageUpdate a:ajax:complete",d),m(".cvf-widget-form .a-button-dropdown").live("click",f),m(".a-cvf-list-link a").live("click",l),m(".cvf-widget-input.a-native-dropdown").live("change",h);a.on("cvf:verification:complete",n)}var m=a.$,v=g.isMobile(),u=p.P&&p.P.AUI_BUILD_DATE;c.isCvfOldAmazonUiFixesEnabled()&&(a.on("checkout:reload:payselect",b),a.on("checkout:reload:spp-payment",b))});"use strict";q.when("A","page-detector").register("alipay-detector",function(a,k){var g=a.$,c=function(){var a=
g("input[name\x3d'isAlipayAppPayment']");0<a.length&&k.isMobileSpc&&a.val("1")},d=function(a){},f=function(){var a=g("input[name\x3d'isAlipayRedirect']");0<a.length&&k.isMobileSpc&&a.val("1")},l=function(a){};a.on("checkout:reload:spc",function(){g("input[name\x3d'isAlipayAppPayment']").length&&q.when("safe-mash").execute(function(a){a=p.cordova.require("cordova/exec");a(c,d,"AlipayPlugin","isAlipayInstalled",[]);g("input[name\x3d'isAlipayRedirect']").length&&a(f,l,"AlipayPlugin","isAlipayFailReturnSupported",
[])})})});"use strict";q.when("A","page-transition-controller","page-detector").execute(function(a,k,g){function c(){var a=d("#backButtonProtection");a.length&&"1"===a.val()&&(k.showPageTransition(),document.location.reload())}var d=a.$;q.register("back-button-protection",function(){return{markAsDirty:function(){d("#backButtonProtection").val(1)}}});a.on("checkout:reload:spc",c);a.on("checkout:reload:spp-revieworder",c)});"use strict";q.when("A","page-transition-controller","loading-spinner-controller",
"ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","delivery-preferences-csm-helper").register("delivery-preferences-controller",function(a,k,g,c,d,f,l,h,e){function n(){l.isTabletSpc()&&(t=r("#spc-orders .delivery-preferences-options"),w(),t.find("select").trigger("change"),u())}function b(){var a=t.find("input[name\x3dpreference]:checked").val(),b=t.find("select[name\x3dSafePlaceLocation]");"NeighborDelivery"===a?(t.find("input[name\x3dneighbor-name]").removeAttr("disabled").removeClass("a-form-disabled"),
t.find("input[name\x3dneighbor-house]").removeAttr("disabled").removeClass("a-form-disabled"),d.isSPP()?q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),t.find(".safe-place-error").hide()):"SafePlaceDelivery"===a?(d.isSPP()?q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"enabled"})}):b.removeAttr("disabled").closest(".a-button").removeClass("a-button-disabled"),
t.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),t.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),t.find(".neighbor-name-error").hide(),t.find(".neighbor-house-error").hide()):(t.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),t.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),d.isSPP()?q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):
b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),t.find(".neighbor-name-error").hide(),t.find(".neighbor-house-error").hide(),t.find(".safe-place-error").hide());m(!0)}function m(a){var b=t.find("input[name\x3dpreference]:checked").val();t.find(".safe-place-error").hide();t.find(".neighbor-name-error").hide();t.find(".neighbor-house-error").hide();t.find("input").removeClass("a-form-error");t.find("div.a-input-text-wrapper").removeClass("a-form-error");t.find("select").closest(".a-button").removeClass("a-button-error");
0<r("div.spc-tablet").length?t.find(".set-delivery-preferences-button").removeClass("a-button-disabled"):t.find(".set-delivery-preferences-button").show();t.find(".save-disabled").hide();t.find(".current-blocker-content").text("");var c=!1;if("NeighborDelivery"===b){var d=t.find("input[name\x3dneighbor-name]");d.data("defaultValueRemoved")&&d.val()||(t.find(".neighbor-name-error").show(),d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),t.find(".current-blocker-content").html(t.find(".neighbor-name-error-text").text()),
c=!0);d=t.find("input[name\x3dneighbor-house]");d.data("defaultValueRemoved")&&d.val()||(t.find(".neighbor-house-error").show(),d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),t.find(".current-blocker-content").html(t.find(".neighbor-house-error-text").text()),c=!0)}else"SafePlaceDelivery"===b&&(d=t.find("select[name\x3dSafePlaceLocation]"),d.val()||(t.find(".safe-place-error").show(),d.closest(".a-button").addClass("a-button-error"),t.find(".current-blocker-content").html(t.find(".safe-place-error-text").text()),
c=!0));d=r("#disableSaveBtnWhenNoDeliveryPrefSelected").val();if(a&&c||"true"===d&&b===F)0<r("div.spc-tablet").length?t.find(".set-delivery-preferences-button").addClass("a-button-disabled"):t.find(".set-delivery-preferences-button").hide(),t.find(".save-disabled").show();return!c}function v(a){a&&a.$event&&a.$event.preventDefault();a="hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26";var b="",f=t.find(".popover-deliv-prefs-content");f.data("obfuscatedEntityId")?
b=f.data("obfuscatedEntityId"):t.data("obfuscatedEntityId")&&(b=t.data("obfuscatedEntityId"));a+="obfuscatedEntityId\x3d"+b+"\x26";b=t.find("input[name\x3dpreference]:checked").val();""!==b&&(a+="prefDelLocation\x3d"+b+"\x26","NeighborDelivery"===b?(a+="neighborName\x3d"+encodeURIComponent(t.find("input[name\x3dneighbor-name]").val())+"\x26",a+="houseNo\x3d"+encodeURIComponent(t.find("input[name\x3dneighbor-house]").val())+"\x26"):"SafePlaceDelivery"===b&&(a+="safePlaceLocation\x3d"+t.find("select[name\x3dSafePlaceLocation]").val()+
"\x26"),b=t.find("input[name\x3ddefaultPreference]:checked").val(),b!==F&&""!==b&&(a+="isDefaultPreference\x3d1"));0<r("div.spc-tablet").length?k.show():g.showSpinner(t.find(".popover-deliv-prefs-content"),!1,H);e.recordCSMWithCurrentFieldValues("popover-submitted","preference","defaultPreference");r.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-delivery-preference.html",data:a,dataType:"text",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc",
"x-amz-checkout-transition":"ajax"},success:function(a,b,e){y=!0;0<r("div.spc-tablet").length?k.hide():g.hideSpinner(t.find(".popover-deliv-prefs-content"));e.getResponseHeader("x-amz-checkout-page")?(t.find(".a-button-close").trigger("click"),d.ajaxUpdatePage(a,b,e)):(a=c.jsonify(a),d.redirect(a));h.increaseCount("checkoutSpcDeliveryPref-save",1)},error:function(a,b,c){0<r("div.spc-tablet").length?k.hide():g.hideSpinner(t.find(".popover-deliv-prefs-content"));m(!0)}})}function u(){t.find("input[name\x3d'neighbor-name'], input[name\x3d'neighbor-house']").unbind("focus").bind("focus",
function(){if(!r(this).data("defaultValueRemoved")){if(l.isMobileSpc()||l.isDesktopSpc())r(this).val(""),r(this).css("color","black");r(this).data("defaultValueRemoved",!0)}}).each(function(){(l.isMobileSpc()||l.isDesktopSpc())&&r(this).data("defaultValueRemoved")&&r(this).css("color","black")});t.find("input:radio[name\x3dpreference]").unbind("click").bind("click",b);t.find("input[name^\x3dneighbor]").unbind("keyup").bind("keyup",function(){m(!1)});0<r("div.spc-tablet").length?t.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",
p):t.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",function(){m(!1)})}function p(a){m(!0)&&v(a)}function w(a){var b=r("#spc-orders .delivery-preferences-options"),c,d="";a?(c=a.$currentTarget.find("input"),d=b.find("input[name\x3dpreference]:checked").val()):c=b.find("input[name\x3dpreference]:checked");b=c.val();if(d!==b){t.find(".expand-content").hide();var d=c,e=d.closest(".delivery-preferences-options");e.find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");
e.find("input").attr("checked",!1);d.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");d.attr("checked",!0);"NeighborDelivery"===b||"SafePlaceDelivery"===b?c.closest(".deliverypreference-option").siblings(".expand-content").show():a&&v(a)}}function B(a){(a=t.find("#delivery-preferences-set-default-checkbox"))&&1===a.length&&(a.prop("checked")?h.increaseCount("checkoutSpcDeliveryPref-setAsDefault",1):h.increaseCount("checkoutSpcDeliveryPref-setAsTemporary",
1))}var r=a.$;if(!r("html").hasClass("a-ie6")){var t,H,y;a.on("a:popover:beforeShow",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-delivprefs")&&(a.popover.$popover.find(".a-popover-inner").html(t.find(".current-blocker-content").text()),a.popover.updatePosition())});a.on("a:popover:show",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(h.increaseCount("checkoutSpcDeliveryPref-open",1),H=a.popover,t=H.$popover,y=!1,u(),e.recordCSMWithCurrentFieldValues("popover-displayed",
"preference","defaultPreference"),b(),t.find("select").trigger("change"))});a.on("a:popover:dismiss",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(y||h.increaseCount("checkoutSpcDeliveryPref-dismissed",1))});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(y||e.recordCSM("popover-dismissed"))});a.declarative("delivery-preferences-switch-tablet",["click"],function(a){w(a)});a.declarative("delivery-preferences-expander-toggle",
["click"],function(a){f.toggleExpanderContent(a)});a.declarative("set-delivery-preferences",["click","touchend"],function(a){a.$event.preventDefault();f.protectAgainstDoubleAction("set-delivery-preferences")||m(!0)&&v()});a.declarative("delivery-preferences-set-default-checkbox-triggered","change",B);a.on("checkout:reload:spc",n)}});"use strict";q.when("A","page-detector","time-left-formatter","weblab-helper").register("fast-track-controller",function(a,k,g,c){function d(){for(var b in u)u[b]&&clearInterval(u[b]);
a.defer(f)}function f(){m.DAY=b("#fasttrack-day").html();m.DAYS=b("#fasttrack-days").html();m.HOUR=b("#fasttrack-hour").html();m.HOURS=b("#fasttrack-hours").html();m.AND=b("#fasttrack-and").html();m.MINUTE=b("#fasttrack-minute").html();m.MINUTES=b("#fasttrack-minutes").html();m.SECOND=b("#fasttrack-second").html();m.SECONDS=b("#fasttrack-seconds").html();(b("#isfresh").length&&b(".checkout.spc-mobile").length||b("#lazy-fresh-promise-delivery-message").length?b("#spc-form"):b("#spc-orders")).find(".fasttrack-span").each(function(){var d=
b(this),e=d.find("input[name\x3d'countdownId']").val();c.isTSPCGoldBoxTimerFixEnabled()?isNaN(v[e])&&(v[e]=parseInt(d.find("input[name\x3d'fasttrackExpiration']").val()),p[e]=a.now()/1E3+v[e]):(v[e]=parseInt(d.find("input[name\x3d'fasttrackExpiration']").val()),p[e]=a.now()/1E3+v[e]);l(d.find("input[name\x3d'countdownThreshold']").val(),d,d.find("input[name\x3d'showSimplifiedCountdown']").val(),e);d.show()})}function l(a,b,c,d){0>=v[d]?e(b,null):a&&0<a&&v[d]>a?b.find("span.fasttrackavailable").hide():
(h(b,c),u[d]=setInterval(function(){h(b,c,d)},1E3))}function h(c,d,f){0<v[f]?(v[f]=Math.round(p[f]-a.now()/1E3),d=g.getTimeLeftFormatted(v[f],1===d||"1"===d?!0:!1,m),b("html").hasClass("a-tablet")?c.find("span[data-field\x3d'fasttrackcountdown']").html("\x26nbsp;"+d):c.find("span[data-field\x3d'fasttrackcountdown']").html(d),c.find("span.fasttrackexpired").hide(),c.find("span.fasttrackcountdown").show(),c.find("span.fasttrackavailable").show()):e(c,f)}function e(a,b){b?(u[b]&&clearInterval(u[b]),
a.find("span.fasttrackavailable").hide(),a.find("span.fasttrackexpired").show()):clearInterval(u[b])}function n(){d()}var b=a.$;if(!b("html").hasClass("a-ie6")){var m={},v={},u={},p={};a.on("checkout:reload:spc",d);a.on("checkout:reload:spp-revieworder",d);return{spcLiteLazyLoadFastTrack:n}}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","client-side-metrics").register("gc-redeem-controller",function(a,k,g,c,d){function f(a){if(!v){a.preventDefault();m(a.currentTarget);
var b;0<m("#spc-gcpromoinput").length&&(b=encodeURIComponent(m("#spc-gcpromoinput").val()));0<m("#gc-promo-input").length&&(b=encodeURIComponent(m("#gc-promo-input").val()));var d=encodeURIComponent(m("#spc-usePromoOnly").val());if(b&&0!==b.length){var f=encodeURIComponent(m("input[name\x3dpurchaseTotal]").val());m("#gc-error").hide();m("#gc-promo-success").hide();m("#gc-success").hide();m("#gc-ineligible").hide();m("#promo-success").hide();c.isSPP()?(k.blockAllActions(),k.showTransitionInContainer(m("#payment"))):
k.show();var h=(new Date).getTime();a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_pay_page_gc_add";m(".checkout.spc.aui-templatized").length&&(a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_spc_gc_add");b="purchaseTotal\x3d"+f+"\x26claimcode\x3d"+b+"\x26disablegc\x3d"+d+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+m("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+h;d=c.setAjaxTransitionHeader({"Cache-Control":"no-cache",
pragma:"no-cache","x-amz-checkout-page":"spc"});m.ajax({type:"POST",url:a,data:b,headers:d,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",complete:function(){v=!1},success:l,error:c.ajaxRedirect});v=!0}else e("addGiftCardOrPromo_NoCode")}}function l(a,b,d){var f=d.getResponseHeader("x-amz-checkout-page");if(f){if(c.ajaxUpdatePage(a,b,d),"spc"===f||"spclite"===f||"spp-revieworder"===f)(a=parseInt(m("#checkoutDisplayPage").data("delaySetTitle"),10)||parseInt(m("#gc-promo-delay").data("egcDelayUpdateRedemptionMessage"),
10)||0)?setTimeout(function(){h(d)},a):h(d)}else{a=g.jsonify(a);if(!a)return c.redirect();if(a.error)return e(a.error);if(a.errors)return e(a.errors);if(a.autohandlererror)return n(a.autohandlererror);c.redirect(a)}}function h(a){var c=a.getResponseHeader("x-updated-promo-type");a=a.getResponseHeader("x-updated-gc-applied-but-ineligible");c&&(a||m("#gc-promo-success").show(),0<m("div.spc-desktop").length?(m("#spc-gcpromoinput").removeClass("a-form-error"),m("#gc-promo-input").removeClass("a-form-error")):
(m("#spc-gcpromoinput").closest(".a-input-text-wrapper").removeClass("a-form-error"),m("#gc-promo-input").closest(".a-input-text-wrapper").removeClass("a-form-error")),"giftcard"===c?(b("applied"),a?(m("#gc-ineligible").show(),b("gcIneligible")):m("#gc-success").show()):m("#promo-success").show())}function e(a){k.hide();m("#gc-error p").hide();m("#gc-error").show();b("error");0<m("div.spc-desktop").length?(m("#spc-gcpromoinput").addClass("a-form-error"),m("#gc-promo-input").addClass("a-form-error")):
(m("#spc-gcpromoinput").closest(".a-input-text-wrapper").addClass("a-form-error"),m("#gc-promo-input").closest(".a-input-text-wrapper").addClass("a-form-error"));m(0<m("#gc-promo-input").length?"."+u[a]:"#"+a).show()}function n(a){if(a){var b=a.action,c="/gp/buy/payselect/handlers/error.html?errorType\x3d"+encodeURIComponent(a.type?a.type:b&&b.code?b.code:"string"===typeof a?a:"Unknown:pipelineJSError");"fatal"===b?c+="\x26errorAction\x3dfatal":"redirect"===b&&(a.url?c=a.url:"cart"===a.page&&(c="/gp/cart/view.html"));
p.location.href=c}else p.location.href="/gp/buy/payselect/handlers/error.html?errorType\x3dUnknown:pipelineJSError"}function b(b){var c=a.state("cxt-gc-redemption-method").method;d.increaseCount("rcxGCRedeem:"+c+":"+b,1)}var m=a.$,v=!1;if(!m("html").hasClass("a-ie6")){a.state("cxt-gc-redemption-method",{method:"type"});var u={addGiftCardOrPromo_Unknown:"UNKNOWN",addGiftCardOrPromo_NoCode:"NO_CODE",addPromo_InvalidForPurchase:"PROMO_INVALID_FOR_PURCHASE",addPromo_BadCode:"PROMO_BAD_CODE",addPromo_ExpiredCode:"PROMO_EXPIRED_CODE",
addPromo_InvalidForOrgUnit:"PROMO_INVALID_FOR_ORG_UNIT",addPromo_OfferNotYetBegun:"USED_BEFORE_START_DATE",addPromo_AlreadyRedeemed:"PROMO_ALREADY_REDEEMED",addGiftCard_AlreadyRedeemedByAnotherAccount:"GC_ALREADY_REDEEMED_BY_ANOTHER_ACCOUNT",addGiftCard_AlreadyRedeemedByThisAccount:"GC_ALREADY_REDEEMED_BY_THIS_ACCOUNT",addGiftCard_BadCode:"GC_BAD_CODE",addGiftCard_ExpiredCode:"GC_EXPIRED_CODE",addGiftCard_Cancelled:"CANCELLED_CODE",addGiftCard_WrongOrgUnit:"GC_WRONG_ORG_UNIT",addGiftCard_ServiceDown:"GC_SERVICE_DOWN",
addGiftCard_InvalidForAGS:"GC_INVALID_FOR_AGS",addGiftCard_PassedClaimByDate:"PASSED_CLAIM_BY_DATE",addGiftCard_OfferNotYetBegun:"GC_NOT_YET_BEGUN",addGiftCard_ExceededMaxLimit:"GC_EXCEED_MAX_LIMIT",addGiftCard_Disabled:"GC_DISABLED",addGiftCard_OTP_Required:"GC_OTP_REQUIRED",addGiftCard_SEVIS_Decline:"GC_SEVIS_DECLINE",addGiftCard_OCRAH_Decline:"GC_OCRAH_DECLINE",addGiftCard_DEFAULT_Message:"GC_DEFAULT_MESSAGE"};a.declarative("gc-element",["click"],function(a){var b=a.data.click;b&&null!==b&&f(a.$event)});
a.on("a:expander:redeem-gc-expander:toggle:expand",function(a){d.increaseCount("checkout:spp-payment:expand_addgc_coll",1)});m(document).delegate("#spc-gcpromoinput, #gc-promo-input","keypress",function(a){13===a.which&&f(a)});return{actionAddGiftPromotion:f,giftSystemErrorHandling:n}}});"use strict";q.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","gift-utility","weblab-helper").register("gift-popover-controller",
function(a,k,g,c,d,f,l,h,e,n){function b(){var a=T;a.find("#select-recipient").empty();for(var b=0;b<ha.length;b++){var c=K("\x3coption/\x3e").attr({value:ha[b].value}).text(ha[b].text);a.find("#select-recipient").append(c)}oa&&(b=a.find('#select-recipient option[value\x3d"'+oa+'"]').attr("selected","selected"),a.find("#select-recipient").closest("#popover-gift-connection-recipient").find(".a-placeholder").text(b.text()),ka())}function m(){a.defer(function(){K("#spc-orders").find(".gift-popover-link").each(function(){K(this).data("action")&&
K(this).removeAttr("href").attr("tabindex",0)})});K(".larger-image-link").find("a").removeAttr("href")}function v(a){var c=T;c.find(".gift-error-box").hide();c.find(".fake-label").each(function(){K(this).unbind("click").bind("click",function(){K(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&c.find(".popover-gift-top .gift-item-title span").html(a.item.title);a&&a.item&&a.item.isAutoripEligible?c.find("#gift-autorip-unavailable-msg").show():c.find("#gift-autorip-unavailable-msg").hide();
if(a&&a.obfuscatedEntityId){var d=c.find(".set-gift-options-button input");d.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,giftData:a},u);f.bindActionEnterKeyOnButton(d)}la?(ia=a&&a.item&&a.item.isAmazonFulfilled,wa=!(a&&a.address&&0===a.address.shipToSelf),ia&&(a&&a.options&&a.options.canHaveMessage||a&&a.options&&a.options.canBeWrapped)?(B(!0),c.find(".mfn-hide-prices").hide(),c.find(".include-gift-receipt").show()):ia||(B(!0),c.find(".include-gift-receipt").hide(),c.find(".mfn-hide-prices").show(),
c.find(".include-gift-message").show()),ya=c.find(".include-gift-message").is(":visible"),G()):a&&a.options&&a.options.canHidePrices?c.find(".hide-prices-checkbox").closest("div").show():c.find(".hide-prices-checkbox").closest("div").hide();a&&a.selected&&(d=M(c.find(".hide-prices-checkbox")),a.selected.hidePrices?d.attr("checked",!0):d.removeAttr("checked"));if(a&&a.item&&a.item.purchaseIsKindle){if(d=c.find(".kindle-registration-box"),d.show(),d.find(".register-kindle-customer-name").html(c.find(".gift-customer-name").html()),
!la){var d=M(c.find(".kindle-reg-radio-another-account")),h=M(c.find(".kindle-reg-radio-your-account"));a.selected.hidePrices||a.selected.isWrapped?(h.removeAttr("checked"),d.attr("checked",!0)):(d.removeAttr("checked"),h.attr("checked","checked"));M(c.find(".hide-prices-checkbox")).trigger("change")}}else c.find(".kindle-registration-box").hide();if(a&&a.options&&a.options.canHaveMessage){a&&a.selected&&(d=a.selected.message,h=M(c.find(".include-gift-message-checkbox")),d&&d.length?(c.find("textarea[name\x3d'gift-message-text']").val(d),
t(!0)):null===d&&(a.selected.isWrapped||a.selected.hasReceipt)?(h.removeAttr("checked"),c.find(".textarea[name\x3d'gift-message-text']").val("")):(c.find("textarea[name\x3d'gift-message-text']").val(""),d="",la?(d+=c.find(".sample-gift-msg-greeting").html(),a&&a.address&&a.address.firstName&&!wa&&(d+=" "+a.address.firstName),d=d+",\n"+c.find(".sample-gift-msg").html(),d+="\n"):(d+=c.find(".sample-gift-msg").html(),d+="\n\n"),d+=c.find(".sample-gift-msg-from").text(),d=la?d+e.getNameWithNoTitle(c.find(".gift-customer-name").html()):
d+e.getFirstName(c.find(".gift-customer-name").html()),c.find("textarea[name\x3d'gift-message-text']").val(d),!la||wa&&ya||t(!0)));var l=K(".gift-message-warning").length,d=function(){la&&t(!0);D(a.options.maxMessageChars,a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);if(l){var b=T.find("textarea[name\x3d'gift-message-text']");e.toggleGiftMessageWarning(b,T)}};if(a&&a.options){var n=c.find("textarea[name\x3d'gift-message-text']");n.bind("keyup",d);n.bind("mouseup",d);D(a.options.maxMessageChars,
a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);l&&e.toggleGiftMessageWarning(n,c);M(c.find(".include-gift-message-checkbox")).bind("change",function(){var b=K(this).is(":checked"),d=a.options.maxMessageChars,f=a.options.maxMessageLines,h=a.options.hasFixedGiftMsgLimit,g=T,k=g.find("textarea[name\x3d'gift-message-text']");b?la&&y():(0<g.find(".validateInputCharactersOnBlur.a-form-error").size()&&(g.find(".validateInputCharactersOnBlur.a-form-error").removeClass("a-form-error"),0<g.find("#onblur-character-validation-error-gift-message-text").size()&&
g.find("#onblur-character-validation-error-gift-message-text").remove()),la?G():(k.val(""),D(d,f,h)));l&&e.toggleGiftMessageWarning(n,c)})}}else c.find(".popover-gift-message-text").css("visibility","hidden"),c.find(".include-gift-message").css("visibility","hidden"),la&&(c.find(".include-gift-message").hide(),c.find(".popover-gift-message").css("visibility","hidden")),c.find(".popover-gift-message-not-available").show();a&&a.options&&!a.options.canBeWrapped?(c.find(".wrap-option").hide(),c.find(".popover-gift-no-wrap-available").show(),
c.find(".hide-prices-amazon-msg").hide(),c.find(".hide-prices-note").hide(),c.find(".hide-prices-merchant-msg").show(),M(c.find(".hide-prices-checkbox")).attr("disabled",!1)):a&&a.item&&a.item.isAmazonFulfilled?(c.find(".wrap-option").hide(),c.find(".popover-gift-fba-wrap").show(),c.find(".hide-prices-amazon-msg").show(),c.find(".hide-prices-merchant-msg").hide(),(d=a.options.wraps[0].imageurl)&&0<d.length&&(c.find(".large-preview").find("img").attr("src",d),c.find(".large-preview").show(),c.find(".fba-wrap-checkbox").show(),
h=c.find(".larger-image-link"),h.unbind("click").bind("click",{imageURL:d},N),f.bindActionEnterKeyOnButton(h)),a.options.wraps[0].description&&c.find(".gift-wrap-title").show().html(a.options.wraps[0].description),"1"===K("#multipleAFNGiftWrapOption").val()?a.options&&a.options.wraps&&1<=a.options.wraps.length&&(d=c.find(".popover-gift-amazon-wrap"),q(c,d),aa(a,"afn",d)):a.options&&a.options.wraps&&1===a.options.wraps.length?(c.find(".popover-gift-amazon-wrap").hide(),c.find(".popover-gift-merchant-wrap").hide(),
c.find(".fba-wrap-checkbox .gift-wrap-price").html(a.options.wraps[0].price),h=M(c.find(".amazon-gift-wrap")),h.val(a.options.wraps[0].id),d=M(c.find(".hide-prices-checkbox")),a.selected.isWrapped?(h.attr("checked",!0),a.item.purchaseIsKindle||(d.attr("checked",!0),d.attr("disabled",!0),c.find(".hide-prices-note").show())):(h.removeAttr("checked"),d.attr("disabled",!1),c.find(".hide-prices-note").hide())):a.options&&a.options.wraps&&1<a.options.wraps.length&&(d=c.find(".popover-gift-amazon-wrap"),
q(c,d),ea(a,"afn",d))):(c.find(".wrap-option").hide(),M(c.find(".hide-prices-checkbox")).removeAttr("disabled"),c.find(".hide-prices-amazon-msg").hide(),c.find(".hide-prices-note").hide(),c.find(".hide-prices-merchant-msg").show(),c.find(".large-preview").hide(),d=c.find(".popover-gift-merchant-wrap").show(),d.find(".mfn-wrap-copy").remove(),ea(a,"mfn",d));la&&(W(),P(),E());if(0<K(".enable-gift-connections").length){c.find("#popover-gift-connection select.a-touch-select-input").each(function(){K(this).unbind("change").bind("change",
function(){var a=K(this),b=a.siblings("a.a-placeholder"),a=a.find(":selected").text();b.text(a);return!1})});c.find("#select-recipient").bind("change",function(a){R(a);return!1});c.find("#select-occasion").bind("change",function(a){ra(a);return!1});c.find("#input-recipient-first-name").keyup(function(){ka()});c.find("#input-recipient-last-name").keyup(function(){ka()});c.find("#popover-gift-connection-recipient").unbind("click").bind("click",function(a){a=T;ja||a.find("#select-recipient-spinner").show()});
oa=F;if(a.giftConnection){typeof a.giftConnection.giftlistTypeId!==F&&"0"===a.giftConnection.giftlistTypeId&&typeof a.giftConnection.occasionId!==F&&"0"===a.giftConnection.occasionId&&c.find("#include-gift-connection-checkbox").attr("checked",!1);a.giftConnection.firstName&&c.find("#input-recipient-first-name").val(a.giftConnection.firstName);a.giftConnection.lastName&&c.find("#input-recipient-last-name").val(a.giftConnection.lastName);if("1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)d=
c.find('#select-recipient option[value\x3d"'+a.giftConnection.giftlistTypeId+'"]').attr("selected","selected"),c.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(d.text()),c.find(".gift-connection-recipient-extra").show();if(a.giftConnection.giftlistId&&"0"!==a.giftConnection.giftlistId)oa=a.giftConnection.giftlistId;else if("0"===a.giftConnection.giftlistTypeId||"1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)oa=a.giftConnection.giftlistTypeId;
a.giftConnection.occasionId&&(d=c.find('#select-occasion option[value\x3d"'+a.giftConnection.occasionId+'"]').attr("selected","selected"),c.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(d.text()));a.giftConnection.occasionMonth&&(d=c.find('#select-occasion-month option[value\x3d"'+a.giftConnection.occasionMonth+'"]').attr("selected","selected"),c.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(d.text()));a.giftConnection.occasionDay&&
(d=c.find('#select-occasion-day option[value\x3d"'+a.giftConnection.occasionDay+'"]').attr("selected","selected"),c.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(d.text()));a.giftConnection.age&&(d=c.find('#select-occasion-age option[value\x3d"'+a.giftConnection.age+'"]').attr("selected","selected"),c.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(d.text()));if("1"===a.giftConnection.occasionId||"2"===a.giftConnection.occasionId)c.find(".gift-connection-occasion-extra").show(),
"2"===a.giftConnection.giftlistTypeId&&c.find("#select-occasion-age-row").show();a.giftConnection.hasReminder&&"0"===a.giftConnection.hasReminder&&c.find("#occasion-has-reminder-checkbox").attr("checked",!1)}(!a.giftConnection||typeof a.giftConnection.occasionId===F||"1"!==a.giftConnection.occasionId&&"2"!==a.giftConnection.occasionId&&"3"!==a.giftConnection.occasionId)&&ka();ha&&(typeof oa!==F||a.registryId in pa)?(typeof oa===F&&(oa=pa[a.registryId]),b(),c.find("#select-recipient").show(),c.find("#select-recipient-spinner").hide(),
ja=!0):(ja=!1,typeof oa!==F?ta():ta(a.registryId))}T.find(".content-container").css("visibility","visible");va.updatePosition(!0);g.hideSpinner(c.find(".popover-content-main"))}function u(a){var b=T,e="";if(!(0<b.find(".validateInputCharactersOnBlur.a-form-error").size())){a&&a.data&&a.data.obfuscatedentityid&&(e+="obfuscatedEntityId\x3d"+a.data.obfuscatedentityid+"\x26");ia&&(e+="isAFN\x3d1\x26");M(b.find(".include-gift-receipt-checkbox")).is(":checked")&&(e+="includeReceipt\x3d1\x26");M(b.find(".include-gift-message-checkbox")).is(":checked")?
(e+="includeMessage\x3d1\x26message\x3d"+encodeURIComponent(b.find("textarea[name\x3d'gift-message-text']").val())+"\x26",e+="maxChars\x3d"+a.data.giftData.options.maxMessageChars+"\x26",e+="maxLines\x3d"+a.data.giftData.options.maxMessageLines+"\x26"):e+="includeMessage\x3d0\x26";e=M(b.find(".hide-prices-checkbox")).is(":checked")?e+"hidePrices\x3d1\x26":e+"hidePrices\x3d0\x26";b.find(".kindle-registration-box").is(":visible")&&(e+="isKindlePurchase\x3d1\x26");var f;if(b.find(".popover-gift-fba-wrap").is(":visible"))if(b.find(".popover-gift-amazon-wrap").is(":visible")){if((f=
b.find("input[name\x3d'afn-gift-wrap']:checked").eq(0).val())&&f.length)for(e+="giftWrap\x3d"+f+"\x26",f=0;f<a.data.giftData.options.wraps.length;f++)if(b.find(".popover-gift-amazon-wrap").find(".afn-wrap-"+f).is(":checked")){e+="currencyAmount\x3d"+a.data.giftData.options.wraps[f].priceAmount+"\x26";e+="currencyUnit\x3d"+a.data.giftData.options.wraps[f].unit+"\x26";break}}else f=M(b.find(".amazon-gift-wrap")),f.is(":checked")&&(e+="giftWrap\x3d"+f.val()+"\x26",a.data.giftData.options&&(e+="currencyAmount\x3d"+
a.data.giftData.options.wraps[0].priceAmount+"\x26",e+="currencyUnit\x3d"+a.data.giftData.options.wraps[0].unit+"\x26"));else if(b.find(".popover-gift-merchant-wrap").is(":visible")&&(f=b.find("input[name\x3d'mfn-gift-wrap']:checked").eq(0).val())&&f.length)for(e+="giftWrap\x3d"+f+"\x26",f=0;f<a.data.giftData.options.wraps.length;f++)if(b.find(".popover-gift-merchant-wrap").find(".mfn-wrap-"+f).is(":checked")){e+="currencyAmount\x3d"+a.data.giftData.options.wraps[f].priceAmount+"\x26";e+="currencyUnit\x3d"+
a.data.giftData.options.wraps[f].unit+"\x26";break}if(0<K(".enable-gift-connections").length)if(b.find("#include-gift-connection-checkbox").is(":checked")){e+="includeGiftConnection\x3d1\x26";a=b.find("#select-recipient").val();e+="gcGiftlistTypeId\x3d"+a+"\x26";if("1"===a||"2"===a)e+="gcFirstName\x3d"+b.find("#input-recipient-first-name").val()+"\x26",e+="gcLastName\x3d"+b.find("#input-recipient-last-name").val()+"\x26";f=b.find("#select-occasion").val();e+="gcOccasionId\x3d"+f+"\x26";if("1"===f||
"2"===f)e+="gcMonth\x3d"+b.find("#select-occasion-month").val()+"\x26",e+="gcDay\x3d"+b.find("#select-occasion-day").val()+"\x26","1"===f&&"2"===a&&(e+="gcAge\x3d"+b.find("#select-occasion-age").val()+"\x26"),e+="gcHasReminder\x3d"+(b.find("#occasion-has-reminder-checkbox").is(":checked")?"1":"0")+"\x26"}else e+="includeGiftConnection\x3d0\x26";(a=K("input#executionId").val())&&(e+="executionId\x3d"+a+"\x26");a=(new Date).getTime();e+="isClientTimeBased\x3d"+K("input[name\x3d'useCtb']").val()+"\x26returnjson\x3d1\x26isDecoupleSPC\x3d1\x26hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+
a;d.isSPP()&&(va.hide(),a=K("#setOrderingPrefsCheckbox"),a.length&&a.is(":checked")&&(e+="\x26saveAsDefaultsSelected\x3d1"));k.show();a=d.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});K.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-gift.html",data:e,dataType:"text",async:!0,cache:!1,headers:a,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,e,f){f.getResponseHeader("x-amz-checkout-page")?(d.isSPP()||b.find(".a-button-close").trigger("click"),
d.ajaxUpdatePage(a,e,f)):(a=c.jsonify(a),d.redirect(a))},error:function(a,b,c){d.ajaxRedirect(a,b,c)}})}}function q(a,b){a.find(".fba-wrap-checkbox").hide();a.find(".large-preview").hide();b.show();b.find(".afn-wrap-copy").remove()}function w(){var a=T,b=a.find(".popover-gift-amazon-wrap").is(":visible"),c=M(a.find(".amazon-gift-wrap")),d=M(a.find(".afn-wrap-none")),e=M(a.find(".hide-prices-checkbox"));if(c.is(":checked")||!d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!0),a.find(".hide-prices-note").show();
else if(c.not(":checked")||d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!1),a.find(".hide-prices-note").hide()}function B(a){var b=T,c=M(b.find(".include-gift-receipt-checkbox")),b=M(b.find(".mfn-hide-prices-checkbox"));a?(ia&&!c.is(":checked")&&c.attr("checked",!0).trigger("change"),ia||b.is(":checked")||b.attr("checked",!0).trigger("change")):(ia&&c.is(":checked")&&c.removeAttr("checked").trigger("change"),!ia&&b.is(":checked")&&b.removeAttr("checked").trigger("change"))}function r(a){var b=
T,c=M(b.find(".include-gift-receipt-checkbox")),b=M(b.find(".mfn-hide-prices-checkbox"));a?(B(!0),ia?c.attr("disabled","disabled"):b.attr("disabled","disabled")):ia?c.removeAttr("disabled"):b.removeAttr("disabled")}function t(a){var b=M(T.find(".include-gift-message-checkbox"));a?(b.is(":checked")||b.attr("checked",!0).trigger("change"),H(!1),y()):(b.is(":checked")&&b.removeAttr("checked").trigger("change"),G())}function H(a){var b=T,c=b.find(".no-message-warning"),d=b.find(".no-receipt-warning"),
e=b.find("textarea[name\x3d'gift-message-text']"),b=b.find(".message-remaining-text");a&&!d.is(":visible")?(n.showGiftTextAreaOnWarning()||e.addClass("gift-message-warning"),b.hide(),c.show()):(n.showGiftTextAreaOnWarning()||e.removeClass("gift-message-warning"),c.hide(),b.show())}function y(){var a=T,b=a.find("textarea[name\x3d'gift-message-text']"),a=a.find(".gift-message-label");b.removeClass("gift-message-inactive");a.removeClass("a-color-secondary")}function G(){var a=T,b=a.find("textarea[name\x3d'gift-message-text']"),
a=a.find(".gift-message-label");b.addClass("gift-message-inactive");a.addClass("a-color-secondary")}function E(){var b=T,c=M(b.find(".include-gift-message-checkbox")),d=b.find(".gift-msg-on-card"),e=b.find(".gift-msg-on-receipt"),f=a.trim(b.find(".gift-message-default-placeholder").text()),h=a.trim(b.find(".gift-message-with-wrap-placeholder").text()),g=b.find("textarea"),l=!1;b.find(".amazon-gift-wrap").each(function(){M(K(this)).is(":checked")&&(l=!0)});b.find(".afn-gift-wrap").each(function(){M(K(this)).is(":checked")&&
(l=!0)});b.find(".mfn-gift-wrap").each(function(){M(K(this)).is(":checked")&&(l=!0)});l?(e.hide(),d.show(),g.attr("placeholder",h),ia&&(t(!0),ya&&c.attr("disabled","disabled"))):(d.hide(),ia&&e.show(),g.attr("placeholder",f),c.removeAttr("disabled"))}function I(){var a=T,b=M(a.find(".include-gift-message-checkbox")),a=a.find("textarea[name\x3d'gift-message-text']");!wa&&ia&&(b.is(":checked")&&0<a.val().length?H(!1):H(!0))}function da(){var a=T,b=M(a.find(".include-gift-receipt-checkbox")),c=a.find(".no-receipt-warning"),
a=a.find(".no-message-warning");b.is(":checked")?(c.hide(),ya||t(!0)):(a.hide(),c.show(),t(!1))}function W(a){a=T;var b=M(a.find(".include-gift-receipt-checkbox")),b=ia&&b.is(":checked"),c=M(a.find(".mfn-hide-prices-checkbox")),c=!ia&&c.is(":checked");b||c?(L(),a.find(".kindle-reg-msg-your-account").hide(),a.find(".kindle-reg-msg-another-account").show()):(O(),r(!1),a.find(".kindle-reg-msg-another-account").hide(),a.find(".kindle-reg-msg-your-account").show())}function P(a){a=T;var b=!1;M(a.find(".include-gift-message-checkbox")).is(":checked")&&
(b=!0);var c=!1;a.find(".amazon-gift-wrap").each(function(){M(K(this)).is(":checked")&&(c=!0)});a.find(".afn-gift-wrap").each(function(){M(K(this)).is(":checked")&&(c=!0)});a.find(".mfn-gift-wrap").each(function(){M(K(this)).is(":checked")&&(c=!0)});(b||c)&&B(!0);b&&ya||c?r(!0):r(!1)}function D(a,b,c){var e=T;ca=a;sa=b;if(a=e.find("textarea[name\x3d'gift-message-text']")){b=c?a.val().length:p.unescape(encodeURIComponent(a.val())).length;la&&!wa&&ia&&(0<b?H(!1):H(!0));var f=a.val().split("\n").length;
c=ca-b;f=sa-f;!la&&0<b&&e.find(".include-gift-message-checkbox").not(":checked")&&e.find(".include-gift-message-checkbox").attr("checked",!0);a=a.val().split("\n");for(var h in a)24<a[h].length&&(f=0===a[h].length%24?f-(Math.floor(a[h].length/24)-1):f-Math.floor(a[h].length/24));e.find(".popover-gift-center .remainder-count").hide();(-1>c?e.find(".popover-gift-center .remaining-char-over-multiple").show():0>c?e.find(".popover-gift-center .remaining-char-over-single").show():1===c?e.find(".popover-gift-center .remaining-char-single").show():
e.find(".popover-gift-center .remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(c));(-1>f?e.find(".popover-gift-center .remaining-line-over-multiple").show():0>f?e.find(".popover-gift-center .remaining-line-over-single").show():1===f?e.find(".popover-gift-center .remaining-line-single").show():e.find(".popover-gift-center .remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(f));if(0>c||0>f)d.isSPP()?(e.find(".set-gift-options-button").addClass("aok-hidden"),
e.find(".set-gift-options-button-disabled").removeClass("aok-hidden")):(e.find(".set-gift-options-button").hide(),e.find(".set-gift-options-button-disabled").show()),0>c?(e.find(".gift-char-limit-error").find(".char-limit-error").html(ca),e.find(".current-blocker-content").html(e.find(".gift-char-limit-error").html())):0>f&&(e.find(".gift-line-limit-error").find(".line-limit-error").html(sa),e.find(".current-blocker-content").html(e.find(".gift-line-limit-error").html()));-1<c&&-1<f&&(d.isSPP()?(e.find(".set-gift-options-button").removeClass("aok-hidden"),
e.find(".set-gift-options-button-disabled").addClass("aok-hidden")):(e.find(".set-gift-options-button").show(),e.find(".set-gift-options-button-disabled").hide()))}}function N(a){a.stopPropagation();var b=T;b.find(".popover-content-main").fadeOut(100,function(){b.find(".popover-content-gift-wrap-preview .gift-wrap-preview-image").attr("src",a.data.imageURL);b.find(".popover-content-gift-wrap-preview").fadeIn(100)});var c=b.find(".popover-content-gift-wrap-preview .back-to-gift-options-button");c.unbind("click").bind("click",
U);f.bindActionEnterKeyOnButton(c);xa=!0}function U(a){xa=!1;var b=T;a?b.find(".popover-content-gift-wrap-preview").fadeOut(100,function(){b.find(".popover-content-main").fadeIn(100)}):setTimeout(function(){b.find(".popover-content-gift-wrap-preview").hide();b.find(".popover-content-main").show()},500)}function x(a){var b=T,c=!1;K(".amazon-gift-wrap").each(function(){M(K(this)).is(":checked")&&(c=!0)});K(".afn-gift-wrap").each(function(){M(K(this)).is(":checked")&&(c=!0)});K(".mfn-gift-wrap").each(function(){M(K(this)).is(":checked")&&
(c=!0)});if(c)L(),V();else if(M(b.find(".hide-prices-checkbox")).is(":disabled"))ba();else if(a.is("input[type\x3dcheckbox]")&&(a.closest(".a-checkbox").hasClass("hide-prices-checkbox")||a.hasClass("hide-prices-checkbox")))a.is(":checked")?L():O();else if(d.isSPP())(b=a.closest(".a-radio"))&&a.is(":checked")&&(b.hasClass("kindle-reg-radio-your-account")?O():b.hasClass("kindle-reg-radio-another-account")&&L());else if(a.hasClass("kindle-reg-radio-another-account")||a.hasClass("kindle-reg-radio-your-account"))b.find(".kindle-reg-radio-your-account").is(":checked")?
O():L()}function L(){var a=T,b=M(a.find(".hide-prices-checkbox"));b.is(":checked")&&!d.isSPP()||b.attr("checked","checked");M(a.find(".kindle-reg-radio-your-account")).is(":checked")&&M(a.find(".kindle-reg-radio-another-account")).attr("checked",!0)}function O(){var a=T,b=M(a.find(".hide-prices-checkbox"));b.is(":checked")&&b.removeAttr("checked");M(a.find(".kindle-reg-radio-another-account")).is(":checked")&&M(a.find(".kindle-reg-radio-your-account")).attr("checked",!0)}function V(){var a=T;M(a.find(".hide-prices-checkbox")).attr("disabled",
"true");M(a.find(".kindle-reg-radio-another-account")).attr("disabled",!0);M(a.find(".kindle-reg-radio-your-account")).attr("disabled",!0);a.find(".hide-prices-merchant-cant").is(":visible")||a.find(".hide-prices-note").show()}function ba(){var a=T;M(a.find(".hide-prices-checkbox")).removeAttr("disabled");M(a.find(".kindle-reg-radio-another-account")).removeAttr("disabled");M(a.find(".kindle-reg-radio-your-account")).removeAttr("disabled");a.find(".hide-prices-note").hide()}function fa(a){var b=f.getPosition(a,
"#",2),c=f.getPosition(a,"#",3);return"60"===a.substring(b+1,c)}function aa(b,c,d){var e=X(),f,h;e?(f=d.find('li[class\x3d"a-carousel-card gift-wrap noshi-wrap none-wrap"]'),h=d.find(".carousel-gift-wrap").find("ol")):(f=d.find("."+c+"-wrap-template"),h=d.find("ul.allGiftWrapList"));e&&a.trigger("checkout:gift:removeEmptyCarouselCards",h);var g=(d.data("lineitemid")||b.obfuscatedEntityId||"").replace(":","-");"afn"!==c||e||(h.find('li[class!\x3d"none-wrap gift-wrap noshi-wrap"]').remove(),K("#giftwrap-carousel-wrap-holder-"+
g).css("width",90*(b.options.wraps.length+1)),K("#giftwrap-carousel-wrap-pane-"+g).css("width",360));for(var l=T,n=l.find(".larger-image-link-carousel-template"),k=0;k<b.options.wraps.length;k++){var m=f.clone(!0).removeClass(c+"-wrap-template").addClass(c+"-wrap-copy"),r=n.clone(!0).removeClass("larger-image-link-carousel-template").addClass("larger-image-link-carousel-"+k),t=c,u=b,v=k,Y=m,p=r,q=u.options.wraps[v].id;Y.find("input").addClass(t+"-wrap-"+v).val(q);Y.find("label").attr("for",t+"-wrap-"+
v);q=u.options.wraps[v].description;Y.find("."+t+"-wrap-description").html(q);q=u.options.wraps[v].price;Y.find("."+t+"-wrap-price").html(q);(u=u.options.wraps[v].imageurl)&&u.length?(Y.find("."+t+"-image").attr("src",u).show(),t=Y.find(".larger-image-link"),t.show(),t.unbind("click").bind("click",{imageURL:u},N),p.unbind("click").bind("click",{imageURL:u},N),p.find("a").unbind("click").bind("click",{imageURL:u},N)):"mfn"!==t||X()||(Y.find(".a-span3").hide(),Y.find(".a-span9").addClass("a-span12").removeClass("a-span9"),
Y.find(".a-color-price").removeClass("wrap-price"));if("afn"===c){v=b;p=k;Y=g;t=h;u=l;q=v.options.wraps[p].id;m.data("giftwrap-id",q);m.data("wrap-no",p);if(v.selected.wrap===q){t.find("li.none-wrap").find("img").removeClass("selected-giftwrap-image");m.find("img").addClass("selected-giftwrap-image");var v=m.find("img").attr("src"),B=K("#giftwrap-option-preview-imagearea-image-"+Y);B.find("img").attr("src",v);B.removeClass("aok-hidden");K("#giftwrap-option-preview-imagearea-default-"+Y).addClass("aok-hidden");
x(m.find("input"));w();r.removeClass("aok-hidden");r.addClass("selectedWrapLargeLink")}X()?(Y=fa(q)?"gift-wrap":"noshi-wrap",m.removeClass(Y).removeClass("none-wrap"),t.append(m.show())):(Y=fa(q)?"\x3cli class\x3dnoshi-wrap\x3e":"\x3cli class\x3dgift-wrap\x3e",t.append(K(Y).append(m.show())));m=u.find("#carousel-larger-image-div");m.find(".larger-image-link-carousel-"+p).length||m.append(r.show())}}d.find("."+c+"-wrap-checkbox").removeAttr("checked");b.selected&&b.selected.isWrapped?d.find("input[value\x3d'"+
b.selected.wrap+"']").attr("checked",!0):M(d.find("."+c+"-wrap-none")).attr("checked",!0);e&&a.trigger("checkout:gift:adjustCarouselInitial",b,d)}function X(){return d.isSPP()&&K("input[name\x3dsppGiftPopoverWithCarousel]").length}function ea(a,b,c){for(var e=c.find("."+b+"-wrap-template"),f=0;f<a.options.wraps.length;f++){var h=e.clone(!0).removeClass(b+"-wrap-template").addClass(b+"-wrap-copy"),g=a.options.wraps[f].id;h.find("input").addClass(b+"-wrap-"+f).val(g);h.find("label").attr("for",b+"-wrap-"+
f);g=a.options.wraps[f].description;h.find("."+b+"-wrap-description").html(g);g=a.options.wraps[f].price;h.find("."+b+"-wrap-price").html(g);if((g=a.options.wraps[f].imageurl)&&g.length){var l=h.find("."+b+"-image");d.isSPP()&&l.removeClass("hidden");l.attr("src",g).show();l=h.find(".larger-image-link");d.isSPP()&&l.removeClass("hidden");l.show();l.unbind("click").bind("click",{imageURL:g},N)}else h.find(".a-span3").hide(),h.find(".a-span9").addClass("a-span12").removeClass("a-span9"),h.find(".a-color-price").removeClass("wrap-price");
d.isSPP()&&h.removeClass("hidden");h.insertAfter(e).show()}c.find("."+b+"-wrap-checkbox").removeAttr("checked");a.selected&&a.selected.isWrapped?c.find("input[value\x3d'"+a.selected.wrap+"']").attr("checked",!0):M(c.find("."+b+"-wrap-none")).attr("checked",!0)}function A(){T.find("#include-gift-connection-checkbox").attr("checked",!0)}function Y(){if(T.find(".include-gift-connection-checkbox").not(":checked")){var a=T;a.find(".gift-connection-recipient-extra").hide();var b;b=a.find('#select-recipient option[value\x3d"0"]').attr("selected",
"selected");a.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(b.text());a.find("#input-recipient-first-name").val("");a.find("#input-recipient-last-name").val("");ka()}}function Z(a){for(var b=T,c=0;c<ha.length;c++)if(a&&a===ha[c].value&&ha[c].bMonth&&ha[c].bDay){var d;d=b.find('#select-occasion-month option[value\x3d"'+ha[c].bMonth+'"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(d.text());d=
b.find('#select-occasion-day option[value\x3d"'+ha[c].bDay+'"]').attr("selected","selected");b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(d.text())}}function ka(){var a=T,b=a.find("#popover-gift-connection #select-recipient").find(":selected").val();if(""!==b&&"0"!==b&&("1"!==b&&"2"!==b||a.find("#input-recipient-first-name").val()||a.find("#input-recipient-last-name").val()))a.find("#select-occasion").prop("disabled",!1),a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:1});
else{b=T;b.find(".gift-connection-occasion-extra").hide();var c;c=b.find('#select-occasion option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-month option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-day option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(c.text());
c=b.find('#select-occasion-age option[value\x3d"-1"]').attr("selected","selected");b.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(c.text());b.find("#occasion-has-reminder-checkbox").attr("checked",!0);a.find("#select-occasion").prop("disabled",!0);a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:.5})}}function ga(a,b){var c=T;"1"===a&&"2"===b?c.find("#select-occasion-age-row").show():c.find("#select-occasion-age-row").hide()}function R(a){a=
T;var b=a.find("#popover-gift-connection #select-recipient").find(":selected").val(),c=a.find("#popover-gift-connection #select-occasion").find(":selected").val();!b||"1"!==b&&"2"!==b?(a.find(".gift-connection-recipient-extra").hide(),"1"===c&&b&&Z(b)):a.find(".gift-connection-recipient-extra").show();ga(c,b);ka()}function ra(a){a=T;var b=a.find("#popover-gift-connection #select-occasion").find(":selected").val(),c=a.find("#popover-gift-connection #select-recipient").find(":selected").val();!b||"1"!==
b&&"2"!==b?a.find(".gift-connection-occasion-extra").hide():("1"===b&&c&&"1"!==c&&"2"!==c&&Z(c),a.find(".gift-connection-occasion-extra").show());ga(b,c)}function ta(a){var c=T,d="/gp/buy/pipeline/handlers/list-of-giftlists.html?escape\x3d0";ha&&(d+="\x26mappingOnly\x3d1");a&&(d+="\x26fromRegistryIds\x3d"+a);K.ajax({type:"POST",url:d,dataType:"json",async:!0,cache:!1,timeout:5E3,success:function(d){c.find("#select-recipient").hide();!ha&&d.options&&0<d.options.length&&(ha=d.options);a&&d.registryIdMapping?
(pa[a]=d.registryIdMapping[a],oa=d.registryIdMapping[a]):a&&(pa[a]=F);ha&&b();c.find("#select-recipient").show();c.find("#select-recipient-spinner").hide();ja=!0},error:function(){c.find("#select-recipient").show();c.find("#select-recipient-spinner").hide();ja=!0}})}function S(b,c){var d=X(),e=c.lineItemId;c=X()?c.currentTab:b.data("current-tab");var f=K("#popover-gift-options-wrapper-"+e).data("active-tab");c!==f&&(b.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),b.addClass("selected-giftwrap-tab"),
b=K("#giftwrap-carousel-wrap-holder-"+e),d||b.css("left",0),f=K("#giftwrap-carousel-wrap-holder-"+e+" li"),d?(a.trigger("checkout:gift:changeCarouselWrapOptions",b,c,e),a.trigger("checkout:gift:adaptCarouselSPCPanel",e,c)):"all"===c?f.show():(f.hide(),f.filter("."+{"gift-wrap":"gift-wrap",noshi:"noshi-wrap"}[c]).show()),K("#popover-gift-options-wrapper-"+e).data("active-tab",c),f.find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),f.filter(".none-wrap").find("img").addClass("selected-giftwrap-image"),
K("#giftwrap-option-preview-imagearea-default-"+e).removeClass("aok-hidden"),K("#giftwrap-option-preview-imagearea-image-"+e).addClass("aok-hidden"),d=K("#allGiftWrapList-"+e).find(".none-wrap").find("input"),e=K(".selectedWrapLargeLink"),d.prop("checked",!0),d.val("").change(),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink")))}function Ba(a,b,c){c.$event.preventDefault();a=b.lineItemId;b=parseInt(K("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);0>b&&(b=b+90+"px",K("#giftwrap-carousel-wrap-holder-"+
a).css("left",b))}function Q(a,b,c){c.$event.preventDefault();a=b.lineItemId;var d=K("#allGiftWrapList-"+a);b=d.find("li").size();c=d.find("li.gift-wrap").size();var d=d.find("li.noshi-wrap").size(),e=K("#popover-gift-options-wrapper-"+a).data("active-tab"),f;"all"===e?f=b:"gift-wrap"===e?f=c:"noshi"===e&&(f=d);b=parseInt(K("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);b>-90*(f-4)&&(b=b-90+"px",K("#giftwrap-carousel-wrap-holder-"+a).css("left",b))}function na(a,b){var c=b.lineItemId;K("#allGiftWrapList-"+
c).find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".afn-image").addClass("selected-giftwrap-image");b=a.parent();var d=a.data("giftwrap-id"),e=a.find("input"),f=a.data("wrap-no");e.prop("checked",!0);e.val(d).change();d=K("#giftwrap-option-preview-imagearea-default-"+c);c=K("#giftwrap-option-preview-imagearea-image-"+c);e=K(".selectedWrapLargeLink");f=K(".larger-image-link-carousel-"+f);b.hasClass("none-wrap")?(d.removeClass("aok-hidden"),c.addClass("aok-hidden"),e.length&&
(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),c.find("img").attr("src",a),d.addClass("aok-hidden"),c.removeClass("aok-hidden"),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink")),f.length&&(f.addClass("selectedWrapLargeLink"),f.removeClass("aok-hidden")))}function ua(a,b){var c=b.lineItemId;b=K("#giftwrap-option-preview-imagearea-default-"+c);c=K("#giftwrap-option-preview-imagearea-image-"+c);a.hasClass("none-wrap")?(b.removeClass("aok-hidden"),
c.addClass("aok-hidden")):(a=a.find("img").attr("src"),c.find("img").attr("src",a),b.addClass("aok-hidden"),c.removeClass("aok-hidden"))}function qa(a,b){var c=b.lineItemId;a=K("#giftwrap-option-preview-imagearea-default-"+c);b=K("#giftwrap-option-preview-imagearea-image-"+c);K("#allGiftWrapList-"+c).find(".selected-giftwrap-image").parentsUntil("ul","li").hasClass("none-wrap")?(a.removeClass("aok-hidden"),b.addClass("aok-hidden")):(c=K("#allGiftWrapList-"+c).find(".selected-giftwrap-image").attr("src"),
b.find("img").attr("src",c),a.addClass("aok-hidden"),b.removeClass("aok-hidden"))}var K=a.$;if(!K("html").hasClass("a-ie6")){var ca,sa,T,va,xa=!1,la=!1,wa=!0,ia=!0,ha,ja=!1,pa={},oa,ya=!1;a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("gift-")&&(d.isSPP()&&h.increaseCount("checkout:spp-revieworder:gift_pop_cancel_sec",1),xa&&U(),la&&(a=T,a.find(".gift-msg-on-card").hide(),a.find(".popover-gift-warning").hide(),a.find(".message-remaining-text").show(),M(a.find(".amazon-gift-wrap")).removeAttr("checked"),
t(!1),a.find('input[type\x3d"checkbox"]').removeAttr("disabled")))});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("gift-")){T=a.popover.$popover;va=a.popover;0<T.find(".include-gift-receipt-checkbox").length&&(la=!0);g.showSpinner(T.find(".popover-content-main"),!1,va);T.find(".content-container").css("visibility","hidden");a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var b=va.data;
if(b)a+="\x26obfuscatedEntityId\x3d"+b;else throw{name:"MissingData",message:"lineItemId is undefined"};}catch(e){p.ueLogError&&p.ueLogError(e,{logLevel:"FATAL",attribution:"gift-popover",message:"[No lineItemId to open the gift-popover with]. "})}K.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/gift-select-content.html",data:a,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},dataFilter:function(a){return c.jsonify(a)},success:function(a,b,c){a&&a.conductoraction&&a.conductoraction.url&&
d.redirect(a);null!==a?v(a,b,c):d.ajaxRedirect()},error:function(a,b,c){d.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-gift"))b=T,a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text()),a.popover.updatePosition(!0);else if(a.popover&&a.popover.$popover){var b=a.popover.$popover;a=b.find(".validateInputCharactersOnBlur.a-form-error");0<a.size()&&a.removeClass("a-form-error");
b=b.find("#onblur-character-validation-error-gift-message-text");0<b.size()&&b.remove()}});var za={enforceSelectorParity:x,enforceGiftReceiptParity:P,enforceHidePriceParity:W,disableHidePrice:w,toggleMessageBoxDisplay:E,toggleEmptyMsgWarning:I,toggleNoReceiptWarning:da,includeGiftConnection:A,clearGiftConnection:Y,toggleGiftConnectionRecipientArea:R,toggleGiftConnectionOccasionArea:ra,updateGiftOptionsTabSelection:S,updateCarouselOnLeftClick:Ba,updateCarouselOnRightClick:Q,updateSelectedGiftWrap:na,
updatePreviewImageOnMouseEnter:ua,updatePreviewImageOnMouseLeave:qa},M=e.getInput;a.declarative("gift-popover-element",["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(za[b[c]])za[b[c]](a.$target,a.data)});a.declarative("gift-popover-element","click mouseenter mouseleave",function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(za[b[c]])za[b[c]](a.$currentTarget,
a.data,a)});a.declarative("spc-update-gift-options-tab-selection","click",function(a){var b=a.$target.parents("li");b.attr("data",a.data);S(b,a.data)});a.on("checkout:reload:spc",m);a.on("checkout:reload:spp-revieworder",m)}});"use strict";q.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics").register("concealment-popover-controller",function(a,k,g,c,d,f,l,h){function e(){v("#spc-orders").find(".concealment-widgets-desktop").removeClass("no-js-hide");
a.defer(function(){v("#spc-orders").find(".concealment-popover-link").each(function(){v(this).data("action")&&v(this).removeAttr("href").attr("tabindex",0)})})}function n(a){return a.is("input")?a:a.find("input")}function b(a){var b=u;b.find(".fake-label").each(function(){v(this).unbind("click").bind("click",function(){v(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&b.find(".concealment-item-title").html(a.item.title);if(a&&a.obfuscatedEntityId){var c=
b.find(".set-concealment-options-button input");c.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,concealmentData:a,quantity:a.quantity},m);f.bindActionEnterKeyOnButton(c)}w=a&&a.item&&a.item.isAmazonFulfilled;a&&a.selected&&(c=n(b.find(".conceal-item-checkbox")),a.selected.concealItem?c.attr("checked",!0):c.removeAttr("checked"));u.find(".content-container").css("visibility","visible");q.updatePosition(!0);g.hideSpinner(b.find(".popover-content-main"))}function m(a){var b=u,
e="";a&&a.data&&a.data.obfuscatedentityid&&(e+="obfuscatedEntityId.0\x3d"+a.data.obfuscatedentityid+"\x26");a&&a.data&&a.data.quantity&&(e+="quantity.0\x3d"+a.data.quantity+"\x26");var f="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.saveConcealmentRefTag&&(f=a.data.concealmentData.saveConcealmentRefTag);var g="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.cancelConcealmentRefTag&&(g=a.data.concealmentData.cancelConcealmentRefTag);(a=n(b.find(".conceal-item-checkbox")).is(":checked"))?
(w&&(e+="isAFN.0\x3d1\x26"),e=e+"includeReceipt.0\x3d1\x26includeMessage.0\x3d1\x26"+("message.0\x3d"+encodeURIComponent(v("input[name\x3d'concealment-item-message']").val())+"\x26"),e=e+"hidePrices.0\x3d0\x26saveOnly\x3d1"+("ref\x3d"+f+"\x26")):e+="ref\x3d"+g+"\x26";var l=v("input#executionId").val();l&&(e+="executionId\x3d"+l+"\x26");l="/gp/buy/gift/handlers/save-all.html/ref\x3d";a?(l+=f,h.increaseCount("CPEX.Checkout.Select.Concealment",1)):(l+=g,h.increaseCount("CPEX.Checkout.Cancel.Concealment",
1));d.isSPP()&&(b.find(".a-button-close").trigger("click"),f=v("#setOrderingPrefsCheckbox"),f.length&&f.is(":checked")&&(e+="\x26saveAsDefaultsSelected\x3d1"));k.show();v.ajax({type:"POST",url:l,data:e,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,e,f){f.getResponseHeader("x-amz-checkout-page")?(d.isSPP()||b.find(".a-button-close").trigger("click"),d.ajaxUpdatePage(a,
e,f)):(a=c.jsonify(a),d.redirect(a))},error:function(a,b,c){d.ajaxRedirect(a,b,c)}})}var v=a.$;if(!v("html").hasClass("a-ie6")){var u,q,w=!0;v(document).delegate(".concealment-popover-link, .concealment-options-button","click",function(){h.increaseCount("CPEX.Checkout.Concealment.Button.click",1)});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")&&(d.isSPP()&&h.increaseCount("checkout:spp-revieworder:concealment_pop_cancel_sec",1),n(u.find(".conceal-item-checkbox")).removeAttr("checked"))});
a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")){u=a.popover.$popover;q=a.popover;g.showSpinner(u.find(".popover-content-main"),!1,q);u.find(".content-container").css("visibility","hidden");a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var e=q.data.lineItemEntityId,f=q.data.itemId;if(e)a+="\x26obfuscatedEntityId\x3d"+e;else if(f)a+="\x26lineItemEntityId\x3d"+f;else throw{name:"MissingData",
message:"lineItemId is undefined"};var h=q.data.quantity;if(h)a+="\x26quantity\x3d"+h;else throw{name:"MissingData",message:"quantity is undefined"};}catch(l){p.ueLogError&&p.ueLogError(l,{logLevel:"FATAL",attribution:"concealment-popover",message:"[Data missing to open the concealment-popover]. "})}e=q.data.ref;v.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/concealment-select-content.html/ref\x3d"+e,data:a+("\x26ref\x3d"+e),dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},
dataFilter:function(a){return c.jsonify(a)},success:function(a,c,e){a&&a.conductoraction&&a.conductoraction.url&&d.redirect(a);null!==a?b(a,c,e):d.ajaxRedirect()},error:function(a,b,c){d.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-concealment")){var b=u;a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text());a.popover.updatePosition(!0)}});var B={};a.declarative("concealment-popover-element",
["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(B[b[c]])B[b[c]](a.$target,a.data)});a.declarative("concealment-popover-element","click mouseenter mouseleave",function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(B[b[c]])B[b[c]](a.$currentTarget,a.data,a)});a.on("checkout:reload:spc",e);a.on("checkout:reload:spp-revieworder",e)}});"use strict";q.when("A",
"page-conductor","scroll-controller","page-detector","client-side-metrics","button-blocker","weblab-helper").register("gold-box-controller",function(a,k,g,c,d,f,l){function h(){a.defer(b);a.defer(m)}var e=a.$,n={};if(!e("html").hasClass("a-ie6")){var b=function(){var a=e("#goldbox-countdown"),b=e("#spc-orders");b&&0!==b.length||(b=e("#spclite-items-block"));b=b.find("input[name\x3dgoldboxexpirelefttime]");if(0!==b.length){if(1<b.size()){var c=parseInt(b.attr("data-timeleftms"),10),f=b;e.each(b,function(){var a=
e(this),b=parseInt(a.attr("data-timeleftms"),10);b<c&&(f=a,c=b)});b=f}var h=parseFloat(b.attr("data-pagestarttime")),m=parseFloat(b.attr("data-timeleftms")/1E3);if(!(isNaN(h)||isNaN(m)||0>=m)){var t=(new Date).getTime();l.isTSPCGoldBoxTimerFixEnabled()&&(isNaN(n[h])?(n={},n[h]=t):t=n[h]);var q=a.find("span[data-timefield\x3dminute]"),y=a.find("span[data-timefield\x3dsecond]"),G=p.setInterval(function(){var b=(new Date).getTime();m-=(b-t)/1E3;t=b;if(0>m&&G)y.html("00"),p.clearInterval(G),G=null,k.isSPP()&&
d.increaseCount("checkout:spp-revieworder:deal_expired",1),e("#gold-box-modal-launcher").trigger("click"),g.scrollToTop(),g.toggleScrollOff();else{var b=Math.floor(m/60%60),c=Math.floor(m%60),c=10>c?"0"+c:c;q.html(b);y.html(c);a.is(":visible")||a.show()}},1E3);k.isSPP()&&d.increaseCount("checkout:spp-revieworder:deal_countdown",1)}}},m=function(){var a=e("#gold-box-button-blocker");1===a.length&&f.show("place-order-gold-box-blocker",a.attr("data-blocker-message"))};a.on("checkout:reload:spc",h);a.on("checkout:reload:spclite",
h);a.on("checkout:reload:spp-revieworder",h)}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","currency-formatter","page-detector","client-side-metrics","pay-rewards-currency","weblab-helper").register("inline-points-controller",function(a,k,g,c,d,f,l,h,e){function n(){r("#spc-points-input")&&r("#spc-points-input").data("points-used")&&(r("#points-applied").show(),r("#inline-points-button").hide());r("#inline-points-register")&&r("#inline-points-register").removeAttr("href");
r("#spc-loyalty-points-input")&&r("#spc-loyalty-points-input").val()&&(r("#loyalty-points-applied").show(),r("#loyalty-points-button").hide());r("#spc-points-input")&&r("#spc-points-input").hasClass("show-currency-input-widget-new")&&r("#spc-points-input").each(function(b,c){var d=a.$(c);b={$element:d,maxAmount:d.data("max-dollar-amount")};c={$element:a.$("#inline-raw-points"),decimalPlaces:d.data("decimal-places"),ratio:d.data("conversion-ratio")};var e=d.data("country-code"),e=h.getCurrencyFormatByCountryCode(e);
h.initializeInlineFormatting(b,c,e);r(document).delegate("#spc-points-input","keydown",function(a){if(d.data("points-used")!==d.val){a=r("#inline-points-button");var b=!1;a.is("span")&&(b=!0);var c=a.find("span.apply"),e=a.find("span.change");r("#points-applied").hide();d.data("points-used")?(c.hide(),e.show()):(c.show(),e.hide());b?a.addClass("display-inline-block"):a.show()}})})}function b(a,b){a.preventDefault();if(m(b)){c.isSPP()?(k.blockAllActions(),k.showTransitionInContainer(r("#payment"))):
k.show();var d;a={"x-amz-checkout-page":"spc"};if(b)d=r("#loyalty-points-hidden-fields"),b="/gp/buy/spc/handlers/update-loyalty-points.html/ref\x3dox_spc_points_edit",d="\x26jpPointsPaymentInstrumentId\x3d"+encodeURIComponent(d.find("input[name\x3d'jpPointsPaymentInstrumentId']").val())+"\x26jpPointsCustomerRequestedAmount\x3d"+r("#spc-loyalty-points-input").val()+"\x26jpPointsConversionRate\x3d"+d.find("input[name\x3d'jpPointsConversionRate']").val()+"\x26jpPointsBaseCurrencyCode\x3d"+d.find("input[name\x3d'jpPointsBaseCurrencyCode']").val()+
"\x26jpPointsTargetCurrencyCode\x3d"+d.find("input[name\x3d'jpPointsTargetCurrencyCode']").val()+"\x26jpPointsAvailablePoints\x3d"+d.find("input[name\x3d'jpPointsAvailablePoints']").val()+"\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+r("input[name\x3duseCtb]").val();else{a=c.setAjaxTransitionHeader(a);d=r("#inline-points-hidden-fields");var e=d.find("input[name\x3d'useGCBalance']").val();b="/gp/buy/pipeline/handlers/update-reward-points.html/ref\x3d"+(c.isSPP()?"chk_pay_addswp_coll":"ox_pay_page_points_apply");
d="paymentMethodId\x3d"+d.find("input[name\x3d'paymentMethodId']").val()+"\x26paymentMethodType\x3d"+d.find("input[name\x3d'paymentMethodType']").val()+"\x26rewardAccountId\x3d"+d.find("input[name\x3d'rewardAccountId']").val()+"\x26rewardAccountAmount\x3d"+r("#spc-points-input").val()+"\x26rewardAccountRate\x3d"+d.find("input[name\x3d'rewardAccountRate']").val()+"\x26useGCBalance\x3d"+e+"\x26usePromoBalance\x3d"+e+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+
r("input[name\x3duseCtb]").val()}r.ajax({type:"POST",url:b,data:d,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:a,success:function(a,b,d){d.getResponseHeader("x-amz-checkout-page")?c.ajaxUpdatePage(a,b,d):(a=g.jsonify(a),c.redirect(a))},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}}function m(a){var b=!1,c=r("input[name\x3drewardAccountAmount]"),d=r("#inline-points-error-block");a||r("#spc-points-input")&&!r("#spc-points-input").hasClass("show-currency-input-widget-new")?
(a&&(c=r("input[name\x3dloyaltyPointsValue]"),d=r("#loyalty-points-error")),d.hide(),d.find("p").hide(),u(c))?p(c,a)?q(c,a)||(d.find("p").filter(function(){return"badMax"===r(this).data("error")}).show().css("display","inline"),b=!0):(d.find("p").filter(function(){return"badMin"===r(this).data("error")}).show().css("display","inline"),b=!0):(d.find("p").filter(function(){return"badValue"===r(this).data("error")}).show().css("display","inline"),b=!0):a||p(c,a)||(d.find("p").filter(function(){return"badMin"===
r(this).data("error")}).show().css("display","inline"),b=!0);if(b)return d.show(),c.addClass("a-form-error"),!1;c.removeClass("a-form-error");return!0}function v(a,b){var c=r(a.currentTarget),e=c.val();a=r("#inline-raw-points");b&&(a=r("#loyalty-points-applied-value"));var f=a.html();if(b)!/^\s*$/.test(e)&&!isNaN(e)&&0<e?a.html(e):a.html(0);else if(!r("#spc-points-input").hasClass("show-currency-input-widget-new")){var h=c.data("min-dollar-amount");!/^\s*$/.test(e)&&!isNaN(e)&&0<e&&!isNaN(h)&&e>=
h?(h=c.data("conversion-ratio"),c=c.data("decimal-places"),e=d.getNumberWithSeparators(e/h,c),a.html(e)):a.html(0)}(b||r("#points-applied").is(":visible"))&&f!==a.html()&&(a=r("#spc-loyalty-points-display"),f=r("#loyalty-points-applied"),e=r("#loyalty-points-button"),c=!1,b||(a=r("#inline-points-button"),a.is("span")&&(c=!0),f=a.find("span.apply"),e=a.find("span.change"),r("#points-applied").hide()),f.hide(),e.show(),c?a.css("display","inline-block"):a.show())}function u(a){a=a.val();return/^\s*$/.test(a)||
!isNaN(a)}function p(a,b){if(b)return!0;b=a.val();if(/^\s*$/.test(b))return!0;b=parseFloat(b);return isNaN(b)||!a.data("min-dollar-amount")?!0:0===b||b>=a.data("min-dollar-amount")}function q(a,b){var c=a.val();if(/^\s*$/.test(c))return!0;var c=parseFloat(c),d=a.data("max-dollar-amount");b&&(d=a.data("available-points"));return isNaN(c)||!d?!0:c<=d}function B(a){switch(a.keyCode?a.keyCode:a.which){case 13:case 10:var c=r("#loyalty-points-button"),d=r("#spc-points-input");0<c.length&&c.is(":visible")?
b(a,1):0<d.length&&b(a,0)}}var r=a.$;r("html").hasClass("a-ie6")||(r(document).delegate("#spc-loyalty-points-input","keypress",function(a){B(a)}),r("#spc-points-input")&&!r("#spc-points-input").hasClass("show-currency-input-widget-new")&&(r(document).delegate("#spc-points-input","keypress",function(a){B(a)}),r(document).delegate("#spc-points-input","keyup",function(a){v(a,0)})),r(document).delegate("#spc-loyalty-points-input","keyup",function(a){v(a,1)}),r(document).delegate("#inline-points-button",
"click",function(a){b(a,0)}),r(document).delegate("#loyalty-points-button","click",function(a){b(a,1)}),a.on("a:expander:apply-point-expander:toggle:expand",function(a){l.increaseCount("checkout:spp-payment:expand_addswp_coll",1)}),a.on("checkout:reload:spc",n),a.on("checkout:reload:spp-revieworder",n))});"use strict";q.when("A","client-side-metrics","ready").execute(function(a,k){var g=a.$;a.on("checkout:reload:spc",function(){var a=g("input[name\x3d'rewardsProgramId']").val(),d=g("input[name\x3d'swpWidgetCase']").val();
a&&d&&k.increaseCount("Checkout::SPC::SWPWidgetCSM::"+a+"::"+d,1)})});"use strict";q.when("A","client-side-metrics","ready").execute(function(a,k){function g(){"1"!==c("meta[name\x3dSWP_TPP_FEATURE_ENABLED]").attr("content")||d||c.ajax({type:"POST",url:"/gp/shopwithpoints/temporaryPreference/verify-and-log-temporary-preference.html",data:{sourcePage:"SPC"},dataType:"text",async:!0,success:function(){d=!0;k.increaseCount("Checkout::SPC::LogTemporaryPaymentPreferenceAppliedAjax::Success",1)},error:function(){k.increaseCount("Checkout::SPC::LogTemporaryPaymentPreferenceAppliedAjax::Failure",
1)}})}var c=a.$,d=!1;a.on("checkout:reload:spc",g);a.on("checkout:reload:spclite",g);a.on("checkout:reload:spp-revieworder",g);a.on("checkout:reload:spp-collapsed",g)});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor").register("inline-fps-balance-controller",function(a,k,g,c){function d(a){a.preventDefault();f("#inline-fps-balance-checkbox").prop("disabled","disabled");c.isSPP()?(k.blockAllActions(),k.showTransitionInContainer(f("#payment"))):k.show();var d=f("#inline-fps-balance-hidden-fields"),
e=0;f("#inline-fps-balance-checkbox").prop("checked")&&(e=1);a=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});var n="/gp/buy/pipeline/handlers/update-fps-balance.html/ref\x3d"+(c.isSPP()?"chk_pay_"+(e?"apply":"remmove")+"_fps_balance_coll":"ox_spc_page_fps_balance_apply"),d="fpsPaymentMethodId\x3d"+d.find("input[name\x3d'fpsPaymentMethodId']").val()+"\x26useFlexiblePayments\x3d"+e+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+f("input[name\x3duseCtb]").val();
f.ajax({type:"POST",url:n,data:d,dataType:"text",async:!0,cache:!1,headers:a,success:function(a,d,e){e.getResponseHeader("x-amz-checkout-page")?c.ajaxUpdatePage(a,d,e):(a=g.jsonify(a),c.redirect(a))},error:function(a,d,e){c.ajaxRedirect(a,d,e)}})}var f=a.$;f("html").hasClass("a-ie6")||f(document).delegate("#inline-fps-balance-checkbox","click",function(a){d(a)})});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","checkout-general-utils","error-feature-detection",
"page-detector","client-side-metrics","weblab-helper","a-modal").register("shipping-speed-selection-controller",function(a,k,g,c,d,f,l,h,e,n){function b(){V?x("fieldset div.a-radio").addClass("a-touch-radio"):a.defer(function(){var a=x("#spc-orders").find("div.ship-option");a.filter(".no-scheduled-delivery");a.each(function(){x(this).find("input.radio-image").remove()});a.each(function(){var a=x(this).find("input.radio-standard");a.attr("checked")&&a.attr("checked",!0)})});aa=x("#spc-orders").find("div.ship-option").find('input[type\x3d"radio"]:checked');
X=aa.attr("value");m();f.markFeatureAvailable("shipping-speed-selection-controller");v()}function m(){var a=0<x("#trigger-case-call-to-resolve-cv").length||0<x(".force-resolve-invalid-ship-option").length;if(c.isSPP()&&a){var a=function(){var a=p.setInterval(function(){c.isAnimating()||(k.show(),p.clearInterval(a))},50)},b=x("div.ship-option").filter(".call-set-to-resolve-cv").first().find("input[type\x3d'radio']");if(b&&b.length){var d=b.parents(".shipping-speeds").find("input.lineitemidinput[type\x3dhidden]").val();
E(b,null,null,{transitionAction:a,refTag:"chk_revieworder_set_ship_option_no_default",extraData:{callingCASEResolveCV:1,lineItemIds:d}})}}}function v(){x("#buy-button-disabled-state").length&&u(function(a){q(a)})}function u(a){e.isSDGoldenCXSPCDesktopEnabled()?x("div.sd-widgets").each(function(b,c){a(c)}):x("div.sd_widget_root").each(function(b,c){a(c)})}function q(a){var b=setInterval(x.proxy(function(){if(x(this).hasClass("sd_widget_initialized")){var a=x(this),c=x(a).attr("id");c&&(a=w(a),a["ScheduledDeliveryEntity.startDeliveryDate"]&&
E(null,c,a));p.clearInterval(b)}},a),1E3)}function w(a){var b={};B(a,function(a){var c=x(a).attr("key");a=x(a).val();b[c]=a||""});return b}function B(a,b){x(a).find("input[type\x3d'hidden']").each(function(a,c){b(c)})}function r(){L||(L=x("input[type\x3d'hidden'][name\x3d'scopeId']").val());return L}function t(a,b,d){if(d.getResponseHeader("x-amz-checkout-page")){var f=g.jsonify(a);return f&&f.success&&f.trialkey&&O[f.trialkey]?(a=O[f.trialkey],c.isSPP()&&"object"===typeof a&&(a=JSON.stringify(O[f.trialkey])),
e.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<x(".mobile-view").length?c.ajaxUpdatePage(a,b,d,{pushNewFrame:"false"}):c.ajaxUpdatePage(a,b,d),ba&&(clearTimeout(ba),ba=null),O={},!0):e.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<x(".mobile-view").length?c.ajaxUpdatePage(a,b,d,{pushNewFrame:"false"}):c.ajaxUpdatePage(a,b,d)}return c.redirect(a)}function H(a,b){if(a){var c=a.data(b);if(c!==F)return c;(a=a.closest(".radio-standard"))&&(c=a.data(b));return c}}function y(a){a.closest("fieldset").find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");
a.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive")}function G(a){var b=a;x(".shipping-group").each(function(a,c){var d=!1;x(c).parents().each(function(a,b){return x(b).hasClass("shipment")?(d=!0,!1):!0});d||(b=b.add(c))});return b}function E(a,b,f,g){V&&y(a);g&&g.transitionAction?g.transitionAction():k.show();for(var l in fa)fa.hasOwnProperty(l)&&(fa[l].abort(),delete fa[l]);f=x("#spc-orders").find("input[type\x3d'hidden'][name\x3d'shiptrialprefix']").val();
var n;a||(a=x("#"+b).closest(".shipping-speed").find("input[type\x3d'radio']"));a.attr("value")!==X&&(h.increaseCount("checkout:spc:shipoption:change",1),X=a.attr("value"));n=a.closest(".shipment").data("orderid");a&&a.length&&a.hasClass("valid-btn")&&a.closest(".prime-calendar").hasClass("long-calendar")&&(n=a.closest(".prime-calendar").data("orderid"));var m="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1";if(g&&g.extraData)for(var u in g.extraData)g.extraData.hasOwnProperty(u)&&
(m+="\x26"+u+"\x3d"+g.extraData[u]);var p=x(".shipment"),v=0;b=p.length;p=G(p);m+="\x26groupsadded\x3d"+(p.length-b);p.each(function(b,c){var d=x(c),f="",h=d.has(".prime-calendar-container"),g=d.find("input[name\x3d'currentshippingspeed']").attr("value"),l=d.find("input[name\x3d'currentshipsplitpreference']").attr("value");1===p.length&&(m+="\x26oldoption\x3d"+g+"."+l);var k=d.find("input[name\x3d'defaultshipsplitpreference."+v+"']").attr("value"),r=d.find("input[name\x3d'usingprimeshipping."+v+"']").attr("value");
k&&r&&(m+="\x26defaultshipsplitpreference."+v+"\x3d"+k,m+="\x26usingprimeshipping."+v+"\x3d"+r);k=d.find(".shipping-speed");k=a?k.find('input[type\x3d"radio"]:checked'):k.find("input[src*\x3dradio-on]");h&&!k.length&&(k=d.find("input[name\x3d'hiddenSelection"+v+"']"));r=d.find(".ship-split-preferences").find("input[type\x3d'radio']:checked");1!==r.length&&(r=d.find(".ship-split-preferences").find("input[type\x3d'hidden'][name^\x3d'shippriority']"));n===d.data("orderid")&&(H(a,"shippingofferingid")?
k=a:r=a,1===p.length&&(f=h?f+("\x26option\x3d"+k.data("key")+"."+(r?r.attr("value"):"")):f+("\x26option\x3d"+k.attr("value")+"."+(r?r.attr("value"):""))));var t=d.find("input[name\x3d'lineitemids"+v+"']");0<t.length&&(f+="\x26lineitemids"+v+"\x3d"+t.attr("value"));f+=N(d,v);k.length?(d=f,g=k,l=r,c="",f=v,H(g,"rcxsspdecoupling")?(c={},c["shippingspeed"+f]=h?g.attr("key"):g.attr("value"),c["shippingofferingid"+f]=H(g,"shippingofferingid"),c["guaranteetype"+f]=H(g,"guaranteetype"),c["issss"+f]=H(g,"issss"),
c["forceshipsplitpreference"+f]=H(g,"forceshipsplitpreference"),h="shipWhenComplete",l&&(h=l.attr("value")),1===H(g,"isscheduleddelivery")&&(c["isscheduleddelivery"+f]="1",h="shipWhenComplete"),c["shippriority"+f]=h,c["preferredSSP"+f]=H(g,"shipsplitpriority"),c["currentSSP"+f]=l.attr("value"),c["isShipWheneverValid"+f]=H(g,"isshipwhenevervalid"),c["isShipWhenCompleteValid"+f]=H(g,"isshipwhencompletevalid"),c=x.param(c),h="\x26"+c):(c=h?c+("\x26shippingspeed"+f+"\x3d"+g.data("key")):c+("\x26shippingspeed"+
f+"\x3d"+g.attr("value")),c+="\x26shippingofferingid"+f+"\x3d"+H(g,"shippingofferingid"),c+="\x26guaranteetype"+f+"\x3d"+H(g,"guaranteetype"),c+="\x26issss"+f+"\x3d"+H(g,"issss"),c+="\x26forceshipsplitpreference"+f+"\x3d"+H(g,"forceshipsplitpreference"),h="shipWhenComplete",l&&(h=l.attr("value")),1===H(g,"isscheduleddelivery")&&(c+="\x26isscheduleddelivery"+f+"\x3d1",h="shipWhenComplete"),h=c+("\x26shippriority"+f+"\x3d"+h)),f=d+h,1===H(k,"isscheduleddelivery")?(h=k.closest(".shipping-speed").find('[id^\x3d"sd_widgets_"]'),
e.isSDGoldenCXSPCDesktopEnabled()&&(h=x("#sd-widgets-"+b)),f+="\x26"+h.children(":input").serialize()):1===H(k,"isscheduleddeliveryslot")&&H(k,"sddatastring")&&(f+="\x26ScheduledDeliveryEntity.data."+v+"\x3d"+encodeURIComponent(k.data("sddatastring")))):0<d.find(".vas-scheduling-prefBlock").length?(b=f,h=v,k=""+("\x26shippingofferingid"+h+"\x3d"+d.find("input[type\x3d'hidden'][name^\x3d'shippingofferingid']").val()),k+="\x26guaranteetype"+h+"\x3d"+d.find("input[type\x3d'hidden'][name^\x3d'guaranteetype']").val(),
k+="\x26issss"+h+"\x3d"+d.find("input[type\x3d'hidden'][name^\x3d'issss']").val(),k+="\x26forceshipsplitpreference"+h+"\x3d"+d.find("input[type\x3d'hidden'][name^\x3d'forceshipsplitpreference']").val(),f=b+(k+("\x26shippingspeed"+h+"\x3d"+g)+("\x26shippriority"+h+"\x3d"+l))):e.isRemoveDigitalFlagForScheduledDeliveryShipmentEnabled()&&"1"===x(c).find("input[type\x3d'hidden'][name\x3d'previousSDSelected"+v+"']").attr("value")||(f+="\x26isdigital"+v+"\x3d1");v++;m+=f});0<v&&(m+="\x26groupcount\x3d"+
v);b="ox_spc_set_ship_option";c.isSPP()&&(b="chk_revieworder_set_ship_option",u=x("#setOrderingPrefsCheckbox"),u.length&&u.is(":checked")&&(m+="\x26saveAsDefaultsSelected\x3d1"));u=x("input[name\x3duseCtb]").val();m+="\x26isClientTimeBased\x3d"+u;1===H(a,"istrial")?(f=r()+":"+a.attr("name")+":"+a.attr("value"),m+="\x26trialkey\x3d"+f,O[f]&&(ba&&clearTimeout(ba),b="ox_spc_set_cached_ship_option",c.isSPP()&&(b="chk_revieworder_set_cached_ship_option"),m=m.replace("returnFullHTML\x3d1","returnFullHTML\x3d0"),
m+="\x26trialSuccess\x3d1")):"undefined"!==typeof f&&(f=f+":"+a.attr("name")+":"+a.attr("value"),m+="\x26trialkey\x3d"+f);g&&g.refTag&&(b=g.refTag);g&&g.removeGiftOption&&(m+="\x26giftOrderid\x3d"+a.closest(".shipment").data("orderid"));0===m.indexOf("\x26")&&(m=m.substr(1));g="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+b;f=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});e.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<x(".mobile-view").length&&(f=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc",
"x-amz-checkout-transition":"ajax"}));x.ajax({type:"POST",url:g,data:m,dataType:"text",async:!0,cache:!1,headers:f,success:function(a,b,c){t(a,b,c);d.nukeDropdowns("#b2brd-cadence-dropdown")},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}function I(a,b){V&&y(a);a=b.find("input[name\x3d'ispuLoadingText']").attr("value");if(c.isSPP()&&a){var d=x("#shipaddress");d&&d.length&&(d.hasClass("expanded")?k.show():(k.shrinkPanel(x(".spp-panel.expanded"),!1),k.shrinkPanel(d,!0,a)))}else k.show();a="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+
(new Date).getTime()+"\x26hasWorkingJavascript\x3d1";var d=b.find("input[name\x3d'storeAddressID']").attr("value"),e=b.find("input[name\x3d'storeId']").attr("value"),f=b.find("input[name\x3d'storeOwnerId']").attr("value"),h=b.find("input[name\x3d'lineItemsQuantity']").attr("value"),g=b.find("input[name\x3d'destinationType']").attr("value"),l=b.find("input[name\x3d'ispuShippingOfferingId']").attr("value"),n=b.find("input[name\x3d'ispuShipSplitPriority']").attr("value"),m=b.find("input[name\x3d'ispuGuaranteeType']").attr("value");
b=b.find("input[name\x3d'ispuPageType']").attr("value");a=a+("\x26storeId\x3d"+e)+("\x26storeAddressId\x3d"+d)+("\x26storeOwnerId\x3d"+f);a+="\x26lineItemsQuantity\x3d"+h;a+="\x26destinationType\x3d"+g;a+="\x26shippingOfferingId\x3d"+l;a+="\x26shipPriority\x3d"+n;a+="\x26guaranteeType\x3d"+m;a+="\x26pageType\x3d"+b;b="chk_spc_ispu_ship_option";c.isSPP()&&(b="chk_revieworder_ispu_ship_option");b="/gp/buy/ispu/handlers/ispu-select-store.html/ref\x3d"+b;d=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});
0<x(".mobile-view").length&&(d=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"}));x.ajax({type:"POST",url:b,data:a,dataType:"text",async:!0,cache:!1,headers:d,success:function(a,b,c){t(a,b,c)},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}function da(a){var b=[a.closest(".shipment").data("orderid")];P(a,b)}function W(a){var b=[];x("#spc-orders").find(".shipment").each(function(a,c){b.push(a)});h.increaseCount("checkout:spc:mobile:same-day-upsell-banner:clicked",
1);P(a,b)}function P(a,b){k.show();var d="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1",e="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+a.data("reftag");x("#spc-orders").find(".shipment").each(function(c,e){d+="\x26lineitemids"+c+"\x3d"+x(e).find("input[type\x3d'hidden'][name\x3d'lineitemids"+c+"']").attr("value");d+=N(x(e),c);var f=x(e).find("input[type\x3d'hidden'][name^\x3d'shippriority']");if(e=-1===b.indexOf(c)?
x(e).find("#selected-ship-option-"+c):a)d+="\x26shippingofferingid"+c+"\x3d"+e.data("shippingofferingid"),d+="\x26guaranteetype"+c+"\x3d"+e.data("guaranteetype"),d+="\x26issss"+c+"\x3d"+e.data("issss"),d+="\x26forceshipsplitpreference"+c+"\x3d"+e.data("forceshipsplitpreference"),d+="\x26shippriority"+c+"\x3d"+e.data("targetshipoptionkey"),e.data("rcxsspdecoupling")&&(d+="\x26preferredSSP"+c+"\x3d"+e.data("shipsplitpriority"),d+="\x26currentSSP"+c+"\x3d"+f.attr("value"),d+="\x26isShipWheneverValid"+
c+"\x3d"+e.data("isshipwhenevervalid"),d+="\x26isShipWhenCompleteValid"+c+"\x3d"+e.data("isshipwhencompletevalid"))});var f=x("#spc-orders").find("input[type\x3d'hidden'][name\x3d'groupcount']").val(),d=d+("\x26groupcount\x3d"+f),d=d+("\x26isClientTimeBased\x3d"+x("input[type\x3d'hidden'][name\x3d'useCtb']").attr("value")),d=d+("\x26trialkey\x3d"+r()+":"+a.data("orderindex")+":"+a.data("targetshipoptionkey")),f=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});x.ajax({type:"POST",url:e,data:d,
dataType:"text",async:!0,cache:!1,headers:f,success:function(a,b,c){t(a,b,c)},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}function D(b,c,e,f){d.protectAgainstDoubleAction(c)||A||(a.trigger(e,b),b=b.$currentTarget.find("a"),f&&f(b))}function N(a,b){var c=a.find("input[name\x3d'onOrAfterAppointment"+b+"']").val();a=a.find("input[name\x3d'onOrAfterLineItemId"+b+"']").val();var d="";c&&a&&(d=d+("\x26onOrAfterAppointment"+b+"\x3d"+c)+("\x26onOrAfterLineItemId"+b+"\x3d"+a));return d}function U(){ea.closest("div.shipping-speed").find('input[type\x3d"radio"]').attr("checked",
!0);"undefined"!==typeof n?(0<x(".mobile-view").length?n.get(x("#faster-than-same-day-sosp-popover")):n.get(x("#faster-than-same-day-spc-popover"))).hide():a.$("div.a-popover button.a-button-close").trigger("click");E(ea,null,null,{removeGiftOption:!0})}var x=a.$;if(!x("html").hasClass("a-ie6")){var L,O={},V=x("html").hasClass("a-touch"),ba,fa={},aa,X,ea;p.spcpage.scheduledDeliverySetSOCallback=function(b,d){c.isSPP()&&a.objectIsEmpty(b)||(p.spcpage&&x("#spcpagecontent").is(":visible")?p.spcpage.actionSetShipOptions(null,
d,b):E(null,d,b))};p.spcpage.scheduledDeliverySetSOCallbackWithTarget=function(b,d,e){c.isSPP()&&a.objectIsEmpty(d)||(p.spcpage&&x("#spcpagecontent").is(":visible")?p.spcpage.actionSetShipOptions(null,e,d):E(b,e,d))};p.spcpage.scheduledDeliveryEnableSOCallback=function(){};p.spcpage.scheduledDeliveryMdwSetSOCallback=function(b,d,f){e.isSsdMdwEnabled()&&(c.isSPP()&&a.objectIsEmpty(d)||(p.spcpage&&x("#spcpagecontent").is(":visible")?p.spcpage.actionSetShipOptions(null,f,d):E(b,f,d)))};x(document).delegate(".ship-option",
"click",function(b){var c=x(b.target);e.isSPCMobileDisplayMoreShipOptionsEnabled()&&x(b.target).closest(".ship-option").hasClass("mobile-view")&&b.preventDefault();var f=x(b.currentTarget);h.resetMetrics();if(!(c.is('a[target\x3d"AmazonHelp"]')||c.is('a[target\x3d"PromoDetails"]')||c.hasClass("no-ship-option-selection-change")||f.is("input")||c.hasClass("a-button")||c.closest("a-button").length||c.is("img")&&(c.closest("div").is(".prime-ship-speed")||c.closest(".prime-fake-radio").parent().is(".prime-ship-speed"))))if(c=
f.find("div.prime-ship-speed"),0<c.length)c.find("a:first img").trigger("click");else if((c=f.find("input[type\x3d'image']").attr("src"))&&c.match(/radio-off/)&&x(".ap_popover_sprited").hide(),f=f.find("input[type\x3d'radio']"),(c=f.closest("div.shipping-speeds").data("sospargs"))&&1===f.data("isscheduleddelivery")&&!f.is(":checked"))k.show(),f.attr("checked",!0),y(f),d.redirectWithJavascript("/gp/buy/shipoptionselect/handlers/display.html?"+c);else if(e.removesGiftOptionOnRush()&&0<f.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&
1===f.closest(".radio-standard").data("nosupportforgiftoption")){ea=f;ea.is(":checked")&&(ea.attr("checked",!1),aa.attr("checked",!0));var g=0<x(".mobile-view").length?x("#faster-than-same-day-sosp-popover"):x("#faster-than-same-day-spc-popover");"undefined"!==typeof n?n.get(g).show():a.delay(function(){g.trigger("click")},10)}else if(f.hasClass("js-no-serverside-callback")&&(f.attr("checked",!0),y(f),f.closest(".a-section-expander-container").find(".a-link-section-expander").click()),!e.isSsdMdwEnabled()||
1!==f.closest(".radio-standard").data("callcaseforsdoverride"))if(!e.isSDGoldenCXSPCDesktopEnabled()||1!==H(f,"isscheduleddelivery")||!l.isDesktopSpc()){var c=x("#disableSubmitButtons").length,m=!1;e.isSPCMobileDisplayMoreShipOptionsEnabled()&&(b=x(b.currentTarget).closest(".ship-option"),b.hasClass("mobile-view")&&!b.hasClass("mobile-selected-option")&&(m=!0));!c&&f.is(":checked")&&!m||1===f.data("isscheduleddelivery")||(f.attr("checked",!0),E(f))}});x(document).delegate(".ship-option input[type\x3d'radio']",
"change",function(a){if(!e.isSPCMobileDisplayMoreShipOptionsEnabled()||!x(a.target).closest(".ship-option").hasClass("mobile-view")){a=x(a.currentTarget);var b=a.closest("div.prime-ship-speed");e.removesGiftOptionOnRush()&&0<a.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&1===a.closest(".radio-standard").data("nosupportforgiftoption")||e.isSsdMdwEnabled()&&1===a.closest(".radio-standard").data("callcaseforsdoverride")||e.isSDGoldenCXSPCDesktopEnabled()&&1===H(a,"isscheduleddelivery")&&
l.isDesktopSpc()||(0<b.length?b.find('input[type\x3d"radio"]').attr("checked",!1):1!==a.data("isscheduleddelivery")&&E(a))}});x(document).delegate(".ispu-ship-option","click",function(a){if(e.isISPUMasterEnabled()){x(a.target).closest(".ispu-ship-option").hasClass("mobile-view")&&a.preventDefault();x(a.target);var b=x(a.currentTarget);h.resetMetrics();var c=b.find("input[type\x3d'radio']"),d=!1;a=x(a.currentTarget).closest(".ispu-ship-option");a.hasClass("mobile-view")&&!a.hasClass("mobile-selected-option")&&
(d=!0);if(!c.is(":checked")||d)c.attr("checked",!0),I(c,b)}else h.increaseCount("checkout:ispu:selection:weblab:disabled",1)});x(document).delegate(".ispu-ship-option input[type\x3d'radio']","change",function(a){if(!e.isISPUMasterEnabled())h.increaseCount("checkout:ispu:selection:weblab:disabled",1);else if(!x(a.target).closest(".ispu-ship-option").hasClass("mobile-view")){a=x(a.currentTarget);var b=a.closest(".ispu-ship-option");I(a,b)}});x(document).delegate(".rush-ispu-ship-option","click",function(a){if(e.isRushISPUMasterEnabled()){x(a.target).closest(".rush-ispu-ship-option").hasClass("mobile-view")&&
a.preventDefault();x(a.target);var b=x(a.currentTarget);h.resetMetrics();var c=b.find("input[type\x3d'radio']"),d=!1;a=x(a.currentTarget).closest(".rush-ispu-ship-option");a.hasClass("mobile-view")&&!a.hasClass("mobile-selected-option")&&(d=!0);if(!c.is(":checked")||d)c.attr("checked",!0),I(c,b)}else h.increaseCount("checkout:rushIspu:selection:weblab:disabled",1)});x(document).delegate(".rush-ispu-ship-option input[type\x3d'radio']","change",function(a){if(!e.isRushISPUMasterEnabled())h.increaseCount("checkout:rushIspu:selection:weblab:disabled",
1);else if(!x(a.target).closest(".rush-ispu-ship-option").hasClass("mobile-view")){a=x(a.currentTarget);var b=a.closest(".rush-ispu-ship-option");I(a,b)}});x(document).delegate(".rush-ispu-view-details-link","click",function(a){a.preventDefault();a.stopPropagation()});a.declarative("shipping-speed-expander-toggle",["click"],function(a){var b=a.$target.closest(".a-box"),c,e;b.hasClass("a-single")?(c=b.find(".expanded-header-content"),e=b.find(".collapsed-header-content"),e.hide(),c.hasClass("prime-title")&&
c.find("div").attr("style",""),c.show()):(e=b.find(".collapsed-header-content"),c=b.find(".expanded-header-content"),b=b.siblings(".a-expander-content").find(".a-icon-touch-radio-active").siblings(".a-radio-label").html(),e.html(b),c.hide(),e.show());d.toggleExpanderContent(a)});a.declarative("select-prime-slot",["click"],function(a){a=a.$currentTarget;x(".a-button-close").trigger("click");a.closest(".valid-slot").hasClass("selected-slot")||E(a)});var A=!1;x(document).delegate(".mobile-upsell","touchmove",
function(a){A=!0});x(document).delegate(".mobile-upsell","touchstart",function(a){A=!1});a.declarative("select-upsell-shipping-speed",["click","touchend"],function(a){D(a,"select-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select",da)});a.declarative("select-all-upsell-shipping-speed",["click","touchend"],function(a){D(a,"select-all-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select-all",W)});a.declarative("faster-than-same-day-save",["click"],U);a.declarative("faster-than-same-day-sosp-save",
["click"],U);a.on("checkout:reload:spc",b);a.on("checkout:reload:spp-revieworder",b)}});"use strict";q.when("A","page-detector","spc-page-state","client-side-metrics","page-conductor","weblab-helper").register("order-summary-controller",function(a,k,g,c,d,f){function l(){q=b("#transactionalRadio");w=b("#marketplaceRadio");v=b("#tfx-see-exchange-rates");u=b("#tfx-switch-currency-options");m||(c.increaseCount("removeauijs15"),b("#transactionalRadioImage").remove(),b("#marketplaceRadioImage").remove(),
b("#acceptAccImage").remove());var a=b("#exchange-rate-link"),d=b("#switch-currency-link");if(0!==w.length){var e=u.find('input[name\x3d"switchCurrency"]'),f=e.not(":checked"),e=g.prop("currencyType")||e.filter(":checked").val();f.val()===e?f.trigger("click"):h(e);m||(c.increaseCount("removeauijs16"),a.find("i.a-icon-collapse").remove(),d.find("i.a-icon-collapse").remove())}}function h(e){b(".tfx-currency").each(function(){b(this).text(b(this).data(e))});g.prop("currencyType",e);var h=b("#subtotals-marketplace-table"),
l=b("#subtotals-transactional-table"),n=b("#subtotals-marketplace-spp-bottom"),u=b("#subtotals-transactional-spp-bottom"),p=b("#vatRetailSubtotals-transactional-table"),E=b("#vatGlobalSubtotals-transactional-table"),I=b("#vatMerchantSubtotals-transactional-table"),F=b("#vatRetailSubtotals-marketplace-table"),W=b("#vatGlobalSubtotals-marketplace-table"),P=b("#vatMerchantSubtotals-marketplace-table"),D=b(".place-your-order-button"),N=b("#fx-enable"),U=d.isSPP()?b(".place-order-button-text"):b(".place-your-order-button + span");
d.isSPP()||setTimeout(function(){var a=Math.max(h.outerHeight(),l.outerHeight());0<a&&(h.height(a),l.height(a))},500);if(!m){c.increaseCount("removeauijs17");var x=w.siblings("i"),L=q.siblings("i");if(x.hasClass("a-icon-touch-radio-inactive")||x.hasClass("a-icon-touch-radio-active"))"marketplace"===e?(x.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),L.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive")):(L.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),
x.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"))}"marketplace"===e?(b("#fxGoodNews-transactional").hide(),b("#fxGoodNews-marketplace").show(),l.hide(),h.show(),u.hide(),n.show(),p.hide(),E.hide(),I.hide(),F.show(),W.show(),P.show(),f.isTFXGuaranteedExchangeFeeEnabled()&&(v.hide(),N.hide()),D.val(b("#placeYourOrderTextMarketplace").val()),m&&U.text(b("#placeYourOrderTextMarketplace").val()),b("#currencyChanged").attr("value","true"),b("#fxCurrencyChoice").attr("value",
"marketplace"),b("#tfx-total-header").addClass("aok-hidden"),b("#mkt-total-header").removeClass("aok-hidden")):(b("#fxGoodNews-transactional").show(),b("#fxGoodNews-marketplace").hide(),h.hide(),l.show(),n.hide(),u.show(),F.hide(),W.hide(),P.hide(),p.show(),E.show(),I.show(),f.isTFXGuaranteedExchangeFeeEnabled()&&(v.show(),N.show()),D.val(b("#placeYourOrderTextTransactional").val()),m&&U.text(b("#placeYourOrderTextTransactional").val()),b("#currencyChanged").attr("value","false"),b("#fxCurrencyChoice").attr("value",
"transactional"),b("#mkt-total-header").addClass("aok-hidden"),b("#tfx-total-header").removeClass("aok-hidden"));a.trigger("checkout:spc:ordersummary:sizeChanged");k.isMobileSpc()&&(n=b("#vatBreakdownNote"),0<n.size()&&(u=n.attr("href"),u=0<u.lastIndexOf(".html?")?u+("\x26currencyType\x3d"+e):u+("?currencyType\x3d"+e),n.attr("href",u)))}function e(a){var d=b("#tfx-footer"),e=b("#tfx-header");if(!m){c.increaseCount("removeauijs18");var f=b("#fxApplicabilityDecision").siblings("i"),g=b("#fxApplicabilityAdoption").siblings("i");
if(g.hasClass("a-icon-touch-checkbox-inactive")||g.hasClass("a-icon-touch-checkbox-active"))g.removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),f.removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active")}"accept"===a?(n()?(b("#fx-terms-and-conditions").show(),b("#fxCardCurrencySubcondition").hide()):(b("#fx-enable").show(),b("#fx-disable").hide()),b("#fxApplicabilityDecision").prop("checked",!0),e.show(),h("transactional"),d.show(),
b("#marketplaceRadio").prop("checked",!1),b("#transactionalRadio").prop("checked",!0),b("#fxApplicabilityChoice").attr("value","accept")):(n()?(b("#fx-terms-and-conditions").hide(),b("#fxCardCurrencySubcondition").show()):(b("#fx-enable").hide(),b("#fx-disable").show()),b("#fxApplicabilityAdoption").prop("checked",!1),e.hide(),h("marketplace"),d.hide(),b("#transactionalRadio").prop("checked",!1),b("#marketplaceRadio").prop("checked",!0),b("#fxApplicabilityChoice").attr("value","decline"))}function n(){return d.isSPP()&&
b("input[name\x3disNewTFXExperienceEnabled]").length}var b=a.$;if(!b("html").hasClass("a-ie6")){var m=p.P&&p.P.AUI_BUILD_DATE,v,u,q,w;f.isTFXCurrencyToggleOnTabletFixed()?(b(document).delegate("#checkoutCurrencyTransactional","click",function(){h("transactional")}),b(document).delegate("#checkoutCurrencyMarketplace","click",function(){h("marketplace")})):(b(document).delegate("#transactionalRadio","click",function(){h("transactional")}),b(document).delegate("#marketplaceRadio","click",function(){h("marketplace")}));
b(document).delegate("#fxApplicabilityDecisionCheckbox","click",function(){e("decline")});b(document).delegate("#fxApplicabilityAdoptionCheckbox","click",function(){var a=n()&&!b("#fxApplicabilityAdoption").is(":checked");e(a?"decline":"accept")});a.on("a:expander:tfx-options-expander:toggle:expand",function(a){c.increaseCount("checkout:spp-ordersummary:expand_tfx_options",1)});a.on("a:expander:tfx-see-rate-expander:toggle:expand",function(a){c.increaseCount("checkout:spp-ordersummary:expand_tfx_see_rate",
1)});return{changeCurrency:h,initOrderSummary:l}}});"use strict";q.when("A","ready").register("spc-page-state",function(a){var k={};return{prop:function(a,c){if(a&&"string"===typeof a)return 1<arguments.length&&(k[a]=c),k[a]}}});"use strict";q.when("A","ready").execute(function(a){function k(){0<g("#spcCachedPromiseData").length&&(c=(new Date).getTime(),g(".place-your-order-button").click(function(){var a=(new Date).getTime()-c;g("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'spcWaitingTime' value\x3d'"+
a+"' /\x3e")}))}var g=a.$,c=0;a.on("checkout:reload:spc",k);a.on("checkout:reload:spclite",k);a.on("checkout:reload:spp-revieworder",k)});"use strict";q.when("A","client-side-metrics","ready").register("spc-apx-standin",function(a,k){function g(c){var f=a.state("apx-standin-state");f.timestamp=(new Date).toISOString();f.metricName=c;return f}if(a.state("apx-standin-state")){var c=g("APX_STANDIN_ENABLED");k.emitNexusMetrics(c,c.producerId,c.schemaId);a.on("a:popover:show",function(a){if(a.popover&&
a.popover.name&&"apx-popover"==a.popover.name||a.popover&&a.popover.originalFocus&&a.popover.originalFocus.id&&"payChangeButtonId"==a.popover.originalFocus.id)a=g("APX_STANDIN_POPOVER_SHOW"),k.emitNexusMetrics(a,a.producerId,a.schemaId)});a.on("a:sheet:afterShow:apx_standin_bottom_sheet_instance",function(a){a=g("APX_STANDIN_POPOVER_SHOW");k.emitNexusMetrics(a,a.producerId,a.schemaId)})}});"use strict";q.when("A","page-transition-controller","scroll-controller","loading-spinner-controller","page-conductor",
"checkout-general-utils","ready").register("changeCustomerDetailsPopover",function(a,k,g,c,d,f){function l(){return 0<n("#onblur-character-validation-error-changeNameInput").size()}function h(){b&&b.find("button[data-action\x3da-popover-close]").trigger("click")}function e(){var a=n("#saveButton");if(a.length){var b=n("#changeNameInput"),c=n("#changePostNumberInput"),d=n("#changePhoneInput"),e=1,f=1,h=1;b.length&&!b.val()&&(e=0);c.length&&!c.val()&&(f=0);d.length&&!d.val()&&(h=0);e&&f&&h&&!l()?(a.removeClass("a-button-disabled"),
a.removeAttr("disabled")):(a.addClass("a-button-disabled"),a.attr("disabled","true"))}}var n=a.$,b;a.declarative("clickedsave","click submit",function(a){if(!l()){var b=n("#changeNameInput").val(),c=n("#changePhoneInput").val(),e=n("#changePostNumberInput").val(),f=n("#changeAccountNameCheckBox").is(":checked")?1:0,g=n("#changePostNumberCheckBox").is(":checked")?1:0,b="custName\x3d"+encodeURIComponent(b)+"\x26changeAccountName\x3d"+encodeURIComponent(f);c&&(b=b+"\x26custPhoneNumber\x3d"+encodeURIComponent(c));
e&&(b=b+"\x26dhlPostNumber\x3d"+encodeURIComponent(e),g&&(b=b+"\x26changeDhlPostNumberInEmbu\x3d"+encodeURIComponent(g)));c=a.data.changeDetailUrl;d.isSPP()&&(c=a.$target.data("changedetailurl"),n("#cancelReminderPopover").click());d.isSPP()||(b+="\x26usePipelineDispatch\x3d1");k.show();c&&n.ajax({type:"POST",data:b,url:c,dataType:"html",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",async:!0,cache:!1,headers:d.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"}),success:function(a,
b,c){h();k.hide();d.ajaxUpdatePage(a,b,c)},error:function(a,b,c){d.ajaxRedirect(a,b,c)}})}});a.declarative("clickedsave","mouseenter mousemove touchstart",function(a){e()});a.declarative("changeNameKeyIn changePostNumberKeyIn changePhoneNumberKeyIn","keydown keyup change keypress mouseenter mouseleave mousemove",function(a){e()});a.declarative("clickedcancel","click submit",function(a){h()});a.on("a:popover:beforeShow:changeDetailPopover",function(a){l()&&n("#onblur-character-validation-error-changeNameInput").remove()});
a.on("a:popover:show:changeDetailPopover",function(a){if(!d.isSPP()){var c=n(p).width(),f=n(p).height(),c=parseInt(.6*c,10),f=parseInt(.7*f,10);b=a.popover.$popover;var h=a.popover;b.css("position","absolute");b.css("top","50px");b.css("height",f+"px");b.css("width",c+"px");h.updatePosition()}c=d.isSPP()?a.popover.originalnamevalue:a.popover.$trigger.data("original-name-value");f=d.isSPP()?a.popover.originalcellphonevalue:a.popover.$trigger.data("original-cellphone-value");a=d.isSPP()?a.popover.originalpostnumbervalue:
a.popover.$trigger.data("original-postnumber-value");var h=n("#changeNameInput"),g=n("#changePhoneInput"),l=n("#changePostNumberInput");h.val(c);g.val(f);l.val(a);e()})});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","page-detector","checkout-general-utils").register("prime-decline-controller",function(a,k,g,c,d,f){function l(){e("input[name\x3d'changeCardNoEndDatePrime']").attr("data-action","prime-decline-element")}function h(a,b,d){if(d.getResponseHeader("x-amz-checkout-page"))c.ajaxUpdatePage(a,
b,d);else{a=g.jsonify(a);if(!a)return c.redirect();a.error?k.hide():a.errors?k.hide():a.autohandlererror?(b=(a=a.autohandlererror)?a.action:null,d=a&&a.type?a.type:b&&b.code?b.code:"string"===typeof a?a:"Unknown:pipelineJSError",p.location.href="fatal"===b?"/gp/buy/payselect/handlers/error.html?errorAction\x3dfatal\x26errorType\x3d"+encodeURIComponent(d):"redirect"===b?a.url:"/gp/buy/payselect/handlers/error.html?errorType\x3d"+encodeURIComponent(d)):c.redirect(a)}}var e=a.$;e("html").hasClass("a-ie6")||
(a.declarative("prime-decline-element",["click","touchend"],function(a){f.protectAgainstDoubleAction("prime-decline-element")||(a.$event.preventDefault(),k.show(),a=(new Date).getTime(),a="changeCardNoEndDatePrime\x3d1\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26fromAnywhere\x3d"+e("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+a,e.ajax({type:"POST",url:"/gp/buy/spc/handlers/stuff-handler.html/ref\x3dox_spc_prime_renew_nodate",data:a,headers:{"Cache-Control":"no-cache",
pragma:"no-cache","x-amz-checkout-page":"spc"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",success:h,error:c.ajaxRedirect}))}),a.on("checkout:reload:spc",l),a.on("checkout:reload:spp-revieworder",l))});"use strict";q.when("A","loading-spinner-controller","page-conductor").register("prime-popover-controller",function(a,k,g){function c(){f={};a.defer(function(){0!==d("#spc-orders").find(".prime-popover-link").length&&(d("#spc-orders").find(".prime-popover-link").each(function(){var a=
d(this);if(a.data("action")){a.removeAttr("href").attr("tabindex",0);var c=a.data("aCheckoutModalPopover");var e=c.name,g="";c.width&&c.height&&(g="width:"+c.width+"px;height:"+c.height+"px;");0<d("#spc-orders").find("#"+e+"-popover").length||(c=d(['\x3cdiv id\x3d"a-popover-'+e+'" class\x3d"a-popover-preload" style\x3d"display:none;"\x3e','\x3cdiv id\x3d"'+e+'-popover" class\x3d"checkout" style\x3d"'+g+'"\x3e\x3c/div\x3e',"\x3c/div\x3e"].join("")),d("#spc-orders").append(c));a=a.data("aCheckoutModalPopover").name;
f[a]||(c=d(".prime-popover-content").html())&&0<c.length&&(f[a]=c,d("#"+a+"-popover").html(c))}}),d("#spc-orders").find(".a-box").each(function(){var a=d(this),c=a.find(".prime-ad-banner-content .prime-popover-link");1<c.length&&(c=c.first());a.find("a.primeAdLauncher").each(function(){var a=d(this);a.wrap('\x3cspan class\x3d"a-declarative" data-action\x3d"prime-event" data-prime-event\x3d\'{"metric":"lm3"}\'\x3e\x3c/span\x3e');a.replaceWith(c.clone().text(a.text()).addClass("a-size-mini"))})}))})}
var d=a.$;if(!d("html").hasClass("a-ie6")){var f={};a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("prime")&&(a=a.popover.name,!f[a])){var c=d("input#primePopopverFallbackContent").val()||"";f[a]=c;d("#"+a+"-popover").html(c)}});a.on("checkout:reload:spc",c);a.on("checkout:reload:spp-revieworder",c)}});"use strict";q.when("A","page-transition-controller","back-button-protection","page-conductor","continue-wrapper-selector","weblab-helper").register("place-order-controller",
function(a,k,g,c,d,f){function l(){if(!c.isAnimating()){var h=e("#spc-form");if("0"===e("#showPageTransition").attr("content"))if(h.hasClass("paylast-spc"))k.show();else{if(0<e("#enableAlternatePYOBlocker").length){var b;b=d.SELECTOR?e(d.SELECTOR):h.find(".a-button.continue-button");if("disabled"===b.find("input").attr("disabled"))return;b.find("input").attr("disabled","disabled");b.addClass("a-button-disabled");setTimeout(function(){b.removeClass("a-button-disabled");b.find("input").removeAttr("disabled")},
4E4)}}else k.showPageTransition();var l=e("#currencyChanged");0<l.length&&"true"===l.val()&&(l='\x3cinput type\x3d"hidden" name\x3d"checkoutCurrencySelection.'+e("#tfx-switch-currency-options").find("input:radio:checked").val()+'" /\x3e',e("#spc-form-inputs").append(l));if(f.isMfaPSD2DeviceDescriptionCollectionEnabled())for(var l=[{name:"javaEnabled",value:p&&p.navigator&&p.navigator.javaEnabled()},{name:"language",value:p&&p.navigator&&p.navigator.language},{name:"screenColorDepth",value:p&&p.screen&&
p.screen.colorDepth},{name:"screenHeight",value:p&&p.screen&&p.screen.height},{name:"screenWidth",value:p&&p.screen&&p.screen.width},{name:"timeZone",value:(new Date).getTimezoneOffset()}],q=0;q<l.length;q++)if(l[q].name!==F&&l[q].value!==F){var u='\x3cinput type\x3d"hidden" name\x3d"'+l[q].name+'" value\x3d"'+l[q].value+'" /\x3e';e("#spc-form-inputs").append(u)}0==h.find("input[type\x3d'hidden'][name\x3d'placeYourOrder1']").length&&h.append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");
(l=a.state("firetv-aws-attributes"))&&l.queryParams&&(q=h.attr("action"),q+=0<=q.indexOf("?")?"\x26":"?",q+=e.param(l.queryParams),h.attr("action",q));c.isSPP()&&h.append(e("#subtotalsSection").find("input").hide());g.markAsDirty();h.submit()}}function h(a){a.preventDefault();l(a.target)}var e=a.$;if(!e("html").hasClass("a-ie6"))return a.declarative("a-checkout-place-order",["click"],function(a){l(a.target)}),e(document).delegate("span.place-order-button-link","click",h),{placeOrderClick:l,placeOrderClickDelegate:h,
PLACE_ORDER_BUTTON_LINK_SELECTOR:"span.place-order-button-link"}});"use strict";q.register("continue-wrapper-selector",function(){return{SELECTOR:null}});"use strict";q.when("A","page-conductor","button-blocker","client-side-metrics","weblab-helper").register("verification-checkbox-controller",function(a,k,g,c,d){function f(a){w?l(a):h(a);B&&a&&a.blocking&&(c.setmarker("fn"),B=!1)}function l(a){var c=v(".continue-button"),d=v(".continue-button-blocker"),e=v(".place-order-blocker-message.custom-blocker-message");
if(a.blocking||!b())a.blocking?(e.text(a.message),c.addClass("aok-hidden"),d.removeClass("aok-hidden")):(e.empty(),c.removeClass("aok-hidden"),d.addClass("aok-hidden"),q.when("a-tooltip").execute(function(a){(a=a.get(d))&&a.isActive()&&a.hide()}))}function h(a){a.blocking?g.show("place-order-imb-checks",a.message):(g.hide("place-order-imb-checks"),v("#hasTVNavigation").length&&q.when("a-tv").execute(function(a){a.select(".continue-button")}))}function e(){var b,e={blocking:!1,message:""};if(w)b=v("#spc-imb").find(".verification-checkbox input:not(:checked)"),
0<b.length&&(e={blocking:!0,message:b.first().closest(".verification-checkbox").attr("data-blocker-message")});else{c.increaseCount("removeauijs23");if(!v("#spc-imb").find(".verification-checkbox").length)return;b=k.isSPP()?v("#spc-imb").find(".verification-checkbox input:not(:checked)"):v("#spc-imb").find(".verification-checkbox:not(:checked)");0<b.length&&(e={blocking:!0,message:k.isSPP()?b.first().closest(".spp-panel").hasClass("aok-hidden")?b.first().closest(".verification-checkbox").data("non-review-panel-blocker-msg"):
b.first().closest(".verification-checkbox").data("blocker-message"):b.first().attr("data-blocker-message")})}d.isPyoClientSideInitiationEnabled()?f(e):a.trigger("checkbox:primaryActionBlocker:blockingStateChanged",e)}function n(){var a=v("#wineNoticeCheckbox");a&&a.length&&(u?(a.attr("checked",""),z&&(a=a.siblings(".a-icon-touch-checkbox-inactive"))&&a.length&&(a.removeClass("a-icon-touch-checkbox-inactive"),a.addClass("a-icon-touch-checkbox-active"))):(a.removeAttr("checked",""),z&&(a=a.siblings(".a-icon-touch-checkbox-active"))&&
a.length&&(a.removeClass("a-icon-touch-checkbox-active"),a.addClass("a-icon-touch-checkbox-inactive"))))}function b(){var a=v("input[name\x3disINExpressCheckoutCC]");return a&&a.length?1===parseInt(a.val(),10):!1}function m(){d.isPyoClientSideInitiationEnabled()||n();v('[data-client-component\x3d"PrimaryActionBlockerCheckbox"]').length||(e(),d.isPyoClientSideInitiationEnabled()&&n());var a=p.P&&p.P.AUI_BUILD_DATE?'.verification-checkbox input[type\x3d"checkbox"]':"input.verification-checkbox";v("#spc-imb").find(a).unbind("change.verification-checkbox").bind("change.verification-checkbox",
e)}var v=a.$,u,z=v("html").hasClass("a-touch"),w=!k.isSPP()&&p.P&&p.P.AUI_BUILD_DATE,B=!0;if(!v("html").hasClass("a-ie6")){if(!d.isPyoClientSideInitiationEnabled())a.on("checkbox:primaryActionBlocker:blockingStateChanged",f);a.declarative("change-wine-notice-checkbox",["change"],function(a){u=a.$target.is(":checked")?1:0});a.on("checkout:reload:spc",m);a.on("checkout:reload:spclite",m);a.on("checkout:reload:spp-revieworder",m);a.on("checkout:reload:spp-collapsed",m);a.on("checkout:unload",function(){B=
!0});a.on("checkout:afterReload",function(){B=!1});return{verifyCheckboxes:e,updatePyo:f}}});"use strict";q.when("A","page-transition-controller","scroll-controller","ajax-utility","page-conductor","quantity-service","checkout-modal-popover","page-detector","checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("quantity-update-controller",function(a,k,g,c,d,f,l,h,e,n,b,m){function v(){ba=V=!1;a.defer(function(){var a=D("#spc-orders");a.find("a.quantity-change-button-static").remove();
"1"!==D("#spc-form-inputs").find("input[name\x3d'isQuantityInvariant']").val()&&a.find("div.quantity-value-static").remove()});D(".lineitem").each(function(a,b){a=D(b);a.find(".no-js-quantity").remove();b=a.find(".quantity-dropdown");b.is(":visible")?(a.find(".js-select").prop("disabled",!1),b.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))});var c=D("#pantry-mov-popover-content"),d=D("#pantry-mov-popover-placeholder");!c.length&&
d.length&&(c=d.attr("data-device"),D.ajax({type:"GET",url:"/gp/pantry/checkout/mov/get-pantry-mov-popover-contents.html",data:"device\x3d"+c,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,c,e){~a.indexOf("pantry-mov-popover-content")?d.append(a):b.increaseCount("checkout:pantry:pantry_mov_popover_contents:bad-content",1)},error:function(a,c,d){b.increaseCount("checkout:pantry:pantry_mov_popover_contents:"+d,1)}}))}function u(a,
b){a=D('.update-quantity-error[data-itemid\x3d"'+a+'"]');a.find(".error-message").hide();a.find('.error-message[data-error-type\x3d"'+b+'"]').show();a.find("i").show();a.find(".a-span12").show();a.show();b=a.closest(".item-details-right-column");b.find(".spc-quantity-dropdown-button").addClass("a-button-error");b.find(".spc-quantity-input").addClass("a-form-error");b=a.parents("div.update-quantity-error");a=b.siblings(".item-details");0<a.length&&(a.find(".a-input-text-wrapper").addClass("a-form-error"),
a.removeClass("a-spacing-large"),a.find(".a-touch-select").addClass("a-input-text a-form-error"));b.show()}function z(a,f,h){var l=h.getResponseHeader("x-amz-checkout-new-cart-quantity");e.updateCartByMash(l);if(h.getResponseHeader("x-amz-checkout-page"))d.ajaxUpdatePage(a,f,h,{pushNewFrame:"false"}),a=h.getResponseHeader("x-amz-checkout-updated-itemid"),h=h.getResponseHeader("x-amz-checkout-quantity-error"),a&&h&&u(a,h);else if(a=c.jsonify(a))if(a&&a.errors&&a.errors.pantry&&a.errors.pantry.mov)B(a.errors.pantry.showAddonInfo);
else{if(a&&a.errors&&a.errors.addon&&(d.isSPP()&&b.increaseCount("checkout:spp-revieworder:addon_warn_pri",1),h=a.errors.addon.type,f=a.errors.addon.asins,w(),D(".item-list").hide(),f.forEach(function(a){D('[data-asin\x3d"'+a+'"]').show()}),h=D("#addon-warning-"+h+"-launcher"),h.length)){D("input[name\x3duseLiveAUI]").length?n.get(h).attrs({$trigger:fa}).show():aa&&D("div.checkout.spc-mobile.aui-templatized").length?h.click():(b.increaseCount("removeauijs19"),a=D.Event("keyup",{triggerPositioningElement:fa,
manualTrigger:!0}),h.trigger(a),0<D("div.spc-mobile").length&&(g.scrollToTop(),g.toggleScrollOff()));k.hide();return}return d.redirect(a)}else d.redirect()}function w(){D("#a-popover-addon-warning-normal .select-address-title").hide();0<N?(D("#a-popover-addon-warning-normal .reduce-title").show(),D("#a-popover-addon-warning-normal .delete-title").hide()):(D("#a-popover-addon-warning-normal .delete-title").show(),D("#a-popover-addon-warning-normal .reduce-title").hide())}function B(a){var c=D("#pantry-mov-popover-launcher"),
e=D(".pantry-mov-reduce-prompt"),f=D(".pantry-mov-delete-prompt"),h=D("#pantry-mov-addon-info-container");c.length?(P()||b.increaseCount("checkout:pantry:pantry_mov_popover:non_spc",1),h.length&&h.empty(),a&&D("#addon-warning-normal-popover-content").length&&(w(),h.length||(h=D("\x3cdiv/\x3e",{id:"pantry-mov-addon-info-container"})),h.append('\x3chr class\x3d"a-divider-normal"\x3e').append(D("#addon-warning-normal-popover-content").html()).appendTo("#pantry-mov-popover-content")),0<N?(e.show(),f.hide()):
(f.show(),e.hide()),c.length&&(c.click(),k.hide())):(b.increaseCount("checkout:pantry:pantry_mov_popover_contents:no-launcher",1),d.redirect())}function r(a,b){k.show();var c={isClientTimeBased:D('input[name\x3d"useCtb"]').val(),fromAnywhere:D("input[name\x3dfromAnywhere]").val(),success:z};if(b)for(var e in b)b.hasOwnProperty(e)&&(c[e]=b[e]);d.isSPP()?(c.ref="chk_ship_chg_qty_pri",b=D("#setOrderingPrefsCheckbox"),b.length&&b.is(":checked")&&(c.saveAsDefaultsSelected=1)):D(".spc-mobile.aui-templatized").length&&
(c.ref="ox_spc_change_quantity");b=D("#addon-indicator")&&"true"===D("#addon-indicator").attr("data-has-addon-items");e=D("#pantry-mov-indicator")&&"true"===D("#pantry-mov-indicator").attr("data-has-pantry-items");a||!b&&!e||(c.istrial=1);f.call(x,N,c);L?L.data("currentQuantity",N):O&&O.data("currentQuantity",N)}function t(){k.hide();p.location="/gp/aw/c/ref\x3dox_spc_deal_expired?app-action\x3dcart"}function H(a){var b=U;N=U;L&&q.when("a-dropdown").execute(function(a){L&&(a.getSelect(L).setValue(b.toString()),
L.data("currentQuantity",N))});a===X.addOn&&g.toggleScrollOn();O&&(O.val(b),O.data("currentQuantity",N),a=O.closest(".quantity-block"),a.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden"),a.find(".quantity-display").removeClass("hidden"),a.find(".quantity-display-block-tablet").removeClass("hidden"),a.find(".dynamic-quantity-update").hasClass("stay-visible")||a.find(".dynamic-quantity-update").addClass("hidden").children().addClass("hidden"))}function y(a,c){var d=a.$currentTarget.is("a")?
a.$currentTarget:a.$currentTarget.find("a");x=d.data("entityId");N=0;L=null;U=d.data("currentQuantity");fa=D("a.quantity-delete-button[data-entity-id\x3d'"+x+"']");fa.length||(fa=a.$currentTarget);O=d.closest(".dynamic-quantity-update").find(".quantity-input");O.length||(O=null);d.data("isBundleDelete")?m.isMobileBundleDeleteFixEnabled()?D("#pb-delete-trigger-"+d.data("bundleGroupId")).trigger("click"):setTimeout(function(){D("#pb-delete-trigger-"+d.data("bundleGroupId")).trigger("click")},100):m.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&
d.data("showItemAssocDeletePopover")?(b.increaseCount("checkout:item-association:delete:selected",1),setTimeout(function(){D("#ia-delete-trigger-"+d.data("itemAssocGroupId")).trigger("click")},100)):(r(!1,c),l.hideById(d.closest(".a-popover").data("aPopoverId")))}function G(a){if(!e.protectAgainstDoubleAction("order-summary-update-quantity",200)){b.resetMetrics();var c=a.$currentTarget,d=c.closest(".lineitem"),f=c.find("select"),h=f.length?f:c;x=d.data("entityId");f=D('.update-quantity-error[data-itemid\x3d"'+
x+'"]');O=L=null;h.is("select")?(L=c.find("select"),N=h.val()):(O=d.find(".quantity-input"),N=O.val());U!==N&&(fa=h.is("select")?L.parent():O,""===N?F(d):"Delete"===N||0===parseInt(N,10)?(a.$event.preventDefault(),e.protectAgainstDoubleAction("delete-item")||E(a)):(a=parseInt(D("#quantity-input-max-value").val(),10),e.validateNumber(N,0,a)?(f.hide(),d.blur(),d.data("isBundleDelete")?m.isMobileBundleDeleteFixEnabled()?D("#pb-delete-trigger-"+d.data("bundleGroupId")).trigger("click"):setTimeout(function(){D("#pb-delete-trigger-"+
d.data("bundleGroupId")).trigger("click")},100):r(!1)):u(x,"changeQuantity_quantityNotInRange")))}}function E(a,b){var c=a.$currentTarget.closest(".lineitem");x=c.data("entityId");N=0;c.data("isBundleDelete")?m.isMobileBundleDeleteFixEnabled()?D("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click"):setTimeout(function(){D("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click")},100):(r(!1,b),l.hideById(c.closest(".a-popover").data("aPopoverId")))}function I(a){var b=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),
c=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val(),d=a.$currentTarget.find("input").data("currentQuantity");U=d;-1===parseInt(c,10)||""===c?("change"===a.type&&F(a.$currentTarget.closest(".lineitem")),b.hide()):parseInt(c,10)!==d?b.show():b.hide()}function F(a){a.find(".quantity-input").val(U)}function W(c,d,e){var f=d.data("itemAssocGroupId"),h="a:sheet:beforeShow:ia-delete-mbs-"+f,g="a:sheet:afterHide:ia-delete-mbs-"+f;a.on(h,function ra(b){b=b.sheet.getContentContainer();
var c=D("#ia-delete-"+f).html();c&&(b.empty(),b.html(c));a.off(h,ra)});q.when("a-dropdown").execute(function(d){a.on(g,function S(){b.increaseCount("checkout:item-association:delete:canceled",1);D("#ia-delete-trigger-"+f).data("isItemAssocAlreadyDeleted")||(N=e,L.data("currentQuantity",e),d.getSelect(c).setValue(e));a.off(g,S)})});D("#ia-delete-trigger-"+f).trigger("click")}function P(){return d.isSPP()?D("#revieworder").hasClass("expanded")?!0:!1:0<D("div.spc").length?!0:!1}var D=a.$;if(!D("html").hasClass("a-ie6")){var N,
U,x,L,O,V=!1,ba=!1,fa,aa=p.P&&p.P.AUI_BUILD_DATE,X={addOn:"addOn",pantryMOV:"pantryMOV"};a.declarative("change-quantity",["click","touchend"],function(a){if(!e.protectAgainstDoubleAction("lock-update-quantity",200)){a=a.$currentTarget;var b=!0;a.addClass("hidden");a=a.closest(".quantity-block");a.find(".change-quantity").addClass("hidden");a.find(".quantity-display").addClass("hidden");a.find(".quantity-display-block-tablet").addClass("hidden");a.find(".dynamic-quantity-update").removeClass("hidden").find(".hidden").each(function(){var a=
D(this);a.removeClass("hidden");a.is("input")&&(a.focus(),a.select(),a.unbind("keydown.update-quantity-spc").bind("keydown.update-quantity-spc",function(a){13===a.which&&a.preventDefault()}),a.unbind("keyup.update-quantity-spc").bind("keyup.update-quantity-spc",function(a){13!==a.which||b||D(a.target).closest(".dynamic-quantity-update").find(".update-quantity-button").trigger("click")}))});setTimeout(function(){b=!1},500)}});a.declarative("order-summary-get-quantity",["click","touchend"],function(a){e.protectAgainstDoubleAction("order-summary-get-quantity",
200)||a.$currentTarget.find("select").length&&(U=a.$currentTarget.find("select").val())});a.declarative("order-summary-update-quantity",["change"],G);a.declarative("order-summary-update-quantity-text-field",["click","touchend"],G);a.declarative("order-summary-handle-text-input",["keydown"],function(a){13===a.$event.which?(a.$event.preventDefault(),G(a)):e.limitInputToNumbers(a)});a.declarative("order-summary-show-update-button",["change","keyup"],I);a.declarative("trigger-update-quantity-button",
["keydown"],function(a){13===a.$event.which&&(a.$event.preventDefault(),a.$currentTarget.closest(".quantity-block").find(".update-quantity-button").trigger("click"))});a.declarative("toggle-update-quantity-button",["change","keyup"],function(a){var b=a.$currentTarget.closest(".quantity-block").find(".update-quantity-button"),c=a.$currentTarget.find("input"),d=c.val(),e=c.data("currentQuantity");""===d?("change"===a.type&&c.val(e),b.hide()):parseInt(d,10)!==e?b.show():b.hide()});a.declarative("update-quantity",
["click","touchend"],function(a){b.resetMetrics();var c=a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a");a=c.closest(".quantity-block");var d=c.closest(".dynamic-quantity-update"),f=d.find(".quantity-input");d.length||(f=a.find(".quantity-input"));if(e.protectAgainstDoubleAction("lock-update-quantity",200))f.focus();else{var h=f.val();x=c.data("entityId");var g=D('.update-quantity-error[data-itemid\x3d"'+x+'"]'),l=parseInt(D("#quantity-input-max-value").val(),10);e.validateNumber(h,
0,l)?(g.hide(),d.find(".a-form-error").removeClass("a-form-error"),f.removeClass("a-form-error"),h=parseInt(h,10),O=f,U=O.data("currentQuantity"),U=parseInt(U,10),h===U?(a.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden"),a.find(".quantity-display").removeClass("hidden"),a.find(".quantity-display-block-tablet").removeClass("hidden"),d.addClass("hidden").children().addClass("hidden")):(N=h,fa=c,c.blur(),c.data("isBundleDelete")?m.isMobileBundleDeleteFixEnabled()?D("#pb-delete-trigger-"+
c.data("bundleGroupId")).trigger("click"):setTimeout(function(){D("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click")},100):r(!1))):u(x,"changeQuantity_quantityNotInRange")}});D(document).delegate(".spc-quantity-dropdown","change",function(a){L=D(a.currentTarget);b.resetMetrics();aa?(a=L.next(),x=a.data("entityId"),U=a.data("currentQuantity")):(b.increaseCount("removeauijs21"),x=L.data("entityId"),U=L.data("currentQuantity"));var c=L.find(":selected");N=parseInt(c.val(),10);U!==N&&(a=
D("#toggleDropdownQuantityTrigger"),a.length&&N===parseInt(a.val(),10)?(a=L.closest(".quantity-block"),a.find(".spc-quantity-dropdown-button").hide(),a.find(".quantity-input").show()):(fa=L.parent(),L.blur(),c&&c.data("isBundleDelete")?m.isMobileBundleDeleteFixEnabled()?D("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click"):setTimeout(function(){D("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click")},100):m.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&
c&&c.data("showItemAssocDeletePopover")||r(!1)))});a.on("a:dropdown:select",function(a){if(m.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&(a=D(a.nativeItemNode))&&a.data("showItemAssocDeletePopover")){b.increaseCount("checkout:item-association:delete:selected",1);var c=a.closest("select"),d=aa?c.next().data("currentQuantity"):c.data("currentQuantity");W(c,a,d)}});a.declarative("item-assoc-delete-confirm",["click","touchend"],function(a){if(!e.protectAgainstDoubleAction("item-assoc-delete-confirm")){b.increaseCount("checkout:item-association:delete:confirmed",
1);r(!1);var c=D(a.$target).data("itemAssocGroupId");D("#ia-delete-trigger-"+c).data("isItemAssocAlreadyDeleted",1);q.when("a-sheet").execute(function(a){var b=a.get("ia-delete-mbs-"+c);b&&a.hideSheet(b)})}});a.declarative("item-assoc-delete-cancel",["click","touchend"],function(){e.protectAgainstDoubleAction("item-assoc-delete-cancel")||(b.increaseCount("checkout:item-association:delete:canceled",1),N=U)});a.declarative("dont-delete-item",["click","touchend"],function(a){a.$event.preventDefault();
e.protectAgainstDoubleAction("dont-delete-item")||l.hideById(a.$currentTarget.closest(".a-popover").data("aPopoverId"))});a.declarative("delete-item",["click","touchend"],function(a){a.$event.preventDefault();e.protectAgainstDoubleAction("delete-item")||y(a)});a.declarative("delete-prime-membership-item-confirm",["click","touchend"],function(a){a.$event.preventDefault();if(!e.protectAgainstDoubleAction("delete-prime-membership-item-confirm")){var b={additionalData:{deletePrimeMembership:1,primeMembershipASIN:(a.$currentTarget.is("a")?
a.$currentTarget:a.$currentTarget.find("a")).data("asin")}};y(a,b)}});a.declarative("bundle-delete",["click","touchend"],function(){e.protectAgainstDoubleAction("bundle-delete")||r(!1)});a.declarative("bundle-delete-action",["click","touchend"],function(a){e.protectAgainstDoubleAction("bundle-delete-action")||(q.when("a-popover-base").execute(function(b){b.get(a.data.popoverName).hide()}),r(!1))});a.declarative("egc-delete",function(a){x=a.entityId;N=0;r(!0)});a.declarative("bundle-dont-delete",["click",
"touchend"],function(){e.protectAgainstDoubleAction("bundle-dont-delete")||(N=U,m.isMobileBundleDeleteFixEnabled()?q.when("a-dropdown").execute(function(a){L&&(a.getSelect(L).setValue(U.toString()),L.data("currentQuantity",N))}):L&&q.when("a-dropdown").execute(function(a){a.setValue(L.attr("id"),U.toString());L.data("currentQuantity",N)}))});a.declarative("pantry-return-to-cart-btn",["click","touchend"],function(){e.protectAgainstDoubleAction("pantry-return-to-cart-btn")||P()&&t()});a.declarative("pantry-delete-items-btn",
["click","touchend"],function(){!e.protectAgainstDoubleAction("pantry-delete-items-btn")&&P()&&(ba=!0,D(".a-button-close").trigger("click"),r(!0))});a.declarative("pantry-cancel-delete-btn",["click","touchend"],function(){e.protectAgainstDoubleAction("pantry-cancel-delete-btn")||P()&&H(X.pantryMOV)});a.on("a:popover:hide:pantry-mov-popover",function(){P()&&(ba||H(X.pantryMOV))});a.declarative("addon-return-to-cart",["click","touchend"],function(){e.protectAgainstDoubleAction("addon-return-to-cart")||
P()&&t()});a.declarative("addon-delete-items",["click","touchend"],function(){e.protectAgainstDoubleAction("addon-delete-items")||(P()&&(V=!0,D(".a-button-close").trigger("click"),r(!0)),d.isSPP()&&b.increaseCount("checkout:spp-revieworder:addon_delete_pri",1))});a.declarative("addon-dont-delete",["click","touchend"],function(){e.protectAgainstDoubleAction("addon-dont-delete")||(P()&&H(X.addOn),d.isSPP()&&b.increaseCount("checkout:spp-revieworder:addon_keep_pri",1))});a.on("a:popover:hide:addon-warning-normal",
function(){0<D("div.spc-mobile").length?t():P()&&(V||H(X.addOn))});a.on("a:popover:hide:addon-warning-special",function(){P()&&(V||H(X.addOn))});a.on("checkout:reload:spc",v);a.on("checkout:reload:spp-revieworder",v)}});q.when("A","ready").execute(function(a){a.on("a:popover:beforeShow",function(a){if(a.popover.$trigger.hasClass("quantity-dropdown-button")){var g=a.popover.$popover,c=g.closest("div.a-dropdown");c.length&&(a.popover.$iframe.css("max-height","260px"),g.css("max-height","260px"),g=c.find("div.a-popover-inner"),
g.css({"max-height":"260px"}),a.popover.updatePosition(),g.css({"overflow-y":"scroll"}))}})});"use strict";q.when("A","page-transition-controller","page-conductor","ajax-utility").register("tax-exemption-controller",function(a,k,g,c){function d(a,d,f){return f.getResponseHeader("x-amz-checkout-page")?g.ajaxUpdatePage(a,d,f,{pushNewFrame:"false"}):(a=c.jsonify(a))?g.redirect(a):g.redirect()}function f(a,c){var f=c.$target.data("entityId");if(f){k.show();var b={isClientTimeBased:l('input[name\x3d"useCtb"]').val(),
fromAnywhere:l("input[name\x3dfromAnywhere]").val()},b=b||{};c={returnFullHTML:1,cachebuster:(new Date).getTime(),isClientTimeBased:0,hasWorkingJavascript:1};l.extend(c,b);c.entityId=f;c.optOut=a;a=g.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});l.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/tax-exemption-optout.html",data:l.param(c),dataType:"text",async:!0,cache:!1,headers:a,success:d,error:g.ajaxRedirect})}else p.ueLogError&&p.ueLogError({name:"MissingData",message:"lineItemId is undefined, when trying to opt out from tax exemption",
logLevel:"FATAL"})}var l=a.$;l("html").hasClass("a-ie6")||(a.declarative("tax-exemption-opt-out",["click","touchend"],function(a){f(!0,a)}),a.declarative("tax-exemption-opt-in",["click","touchend"],function(a){f(!1,a)}))});"use strict";q.when("A").execute(function(a){return{}});"use strict";q.when("A","page-transition-controller","page-conductor").register("sns-subscription-controller",function(a,k,g){function c(){var c=l(document);c.delegate(".sns-option","click",function(a){a=l(this);f(a.closest(".sns-upsell"),
a)});c.delegate(".sns-option-mobile","click",function(a){var c=l(this);a.target.name&&"snsSetCreateSubscription"===a.target.name&&f(c.closest(".sns-upsell-mobile"),c)});c.delegate(".sns-option-tablet","click",function(a){a=l(this);f(a.closest(".sns-upsell-tablet"),a)});c.delegate(".sns-upsell-nextdelivery","change",function(){d(l(this))});a.declarative("sns-upsell-nextdelivery-dropdown","change",function(a){d(l(a.$target))});c.delegate(".sns-upsell-learn-more","click",function(a){var c=l(this);a=
c.width();var b=c.height(),d=c.position(),c=c.find(".sns-upsell-popover-learn-more");c.removeClass("aok-hidden");var f=c.width();c.height();c.css({top:d.top+b,left:d.left-(f-a)/2,position:"absolute"})});c.delegate(".sns-upsell-learn-more-close","click",function(a){(a=l(this))&&a.closest(".sns-upsell-popover-learn-more")&&a.closest(".sns-upsell-popover-learn-more").addClass("aok-hidden");return!1})}function d(a){var c=a.closest(".sns-upsell,.sns-upsell-mobile,.sns-upsell-tablet");if(a.length&&c.length){var d=
c.data("index"),b=c.find("span.sns-change-delivery-txt");b&&b.text(a.find("option:selected").data("date"));b=a.find("option:selected").data("epoch");a=a.find("option:selected").val();c.find("input[type\x3d'hidden'][name\x3d'sns_nextDelivery"+d+"']").val(b);c.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+d+"']").val(a)}}function f(a,c){k.show();var d=a.data("index"),b=(new Date).getTime(),f=a.find("input[type\x3d'hidden'][name\x3d'sns_lineItemIdentifier"+d+"']").attr("value"),p=a.find("input[type\x3d'hidden'][name\x3d'sns_merchantId"+
d+"']").attr("value"),u=a.find("input[type\x3d'hidden'][name\x3d'sns_asin"+d+"']").attr("value");a=a.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+d+"']").attr("value");c=c.prop("checked")||c.find("[type\x3dcheckbox]").is(":checked");b={returnpipedata:0,returnFullHTML:1,cachebuster:b,hasWorkingJavascript:1};b.lineItemIdentifier=f;b.isONMLSelected=c?1:0;b.merchantId=p;b.asin=u;b.frequency=a;f=g.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});l.ajax({type:"POST",url:"/gp/buy/spc/handlers/set-sns-options.html",
data:l.param(b),dataType:"text",async:!0,cache:!1,headers:f,success:function(a,b,c){return g.ajaxUpdatePage(a,b,c)},error:function(a,b,c){g.ajaxRedirect(a,b,c)}})}var l=a.$;l("html").hasClass("a-ie6")||c()});"use strict";q.when("A","page-detector","page-detector-current-page","page-conductor","page-transition-controller","ajax-utility","place-order-controller","client-side-metrics").execute(function(a,k,g,c,d,f,l,h){function e(a){"function"===typeof p.ues&&(p.ues("t0",a,new Date),p.ues("ctb",a,"1"));
"function"===typeof p.uet&&p.uet("tc",a,{wb:1})}function n(a,b){"function"===typeof p.uet&&p.uet(a,b,{wb:1})}function b(a){p.ueLogError&&p.ueLogError({message:a},{logLevel:"WARN",attribution:"ajax-typ"})}function m(){var a=G("span#typ-load").attr("data-typ-args");p.location.href="https://"+p.location.hostname+"/gp/buy/thankyou/handlers/display.html?"+a}function q(){n("cf","ajax-typ:place-your-order");if(x){var a=G("#typ-desktop-frame").contents(),b=x;if(b.deliveryestimates)for(var c in b.deliveryestimates)if(b.deliveryestimates.hasOwnProperty(c)){var e=
a.find("span#"+c);e&&e.replaceWith(b.deliveryestimates[c])}b.autorip&&(a=a.find("#thank-you-rogue"))&&a.replaceWith(b.autorip)}b=G("#typ-desktop-frame").contents();a=b.find("span#typ-rewrite-url");history&&history.pushState&&a&&0<a.length&&(history.pushState({},"",a.attr("data-url")),a.attr("data-view"));b=b.find("title").text();G("#checkoutDisplayPage").hide();G("#typ-desktop").show();document.title=b;d.hide();G("span#typ-load").attr("data-typ-args");n("be","ajax-typ:place-your-order");h.setmarker&&
(b=h.getscope(),O&&h.setscope("ajax-typ"),h.setmarker("cf"),O&&h.setscope(b));O||(h.sendUEPageLoadStats(),"function"===typeof p.uex&&p.uex("ld","ajax-typ:place-your-order",{wb:1}))}function u(a,d,e){a&&a.conductoraction&&a.conductoraction.url?c.redirect(a):(n("af","ajax-typ:place-your-order"),x=a,W?q():F?P=1:(b("No TYP data available after place-order, redirecting to static TYP"),m()))}function z(){if(!fa)if(ba&&clearTimeout(ba),3===V.readyState){var a;try{a=f.jsonify(V.responseText)}catch(d){a=null}null!==
a?(fa=1,u(a)):ba=setTimeout(z,50)}else 4===V.readyState&&(fa=1,200===V.status?(a=f.jsonify(V.responseText),null!==a?u(a):(b("No results from place-order, calling ajaxRedirect"),c.ajaxRedirect())):(b("Error calling place-order, calling ajaxRedirect"),c.ajaxRedirect()))}function w(){da=1;N&&clearTimeout(N);U&&clearTimeout(U);var a=G("#currencyChanged");0<a.length&&"true"===a.val()&&(a='\x3cinput type\x3d"hidden" name\x3d"checkoutCurrencySelection.'+G("#tfx-switch-currency-options").find("input:radio:checked").val()+
'" /\x3e',G("#spc-form-inputs").append(a));G("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");a=(new Date).getTime()-aa;G("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'waitingTime' value\x3d'"+a+"' /\x3e");G("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'returnjson' value\x3d'1' /\x3e");X&&G("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'isAsyncTYPEnabled' value\x3d'1' /\x3e");var a=G("#spc-form").serialize(),d=G("#typ-desktop-frame").contents().find("input#cached-promise-data");
0<d.length&&(a+="\x26cachedPromiseData\x3d"+d.val());if(L){if(p.XMLHttpRequest)V=new XMLHttpRequest;else if(p.ActiveXObject)try{V=new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){V=null}if(!V){b("Can't get XMLHttpRequest for data stream, calling standard placeOrderController");da=1;l.placeOrderClick();return}V.open("POST","/gp/buy/spc/handlers/place-your-decoupled-order.html",!0);V.setRequestHeader("Content-type","application/x-www-form-urlencoded");V.setRequestHeader("Content-length",a.length);V.setRequestHeader("Connection",
"close");V.onreadystatechange=z;V.overrideMimeType("text/plain");V.send(a)}else G.ajax({type:"POST",url:"/gp/buy/spc/handlers/place-your-decoupled-order.html",data:a,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return f.jsonify(a)},success:function(a,d,e){null!==a?u(a,d,e):(b("No results from place-order, calling ajaxRedirect"),c.ajaxRedirect())},error:function(a,d,e){b("Error calling place-order, calling ajaxRedirect");c.ajaxRedirect(a,d,e)}});"function"===typeof p.uet&&p.uet("bb","ajax-typ:place-your-order",
{wb:1})}function B(){W=F=D=0;G("div#typ-desktop").empty()}function r(a,b,c){D||(D=1,clearTimeout(U),F=0,W=1,E++,(a=G("#typ-desktop-frame").contents().find("span#typ-rewrite-url"))&&0<a.length&&(a=a.attr("data-requestid"),e("ajax-typ:place-your-order"),O||(h.setAsyncRequestId(a),"function"===typeof p.ues&&p.ues("id","ajax-typ:place-your-order",a))),P?q():!da&&5>E&&(N=setTimeout(function(){B();t()},12E4)))}function t(){if(!(da||F||5<=E)){F=1;var a=G("span#typ-load").attr("data-typ-args");U=setTimeout(function(){B();
P&&(b("Timed out waiting for TYP fetch after place-order, redirecting to static TYP"),m())},45E3);G("\x3ciframe /\x3e",{name:"typ-desktop-frame",id:"typ-desktop-frame",width:"100%",height:"100%",frameborder:"0",src:"/gp/buy/thankyou/handlers/display.html?"+a}).appendTo("div#typ-desktop").load(r)}}function H(){r()}function y(){k.isSpc()&&0<G("span#typ-load").length&&(aa=(new Date).getTime(),E=0,G("div#typ-desktop").length?B():G("body").append('\x3cdiv id\x3d"typ-desktop" style\x3d"position:absolute;left:0;right:0;bottom:0;top:0;display:none;"\x3e\x3c/div\x3e'),
L=G("span#typ-load").attr("data-early-json-flush")&&!G("html").hasClass("a-lt-ie10"),X=0<G("span#async-typ-enabled").length,O=G("span#typ-load").attr("data-use-cds-stub"),G(document).undelegate("span.place-order-button-link","click"),G(document).delegate("span.place-order-button-link","click",function(a){a.preventDefault();O?(a=h.getscope(),h.setscope("ajax-typ"),h.setctb(),h.resetue(),h.setmarker("tc"),h.setscope(a)):(h.resetMetrics(),h.setmarker("tc"));F||W?(d.show(),w()):(da=1,l.placeOrderClick())}),
t())}var G=a.$;if(!G("html").hasClass("a-ie6")){var E=0,F=0,da=0,W=0,P=0,D=0,N,U,x,L=0,O=0,V,ba,fa=0,aa=0,X=0;a.on("ajax-typ-cf",H);a.on("checkout:reload:spc",y);a.on("checkout:reload:spp-revieworder",y);a.on("checkout:reload:spclite",y)}});"use strict";q.when("A","client-side-metrics").register("trialSignPrefetchCommon",function(a,k){function g(){c()&&(b().val(0),k.increaseCount("TrialSign:js:activated"),d(),u!==F&&n(),u=a.interval(e,5E4),q=0)}function c(){return 0!==b().length&&0!==m("input[name\x3d'purchaseID']").length}
function d(){p!==F&&p.abort();p=a.ajax("/gp/buy/spc/handlers/trigger-trial-sign.html",{method:"post",params:{purchaseId:m("input[name\x3d'purchaseID']").val()},success:f,error:l,abort:h})}function f(a,c,d){b().val(a.signPurchaseTrialId);p=F;k.increaseCount("TrialSign:js:success")}function l(a,b,c){n();p=F;k.increaseCount("TrialSign:js:failed")}function h(){n();p=F;k.increaseCount("TrialSign:js:aborted")}function e(){q++;10<q?n():(k.increaseCount("TrialSign:js:retry"),k.increaseCount("TrialSign:js:retry:"+
q),d())}function n(){u!==F&&(clearInterval(u),u=F)}function b(){return m("input[name\x3d'trialSignId']")}var m=a.$,p,u,q=0;a.on("checkout:reload:spc",g);a.on("checkout:reload:spclite",g);a.on("checkout:billing-address-update",g);return{makeTrialSignCall:d,trialSignCallSucceeded:f,isTrialSignActivated:c}});"use strict";q.when("A","page-transition-controller","client-side-metrics","page-conductor").register("recurring-delivery-line-item",function(a,k,g,c){function d(a,c,b){if("undefined"===typeof a)throw g.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:JSFailure:VariableUndefined:"+
c,1),b.show(),Error("Provided variable is undefined");b.hide()}function f(a,f,b){d(a,"updateRecurrencePeriod",f);d(a.lineItemId,"updateRecurrencePeriod-lineItemId",f);var m=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});l.ajax({type:"POST",url:"/gp/buy/spc/handlers/update-recurrence-period.html",data:{recurrencePeriod:h,encodedLineItemEntityId:a.lineItemId,relatedRequestId:a.relatedRequestId},dataType:"json",cache:!1,headers:m,success:function(a,c){g.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:"+
c,1);l("#b2brd-frdd").text(a.firstRecurringDeliveryDate);b.hide();f.hide();k.hide()},error:function(c){g.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:"+c,1);l("#b2brd-cadence-selector").find(".a-dropdown-prompt").text(a.selectedRecurrencePeriodDisplayString);b.hide();f.show();k.hide()}});k.show()}var l=a.$,h;a.declarative("b2brd-cadence-dropdown-change","change",function(a){var c=l("#update-recurrence-period-error"),b=l("#update-recurrence-period-link");d(a,"b2brd-cadence-dropdown-change",
c);a=a.$event.target.value;d(a,"handleDropdownChange",c);b.show();h=a});a.declarative("update-recurrence-period","click",function(a){var c=l("#update-recurrence-period-error"),b=l("#update-recurrence-period-link");d(a,"update-recurrence-period",c);f(a.data,c,b)});a.declarative("update-recurrence-period-mobile","change",function(a){var c=l("#update-recurrence-period-error"),b=l("#update-recurrence-period-link");d(a,"update-recurrence-period-mobile",c);var g=a.$event.target.value;d(g,"handleDropdownChange",
c);b.show();h=g;f(a.data,c,b)})});"use strict";q.when("A","client-side-metrics","ajax-utility","button-blocker","button-blocker-popover","spclite-items-viewer","fast-track-controller").register("get-final-results-update",function(a,k,g,c,d,f,l){function h(){for(var b=function(){a.trigger("checkout:spc:ordersummary:sizeChanged")},c=0;20>c;++c)setTimeout(b,100*c)}function e(a,b){setTimeout(function(){var c=f.prepare(a);c&&u("#spclite-items-operation").show();u("#spclite-items-header-dynamic").fadeIn(b?
0:300,function(){c&&u("#spclite-items-operation").find(".spclite-items-view-switch").each(function(){var a=u(this).attr("view-name");a&&u(this).find("a").click(function(){k.increaseCount("SPCLite:ClientSide:SwitchViewClick:"+a,1);f.switchToView(a);u("#spclite-items-operation").fadeOut(b?0:300);h()})})})},b?0:800)}function n(b,c,d){if(b&&u.isArray(b))for(var e=!1,f=0;f<b.length;f++){var h=b[f];if(h.identifier&&h.content){var g=u("#"+c+"-"+h.identifier);g&&0!==g.length?a.slideDown(g.html(h.content),
d?0:500,"ease-out",function(){}):(k.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Item:"+c,1),e||(k.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Page:"+c,1),e=!0))}}}function b(b,c){if(b.presentCVs&&0<b.presentCVs.countOfCVs)m();else{b.orderSummaryHTML&&(a.fadeOut(u("#order-summary-footer"),c?0:250,"ease-out"),a.fadeOut(u("#spc-order-summary"),c?0:250,"ease-out",function(){u("#spc-order-summary").replaceWith(b.orderSummaryHTML).hide();b.additionalOrderSummaryHTML&&u("#order-summary-footer").html(b.additionalOrderSummaryHTML);
a.fadeIn(u("#spc-order-summary"),c?0:400,"ease-out");a.fadeIn(u("#order-summary-footer"),c?0:400,"ease-out")}));b.freshDeliveryMessageHTML&&(u("#lazy-fresh-promise-delivery-message").html(b.freshDeliveryMessageHTML),a.slideDown(u("#lazy-fresh-promise-delivery-message"),c?0:500,"ease-out"),l.spcLiteLazyLoadFastTrack());n(b.itemToPrimeMembershipDelivery,"lazy-membership-delivery",c);n(b.itemToGiftContentMapping,"lazy-gift-options",c);n(b.itemToShipOfferingMapping,"lazy-ship-method",c);n(b.itemToPromise,
"lazy-promise",c);b.freshDeliverySlotInformationHTML&&(u("#lazy-fresh-delivery-slot-information").html(b.freshDeliverySlotInformationHTML),a.slideDown(u("#lazy-fresh-delivery-slot-information"),c?0:250,"ease-out"));b.freshDeliveryInstructionsHTML&&(u("#lazy-fresh-delivery-instructions").html(b.freshDeliveryInstructionsHTML),a.slideDown(u("#lazy-fresh-delivery-instructions"),c?0:250,"ease-out"));if(b.itemToPromoMapping&&u.isArray(b.itemToPromoMapping))for(var d=u("#items-block"),f=0;f<b.itemToPromoMapping.length;f++){var g=
b.itemToPromoMapping[f];"lightningdeal"===g.type?d.find(".lazy-lightning-promo-details-"+g.identifier).removeClass("aok-hidden"):"promotion"===g.type&&d.find(".lazy-promo-details-"+g.identifier).removeClass("aok-hidden")}b.freeShippingId&&u("#"+b.freeShippingId).removeClass("aok-hidden");u("input#isOrderSummaryReady").val(1);e(b.itemGroupData,c);h()}}function m(){var b=u("#spclite-block-order-place-message").html()||"";c.show("disabled-order-place",b);c.lock();d.create({name:"disabled-order-place",
content:b});d.lock();var e=c.getButtonBlocker().data("a-popover-id");a.on("checkout:beforeReload",function(){d.unlock();c.unlock();d.destroy();u("#a-popover-"+e).remove()})}function q(a){if(a&&a.data){var b;try{b=p.atob(a.data)}catch(c){return k.increaseCount("SPCLite:FinalResult:Base64Decode:Failure",1),null}if((b=g.jsonify(b))&&!u.isEmptyObject(b))return b}return null}var u=a.$,z,w=function(a,b){function c(){if(f&&0!==f.length){for(var a="",b=0;b<d%3+1;b++)a+=".";f.html(a);d++}}var d=0,e,f;this.start=
function(){b&&b.useTextAnimate&&(d=0,f=a.find(".spclite-loading-text .spclite-processing-indicator"),e=setInterval(c,800))};this.stop=function(){e&&(clearInterval(e),f&&0<f.length&&f.html(""),d=0);a.find(".spclite-loading-spinner").hide();b&&b.showTextAlways||a.find(".spclite-loading-text").hide()}};a.on("checkout:reload:spclite",function(){if("1"===u('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")){var a=q(p.__spcliteFinalResultsData);if(a){b(a,!0);return}}else if(p.__spcliteFinalResultsData){b(p.__spcliteFinalResultsData,
!0);return}var a="",c=u("input#executionId").val();c&&(a+="executionId\x3d"+c);return u.ajax({type:"GET",url:"/gp/buy/spclite/handlers/get-final-results.html/ref\x3dox_spclite_get_final_results",data:a,dataType:"text",async:!0,beforeSend:function(a){z=new w(u("#spclite-order-summary-loading-indicator"),{showTextAlways:!0});z.start();p.uet&&p.uet("bb","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},success:function(a,c,d){a=g.jsonify(a);"1"===u('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")?
(a=q(a))?b(a,!1):m():a&&!u.isEmptyObject(a)?b(a,!1):m()},error:function(a,b,c){m()},complete:function(a){z.stop();p.uex&&p.uex("ld","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},cache:!1})});a.on("checkout:beforeLoadPage",function(){p.__spcliteFinalResultsData=F})});"use strict";q.when("A","client-side-metrics").register("spclite-items-viewer",function(a,k){function g(){var a=d("#spclite-items-block").find(".spclite-item-detail");a&&0<a.length&&(l={},a.each(function(a){a=d(this).attr("entity-id");
l[a]=d("\x3cp\x3e\x3c/p\x3e").append(d(this).clone().removeClass("a-span-last")).html()}))}function c(a,c){if(!c||0===c.length)return null;a=d('\x3cdiv class\x3d"a-row spclite-item-view" view-type\x3d"order-by-delivery"\x3e\x3c/div\x3e');var f=c;c=[];for(var b=[],g=0;g<f.length;g++){var k=f[g];if("normal"!==k.type)b.push(k);else{for(var p=0;p<c.length;)if(k.data.destinationAddressId!==c[p].data.destinationAddressId)p++;else break;for(;p<c.length;)if(k.data.destinationAddressId===c[p].data.destinationAddressId&&
k.data.promise.starttime.dayepoch>c[p].data.promise.starttime.dayepoch)p++;else break;c.splice(p,0,k)}}for(f=0;f<b.length;f++)switch(k=b[f],k.type){case "primemembership":c.unshift(k);break;case "vas":case "digital":case "no-promise":case "exception":c.push(k);break;default:c.push(k)}for(b=0;b<c.length;b++){k=c[b];if(f=k.content)g='\x3cdiv class\x3d"row spclite-item-group-title"\x3e',f.destination&&(g+='\x3cdiv class\x3d"row destination"\x3e'+f.destination+"\x3c/div\x3e"),f.promise&&(g+='\x3cdiv class\x3d"row promise"\x3e'+
f.promise+"\x3c/div\x3e"),g+="\x3c/div\x3e",a.append(g);a:if(f=k.items,l&&f&&0!==f.length){g="";for(p=0;p<f.length;p++){0===p%2&&(g+='\x3cdiv class\x3d"a-row"\x3e');var q=f[p].identifier;if(!l[q]){f=null;break a}q=d(l[q]);1===p%2&&q.addClass("a-span-last");g+=d("\x3cp\x3e\x3c/p\x3e").append(q).html();1===p%2&&(g+="\x3c/div\x3e")}1===f.length%2&&(g+='\x3cdiv class\x3d"a-column a-span6 a-span-last"\x3e\x3c/div\x3e\x3c/div\x3e');f=g}else f=null;if(f)f=d(f),("no-promise"===k.type||"normal"===k.type&&
k.data&&k.data.promise&&"scheduled"!==k.data.promise.type)&&f.find(".spclite-promise").hide(),a.append(f);else return null;b<c.length-1&&a.append("\x3chr\x3e")}return a}var d=a.$,f,l;return{prepare:function(a){try{var d;a:{g();if(l){var n=c("order-by-delivery",a);if(n){f={"order-by-delivery":n};d=!0;break a}}d=!1}return d}catch(b){k.increaseCount("SPCLite:ClientSide:Exception:SwitchViewPrepare",1)}return!1},switchToView:function(a,e){var g;f&&f[a]?g=f[a]:(k.increaseCount("SPCLite:ClientSide:SwitchViewNoPrepared:"+
a,1),"order-by-delivery"===a&&(g=c(a,e)));if(g){var b=d("#spclite-items-block");b.find(".spclite-item-view").fadeOut(300,function(){b.empty();b.append(g.clone().hide());b.find(".spclite-item-view").fadeIn(500)})}}}});"use strict";q.when("A","loading-spinner-controller").register("cpf-controller",function(a,k){function g(a){var c,g,h;if(/^\d{11}$/.test(a)||/^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(a)){a=a.replace(/[^\w\s]|_/g,"");if(/(\d)\1{10}/.test(a))return!1;c=a.substring(0,9);g=a.substring(9);h=0;for(var e=
10;1<e;e--)h+=c.charAt(10-e)*e;if((2>h%11?0:11-h%11)!==g.charAt(0))return!1;c=a.substring(0,10);h=0;for(a=11;1<a;a--)h+=c.charAt(11-a)*a;return(2>h%11?0:11-h%11)!==g.charAt(1)?!1:!0}return!1}var c=a.$;a.on("checkout:reload:spp-taxid",function(){c("#useThresholdTaxIdService").length||c("#taxidForm").submit(function(){var a=c("#taxidregistration-imb");if(!g(c("#taxid-field").val()))return k.hideSpinner(c("#spinner-anchor"),!0),a.show(),!1;a.hide();return!0})})});"use strict";q.when("A","page-conductor",
"ready").register("taxid-threshold-controller",function(a,k){function g(){var a=c();k.isSPP()?a?(d("#taxid-continue-disabled").hide(),d("#taxid-continue-enabled").show()):(d("#taxid-continue-enabled").hide(),d("#taxid-continue-disabled").show()):a?d("span.#continue").removeClass("a-button-disabled").find('input[type\x3d"submit"]').removeAttr("disabled"):d("span.#continue").addClass("a-button-disabled").find('input[type\x3d"submit"]').attr("disabled","disabled")}function c(){var a=!0,c=d("#taxIdForm");
c.length&&c.find('input[type\x3d"text"]').each(function(){var c=d(this);if(!c.val()||7>c.val().length)c.parents(".taxid-form").find('input[type\x3d"checkbox"]').attr("checked")||(a=!1)});return a}var d=a.$;a.on("checkout:reload:spp-taxid",function(){if(d("#useThresholdTaxIdService").length){var a=d("#taxIdForm");a.length&&(a.find('input[type\x3d"text"]').keyup(g),a.find('input[type\x3d"checkbox"]').change(g));g()}})});"use strict";q.when("A","page-conductor","loading-spinner-controller","taxaddress-page-config",
"ready").register("taxaddress-controller",function(a,k,g,c){function d(){k.isSPP()&&l()}function f(){if(k.isSPP()){var a=n(p.taxregistrationnumberInputIdSelector).val();n(p.taxregistrationnumberInputIdSelector).val(a.replace(m,""));a=n(p.businesslegalnameInputIdSelector).val();n(p.businesslegalnameInputIdSelector).val(a.trim());l()}}function l(){var a=n("#taxid-continue-enabled"),c=n("#taxid-continue-disabled"),d;d=n(p.taxregistrationnumberInputIdSelector).val();var f=n(p.businesslegalnameInputIdSelector).val();
if(e(d)&&e(f))d=!0;else{var f=!f||e(f.toString().trim()),g=e(n(p.taxaddressInputNameSelector).val());d=e(d)||!b.test(d)||f||g?!1:!0}d?(a.show(),c.hide()):(a.hide(),c.show());d=e(n(p.taxregistrationnumberInputIdSelector).val())&&e(n(p.businesslegalnameInputIdSelector).val())?p.continueLabel:p.saveContinueLabel;a.find("span.a-button-text").text(d);c.find("span.a-button-text").text(d)}function h(){if(q)q=!1;else{var a=n(p.taxregistrationnumberInputIdSelector).val().trim(),b=n(p.businesslegalnameInputIdSelector).val().trim();
if(!e(a)||!e(b)){var c={tax_registration_number:a,business_legal_name:b};n.ajax({type:"POST",url:p.sifEncryptionUrl,dataType:"json",data:c,success:function(a,b,d){e(c.tax_registration_number)?n(p.taxregistrationnumberInputIdSelector).val(""):n(p.taxregistrationnumberInputIdSelector).val(a.sifEncryptedTaxId);e(c.business_legal_name)?n(p.businesslegalnameInputIdSelector).val(""):n(p.businesslegalnameInputIdSelector).val(a.sifEncryptedLegalName);q=!0;n(p.taxaddressFormIdSelector).submit()},error:function(a,
b,d){console.log("[taxaddress-controller.js] Error while encrypting the input fields. Error Type: "+b+" tax_registration_number: "+c.tax_registration_number+" business_legal_name: "+c.business_legal_name)}});return!1}}}function e(a){return!a||0===a.toString().length}var n=a.$,b=/^\d{11}$/,m=/\s+/g,p=c.getConfig(),q=!1;a.on("checkout:reload:spp-taxaddress",function(){n(p.taxregistrationnumberInputIdSelector).keyup(f).blur(f);n(p.businesslegalnameInputIdSelector).keyup(d).blur(f);n('input:radio[name\x3d"'+
p.taxaddressInputName+'"]').each(function(){n(this).change(d)});n(p.taxaddressFormIdSelector).submit(h);d()});return{getNewTaxAddressPopoverURL:function(){return p.newTaxAddressPopoverURL},submitTaxAddressFormWithNewAddressId:function(a){n(p.newTaxaddressInputIdSelector).val(a);g.showSpinner(n(p.taxAddressPanelSelector),!1);n(p.taxaddressFormIdSelector).submit()}}});q.when("A","address-popovers","taxaddress-controller","ready").register("taxaddress-addresspopover-helper",function(a,k,g){k.actionRegisterTaxAddressController(g)});
"use strict";q.when("A","page-spinner-controller","ajax-utility","page-conductor","client-side-metrics").execute(function(a,k,g,c,d){function f(){function d(a){if(!g)if(a.preventDefault(),a=encodeURIComponent(l("#spc-deliverytipinput").val()),l("#tip-error").addClass("aok-hidden"),l("#tip-promo-success").addClass("aok-hidden"),l("#tip-success").addClass("aok-hidden"),l("#tip-ineligible").addClass("aok-hidden"),l("#tip-success").addClass("aok-hidden"),a&&0!==a.length)if(0>a)b("invalidDeliveryTip_NoAmount");
else if(/^[0-9]*(\.[0-9]{1,2})?$/.test(a)){k.show();p=l("#spc-deliverytipnoticecheckbox").attr("checked")?1:0;var e=(new Date).getTime();a="tipamount\x3d"+a+"\x26isDefaultTip\x3d"+p+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+l("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+e;e=c.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});l.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-tip.html/ref\x3dox_tip_page_delivery_tip_add",
data:a,headers:e,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",complete:function(){g=!1;k.hide()},success:f,error:c.ajaxRedirect});g=!1}else b("invalidDeliveryTip_NoAmount");else b("addDeliveryTip_NoAmount")}function f(a,b,c){k.hide()}function b(a){k.hide();l("#tip-error").removeClass("aok-hidden");0<l("div.spc-desktop").length?l("#spc-deliverytipinput").addClass("a-form-error"):l("#spc-deliverytipinput").closest(".a-input-text-wrapper").addClass("a-form-error");
l("#"+a).removeClass("aok-hidden")}var g=!1,p=0;h&&(a.declarative("tip-element",["click"],function(a){var b=a.data.click;b&&null!==b&&d(a.$event)}),h=!1)}var l=a.$;if(!l("html").hasClass("a-ie6")){var h=!0;a.on("checkout:reload:spc",f);a.on("checkout:reload:spclite",f)}});"use strict";q.when("A","checkout-general-utils","page-conductor","loading-spinner-controller").register("checkout-feedback-controller",function(a,k,g,c){function d(){if(!l||"function"!==typeof l)return"";var a=l(),c="";if(a)for(var d in a)if("number"===
typeof a[d]||"string"===typeof a[d]||"boolean"===typeof a[d])c+="\x26__pagedata_"+d+"\x3d"+a[d];return c}var f=a.$,l;a.declarative("checkout-submit-feedback",["click","touchend"],function(a){if(!k.protectAgainstDoubleAction("checkout-submit-feedback",200)&&(a=f("#checkout-feedback-form"),a.length)){c.showSpinner(a,!1);var e=a.serialize(),e=e+d();f.ajax({type:"POST",url:a.attr("action"),data:e,dataType:"text",error:g.ajaxRedirect,success:function(a,b,c){b=c.getResponseHeader("checkout-feedback-submitted");
f(".a-button-close").trigger("click");null!==b&&b!==F&&f("#checkout-feedback-banner").append(a)}})}});return{registerPageDataCollecter:function(a){a&&"function"===typeof a&&(l=a)}}});"use strict";q.when("A","page-spinner-controller","scroll-controller","ajax-utility","page-conductor","checkout-modal-popover","page-detector-current-page","checkout-general-utils","a-popover","client-side-metrics").execute(function(a,k,g,c,d,f,l,h,e,n){function b(){function b(a){a=a.$currentTarget.closest(".delivery-instructions-block");
a.find(".edit-delivery-instructions-link").addClass("aok-hidden");a.find(".delivery-instructions-display").addClass("aok-hidden");var c=a.find(".dynamic-delivery-instructions-update").find(".delivery-instructions-input").attr("maxlength");a.find(".dynamic-delivery-instructions-update").removeClass("aok-hidden");m("#deliveryInstructions").focus();m("#deliveryInstructions").select();m("#deliveryInstructions").keydown(function(a){10===a.which&&a.preventDefault()});m("#deliveryInstructions").keyup(function(){m("#delivery-instructions-left-text").hasClass("aok-hidden")&&
m("#delivery-instructions-left-text").removeClass("aok-hidden");var a=c-m(this).val().length;0>a&&(a=0);m("#delivery-instructions-left").text(a)});setTimeout(function(){},500)}function e(a){k.show();a=a.$currentTarget;var b=m("#deliveryInstructions").val(),c=a.closest(".delivery-instructions-block"),g=a.closest(".dynamic-delivery-instructions-update");c.find(".edit-delivery-instructions-link").removeClass("aok-hidden");c.find(".delivery-instructions-display").removeClass("aok-hidden");g.addClass("aok-hidden");
c=(new Date).getTime();b="deliveryInstructions\x3d"+encodeURIComponent(b)+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+m("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+c;c=d.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":l.getCurrentPage()});m.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-instructions.html/ref\x3dox_instructions_page_delivery_instructions_update",data:b,headers:c,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",complete:function(){k.hide()},success:f,error:d.ajaxRedirect});a.blur()}function f(a,b,d){(a=c.jsonify(a))&&!m.isEmptyObject(a)&&m("#deliveryInstructionsDisplay").html(a.deliveryInstructions);k.hide()}p&&(a.declarative("edit-delivery-instructions",["click"],b),a.declarative("update-delivery-instructions",["click"],e),p=!1)}var m=a.$;if(!m("html").hasClass("a-ie6")){var p=!0;a.on("checkout:reload:spc",b);a.on("checkout:reload:spclite",b);a.on("checkout:reload:spp-shipaddress",b);a.on("checkout:reload:spp-f3-sosp",
b);a.on("checkout:reload:spp-payment",b)}});"use strict";q.when("A","page-conductor","page-transition-controller").register("installments-service",function(a,k,g){var c=a.$;return{call:function(a,f,l){g.show();c.ajax({type:"POST",url:"/gp/buy/installments/handlers/set-item-installments.html/ref\x3dox_spc_inst_toggle",data:{itemId:a,programId:f},dataType:"text",async:!0,cache:!1,headers:k.setAjaxTransitionHeader(),success:l.success||null,error:l.error||null})},sendReftag:function(a){c.post("/gp/buy/spc/handlers/pmts-continue-widget.html/ref\x3d"+
a)}}});"use strict";q.when("A","page-transition-controller","page-conductor","page-detector","button-blocker","installments-service","client-side-metrics","widgets/installmentsModal/state","allow-installments-page-transition").register("installments-controller",function(a,k,g,c,d,f,l,h,e){function n(){a.defer(m)}function b(a,b,c){e.isEnabled?g.ajaxUpdatePage(a,b,c,{pushNewFrame:"true"}):(k.hide(),g.ajaxUpdatePage(a,b,c,{pushNewFrame:"false"}))}function m(){var a=p("#installments-button-blocker");
1===a.length&&(a=a.data("blocker-message"),d.show("place-order-installments-blocker",a))}var p=a.$;a.declarative("installments-sync-state",["change"],function(a){var c=p("#trigger-installments-modal"),d;if(c.length)if(h.$target=a.$target,h.bundleAsin=a.data.bundleAsin,h.asin=a.data.asin,h.itemId=a.data.itemId,h.isChecked=h.$target.is(":checked"),h.programId=h.isChecked?a.data.programId:"",a={success:b,error:g.ajaxRedirect},h.handlerData=a,d=h.isChecked?"Checkout:Installments:UpdateOptIn":"Checkout:Installments:UpdateOptOut",
h.isChecked)c=h.asin,a=h.bundleAsin,f.call(h.itemId,h.programId,h.handlerData),a?f.sendReftag("installments_toggle_on_asin_"+c+"_bundle_asin_"+a):f.sendReftag("installments_toggle_on_asin_"+c);else{a=h.itemId;var e=h.programId,k=h.handlerData,m=h.asin,n=h.bundleAsin;n&&c.length?(f.sendReftag("installments_toggle_off_asin_"+m+"_bundle_asin_"+n),c.click()):(f.sendReftag("installments_toggle_off_asin_"+m),f.call(a,e,k))}else c=a.data.itemId,e=(d=a.$target.is(":checked"))?a.data.programId:"",a={success:b,
error:g.ajaxRedirect},d=d?"Checkout:Installments:UpdateOptIn":"Checkout:Installments:UpdateOptOut",f.call(c,e,a);l.increaseCount(d)});a.on("checkout:reload:spp-revieworder",n);a.on("checkout:reload:spc",n)});"use strict";q.when("A","page-conductor","checkout-modal-popover","page-transition-controller","ajax-utility","page-detector","payments-portal-common","ready").register("spc-payments-portal",function(a,k,g,c,d,f,l){function h(b,c){c={refTag:c,callbackBeforePageUpdate:function(){a.$("div.a-popover button.a-button-close").trigger("click")}};
k.isSPP()&&(c.keepCachedPagesData=1);k.loadPage("spc",b,null,c)}function e(a,d,e){k.isSPP()?(c.blockAllActions(),c.showTransitionInContainer(n("#payment"))):c.show();a="/gp/buy/spc/handlers/pmts-continue-widget.html/ref\x3d"+a;var f=k.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});n.ajax({type:"POST",url:a,data:d,headers:f,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",success:function(a,b,c){c.getResponseHeader("x-amz-checkout-page")?
k.ajaxUpdatePage(a,b,c):e(a)},error:k.ajaxRedirect})}var n=a.$;return{prepareDelegatedPopovers:function(b){function c(a,b){a=n(a);a.data("aCheckoutModalPopover",b);g.createModal({$declarativeParent:a},b)}a.on("pmts:retail:billing-address-popover",function(a){c(".pmts-change-address-link",{header:b.billingAddressPopoverHeader,footer:"",name:"billing-address",allowScrollOnPage:!0})});a.on("pmts:retail:rewards-registration",function(a){c(".pmts-shop-with-points-learn-more-link",{header:b.rewardsRegistrationPopoverHeader,
footer:"",name:"rewards-registration",allowScrollOnPage:!0})})},handleClaimCodeSubmittedEvent:function(a,c){var d={returnjson:"1",returnFullHTML:"1",hasWorkingJavascript:"1",fromAnywhere:n("input[name\x3dfromAnywhere]").val(),cachebuster:(new Date).getTime(),nextAction:"pipeline-dispatch",embedOnlyData:"1"};a=n.param(a)+"\x26"+n.param(d);e("ox_pay_page_gc_add",a,function(a){l.claimCodePageUpdater(c,a)})},handleChangeBillingAddressRequestedEvent:function(){f.isDesktopSpc()?k.isSPP()?n("#pmts-change-billing-address-popover").trigger("click"):
a.trigger("pmts:retail:billing-address-popover"):(c.show(),k.isPipeliningOn()&&h("billingaddressselect","ox_spc_change_ship_addr"))},handleChangePaymentInstrumentRequestedEvent:function(){c.show();k.isPipeliningOn()&&h("payselect","ox_spc_change_payment")},handleRewardsAccountLearnMoreRequestedEvent:function(){a.trigger("pmts:retail:rewards-registration")},handlePointsAccountSubmittedEvent:function(a){var c={hasWorkingJavascript:"1",isClientTimeBased:n("input[name\x3duseCtb]").val(),nextAction:"dispatch"};
a=n.param(a)+"\x26"+n.param(c);e("ox_spc_points_edit",a,function(a){a=d.jsonify(a);k.redirect(a)})}}});"use strict";q.when("ajax-utility","gc-redeem-controller","page-transition-controller","ready").register("payments-portal-common",function(a,k,g){return{claimCodePageUpdater:function(c,d){d=a.jsonify(d);null!==d?d.widgetJsonData?(c.update(d.widgetJsonData),g.hide()):d.autohandlererror&&k.giftSystemErrorHandling(d.autohandlererror):g.hide()}}});"use strict";q.when("A","page-detector-current-page",
"a-button","a-meter").register("checkout-throttle-error",function(a,k,g,c){var d=a.$;a.on("checkout:reload:throttle",function(){if(d("#checkout-throttle-meter").length){var a=1E3*d('input[name\x3d"waiting-time"]').val()/100;g("#checkout-throttle-return-to-cart").disable();var l=c("#checkout-throttle-meter"),h=0,e=setInterval(function(){l.percent(h);if(100>h)h+=1;else{clearInterval(e);var a=g("#checkout-throttle-return-to-cart");a.text(d("#checkout-throttle-primary-button-active-text").text());a.enable()}},
a)}})});"use strict";q.when("A","weblab-helper").register("nav-bar-helper",function(a,k){function g(){try{q.register("navCF")}catch(a){if(-1===a.message.toLowerCase().indexOf("already registered"))throw a;}}if(k.isNavCFWeblabOn())a.on("checkout:reload",g)});q.when("A").execute(function(a){a.declarative("remaining-customizations-action","click",function(a){a.$currentTarget.parent().find(".remaining_customization_info").removeClass("aok-hidden");a.$currentTarget.hide();a.$event.preventDefault()})});
"use strict";q.when("A","checkout-federation-utilities","client-side-metrics").register("checkout-federation-wrapper",function(a,k,g){function c(a){for(var c=[],g=d;g<a.length;g++)c.push(a[g]);return c}var d=2;return{wrap:function(a,d){try{return a.apply(null,c(arguments))}catch(b){var h=d,e=b,n;n=h;n=k.getExternalDependecies()[n];n=n!==F&&null!==n?n.cti:"Undefined";g.logError(e,"["+h+"] Javascript error thrown while executing wrapper",n,"FATAL");p.console&&p.console.error&&p.console.error(e,h,n)}}}});
"use strict";q.when("A","jQuery","checkout-federation-utilities").register("checkout-federation-injector",function(a,k,g){function c(a){a=a.assetsModule;if(d[a]?0:0<k('script[type\x3d"checkout-asset-trigger"][data-checkout-asset-trigger\x3d"'+a+'"]').length)d[a]=!0,q.register("trigger"+a,function(){})}var d={};a.on("checkout:reload",function(){var a=g.getExternalDependecies(),d;for(d in a)a.hasOwnProperty(d)&&c(a[d])})});"use strict";q.when("A","client-side-metrics").register("checkout-federation-utilities",
function(a,k){return{getExternalDependecies:function(){var g=a.state("triggerExternalDependencies");Object&&Object.keys&&k.increaseCount("Checkout:ExternalDependencies:count:"+(g?Object.keys(g).length:"undefined"));return g===F||null===g?{}:g}}});"use strict";q.register("allow-installments-page-transition",function(){return{isEnabled:!1}})});
/* ******** */
(function(k){var h=window.AmazonUIPageJS||window.P,E=h._namespace||h.attributeErrors,a=E?E("CheckoutMultiPagePipeline",""):h;a.guardFatal?a.guardFatal(k)(a,window):a.execute(function(){k(a,window)})})(function(k,h,E){k.when("A","a-tooltip").register("button-blocker-mpp",function(a,d){var c=a.$;a.declarative("a-tooltip-button-blocker",["mouseenter","click","touchstart"],function(a){a=a.$target;if(0<a.length){var b=d.get(a),g=c(".place-order-blocker-message.custom-blocker-message");if(g.is(":empty")){var f=
c("#gold-box-button-blocker");1===f.length&&g.text(f.attr("data-blocker-message"))}g.is(":empty")&&c("div.locale-cn").length&&(g=c(".place-order-blocker-message.china-invoice-message"));b?b.updateContent(g.text()):b=d.create(a,{content:g.text()});b.isActive()||b.show()}})});k.when("A","a-popover-base","a-popover-util","button-blocker").register("button-blocker-popover",function(a,d,c,e){function b(a,b){if(b.name)d.show({$trigger:a?a.$target:e.getButtonBlocker(),skin:m,alone:!1,update:n,hide:h,content:b.content,
name:b.name,position:b.position||"triggerVertical"});else if(b=d.show({$trigger:a.$target,skin:m,alone:!1,update:n,hide:h,content:a.$currentTarget.data("blockerText"),position:b.position||"triggerVertical"}))b.update(a.$currentTarget.data("blockerText")),b.updatePosition()}function g(b){var f=b?b.$target:e.getButtonBlocker();f&&a.delay(function(){b&&c.eventOccursWithin(b,f)||d.hide(f)},250)}var f=a.$,m=function(a){return['\x3cdiv class\x3d"a-popover"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e','\x3cdiv class\x3d"a-popover-inner"\x3e'+
a+"\x3c/div\x3e",'\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")},z=!1,n=function(a){z||f(".a-popover-inner",this.$popover).html(a)},h=function(){z||a.fadeOut(this.$popover,250)},y={mouseenter:b,mouseleave:g},w={click:b};a.declarative("a-button-blocker",["mouseenter","mouseleave","click"],function(b){try{b.$event.preventDefault()}catch(d){if(!f("html").hasClass("a-lt-ie9"))throw d;}if(!z){var c=(a.capabilities.touch?w:
y)[b.type];c&&c(b,b.data)}});return{create:function(a){a&&a.name&&a.content&&b(null,a)},destroy:function(a){g(null)},lock:function(){z=!0},unlock:function(){z=!1}}});"use strict";k.when("jQuery").register("form-icon-controller",function(a){function d(a){a.is(":checked")?a.closest("label").find("i").removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active"):a.closest("label").find("i").removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive");
a.is(":disabled")?a.closest("label").addClass("a-touch-selector-disabled"):a.closest("label").removeClass("a-touch-selector-disabled")}function c(a){a.is(":checked")?a.closest("label").find("i").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"):a.closest("label").find("i").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");a.is(":disabled")?a.closest("label").addClass("a-touch-selector-disabled"):a.closest("label").removeClass("a-touch-selector-disabled")}
function e(){a("label.a-touch-checkbox-control input").each(function(b){d(a(this))});a("label.a-touch-radio-control input").each(function(b){c(a(this))})}function b(){a("label.a-touch-checkbox-control input").unbind("change.form-icon-controller").bind("change.form-icon-controller",function(b){d(a(this))});a("label.a-touch-radio-control input").unbind("change.form-icon-controller").bind("change.form-icon-controller",function(b){c(a(this))});a("label.a-touch-radio-control").unbind("click.form-icon-controller").bind("click.form-icon-controller",
function(b){b=a("input",this);if(!b.is(":disabled")){var c=a("i.a-icon",this),d=a('i[data-a-input-name\x3d"'+b.attr("name")+'"]'),g=a('input[name\x3d"'+b.attr("name")+'"]');g.removeAttr("checked");b.attr("checked","checked");d.addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active");c.addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");g.trigger("change");b.trigger("change")}});a("label.a-touch-checkbox-control").unbind("click.form-icon-controller").bind("click.form-icon-controller",
function(b){b=a("input",this);if(!b.is(":disabled")){var c=a("i.a-icon",this);b.is(":checked")?b.removeAttr("checked"):b.attr("checked","checked");c.toggleClass("a-icon-touch-checkbox-active").toggleClass("a-icon-touch-checkbox-inactive");b.trigger("change")}})}function g(){a("html").hasClass("a-touch")&&(e(),b(),a("label.a-touch-radio-control input").trigger("change"))}k.when("A").execute(function(a){a.on("checkout:reload",g)});return{initializeIconControllers:e,bindIconControllers:b}});"use strict";
k.when("A","checkout-general-utils").register("inline-expander",function(a,d){function c(a){var c=a.parent().find(".a-expander-inner");c.length||(c=e("#"+a.data("expanderContent")));a.data("isShown")&&"false"!==a.data("isShown")?(c.slideUp("fast"),a.data("isShown","false")):(c.slideDown("fast"),a.data("isShown","true"),c=e("#"+a.data("expanderAnchor")),c.length&&e("html, body").animate({scrollTop:c.offset().top},"fast"));a=a.find("i");(a.hasClass("a-icon-collapse")||a.hasClass("a-icon-expand"))&&
a.toggleClass("a-icon-collapse").toggleClass("a-icon-expand")}var e=a.$;a.declarative("a-inline-expander",["click","touchend"],{allowLinkDefault:!0},function(a){a.$event.preventDefault();d.protectAgainstDoubleAction("a-inline-expander",400)||c(e(a.$event.currentTarget))});return{toggleExpander:c}});"use strict";k.when("jQuery").register("checkout-pagination",function(a){function d(a,b,d,e,g){var y=b.find("li.checkout-page-selector.a-selected").removeClass("a-selected");a.find("js-hide").hide().removeClass("js-hide");
c(y,a,b,d,g,e);e.height(e.height())}function c(a,c,d,n,h,y){if(!a.hasClass("a-selected")){var w=parseInt(a.text(),0)-1,D=parseInt(a.siblings(".a-selected").text(),0)-1,q=d.find(".checkout-page-previous"),u=d.find(".checkout-page-next");c.stop(!0,!0).clearQueue();0===w?b(q):e(q);w===h-1?b(u):e(u);d.find(".checkout-page-selector").removeClass("a-selected");a.addClass("a-selected");a=function(){return c.slice(w*n,w*n+n).fadeIn("fast")};isNaN(D)?a().stop(!0,!0):c.slice(D*n,D*n+n).fadeOut("fast",a);0<
w&&g(y)}}function e(a){a.hasClass("a-disabled")&&(a.removeClass("a-disabled"),a.wrapInner('\x3ca href\x3d"javascript:void(false)"/\x3e'))}function b(a){a.hasClass("a-disabled")||(a.addClass("a-disabled"),a.html(a.children("a").html()))}function g(b){var c=0;b.children().filter(":visible").each(function(){c+=a(this).outerHeight(1)});c>b.height()&&b.height(c)}return{initializePagination:function(b){b.unbind("checkoutpagination.initializePagination").bind("checkoutpagination.initializePagination",function(){var b=
a(this),e=b.find(".checkout-pagination-content"),g=e.children().addClass("checkout-pagination-item"),f=b.find("div.a-pagination"),y=parseInt(f.data("checkoutPaginationItemsperpage"),0)||5;if(0!==y&&0!==f.length){var w=Math.ceil(g.length/y);1===w?f.hide():(d(g,f,y,e,w),b.delegate("li.checkout-page-selector","click",function(b){b.preventDefault();c(a(this),g,f,y,w,e)}),b.delegate("li.checkout-page-previous","click",function(b){b.preventDefault();if(a(this).hasClass("a-disabled"))return!1;c(f.find(".a-selected").prev(),
g,f,y,w,e)}),b.delegate("li.checkout-page-next","click",function(b){b.preventDefault();if(a(this).hasClass("a-disabled"))return!1;c(f.find(".a-selected").next(),g,f,y,w,e)}),e.delegate(".checkout-pagination-item","activate.checkout-pagination",function(){var b=a(this),b=g.index(b);f.find("li:contains("+(Math.floor(b/y)+1)+")").click()}))}}).trigger("checkoutpagination.initializePagination")}}});"use strict";k.register("latency-logger",function(){var a=[],d=[];return{start:function(c){var e=(new Date).getTime();
a.push(e);d.push(c)},stop:function(){var c=(new Date).getTime(),e=a.pop();if(h.log_latency&&h.console&&h.console.log){var b=d.pop();console.log(b+": "+(c-e)+" ms")}}}});"use strict";k.when("page-conductor","ajax-utility","jQuery","page-detector","weblab-helper").register("page-conductor-mpp",function(a,d,c,e,b){a.initFunc(function(a){c("body").html(a)},function(a){var d=c("#checkoutDisplayPage"),m=b.isFreshMobileNoScrollOnRefreshEnabled()&&"1"===d.data("freshCheckoutNoScrollToTopMobile");d.removeData("freshCheckoutNoScrollToTopMobile");
d.length&&(d.html(a),e.isMobile()&&(b.isIngressEnabled()?(c('button[data-action\x3d"a-popover-close"]:visible').trigger("click"),b.isProgressiveOrderReviewScrollingFixEnabled()&&b.isProgressiveOrderReviewCardAnchorEnabled()?c(document).scrollTop(c("#progressive-order-review-card-anchor").offset().top-20):c(document).scrollTop()):m||(b.isProgressiveOrderReviewCardAnchorEnabled()?c(document).scrollTop(c("#progressive-order-review-card-anchor").offset().top-20):c(document).scrollTop(d.offset().top)),
a=c("h1"),a.attr("tabindex","0").css("outline","none"),a.focus()))})});"use strict";k.when("A","loading-spinner-controller","page-conductor").register("long-calendar-popover-controller",function(a,d,c){var e=a.$,b={},g,f,m=0;a.on("a:popover:show:prime-long-calendar",function(a){g=a=a.popover.$trigger.data("orderid");e(".prime-long-calendar-popover").each(function(a){e(this).parent().hasClass("a-popover-inner")&&(f=e(this))});d.showSpinner(f,!1);var n;if(e("#spc-another-day-link").length)n="spc",m=
0;else if(n="sosp",m=1,b[g]){e(".prime-long-calendar-popover").html(b[g]);return}var h;"spc"===n?h=e("input[name\x3dlineitemids"+a+"]").attr("value"):"sosp"===n&&(h=e("input[name\x3dlineItemEntityIds_"+a+"]").attr("value"));e.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/long-calendar-content.html",data:"lineitemids\x3d"+h+"\x26orderid\x3d"+a+"\x26fromPage\x3d"+n,dataType:"html",async:!0,cache:!1,headers:{"x-amz-checkout-page":n},success:function(a){e(a).find("#recs-server-error").length?e(".a-button-close").trigger("click"):
e(".prime-long-calendar-popover").html(a)},error:c.ajaxRedirect})});a.on("a:popover:hide:prime-long-calendar",function(a){m&&(b[g]=f.html())})});"use strict";k.when("A","a-popover-base").execute(function(a,d){function c(a){var e=$(".ags-popover-content").closest(".a-popover-wrapper");e.find(".a-popover-inner").unbind();var f=a.$declarativeParent;if(d.get(f)){var m=setTimeout(function(){d.hide(f)},250);e.find(".a-popover-inner").bind("mouseenter",function(a){clearTimeout(m);a.stopPropagation()});e.find(".a-popover-inner").bind("mouseleave",
function(d){c(a);d.stopPropagation()})}}var e;a.on("a:popover:beforeShow:ags-badge-popover",function(){var a=$(".ags-popover-content").closest(".a-popover-wrapper"),c=a.find(".a-popover-header");1===c.length&&(e=c.find(".a-button-close").clone(),c.remove());a.find(".a-popover-inner").prepend(e)});a.declarative("a-popover","mouseenter",function(a){"ags-badge-popover"===a.data.name&&a.$currentTarget.trigger("click")});a.declarative("a-popover","mouseleave",function(a){"ags-badge-popover"===a.data.name&&
c(a)})});"use strict";k.when("A","ready").register("checkout-buttom-sheet-controller",function(a){a=a.$;var d=a("#a-page");return{disablePageScrolling:function(){d.css({position:"fixed",top:"-"+h.scrollY+"px"})},enablePageScrolling:function(){var a=Math.abs(d.position().top);d.css({position:"",top:""});h.scrollTo(0,a)}}});k.when("A","ready").register("autopopulate-fields-clear",function(){});"use strict";k.when("A","ready").execute(function(a){var d=a.$,c,e,b;a.on("checkout:beforeReload",function(){b!==
E&&(e.css("margin-bottom",b+"px"),b=E)});a.on("checkout:reload:spc",function(){c=d("#pyo-button-pinned");e=d("body");if(1===c.length&&"fixed"===c.css("position")&&b===E){var a=e.css("margin-bottom");b=parseInt(a,10);e.css("margin-bottom",b+c.height()+"px")}})});k.when("A","ready").register("progressive-order-review-truncate",function(){});"use strict";k.when("A","page-detector").execute(function(a,d){function c(){d.isSpc()&&e("iframe#typ-assets-spc-iframe").attr("src","/gp/checkoutprefetch/typ-assets.html")}
var e=a.$;a.on("checkout:reload:spc",function(){setTimeout(c,1E3)})});"use strict";k.when("A","page-detector","page-detector").execute(function(a,d,c){function e(){0<g(".prime-calendar-container").length&&g(".prime-calendar-container").contents().each(function(a,b){8===b.nodeType&&g(b).replaceWith(b.nodeValue)});z=m=-1;var a=g("html");a.hasClass("a-ie6")&&(a.removeClass("a-js").addClass("a-no-js"),g(".a-declarative").removeClass("a-declarative"));setTimeout(b,1E3)}function b(){if(c.isSpc())if(c.isSpcLite()){n=
g("#left-grid");k=g("#right-grid");z=g("#second-buy-button").height();k.css("min-height",0);n.css("min-height",0);var a=n.height(),b=g("#order-summary-box").height(),d=b+z;if(d<a){k.css("min-height",a);n.css("min-height",a);var b=g(document).height(),e=g(h).height()+200;b>e&&d<a?g("#second-buy-button").show():g("#second-buy-button").hide()}else a<d&&n.css("min-height",b),g("#second-buy-button").hide()}else-1===m&&(n=g("#left-grid"),k=g("#right-grid"),m=n.height(),z=g("#second-buy-button").height()),
b=g("#order-summary-box").height(),d=b+z,d<m?(k.css("min-height",m),n.css("min-height",m),b=g(document).height(),e=g(h).height()+200,b>e&&d<m?g("#second-buy-button").show():g("#second-buy-button").hide()):(m<d&&n.css("min-height",b),g("#second-buy-button").hide())}var g=a.$,f,m,z,n,k;a.on("resize",function(){f&&h.clearTimeout&&h.clearTimeout(f);f=setTimeout(function(){b();f=null},100)});a.on("checkout:spc:ordersummary:sizeChanged",b);a.on("checkout:reload:spc",e);a.on("checkout:reload:spclite",e)});
k.when("error-feature-detection").execute(function(a){a.registerFeature("shipping-speed-selection-controller",1)});"use strict";k.when("A","checkout-general-utils","page-transition-controller","page-detector","page-conductor","cache-page-data-controller").execute(function(a,d,c,e,b,g){function f(d,c,e,f,g){a.trigger("checkout:beforeLoadPage");b.ajaxUpdatePage(n[d+":"+c+":"+e+":"+f+":"+g].data,n[d+":"+c+":"+e+":"+f+":"+g].status,n[d+":"+c+":"+e+":"+f+":"+g].response,{refTag:f,anchor:e})}function m(a){if(h)h=
!1;else if(d.protectAgainstDoubleAction("pipeline-link"))a.preventDefault(),a.stopImmediatePropagation();else{var e=z(a.currentTarget),m=e.data("pipelineLinkFromPage"),q=e.data("pipelineLinkToPage"),u=e.data("pipelineLinkAnchor"),l=e.data("pipelineLinkRef"),e=e.data("pipelineLinkArgs");q&&(a.preventDefault(),a.stopImmediatePropagation(),b.isSPP()&&g.setCachedPageData(m,q),"object"!==typeof n[m+":"+q+":"+u+":"+l+":"+e]||!n[m+":"+q+":"+u+":"+l+":"+e].pending&&"undefined"===typeof n[m+":"+q+":"+u+":"+
l+":"+e].data?(c.show(),a={refTag:l,anchor:u},b.isSPP()&&(a.keepCachedPagesData=1),b.loadPage(m,q,e,a)):n[m+":"+q+":"+u+":"+l+":"+e].pending?(c.show(),n[m+":"+q+":"+u+":"+l+":"+e].dispatch=1):f(m,q,u,l,e))}}var z=a.$,n={},h=!1;a.on("checkout:reload:spc",function(){z("a.pipeline-link.static-link-prefetch").each(function(a,d){a=z(d);a.bind("touchmove",function(){h=!0});a.bind("click keypress touchend",m);var c=a.data("pipelineLinkFromPage"),e=a.data("pipelineLinkToPage"),g=a.data("pipelineLinkAnchor"),
l=a.data("pipelineLinkRef"),C=a.data("pipelineLinkArgs");if(e){n[c+":"+e+":"+g+":"+l+":"+C]={};n[c+":"+e+":"+g+":"+l+":"+C].pending=1;n[c+":"+e+":"+g+":"+l+":"+C].dispatch=0;var G={refTag:l,anchor:g,resultscallback:function(a,d,m){n[c+":"+e+":"+g+":"+l+":"+C].pending=0;a?(n[c+":"+e+":"+g+":"+l+":"+C].data=a,n[c+":"+e+":"+g+":"+l+":"+C].response=m,n[c+":"+e+":"+g+":"+l+":"+C].status=d,n[c+":"+e+":"+g+":"+l+":"+C].dispatch&&f(c,e,g,l,C)):n[c+":"+e+":"+g+":"+l+":"+C].dispatch&&(G.resultscallback=E,b.loadPage(c,
e,C,G))}};a="isAsync\x3d1\x26isClientTimeBased\x3d1";C&&(a+="\x26"+C);b.loadPage(c,e,a,G)}})})});"use strict";k.when("A","loading-spinner-controller","page-transition-controller","page-conductor","ajax-utility","checkout-general-utils","page-detector","client-side-metrics").register("inline-address-popover-controller",function(a,d,c,e,b,g,f,m){function z(){a.defer(function(){t("#spc-top").find(".change-address-popover-link").each(function(){var a=t(this);a.data("action")&&-1<a.data("action").indexOf("a-checkout-modal-popover")&&
a.attr("tabindex",0)})});var b=t(".a-popover-modal");b.find("#shipping-address-popover").remove();b.find("#billing-address-popover").remove();a.defer(function(){n();k()})}function n(){t("#desktop-shipping-address-div .screenreader-address-span").text(" "+t("#desktop-shipping-address-div .displayAddressAddressLine1").text())}function k(){t("#billing-address .duplicate-address").is(":visible")?t("#billing-address .screenreader-address-span").text(" "+t("#desktop-shipping-address-div .displayAddressAddressLine1").text()):
t("#billing-address .screenreader-address-span").text(" "+t("#billing-address .displayAddressAddressLine1").text())}function y(d,ga,f){function g(b){b.isSameAsShipping?(t("#billing-address .single-address").hide(),t("#billing-address .duplicate-address").show()):b.addressHTML&&(t("#billing-address .duplicate-address").hide(),t("#billing-address .single-address").html(b.addressHTML).show());k();a.trigger("checkout:billing-address-update")}function p(a){var b=t("#left-grid");a.isSameAsShipping?b.find(".pmts-billing-address-details").html(b.find(".billing-duplicate-address").html()):
a.addressHTML&&b.find(".pmts-billing-address-details").html(a.addressHTML)}function l(a){return"shouldRefreshSPCOnChange"in a&&1===a.shouldRefreshSPCOnChange}if(f.getResponseHeader("x-amz-checkout-page")){var n=f.getResponseHeader("x-amz-checkout-fatal-error");if(null!==n&&n!==E){h.location=n;return}t(".a-button-close").trigger("click");return e.ajaxUpdatePage(d,ga,f)}if((d=b.jsonify(d))&&(d.isSameAddress||d.isSameAsShipping||d.addressHTML)&&(0===t("#billing-address").size()?p(d):g(d),!l(d))){c.hide();
t(".a-button-close").trigger("click");d.requestid&&(m.setAsyncRequestId(d.requestid),m.sendUEPageLoadStats());return}e.redirect(d);d&&d.conductoraction?t(".a-button-close").trigger("click"):l(d)||(c.hide(),t(".a-button-close").trigger("click"))}function w(a,b){b=b.toLowerCase();if("none"===t("#"+b+"-address-popover").closest(".a-popover").css("display"))I.push(b+"-Address: Not populating popup modal is hidden");else{var c=t("#"+b+"-address-popover .select-address-main"),e="/gp/buy/pipeline/handlers/update-"+
b+"-address.html",f=!1;"true"===a.isCampus&&(f=c.closest(".select-address-main"),f.find(".popover-pagination").remove(),f="true"===a.hideAddAddress||!1);Q(a.addresses,c,2,3,e,b,"pageConductor.ajaxRedirect",f);a=c.find(".select-address-page").filter(function(){return"template"!==t(this).data("addresspage")}).length;1<a&&(a=C(0,a,l),f=c.closest(".select-address-main"),f.find(".popover-pagination").remove(),a.appendTo(f).show());!1===p.modifiedForCampus&&c.closest(".address-popover").find(".address-popover-sidebar").css("visibility",
"visible").hide().fadeIn(300);d.hideSpinner(c);I.push(b+"-Address: Hiding spinner");N(t("#"+b+"-address-popover"));c.find(".select-address-page").filter(function(){return 0===t(this).data("addresspage")}).fadeIn(300)}}function D(a){I.push("Billing-Address: AJAX Call returned with data: "+b.jsonify(a));w(a,"Billing")}function q(a){I.push("Shipping-Address: AJAX Call returned with data: "+b.jsonify(a));w(a,"Shipping");var d=t("#shipping-address-popover .select-address-main"),c=t("#popover-store-pickup-search-spc");
a.showPickupSearch?(c.show(),a.useTwoZipStoreSearch?(c.find(".secondary-pickup-input").show(),c.find("input[name\x3d'searchCriterion']").val("storeTwoZips"),c.find(".popover-pickup-input input").removeClass("single-input").addClass("two-inputs")):c.find(".secondary-pickup-input input").val("")):c.hide();a.canShipToMultiple?t("#spc-popover-ship-to-multiple-link").show():t("#spc-popover-ship-to-multiple-link").hide();c.find(".popover-pickup-input input").focus(function(){t(this).hasClass("pickup-search-field")&&
t(this).removeClass("a-color-secondary").val("")});a=d.find(".add-address-button");a.hasClass("pipeline-link")||(a.bind("click",{usecase:"addaddress",reftag:"ox_spc_shipaddr_addnewbox_popover"},u),d=t("#spc-popover-add-new-address-link a"),d.bind("click",{usecase:"addaddress",reftag:"ox_spc_shipaddr_addnewlink_popover"},u),c=t("#spc-popover-edit-address-link a"),c.bind("click",{usecase:"editaddress",reftag:"ox_spc_shipaddr_editlink_popover"},u),g.bindActionEnterKeyOnButton(a),g.bindActionEnterKeyOnButton(d),
g.bindActionEnterKeyOnButton(c));a=t("#spc-popover-ship-to-multiple-link a");a.hasClass("pipeline-link")||(a.bind("click",{usecase:"shiptomultiple",reftag:"ox_spc_shipaddr_multilink_popover"},u),g.bindActionEnterKeyOnButton(a))}function u(a){var b;if(a&&a.data&&a.data.usecase){b=a.data.usecase;a=a.data.reftag?a.data.reftag:"shipaddr_popover_link";var d=null,e="";"addaddress"===b?(d="/gp/buy/addressselect/handlers/display.html",e="#new-address"):"editaddress"===b?d="/gp/buy/addressselect/handlers/display.html":
"shiptomultiple"===b&&(d=g.addQueryStringParameter("/gp/ordering/checkout/item/select.html","useCase","multiAddress"));d&&(c.show(),d=g.addQueryStringParameter(d,"ref",a),d=g.addQueryStringParameter(d,"hasWorkingJavascript","1"),h.location.href=d+e)}}function l(a){if(a&&a.target){var b=t(a.target),d=parseInt(b.closest("li").data("goto"),10),c=t(a.target).closest(".select-address-main"),e=c.find(".select-address-page").filter(function(){return"template"!==t(this).data("addresspage")}).length;c.find(".select-address-page:visible").fadeOut(300,
function(){var a=C(d,e,l);c.find(".popover-pagination").remove();a.appendTo(c).show();c.find("div").filter(function(){return t(this).data("addresspage")===d}).fadeIn(300)})}}function C(a,b,d){var c=t("div[data-pagination\x3d'template']").clone().attr("data-pagination","copy"),e=c.find(".pagination-next-disabled"),f=a-1;0>f&&(f=0);var p=f+2;p>=b&&(p=b-1,f=p-2,0>f&&(f=0));3>f&&(f=1);4>b-p&&(p=b-2);e.before(t("\x3cli\x3e").addClass("pagination-link").data("goto",0).html("\x3ca\x3e1\x3c/a\x3e").attr("tabindex",
0));for(2<f&&e.before(t("\x3cli\x3e").addClass("a-disabled").html("..."));f<=p;f++)e.before(t("\x3cli\x3e").addClass("pagination-link").data("goto",f).html("\x3ca\x3e"+(f+1)+"\x3c/a\x3e").attr("tabindex",0));3<b-p&&e.before(t("\x3cli\x3e").addClass("a-disabled").html("..."));e.before(t("\x3cli\x3e").addClass("pagination-link").data("goto",b-1).html("\x3ca\x3e"+b+"\x3c/a\x3e").attr("tabindex",0));0<a&&(c.find(".pagination-previous-disabled").hide(),c.find(".pagination-previous-enabled").addClass("pagination-link").data("goto",
a-1).attr("tabindex",0).show());a<b-1&&(e.hide(),c.find(".pagination-next-enabled").addClass("pagination-link").data("goto",a+1).attr("tabindex",0).show());c.find("li.pagination-link").filter(function(){return t(this).data("goto")===a}).removeClass("pagination-link").addClass("a-selected");b=c.find(".pagination-link");b.bind("click",d);g.bindActionEnterKeyOnButton(b);return c}function G(){return"template"===t(this).data("addresspage")}function M(){return"template"===t(this).data("addressrow")}function v(){return"template"===
t(this).data("newaddressslot")}function J(){return"template"===t(this).data("addressslot")}function L(){return"template"===t(this).data("addressgroup")}function R(a,b,c){var d=t("#shipping-address-popover .address-book").filter(L).clone().data("addressgroup","copy").show();d.find("h4").html(b);d.find(".popover-address-book-container").html(a.contents());c&&d.find(".popover-address-book-container").removeClass("a-padding-base");return a.empty().prepend(d)}function Q(a,b,d,e,f,p,n,l){b.find(".select-address-page").filter(function(){return"template"!==
t(this).data("addresspage")}).remove();for(var m=0,w=0,q=0,F=0,z,D=!1,h=function(){t(this).height()>F&&(F=t(this).height())},C=0;m<=a.length;C++){for(var u=b.find(".select-address-page").filter(G).clone().data("addresspage",C),k=0;k<d&&m<=a.length;k++){var I=u.find(".select-address-row").filter(M).clone().data("addressrow","copy").show();m<a.length&&a[m].addressBook&&(z=a[m].addressBook);for(var y=0;y<e&&m<=a.length;y++){var A;if(m===a.length)A=I.find(".select-address-slot").filter(v).clone().data("newaddressslot",
"copy").show(),z&&A.find(".add-address-button").width(170),!0===l&&A.hide();else{if(z&&a[m].addressBook!==z)continue;A=I.find(".select-address-slot").filter(J).clone().data("addressslot","copy").show();A.find(".select-address-slot-content").append(a[m].html);A.unbind("deliverTo-slotSelected").bind("deliverTo-slotSelected",function(){t(this).find(".select-address-button a").click()});a[m].isInvoiceAddress&&A.append(A.find(".invoice-address-note").clone().show());var S={seturl:f,setargs:a[m].setArgs+
"\x26index\x3d"+m,callerType:p,errorhandler:n,popoverdiv:b.closest(".address-popover")},B;B=a[m].isSelected?A.find(".use-current-address-button"):A.find(".use-different-address-button");a[m].isSuggestedPUP?function(a){B.unbind("click").bind("click",function(){c.show()}).show().find("a").attr("href",a)}(a[m].insertUrl):B.unbind("click").bind("click",S,O).show();g.bindActionEnterKeyOnButton(B)}y===e-1&&A.addClass("a-span-last");I.append(A);m++}k===d-1&&I.addClass("a-spacing-base");z&&(m<a.length&&a[m].addressBook!==
z||k===d-1&&!D?I=R(I,z,!1):D=!0);u.find("div:first").append(I)}w++;D&&(u=R(u,z,!0),D=!1);b.append(u);u.show();b.height()>parseInt(b.css("min-height"),10)&&b.css("min-height",b.height());u.height()>q&&b.find(".select-address-page").css("min-height",u.height());u.find(".select-address-slot-content").each(h);q=u.height();u.hide()}b.find(".select-address-slot-content").height(F);t(".screenreader-address-span").each(function(){var a=t(this);a.text(" "+a.closest(".select-address-slot").find("li.displayAddressAddressLine1").text())})}
function O(a){var d,f,g;a&&a.data&&a.data.seturl&&a.data.setargs&&a.data.callerType&&a.data.errorhandler&&(d=a.data.seturl,f=a.data.setargs,g=a.data.callerType);c.show();a=t("input[name\x3duseCtb]").val();f=f+"\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+a+"\x26responsive\x3d1";a=t("input#deliver-to-input");a.length&&(f+="\x26deliverTo\x3d"+a.val());a={"x-amz-checkout-page":"spc"};t("#passAjaxRequestHeader").length&&(a["x-amz-checkout-transition"]="ajax");H({type:"POST",
url:d,data:f,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded;charset\x3dutf-8",headers:a,success:function(a,d,f){"shipping"===g?f.getResponseHeader("x-amz-checkout-page")?(t(".a-button-close").trigger("click"),e.ajaxUpdatePage(a,d,f)):(a=b.jsonify(a))&&a.isSameAddress?(c.hide(),t(".a-button-close").trigger("click"),a.requestid&&(m.setAsyncRequestId(a.requestid),m.sendUEPageLoadStats())):(n(),e.redirect(a)):"billing"===g&&y(a,d,f)},error:function(a,b,d){e.ajaxRedirect(a,
b,d)}})}function T(){p.initialized&&setTimeout(function(){var a=t("#shipping-address-popover .select-address-main");a.css("minHeight",p.shippingAddressPopoverMinHeight).find(".select-address-page").css("minHeight",p.selectAddressPageMinHeight);a.closest(".address-popover").find(".address-popover-sidebar").show()},300);p.modifiedForCampus=!1}function H(a){F&&F.abort();var b=a.success;a.success=function(a,d,c){F=null;b&&"function"===typeof b&&(console.log("Success"),b(a,d,c))};var d=a.error;a.error=
function(a,b,c){F=null;console.log("Error");"abort"!==b&&d&&"function"===typeof d&&d(a,b,c)};F=t.ajax(a)}function B(a,b){if(a){b=b||0;I=["Starting spinner monitor"];var d=a.attr("id");P(d);W(d,function(){P(d);var c="none"!==t(".a-popover-modal").css("display"),e=0<a.children(".loading-spinner").length;c&&e&&(c=1E4+b,c="Popover Modal ("+a.attr("id")+") is still waiting after "+c/1E3+" secs. Current status is: "+I,g.logError(c))},1E4)}}function N(a){a&&(a=a.attr("id"),P(a))}function P(a){S[a]&&(clearTimeout(S[a]),
delete S[a])}function W(a,b,d){b=setTimeout(b,d);S[a]=b}var t=a.$;if(!t("html").hasClass("a-ie6")&&!t("html").hasClass("a-touch")){var p={initialized:!1,modifiedForCampus:!1,shippingAddressPopoverMinHeight:0,selectAddressPageMinHeight:0};a.declarative("search-locker",["click","touchend"],function(){if(!g.protectAgainstDoubleAction("search-locker")){var a=t("input[name\x3d'searchLockerFormAction']").val();if(a){c.show();var b='\x3cform name\x3d"searchLockerForm" action\x3d"'+a+'" method\x3d"POST"\x3e';
t("#popover-store-pickup-search-spc input").each(function(){b+='\x3cinput name\x3d"'+t(this).attr("name")+'" value\x3d"'+t(this).val()+'" type\x3d"hidden" /\x3e'});b+='\x3cinput name\x3d"hasWorkingJavascript" value\x3d"1" type\x3d"hidden" /\x3e';b+="\x3c/form\x3e";a=t(b);t("body").append(a);a.submit()}}});a.on("a:popover:hide:shipping-address",function(){p.modifiedForCampus&&T()});a.on("a:popover:beforeShow:shipping-address",function(a){if((a=a&&a.popover?a.popover.data:E)&&!0===a.returnCampusAddressesOnly){a=
t("#shipping-address-popover .select-address-main");var b=a.closest(".select-address-main");a.closest(".address-popover").css("minWidth",b.width()).find(".address-popover-sidebar").hide();p.modifiedForCampus=!0;!1===p.initialized&&(p.shippingAddressPopoverMinHeight=a.css("minHeight"),p.selectAddressPageMinHeight=a.closest(".address-popover").find(".select-address-page").css("minHeight"),p.initialized=!0);a.css("minHeight","").find(".select-address-page").css("minHeight","")}else p.modifiedForCampus=
!1});a.on("a:popover:show:shipping-address",function(a){d.showSpinner(t("#shipping-address-popover"),!1);B(t("#shipping-address-popover"));I.push("Shipping-Address: Executing AJAX request");H({type:"POST",url:"/gp/buy/pipeline/handlers/shipping-address-select-content.html",dataType:"text",dataFilter:function(a){return b.jsonify(a)},data:a&&a.popover?a.popover.data:E,async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},success:q,error:e.ajaxRedirect})});a.on("a:popover:show:billing-address",function(a){d.showSpinner(t("#billing-address-popover"),
!1);B(t("#billing-address-popover"));I.push("Billing-Address: Executing AJAX request");H({type:"POST",url:"/gp/buy/pipeline/handlers/billing-address-select-content.html",dataType:"text",dataFilter:function(a){return b.jsonify(a)},async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},success:D,error:e.ajaxRedirect})});a.on("checkout:reload:spc",z);var F,I=[],S={}}});"use strict";k.when("A").register("thirdparty-redirect-popover-controller",function(a){function d(){h.history&&h.history.pushState?
g(document).delegate("span.place-your-order-button-span","click",function(a){a.preventDefault()}):(g("span.place-your-order-button-span").removeClass("a-declarative"),g("input.place-your-order-button").parents("span.a-button-primary").addClass("place-order-button-link"))}function c(a){var b=g(a);0<b.filter("#thirdpartyform-headless").length?(g("#spc-desktop").append('\x3cdiv id\x3d"thirdparty-redirecting-hidden-form" style\x3d"display:none"\x3e\x3c/div\x3e'),g("#thirdparty-redirecting-hidden-form").append(b),
g("#thirdpartyform-headless").submit()):(h.history.pushState({state:"pushed-thirdparty-submit"},null,g("#spc-form").attr("action")),b=document.open(),b.write(a),b.close(),h.onpopstate=function(a){null===a.state&&h.location.reload()})}function e(a){g("#spc-form").submit()}function b(a){f&&f.abort();var b=a.success;a.success=function(a,d,c){f=null;b&&"function"===typeof b&&b(a,d,c)};var d=a.error;a.error=function(a,b,c){f=null;"abort"!==b&&d&&"function"===typeof d&&d(a,b,c)};f=g.ajax(a)}var g=a.$;a.on("checkout:reload:spc",
d);a.on("checkout:reload:spp-revieworder",d);a.on("a:popover:show:thirdparty-redirecting",function(a){a=g("#spc-form");a.append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");a.append("\x3cinput type\x3d'hidden' name\x3d'headlessForm' value\x3d'1' /\x3e");b({type:"POST",url:a.attr("action"),data:a.serialize(),async:!0,cache:!1,success:c,error:e})});var f});"use strict";k.when("A","order-summary-controller","inline-expander","client-side-metrics").register("order-summary-controller-mpp",
function(a,d,c,e){var b=a.$,g=h.P&&h.P.AUI_BUILD_DATE;a.on("checkout:reload:spc",function(){d.initOrderSummary();var a=b("#exchange-rate-link"),m=b("#switch-currency-link");if(!g){e.increaseCount("removeauijs67");if(b("html").hasClass("a-touch"))m.unbind("click").bind("click",function(a){c.toggleExpander(b(a.currentTarget))}),a.unbind("click").bind("click",function(a){c.toggleExpander(b(a.currentTarget))});else{var z=b("#spc-order-summary");z.find(".regulatory-fee-link").removeAttr("href").attr("tabindex",
0);z.find(".vat-breakdown-link").removeAttr("href").attr("tabindex",0)}c.toggleExpander(m);c.toggleExpander(a)}})});"use strict";k.when("A","page-detector").register("time-preferences-controller",function(a,d){function c(a){a=g(a.target).closest("a");var b=a.next(".time-preferences-options-list");b.is(":hidden")?(a.find(".time-pref-title").hide(),a.find(".time-pref-title-expanded").show(),b.slideDown("fast")):(a.find(".time-pref-title-expanded").hide(),a.find(".time-pref-title").show(),b.slideUp("fast"))}
function e(a){var b=g(a.target);a=b.closest(".time-preferences-options-list").prev(".time-preferences-link").find(".time-pref-title-details");f&&(a=b.closest(".a-expander-container").find(".time-pref-title-details"));b=b.closest(".time-preferences-option").find(".time-preference-label").text();a.text(b)}function b(){if(0!==g("div.locale-cn").length&&g("html").hasClass("a-touch")){var a=g("#spc-orders");a.find(".time-preferences-option").unbind("click").bind("click",e);a.find(".time-preferences-link").unbind("click").bind("click",
c)}}var g=a.$;if(!g("html").hasClass("a-ie6")){var f=h.P&&h.P.AUI_BUILD_DATE;a.on("checkout:reload",b)}});"use strict";k.when("A","page-detector").register("imb-controller",function(a,d){function c(){a.defer(function(){var a=e("#spc-imb").find(".imb-message-link");0<a.length&&a.find("i.js-hide").remove()})}var e=a.$;if(!e("html").hasClass("a-ie6"))a.on("checkout:reload:spc",c)});"use strict";k.when("A","fast-track-controller","page-detector").register("carrier-details-controller",function(a,d,c){function e(){a.defer(function(){g("#spc-reservation-countdown").length&&
b()})}function b(){var a=g("#spc-reservation-countdown");if(a.length){var b=a.data("secondsLeft"),c=function(b,e){b--;if(0>=b)e.find(".cn-wireless-notice-js").hide(),e.find(".cn-wireless-expired-message").show();else{var g=d.getFastTrackCountdown(b,a);e.find("span[data-field\x3d'countdown']").html(g);e.find(".cn-wireless-notice-js").show();e.find(".cn-wireless-expired-message").hide();setTimeout(function(){c(b,e)},1E3)}};c(b,a)}}var g=a.$;g("html").hasClass("a-ie6")||(a.on("a:popover:beforeShow:simcard",
function(a){a.popover.$popover.find(".popover-content").html(g("#carrier-sim-card-details").html());a.popover.updatePosition()}),a.on("checkout:reload:spc",e))});"use strict";k.when("A","checkout-buttom-sheet-controller","client-side-metrics").execute(function(a,d,c){a.on("a:sheet:beforeShow:assuranceWidget",function(a){c.increaseCount("Checkout:assuranceWidget:WidgetClicked");d.disablePageScrolling()});a.on("a:sheet:afterShow:assuranceWidget",function(a){c.increaseCount("Checkout:assuranceWidget:BottomSheetShown")});
a.on("a:sheet:afterHide:assuranceWidget",function(a){d.enablePageScrolling();c.increaseCount("Checkout:assuranceWidget:BottomSheetClosed")})});"use strict";k.when("A","page-transition-controller","checkout-general-utils","address-utilities","client-side-metrics","isMobileAddressRaceConditionMitigationWeblabOn").register("as-controller",function(a,d,c,e,b,g){function f(a){a=a.find("input[type\x3d'checkbox']");0<p(".checkout-as-mobile").length?m(a):0<p(".checkout-as-tablet").length&&z(a)}function m(a){var d=
h.P&&h.P.AUI_BUILD_DATE,c=a.closest(".address-book-entry").find(".ship-to-this-link-area"),e=c.find(".a-button"),f=c.find("a");0>=a.length||a.is(":checked")?(e.removeClass("a-button-disabled"),d?(a=c.find(".ship-to-this-link-value"),f.attr("href",a.text())):(b.increaseCount("removeauijs24"),f.attr("href",f.data("select-locker-url")))):(e.addClass("a-button-disabled"),f.removeAttr("href"))}function z(a){var b=p("#ship-to-this-link-area"),d=b.find(".a-button"),b=b.find("input[type\x3d'submit']");0>=
a.length||a.is(":checked")?(d.removeClass("a-button-disabled"),b.prop("disabled",!1)):(d.addClass("a-button-disabled"),b.attr("disabled",!0))}function n(a){a.find("div.enter-address-form form").find("input.a-form-error, select.a-form-error").filter(function(){return 0===p(this).parents().filter(".enhanced-input").length}).closest(".a-input-text-wrapper").addClass("a-form-error")}function A(a){a=a.find("div.enter-address-form form");a.find(".enhanced-input .enterAddressFormInputError").addClass("a-form-error");
a.find(".enhanced-input input.a-form-error, .enhanced-input select.a-form-error, .enhanced-input label.a-form-error").each(function(){p(this).parents(".a-input-text-wrapper").last().addClass("a-form-error")})}function y(a){var b=a.siblings("div.a-input-text-wrapper").andSelf();b.siblings().unwrap();a.removeClass("a-input-text-wrapper");for(var d=p(),b=b.first();b.length;b=b.parent().nextAll("div.a-input-text-wrapper:first"))if(b.hasClass("a-input-text-wrapper")){var c=b.nextUntil(":not(.a-input-text-wrapper)").andSelf();
c.wrapAll("\x3cdiv class\x3d'a-input-text-group'\x3e\x3c/div\x3e");1===c.length&&(d=d.add(b))}d.unwrap();a=a.closest("form");a.find(".a-input-text-group").siblings("div").andSelf().addClass("a-spacing-base");a.find(".a-touch-select").addClass("a-spacing-mini")}function w(a){a.find("#identity-add-new-address select.#enterAddressCountryCode").closest(".a-input-text-wrapper").each(function(){var a=p(this),b=p(this).closest("form").find("#address-country-container");a.appendTo(b).removeClass("a-input-text-wrapper").addClass("a-spacing-medium")});
a=a.find("#identity-add-new-address .a-input-text-wrapper:has(.a-touch-select), #identity-add-new-address .a-input-text-wrapper:has(.javascript-unwrap-row)").not(":has(.enhanced-input)");y(a)}function D(a){var b=a.find(".store-results-list"),d=b.siblings(":not(script)");p(h).unbind("resize.store-results").bind("resize.store-results",function(){q(b,d)});q(b,d)}function q(a,b){var d=p(h).height();b.each(function(){d-=p(this).outerHeight()});a.height(d)}function u(a){a.undelegate("div.address-book-entry",
"click.resultToMapBinding").delegate("div.address-book-entry","click.resultToMapBinding",function(){var a=p(this);a.hasClass("address-book-entry")||(a=a.closest("div.address-book-entry"));0!==a.length&&(a=a.index("div.address-book-entry"),h.Map&&h.Map.selectPin&&h.Map.selectPin(a))});a.find("label.a-touch-radio a.a-button").unbind("click.checkout-as").bind("click.checkout-as",function(a){d.show();a.stopPropagation()})}function l(a){h.Map&&h.Map.registerPinClickCallback&&h.Map.registerPinClickCallback(function(b){var d=
a.find("div.store-results-list");b=d.find("div.address-book-entry:eq("+b+")");b.find(".a-control-row").trigger("activate.checkout-pagination").trigger("click",["preventAddressSelectionChangedTrigger"]);b=b.position().top;var c=d.scrollTop();d.animate({scrollTop:c+b+"px"})})}function C(a){h.mapBubbleButtonClicked=function(b){b=p(b).data("storeid");b=a.find("div.store-results-list").find("div.address-book-entry:eq("+b+")").find(".a-button").attr("href");d.show();c.redirectWithJavascript(b)}}function G(a){a.find("form.controlEnterKeyFormSubmission").find("input[type\x3d'text']").unbind("keypress.controlEnterKeyFormSubmission").bind("keypress.controlEnterKeyFormSubmission",
function(a){if(a.which&&13===a.which||a.keyCode&&13===a.keyCode){if(a=p(this).closest("form").find("button[type\x3d'submit'], input[type\x3d'submit']"),a.length)return a.click(),!1}else return!0})}function M(a){a.find("form.controlEnterAddressForm").find("input[type\x3d'text']").unbind("keypress.controlEnterAddressForm").bind("keypress.controlEnterAddressForm",function(a){return(a.which&&13===a.which||a.keyCode&&13===a.keyCode)&&0<p(this).closest("div").next().length?(c.moveToNextInput(p(this).closest("div")),
!1):!0})}function v(a){k.when("checkout-pagination").execute(function(b){b.initializePagination(a.find("div.checkout-pagination-container"));a.find(".a-icon-touch-radio-active").closest(".checkout-pagination-item").trigger("activate.checkout-pagination")})}function J(){var a=p("div.checkout-as-tablet");a.length&&(a.hasClass("checkout-as-store-search-results")&&(R(a),D(a),u(a),l(a),C(a),a.find("div.store-opening-hours br").replaceWith(",\x26nbsp;")),v(a),w(a),a.find("div.address-options div.address-feature div.a-expander-content[aria-expanded\x3dfalse]").css({display:"none"}),
n(a),A(a),Q(a),G(a),e.countrySpecificLabelOptimizationCheck(a),k.when("tablet-address-select-controller").execute(function(){a.find("div.address-book-entry").find(".a-icon-touch-radio-active").closest("label.a-declarative").trigger("click")}))}function L(a){a.find("input[type\x3d'hidden']").each(function(){p(this).appendTo(p(this).closest("form"))})}function R(a){a.undelegate("click.as").delegate(".addr-display","click.as",function(b,d){b=p(this).closest(".a-box");0===b.length&&(b=p(this).closest(".address-book-entry"));
if(!b.hasClass("active-box")){var c=a.find(".active-box");c.removeClass("active-box").addClass("inactive-box");c.find("i").removeClass("a-icon-touch-radio-active");c.find("i:not('.locker-restriction-reminder')").addClass("a-icon-touch-radio-inactive");b.removeClass("inactive-box").addClass("active-box");"preventAddressSelectionChangedTrigger"!==d&&b.trigger("address-selection-changed");a.hasClass("checkout-as-store-search-results")&&f(b)}});var b=a.find(".address-book-entry:has(input[type\x3dradio]:checked)");
b.trigger("click");a.hasClass("checkout-as-store-search-results")&&f(b)}function Q(a){k.when("a-form-controls").execute(function(){a.find("select.a-touch-select-input").each(function(){var a=p(this);""!==a.val()&&"--"!==a.val()&&a.change()})})}function O(a){var b=p("input#deliver-to-input").val();if(0<b.length){var d=p(a.currentTarget).attr("href");p(a.currentTarget).attr("href",d+"\x26deliverTo\x3d"+encodeURIComponent(b))}}function T(){var a=p("div.checkout-as-mobile"),d=0<p("form#address-ui-checkout-form").length;
a.length&&!d&&(h.P&&h.P.AUI_BUILD_DATE?(L(a),w(a),e.countrySpecificLabelOptimizationCheck(a),A(a),N(a),a.hasClass("checkout-as-store-search-results")&&(a=p(".address-book-entry:has(input[type\x3dradio]:checked)"),0<a.length&&f(a))):(b.increaseCount("removeauijs25"),L(a),n(a),A(a),R(a),w(a),Q(a),e.countrySpecificLabelOptimizationCheck(a),M(a),N(a),G(a)),g&&p(".address-book-entry").find(":checked").trigger("change"))}function H(){var a=p("div.checkout-as-desktop");a.length&&e.countrySpecificPopoverOptimizationCheck(a)}
function B(a){b.increaseCount("checkout:access-point:"+a,1)}function N(b){F=b.find("div[id$\x3d'-country']");S=b.find("div[id$\x3d'-pickup-type']");F.length&&S.length&&P(F,S);a.declarative("country-filter-pickup-point","change",function(a){F.length&&S.length&&P(F,S)})}function P(a,b){I=a.find("select[name\x3dcountry]");U=b.find("select[name\x3dpickupType]");if(I.length&&U.length){var d=I.find("option:selected");a=U.find("option[value!\x3d'All']");d=U.find("option."+d.attr("data-pickuptypeclass"));
d.length?(a.hide(),d.show(),U.prop("disabled",!1),U.val("All").change(),b.show()):b.length&&U.length&&(U.prop("disabled","disabled"),b.hide())}}function E(){J();T();H();p("div.checkout-as input[placeholder]").each(function(){var a=p(this).attr("placeholder"),a=p("\x3cdiv /\x3e").html(a).text().replace(":","");p(this).attr("placeholder",a)});p("div.checkout-as #newShippingAddressFormFromIdentity span.field-description, #locker-find span.field-description").each(function(){var a=p(this),b=a.closest("div.one-new-address-form-field, label").find("input, select, textarea");
!(0<a.find("a[href]").length||0===b.length)&&"placeholder"in b[0]&&(b.attr("placeholder",a.text()),a.remove())});p("html.checkout-as-mobile div.displayAddressDiv ul.displayAddressUL, div.checkout-as-tablet div.displayAddressDiv ul.displayAddressUL").bind("touchend",function(a){});(function(){var a=p("div.checkout-as #searchLockerByLocationButton");a.unbind("enable").bind("enable",function(){p(this).removeClass("a-button-disabled").removeAttr("disabled")}).unbind("disable").bind("disable",function(){p(this).addClass("a-button-disabled").attr("disabled",
!0)});if(navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition){a.text();a.data("labelActive");a.data("labelSuccess");a.find(".a-button-text");var b=a.data("submit-url");a.click(function(c){c.preventDefault();var e=p("\x3cdiv id\x3d'turbo-checkout-bottom-sheet' class\x3d'aok-hidden'\x3e\x3c/div\x3e");a.append(e);var f=p("div.checkout-as #clientSideLockerFindErrorIMB").hide().removeClass("hidden").find(".hidden").removeClass("hidden").hide().end();navigator.geolocation.getCurrentPosition(function(c){e.remove();
var f=a.closest("form"),g=b?b:f.attr("action");f.attr("action",g);f.append(p("\x3cinput type\x3d'hidden' /\x3e").attr("name","latitude").attr("value",c.coords.latitude));f.append(p("\x3cinput type\x3d'hidden' /\x3e").attr("name","longitude").attr("value",c.coords.longitude));f.append(p("\x3cinput type\x3d'hidden' /\x3e").attr("name","isGeolocalisationButtonClicked").attr("value",1));d.showPageTransition();f.submit()},function(b){e.remove();a.closest("div.checkout-as-mobile, div.checkout-as-tablet").length?
alert(f.find("p.e"+b.code).text()):f.show().find("p.e"+b.code).show()},{maximumAge:12E4,timeout:1E4})})}else a.hide()})();(function(){p("div.checkout-as-mobile form#locker-find").submit(function(a){a=p(this).find("#locker-find-search-field");var b=p(this).find("#locker-find-inline-alert"),c=p("div.checkout-as-mobile #locker-find-error-imb");a.closest("form");var e=p(this).find("input[name\x3d'latitude']").attr("value"),f=p(this).find("input[name\x3d'longitude']").attr("value"),g=0<a.val().trim().length;
b.removeClass("aok-hidden").addClass("aok-hidden");a.parent().removeClass("a-form-error");if(e&&f)return!0;if(g)return d.showPageTransition(),!0;c&&c.remove();a.parent().removeClass("a-form-error").addClass("a-form-error");b.removeClass("aok-hidden");return!1})})();(function(){p.support.ajax&&p("div.checkout-as a.a-button-text[href], div.checkout-as a.a-button[href], div.checkout-as a.js-add-working-javascript[href]").each(function(){0<p(this).attr("href").indexOf("?")&&p(this).attr("href",p(this).attr("href")+
"\x26hasWorkingJavascript\x3d1")})})();(function(){p("div.checkout-as .enter-address-form").not(".hidden").find("div.a-alert-error").addClass("js-originally-shown-imb");p("div.checkout-as a.js-switch-form").click(function(a){a.preventDefault();a=p(this).closest(".enter-address-form");e.toggleAddressForm(a,a.siblings(".enter-address-form"))})})();(function(){k.when("A").execute(function(a){a.declarative("switch-store-results-display",["click"],function(a){if(a.data&&a.data.showDiv){var b=p(a.data.showDiv);
0!==b.length&&(a.$declarativeParent.addClass("a-button-selected").siblings(".a-button-selected").removeClass("a-button-selected"),b.show(),b.siblings("div").hide())}})})})();(function(){k.when("jQuery").execute(function(a){0!==a(".js-scroll-lock").length&&a(h).unbind("scroll.as").bind("scroll.as",function(){a(".js-scroll-lock").each(function(){var b=a(this),d=b.position().top,d=a(h).scrollTop()-d+10;0>=d||b.outerHeight()>a(h).height()?b.css({marginTop:"auto"}):b.css({marginTop:d})})})})})();(function(){p(".checkout-as div#deliver-to").length&&
p("div#deliver-to").length&&p(".ship-to-this-address").each(function(){p(this).find("a.a-button-text").unbind("click.deliver-to").bind("click.deliver-to",O)})})();p("li[data-a-tab-name\x3dpickupTab]").length&&B("pickupTab:visible");if(0<p(".imb-autoscroll").length){var b=p(".imb-autoscroll:first").closest(".on-imb-scroll-here");b.length&&p("html, body").animate({scrollTop:b.offset().top},1E3)}p("#legacy-non-converged-locker-find").delegate("input[type\x3dtext], select","click change",function(a){p(this).closest("tr").find("input[type\x3dradio]").attr("checked",
!0)});p("html").hasClass("a-lt-ie8")&&p("div.checkout-as-desktop input[type\x3d'text']").addClass("a-input-text");a.defer(function(){p(".screenreader-address-span").each(function(){var a=p(this);a.text(" "+a.closest(".address-book-entry").find("li.displayAddressAddressLine1").text())})})}function t(d,c,e){a.$("#"+d).addClass("aok-hidden");a.$("#"+c).removeClass("aok-hidden");b.increaseCount("APCX:Checkout:AddressBook:unavailableLocationsIngress:"+e)}var p=a.$,F,I,S,U;a.declarative("select-address",
["click"],function(a){a=p(".address-content input[type\x3dradio]:checked");a.length&&(a=a.data("addressSelect"))&&(d.showPageTransition(),c.redirectWithJavascript(a))});a.declarative("tap-to-field",["click"],function(a){p(h).scrollTop(a.$declarativeParent.offset().top)});k.register("tablet-address-select-controller",function(){a.declarative("tablet-store-select-button",["click"],function(a){if(a=a.$currentTarget.closest("div.store-results-list").find("input[name\x3d'selectedStore']:checked").closest("label").data("selectThisStoreUrl"))d.show(),
c.redirectWithJavascript(a)});a.declarative("tablet-checkout-cancel-address",["click"],function(a){a.$currentTarget.closest(".a-expander-container").find("a.a-expander-header").click();p(document).scrollTop(0)});a.declarative("tablet-address-select",["click"],function(a){function b(a){a.addClass("a-button-disabled");a.find("input").attr("disabled",!0)}function d(a){a.removeClass("a-button-disabled");a.find("input").removeAttr("disabled")}var c=p("div.checkout-as-tablet"),e=c.find(".address-select-button"),
c=c.find(".address-edit-button");a.data&&a.data.disableSelect?b(e):d(e);a.data&&a.data.disableEdit?b(c):d(c)})});a.declarative("edit-address",["click"],function(a){a=p(".address-content input[type\x3dradio]:checked");a.length&&(a=a.data("addressEdit"))&&(d.showPageTransition(),c.redirectWithJavascript(a))});a.declarative("suggestion-edit-address",["click"],function(a){a=p("div.checkout-as-tablet #address-suggestion-form");if(a.length){var b=a.find("input[type\x3dradio]:checked");if(b.length){var b=
b.val(),c=a.find("input#operationField");c.length&&(c.val(b),c.attr("name","edit_"+b),d.show(),a.submit())}}});a.declarative("refine-locker-search-results",["click"],function(a){var b=a.$currentTarget.closest("form");b.find("#latitude").val(a.data.latitude);b.find("#longitude").val(a.data.longitude)});a.declarative("mobile-refine-locker-search-results",["click"],function(a){var b=a.$currentTarget,c=b.closest("form");c.find("#latitude").val(a.data.latitude);c.find("#longitude").val(a.data.longitude);
b.find("input[type\x3dradio]").prop("checked",!0);d.show();c.submit()});a.declarative("mobile-store-results-back-button",["click"],function(a){d.show();h.history&&h.history.length&&0<h.history.length?(h.history.go(-1),a.$event.preventDefault()):c.redirectWithJavascript(a.data.url)});a.declarative("suggestion-select-address",["click"],function(a){a=p("div.checkout-as-tablet #address-suggestion-form");if(a.length){var b=a.find("input[type\x3dradio]:checked");if(b.length){var b=b.val().replace(/^addr_/,
""),c=a.find("input#operationField");c.length&&(c.val(b),c.attr("name","useSelectedAddress"),d.show(),a.submit())}}});a.declarative("tablet-checkout-delete-address",["click"],function(a){h.confirm(p("#addressConfirmDeletion").text())&&(a=a.$currentTarget,d.showPageTransition(),c.redirectWithJavascript(a.attr("href")))});a.declarative("mobile-confirm-locker-restriction",["click"],function(a){m(a.$currentTarget.find("input[type\x3d'checkbox']"))});a.declarative("tablet-confirm-locker-restriction",["click"],
function(a){z(a.$currentTarget.find("input[type\x3d'checkbox']"))});a.declarative("mobile-select-address",["change"],function(a){a=a.$currentTarget.closest("div.address-book-entry");if(!a.hasClass("active-box")){if(p("li[data-a-tab-name\x3ddeliverTab]").length&&p("li[data-a-tab-name\x3dpickupTab]").length){var b=a.closest(".address-book");b&&b.find("div.address-book-entry.active-box").removeClass("active-box").addClass("inactive-box")}else p("div.address-book-entry.active-box").removeClass("active-box").addClass("inactive-box");
a.removeClass("inactive-box").addClass("active-box");0<p("div.checkout-as-mobile").length&&f(a)}});a.declarative("pickup-tab-selected",["click"],function(a){B("pickupTab:clicked")});a.on("checkout:reload:shipaddressselect",E);a.on("checkout:reload:billingaddressselect",E);a.on("checkout:reload:editaddress",E);a.on("checkout:reload:newaddress",E);a.on("a:expander:greyOutExpander:toggle:collapse",function(){t("ineligibleStoresExpandedHeading","ineligibleStoresCollapsedHeading","collapsed")});a.on("a:expander:greyOutExpander:toggle:expand",
function(){t("ineligibleStoresCollapsedHeading","ineligibleStoresExpandedHeading","expanded")})});k.when("A").register("as-faf-controller",function(a){function d(){c("#faf-error-message").hide();c("#faf-content").hide();c("#faf-loading-image").show();c.ajax({type:"GET",url:"/gp/gifting/add-friends-and-family.html?filter\x3d1",dataType:"html",cache:!1,timeout:1E4,success:function(a){c("#faf-loading-image").hide();c("#faf-content").show();c("#faf-content").html(a)},error:function(a){c("#faf-loading-image").hide();
c("#faf-error-message").show()}})}var c=a.$;a.on("a:popover:show:add-friends-and-family",function(a){d()});a.on("checkout:reload:shipaddressselect",function(){c("div.checkout-as-desktop").delegate("#faf_retry","click",function(){d()})})});k.when("A","page-transition-controller","page-conductor","checkout-general-utils").execute(function(a,d,c,e){var b=a.$;a.declarative("checkout-delete-address",["click"],function(a){a.$event.preventDefault();var f=0,m;a.data&&a.data.targetAddress!==E&&(f=1,m=a.data.targetAddress);
var z=a.$declarativeParent.find("a[href]:first").attr("href");!z&&f&&(z=a.$declarativeParent.attr("href"));if(b("div.checkout-as-mobile").length&&!h.confirm(b("#addressConfirmDeletion").text()))return!1;d.show();b.ajax({dataType:"json",url:z,success:function(n,h,k){var w;w=f?b("#"+m):a.$declarativeParent.closest(".address-book-entry");var D=w.parent();if(D.closest("div.checkout-as-mobile").length){if(w.removeClass("address-book-entry").addClass("deleted-address-book-entry"),n=w.find(".displayAddressDiv").text(),
w.find(".a-box-inner").empty(),n=b("\x3cdiv class\x3d'a-box a-alert-inline a-alert-inline-success'\x3e\x3c/div\x3e").append("\x3cdiv class\x3d'a-box-inner'\x3e\x3ci class\x3d'a-icon a-icon-alert' /\x3e\x3cp class\x3d'deleted-address-alert-content'\x3e"+n+"\x3cbr/\x3e"+b("#addressWasDeletedSuccess").text()+"\x3c/p\x3e\x3c/div\x3e"),w.find(".a-box-inner").append(n),n=w.prev(".address-book-entry.a-box"),0===n.length&&(n=w.next(".address-book-entry.a-box")),0===n.length&&!(0<b(".checkout.checkout-as .address-book-entry").length)){d.hidePageTransition();
e.redirectWithJavascript(z);return}}else if(b("div.checkout-as-desktop").length){w.detach();var q=D.find("div.address-book-entry");q.length||c.ajaxUpdatePage(n,h,k);q.removeClass("address-book-new-row").filter(":nth-child(3n+1)").addClass("address-book-new-row");b("div.checkout-as-desktop").trigger("checkout-as-recalculate-address-height")}w.is(".a-box.active-box")&&D.find(".address-book-entry.a-box.inactive-box:first").addClass("active-box").removeClass("inactive-box").find("input[type\x3d'radio']").attr("checked",
!0).change().siblings("i.a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");f&&b(".a-button-close").trigger("click");d.hide()},error:function(){d.hidePageTransition();e.redirectWithJavascript(z)}})})});k.when("A","a-expander","ready").register("as-tablet-controller",function(a){var d=a.$;a.on("checkout:reload:shipaddressselect",function(){if(d("div.checkout-as-tablet").length&&h.location.hash){var a=d(h.location.hash+".a-expander-header");
"none"===a.siblings("div.a-expander-content").css("display")&&setTimeout(function(){a.trigger("click")},500)}})});k.when("A","safe-mash","page-detector").register("as-locker-mobile-controller",function(a,d,c){var e=a.$;a.on("checkout:reload:shipaddressselect",function(){c.isMobileAddressSelect()&&a.defer(function(){if(!d||!d.showDeliveryDestinationPicker){var a=e("div.checkout-as-mobile").find("a.checkout-add-locker"),c=a.attr("href");c&&"#"!==c||a.hide()}})})});k.when("A","page-transition-controller",
"safe-mash","page-detector","checkout-general-utils","mash").register("as-mash-controller",function(a,d,c,e,b){var g=a.$;c.showDeliveryDestinationPicker&&g("div.checkout-as-mobile").find("a.checkout-add-locker").show();a.declarative("invoke-mash-store-picker",["click"],function(a){if(c.showDeliveryDestinationPicker){var m;h.app&&h.app.willReappear&&(m=h.app.willReappear,delete h.app.willReappear);e.isTabletAddressSelect()&&a.$currentTarget.closest("div.a-expander-container").find("div.a-expander-content").remove();
c.showDeliveryDestinationPicker({successCallback:function(a){var c="/gp/buy/storeaddress/handlers/select.html",c=b.addQueryStringParameter(c,"addressID",a.addressId),c=b.addQueryStringParameter(c,"requestToken",g("div.checkout-as").data("requestToken")),c=b.addQueryStringParameter(c,"purchaseId",g("div.checkout-as").data("purchaseId"));d.show();h.setTimeout(function(){h.app&&m&&(h.app.willReappear=m);b.redirectWithJavascript(c)},650)},failCallback:function(a){h.app&&m&&(h.app.willReappear=m)}})}else 1<
(a.$currentTarget.attr("href")||"").length&&b.redirectWithJavascript(a.$currentTarget.attr("href"))})});k.when("A","a-checkbox").execute(function(a,d){a.declarative("filter-available-locations",["click"],function(d){var e=a.$;d=d.$target.is(":checked");clientMetrics.increaseCount("APCX:CheckoutMPP:filterAvailableLocations");d?e(".ineligible-store").hide():e(".ineligible-store").show()})});k.when("A","a-checkbox","ready").execute(function(a,d){var c=a.$,e=d("[id\x3d'filterLocationsMpp']");c('[id\x3d"filterLocationsMpp"]').change(function(){e.isChecked()?
c(".ineligible-store").hide():c(".ineligible-store").show();var a=e.isChecked()?!1:!0;"undefined"!==typeof h.Map&&c(".ineligible-store").each(function(){var d=c(this).attr("data-store-display-number");d&&(d=parseInt(d,10)-1,h.Map.togglePinVisibility(d,a))})})});k.when("A").execute("searchLevelAlert",function(a){var d=a.$;d(h);var c=d("#searchLevelMessage"),e=function(){0>c.height()-d(h).scrollTop()?c.removeClass("search-level-message-back-to-top").addClass("search-level-message"):c.removeClass("search-level-message").addClass("search-level-message-back-to-top")};
d("#searchLevelMessage").length&&a.on.scroll(e)});k.when("A","page-transition-controller","checkout-general-utils","page-detector").execute(function(a,d,c,e){function b(){if(e.isMobileAddressSelect()){var a=h.location.href,b=g(".active-box");if("undefined"!==typeof b)var z=b.data("store-id"),n=b.data("address-id"),k=b.data("search-latitude"),b=b.data("search-longitude"),a=c.addQueryStringParameter(decodeURIComponent(a),"selectedStoreId",z),a=c.addQueryStringParameter(decodeURIComponent(a),"optedStoreAddressId",
n),a=c.addQueryStringParameter(decodeURIComponent(a),"latitude",k),a=c.addQueryStringParameter(decodeURIComponent(a),"longitude",b);a&&(d.showPageTransition(),c.redirectWithJavascript(decodeURIComponent(a)))}}var g=a.$;a.on("toggle-preference-success",function(){b()});a.on("toggle-preference-failure",function(){b()});a.on("do-nothing-success",function(){b()})});k.when("A","checkout-general-utils","page-detector").execute(function(a,d,c){a.on("checkout:reload:shipaddressselect",function(){if(c.isMobile()){var d=
a.$,d=d(".active-box");"undefined"!==typeof d&&1==d.data("redirect-from-accessibility")&&(d=d.offset().top,h.scrollTo(0,d))}})});k.when("A","ready").register("delivery-preference-widget-focus",function(a){var d=a.$;a.on("checkout:reload:editaddress",function(a){d("#deliveryPreferenceScrollEnabled").length&&d("#deliveryPreferenceScrollEnabled").offset()&&d("html, body").animate({scrollTop:d("#deliveryPreferenceScrollEnabled").offset().top},"fast")})});"use strict";k.when("A","ready").register("address-autopopulate-fields-clear",
function(){});"use strict";k.when("A","ready").execute("address-scroll",function(a){});"use strict";k.when("A","page-transition-controller").register("accesspoint-search-controller",function(a,d){var c=a.$;a.declarative("search-accesspoint-for-location",["click"],function(a){navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition&&navigator.geolocation.getCurrentPosition(function(b){var d=a.data.url,f=c("#accesspoint-search-form");f.attr("action",d);f.append(c("\x3cinput type\x3d'hidden'/\x3e").attr("name",
"latitude").attr("value",b.coords.latitude));f.append(c("\x3cinput type\x3d'hidden'/\x3e").attr("name","longitude").attr("value",b.coords.longitude));f.submit()},function(a){a=c("#geolocation-error-strings").find(".e"+a.code).text();alert(a)})});a.on("checkout:reload:accesspoint",function(){c("#legacy-non-converged-locker-find").delegate(".storesearchinput input,.storesearchinput select","click",function(a){c(this).closest(".storesearchinput").siblings().find("input[type\x3dradio]").click()})})});
"use strict";k.when("A","checkout-general-utils","ready").register("delivery-preference-controller",function(a,d){function c(){return f("form.checkout-page-form").serialize()}function e(a){f(a).addClass("aok-hidden")}function b(){var a=c();a!==k&&5>=n&&(a&&(a+="\x26"),f.ajax({type:"POST",url:"/gp/buy/deliverypreference/handlers/save.html",data:a+"returnjson\x3d1\x26isTrial\x3d1",dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"deliverypreference"},complete:function(){}}),n++)}function g(){n=
0;k=c();f("form.checkout-page-form").find("input[type\x3d'checkbox'],input[type\x3d'radio'],input[type\x3d'text'],select").unbind("change").change(b);h&&f("form.checkout-page-form").data("checkoutFormReady",!0).change()}var f=a.$,m=f("input#isPipelinedPage"),h=0<m.length&&"1"===m.val(),n,k;a.declarative("select-delivery-preference-radio-button",["click","touchend"],function(a){d.protectAgainstDoubleAction("select-delivery-preference-radio-button")||a.$currentTarget.closest(".delivery-preference-option").find("input[type\x3d'radio']").trigger("click")});
a.declarative("wini-radio-clicked","click",function(a){a=a.$target.context.value;"NeighborDelivery"===a?(e(".wini-safePlaceInput"),f(".wini-neighborInput").removeClass("aok-hidden")):"SafePlaceDelivery"===a?(e(".wini-neighborInput"),f(".wini-safePlaceInput").removeClass("aok-hidden")):"NoSpecialDelivery"===a&&(e(".wini-neighborInput"),e(".wini-safePlaceInput"))});if(h)a.on("checkout:reload:deliverypreference",g)});"use strict";k.register("isMobileAddressRaceConditionMitigationWeblabOn",function(){return!1});
"use strict";k.when("A","weekend-availability-expander-helper").register("weekend-availability-expander-desktop",function(a,d){function c(a,b){return{isSaturdayChecked:e("#"+a).prop("checked"),isSundayChecked:e("#"+b).prop("checked")}}var e=a.$,b=!0,g=!0,f={"sat-sun-expander-header":{saturdayId:"sat-sun-availability-checkbox-sat",sundayId:"sat-sun-availability-checkbox-sun"},"sat-sun-expander-header-domestic":{saturdayId:"sat-sun-availability-checkbox-sat-domestic",sundayId:"sat-sun-availability-checkbox-sun-domestic"}};
return{init:function(){d.isBusinessDefaultWeekendDeliveryViewActive()&&(g=b=!1);a.declarative("sat-sun-availability-checkbox-change","change",function(a){a=c(a.data.satCheckboxId,a.data.sunCheckboxId);d.updateAllWeekendAvailabilityStates(a);var b=e("input[name\x3d'BusinessHours']").attr("value"),b=d.stateToCheckboxes(b);e(".weekend-checkbox-sat").prop("checked",b.isSaturdayChecked);e(".weekend-checkbox-sun").prop("checked",b.isSundayChecked);d.updateAllTitles(a);d.updateAllOptOutMessages(a)});var m=
"expander"===e("input[name\x3d'weekendDeliveryDisplayType']").attr("value"),h=e("input[name\x3dshipToThisAddress]");h.length&&m&&h.closest("form").submit(function(a){d.logExpanderState("mpp","create",g,b)});h=e("input[name\x3dfromAddressEditToContinue]");h.length&&m&&h.closest("form").submit(function(a){d.logExpanderState("mpp","edit",g,b)});a.declarative("a-expander-toggle","click",function(a){a=a.$currentTarget;var e=a.attr("id");a.hasClass("sat-sun-expander-class")&&f[e]!==E&&(a=c(f[e].saturdayId,
f[e].sundayId),d.updateAllWeekendAvailabilityStates(a),d.updateAllTitles(a),b=!b,g=!1)})}}});"use strict";k.when("A","delivery-preferences-csm-helper","checkout-general-utils","page-detector-current-page").register("mpp-delivery-preferences-controller",function(a,d,c,e){a.declarative("delivery-preferences-submit-button",["click","touchend"],function(a){"deliverypreference"===e.getCurrentPage()&&(c.protectAgainstDoubleAction("delivery-preferences-submit-button",400)||d.recordCSMWithCurrentFieldValues("page-submitted",
"prefDelLocation","isDefaultPreference"))});a.on("checkout:reload:spc",function(){d.recordCSMForEligiblePages()});a.on("checkout:reload:deliverypreference",function(){d.recordCSMWithCurrentFieldValues("page-displayed","prefDelLocation","isDefaultPreference")})});"use strict";k.when("A","delivery-preferences-csm-helper","page-detector","page-detector-current-page","client-side-metrics").register("what-if-im-not-in-delivery-preferences",function(a,d,c,e,b){function g(){if(l)a.capabilities.history?h.history.back():
k.when(u?"a-secondary-view":"a-popover-base").execute(function(a){a.get("what-if-im-not-in-form-popover").hide()});else{var b=q("#what-if-im-not-in-form-container").closest(".a-popover-wrapper");b.length&&b.find(".a-button-close").click()}}function f(){q('select[name\x3d"enterAddressCountryCode"]').val()!==q("input[name\x3dcountryOrg]").val()?(q(".what-if-im-not-in-delivery-preferences-summary").hide(),y()):(q(".what-if-im-not-in-delivery-preferences-summary").show(),A())}function m(a,d){u?k.when("a-dropdown").execute(function(b){b.setValue(a.attr("id"),
d)}):(b.increaseCount("removeauijs26"),a.find("option").removeAttr("selected"),a.find('option[value\x3d"'+d+'"]').attr("selected","selected"),a.siblings(".a-placeholder").text(a.find("option:selected").text()))}function z(a,d){u?k.when("a-checkbox").execute(function(b){b=b("#"+a.attr("id"));d?b.check():b.uncheck()}):(b.increaseCount("removeauijs27"),d?a.attr("checked","checked"):a.removeAttr("checked"),a.siblings("i").removeClass("a-icon-touch-checkbox-"+(d?"inactive":"active")).addClass("a-icon-touch-checkbox-"+
(d?"active":"inactive")))}function n(){var a=l&&"newaddress"===e.getCurrentPage(),b=!l&&!c.isTablet()&&"shipaddressselect"===e.getCurrentPage();(a||b)&&d.recordCSMForEligiblePages("address-form:")}function A(){var a=q("#what-if-im-not-in-form-container"),b=q(".what-if-im-not-in-delivery-preferences-summary").closest("form"),d=a.find("input[name\x3dprefDelLocation]:checked").val();b.find('input[name\x3d"prefDelLocation"]').val(d);"NeighborDelivery"===d?(b.find('input[name\x3d"neighborName"]').val(a.find("input[name\x3dneighborName]").val()),
b.find('input[name\x3d"houseNo"]').val(a.find("input[name\x3dhouseNo]").val())):"SafePlaceDelivery"===d&&b.find('input[name\x3d"safePlaceLocation"]').val(a.find("select[name\x3dsafePlaceLocation]").val());b.find('input[name\x3d"isDefaultPreference"]').val(a.find("input[name\x3disDefaultPreference]").is(":checked")?"1":"0")}function y(){var a=q(".what-if-im-not-in-delivery-preferences-summary").closest("form");a.find('input[name\x3d"prefDelLocation"]').removeAttr("value");a.find('input[name\x3d"neighborName"]').removeAttr("value");
a.find('input[name\x3d"houseNo"]').removeAttr("value");a.find('input[name\x3d"safePlaceLocation"]').removeAttr("value");a.find('input[name\x3d"isDefaultPreference"]').removeAttr("value")}function w(){n();q(".what-if-im-not-in-delivery-preferences-summary").length&&(f(),q('select[name\x3d"enterAddressCountryCode"]').change(function(){f()}))}function D(a){a.$event.preventDefault();d.recordCSMWithCurrentFieldValues("embedded-in-address-form-submitted","prefDelLocation","isDefaultPreference");var c=q("#what-if-im-not-in-form-container"),
e=c.find("input[name\x3dprefDelLocation]:checked").val();a=q("#what-if-im-not-in-form-container");a.find("input").removeClass("a-form-error");a.find("div.a-input-text-wrapper").removeClass("a-form-error");u?a.find("select").siblings(".a-button").removeClass("a-button-error"):(b.increaseCount("removeauijs28"),a.find("select").closest(".a-button").removeClass("a-button-error"));a=!1;"NeighborDelivery"===e?(e=c.find("input[name\x3dneighborName]"),e.val()||(e.addClass("a-form-error"),e.closest(".a-input-text-wrapper").addClass("a-form-error"),
a=!0),c=c.find("input[name\x3dhouseNo]"),c.val()||(c.addClass("a-form-error"),c.closest(".a-input-text-wrapper").addClass("a-form-error"),a=!0)):"SafePlaceDelivery"===e&&(c=c.find("select[name\x3dsafePlaceLocation]"),c.val()||(u?c.siblings(".a-button").addClass("a-button-error"):(b.increaseCount("removeauijs29"),c.closest(".a-button").addClass("a-button-error")),a=!0));if(!a){y();A();c=q("#what-if-im-not-in-form-container");a=q(".what-if-im-not-in-delivery-preferences-summary").closest("form");var e=
c.find("input[name\x3dprefDelLocation]:checked").val(),f,l;"NeighborDelivery"===e?(f=a.find("input[name\x3dneighborDeliveryLabel]").val(),l=c.find("input[name\x3dneighborName]").val(),c=c.find("input[name\x3dhouseNo]").val(),l=l+", "+c):"SafePlaceDelivery"===e?(f=a.find("input[name\x3dsafePlaceDeliveryLabel]").val(),l=c.find("select[name\x3dsafePlaceLocation] option:selected").text()):"NoSpecialDelivery"===e&&(f=a.find("input[name\x3dnoSpecialDeliveryLabel]").val());f+=l?": "+l:"";q("#delivery-preference-label").text(f);
f=q("#delivery-preference-link");f.length&&f.text(a.find("input[name\x3dchangeYourPreferenceLabel]").val());g()}}var q=a.$,u=h.P&&h.P.AUI_BUILD_DATE,l=c.isMobile();a.declarative("embedded-what-if-im-not-in-form","submit",D);a.declarative("what-if-im-not-in-mpp-popover","click",D);a.on("a:popover:show:what-if-im-not-in-form-popover",function(){var a=q("#what-if-im-not-in-form-container"),b=q(".what-if-im-not-in-delivery-preferences-summary").closest("form"),c=b.find('input[name\x3d"prefDelLocation"]').val()||
"";a.find("input[name\x3dprefDelLocation][value\x3d"+c+"]").click();a.find('input[name\x3d"neighborName"]').val(b.find("input[name\x3dneighborName]").val());a.find('input[name\x3d"houseNo"]').val(b.find("input[name\x3dhouseNo]").val());var c=a.find('select[name\x3d"safePlaceLocation"]'),e=b.find("input[name\x3dsafePlaceLocation]").val();m(c,e);a=a.find('input[name\x3d"isDefaultPreference"]');z(a,"0"!==b.find("input[name\x3disDefaultPreference]").val());d.recordCSMWithCurrentFieldValues("embedded-in-address-form-displayed",
"prefDelLocation","isDefaultPreference")});a.on("checkout:reload:shipaddressselect",w);a.on("checkout:reload:newaddress",w)});"use strict";k.when("A","weekend-availability-expander-helper","a-secondary-view","client-side-metrics","a-checkbox").register("weekend-availability-secondary-view-mobile",function(a,d,c,e,b){function g(){k=!0;var a=n("input[name\x3d'BusinessHours']").attr("value"),a=d.stateToCheckboxes(a);b("#weekend-availability-sat-checkbox").check(a.isSaturdayChecked);b("#weekend-availability-sun-checkbox").check(a.isSundayChecked);
b("#weekend-availability-sat-checkbox-domestic").check(a.isSaturdayChecked);b("#weekend-availability-sun-checkbox-domestic").check(a.isSundayChecked);n(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!0)}function f(a,d){return{isSaturdayChecked:b("#"+a).isChecked(),isSundayChecked:b("#"+d).isChecked()}}function m(){return k&&y?"save":k?"back":"noView"}function h(a,b,d){var c=n("#hasUserDefinedValue").length?"userDefined":"notUserDefined";e.increaseCount("checkout:delivery-preferences:"+
a+":secondaryView:"+b+":"+d+":"+c)}var n=a.$,k=!1,y=!1;return{init:function(){a.declarative("sat-sun-availability-checkbox-change","change",function(a){d.updateAllOptOutMessages(f(a.data.saturdayCheckboxId,a.data.sundayCheckboxId))});var b="secondaryView"===n("input[name\x3d'weekendDeliveryDisplayType']").attr("value"),e=n("input[name\x3dshipToThisAddress]");e.length&&b&&e.closest("form").submit(function(a){h("mpp","create",m())});e=n("input[name\x3dfromAddressEditToContinue]");e.length&&b&&e.closest("form").submit(function(a){h("mpp",
"edit",m())});a.declarative("weekend-availability-secondary-view-save","click",function(a){var b=a.data;a=c.get(b.popoverName);null!==a&&a!==E&&(b=f(b.saturdayCheckboxId,b.sundayCheckboxId),d.updateAllWeekendAvailabilityStates(b),d.updateAllTitles(b),a.hide(),y=!0)});a.on("a:popover:beforeShow:weekend-availability-secondary-view",g);a.on("a:popover:beforeShow:weekend-availability-secondary-view-domestic",g)}}});"use strict";k.when("A","page-detector").register("weekend-availability-loader",function(a,
d){function c(){d.isMobile()?k.when("weekend-availability-secondary-view-mobile").execute(function(a){a.init()}):k.when("weekend-availability-expander-desktop").execute(function(a){a.init()})}a.on("checkout:reload:shipaddressselect",c);a.on("checkout:reload:editaddress",c);a.on("checkout:reload:newaddress",c)});"use strict";k.when("A","jQuery","gift-form-base-controller").register("gift-form-controller",function(a,d,c){var e=4;a.on("checkout:gift:adaptCarousel",function(a){a=d("#giftwrap-carousel-wrap-holder-"+
a);parseInt(a.css("left"),10);a.css("left",0)});a.on("checkout:gift:changeCarouselWrapOptions",function(a,c,e){"all"===c?d("#giftwrap-carousel-wrap-holder-"+e+" li").show():"GW"===c?(d("#giftwrap-carousel-wrap-holder-"+e+" li",d(a)).hide(),d(".gift-wrap",d(a)).show()):"noshi"===c&&(d("#giftwrap-carousel-wrap-holder-"+e+" li",d(a)).hide(),d(".noshi-wrap",d(a)).show())});c.extendFunctions({updateCarouselOnLeftClick:function(a,c,e){e.$event.preventDefault();a=c.itemId;c=parseInt(d("#giftwrap-carousel-wrap-holder-"+
a).css("left"),10);0>c&&(c=c+90+"px",d("#giftwrap-carousel-wrap-holder-"+a).css("left",c))},updateCarouselOnRightClick:function(a,c,f){var m;f.$event.preventDefault();a=c.itemId;m=d("#giftwrap-carousel-wrap-pane-"+a);c=parseInt(d("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);f=m.find("ul li").size();var h=m.find("ul li.gift-wrap").size();m=m.find("ul li.noshi-wrap").size();var n=d("#afn-gift-options-wrapper-"+a).data("active-tab"),k;"all"===n?k=f:"GW"===n?k=h:"noshi"===n&&(k=m);c>-90*(k-e)&&
(c=c-90+"px",d("#giftwrap-carousel-wrap-holder-"+a).css("left",c))}});k.register("gift/set-carousel-size",function(){return function(a){e=a}})});k.when("A","jQuery","client-side-metrics","ready").execute(function(a,d,c){function e(a,b,c){a=0;var e="",f=!1;d("#includeReceiptCheckbox-"+c)&&d("#includeReceiptCheckbox-"+c).is(":checked")&&(f=!0);d('input[name\x3d"wrap.'+c+'"]:checked')&&(a=d('input[name\x3d"wrap.'+c+'"]:checked').val());d("#includeMessageCheckbox-"+c)&&d("#includeMessageCheckbox-"+c).is(":checked")&&
(e=d("#message-area-"+c).val(),10<e.length&&(e=e.substring(0,10)+"..."));(!a||1>a.length)&&d("#wrapRadio-"+c+"-noWrap").attr("checked","checked").trigger("change");a&&!(1>a.length)||e&&!(1>e.length)||f?(b.find(".no-gift-options-button-text").hide(),b.find(".selected-gift-options-button-text").show(),b.find(".gift-wrap-button-text").hide(),a&&0<a.length&&b.find(".gift-wrap-button-text-"+a.replace(/#/g,"\\#")).show(),e&&0<e.length?(b.find(".gift-message-button-text").show(),b.find(".gift-message-preview").html(e)):
b.find(".gift-message-button-text").hide(),f?b.find(".gift-receipt-button-text").show():b.find(".gift-receipt-button-text").hide()):(b.find(".selected-gift-options-button-text").hide(),b.find(".no-gift-options-button-text").show())}function b(a){a.find(".selected-gift-options-button-text").hide();a.find(".no-gift-options-button-text").show()}function g(a){a.is(":checked")||(w?a.closest("label").click():(c.increaseCount("removeauijs32"),a.attr("checked",!0).trigger("change")))}function f(a){var b=
a.find("div.expando-content"),c=1===a.data("select-gift-receipt");a=1===a.data("select-gift-message");(c||a)&&z(b,c,a)}function m(a){return a.is("input")?a:a.find("input")}function z(a,b,c){var d;d=0<a.find(".includeReceiptCheckbox").length?m(a.find(".includeReceiptCheckbox")):m(a.find(".mfnHidePriceCheckbox"));a=m(a.find(".includeMessageCheckbox"));(b||c)&&g(d);c&&g(a)}function n(){k.when("A","a-carousel-framework").execute(function(a,b){b.initializeAll()})}function A(){w?k.when("A").execute(function(a){a.off("a:expander:gift-options-expander:toggle:collapse");
a.on("a:expander:gift-options-expander:toggle:collapse",function(a){a=a.expander.$expander;var b=a.closest("div.expando-box"),c=b.find("div.expando-content"),b=b.data("itemNumber");e(c,a,b)});a.on("a:sheet:afterShow",function(a){n()});a.on("a:sheet:beforeHide",function(a){a=a.sheet.$container.find(":radio:checked");var b=a.attr("name"),c=a.parents(".wrap"),e=c.find(".wrap-text").text(),c=c.find("img").attr("src"),b=d('.gift-sheet-radio :radio[name\x3d"'+b+'"]'),f=b.parents(".gift-options-wrapper");
b.val(a.val()).prop("checked",!0);f.find(".wrap-text").text(e);f.find(".wrap-img").attr("src",c)});a.off("a:expander:gift-options-expander:toggle:expand");a.on("a:expander:gift-options-expander:toggle:expand",function(a){b(a.expander.$expander);n();var c=a.expander.$expander.closest("div.expando-box");a=c.find("div.expando-content");var d=1===c.data("select-gift-receipt"),c=1===c.data("select-gift-message");(d||c)&&z(a,d,c)})}):(c.increaseCount("removeauijs33"),d("a.expando-link").unbind("click").bind("click",
function(a){var c=d(this),f=c.closest("div.expando-box"),g=f.attr("data-item-number"),w=f.find("div.expando-content");w.is(":visible")?w.slideUp("fast",function(){e(w,c,g);c.find("i").removeClass("a-icon-section-expand").addClass("a-icon-section-collapse")}):(b(c),w.slideDown("fast",function(){c.find("i").removeClass("a-icon-section-collapse").addClass("a-icon-section-expand");var a=1===f.data("select-gift-receipt"),b=1===f.data("select-gift-message");(a||b)&&z(w,a,b)}))}));var g=d("a.expando-link");
if(0<g.length){if(g=g.eq(0),g.click(),w){var m=d("div.expando-box").eq(0);b(g);a.delay(function(){f(m)},100)}}else a.delay(function(){d("div.expando-box").each(function(){f(d(this))})},100)}var y=d("input#isPipelinedPage"),y=0<y.length&&"1"===y.val(),w=h.P&&h.P.AUI_BUILD_DATE;if(y)a.on("checkout:reload:giftselect",A);else A()});"use strict";k.when("A","pay-common-util").register("page-slide",function(a,d){function c(a,c,f){if(!c)return a;0<a.length&&a.remove();a=e(c).hide();c=d.getCurrentPage();0===
c.length?d.elements.pageContainer.append(a):f?a.insertBefore(c):a.insertAfter(c);return a}var e=a.$;return{slideHide:function(a,e){var f=d.getCurrentPage();a=c(a,e,!1);f.hide();a.show()},slideShow:function(a,e){var f=d.getCurrentPage();a=c(a,e,!0);f.hide();a.show()}}});k.when("A","ajax-utility","pay-common-util","page-conductor","page-slide","page-transition-controller","pay-validator","pay-credit-card","a-dropdown","client-side-metrics","pay-gil","mobile-carrier-billing-util","emi-helper","instant-bank-discount-helper",
"new-verified-debit-card","recommendation-helper","safe-apx-helper","weblab-helper","apb-limit-messaging-helper").register("page-main",function(a,d,c,e,b,g,f,m,z,n,A,y,w,D,q,u,l,C,G){function M(a,b){if(null!==a){if(K)return String(a.data(b));n.increaseCount("removeauijs35");return a.attr(b)}}function v(){x.newVDC.find(".vdc-other-fields").show();var a=x.newVDC.find("#cardErrors_VDC").hide();a.find("li.error-message").not(".hidden").length&&a.show()}function J(a){var b=r(a.currentTarget).val(),c=x.newVDC.find(".bank-name").hide(),
d=x.newVDC.find("#suppressedVerifiedDebitCard").hide(),e=x.newVDC.find("option:selected").data("isdisabled"),f=!1,p="1"===r("#save_citi_card").val()&&"CIT"===b,g="1"===x.newVDC.find("#isRupayAsSavedCardEnabled").val()&&"URP"===b;x.newVDC.find(".vdc-other-fields").hide();x.newVDC.find("#cardErrors_VDC").hide();"OtherBanks"===b||p||g?(v(),r.isEmptyObject(q)||q.showExpiryDateAndCvv()):"SMP"!==b||r.isEmptyObject(q)?""!==b&&(a=r(a.currentTarget).find("option:selected").text(),e?d.show().find(".suppress-bank-name-text").html(a):
c.show().find(".bank-name-text").html(a),f=!0):(v(),q.hideExpiryDateAndCvv());X(f)}function L(a){r(".upi-action").hide();a=r(a.currentTarget).val();r("#"+a).show();X(Q(l))}function R(a){X(T())}function Q(a){if(r("#upi-input")){var b=r("#upiActionSelect").val();if("upi-registration"===b)return T();if("upi-acceptance"===b)return O(a)}else return O(a);return!1}function O(a){return(a=a.get("ValidatePaymentMethod"))?a.shouldEnableContinueButton():!0}function T(){var a=r("#upiRegistration_bankSelect").val();
if(a&&0<a.length)return!0}function H(a,b){if(!r.isEmptyObject(w)&&a)return a(b)}function B(b){var c=Array.prototype.slice.call(arguments);c.shift();k.now("upi-helper").execute("safe-upi-wrapper",function(d){d&&!a.objectIsEmpty(d)&&"function"===typeof d[b]&&d[b].apply(null,c)})}function N(a){H(w.removeEMIMenuSelectionAttributes);x.newEMI.find(".emi-group").hide();a="CreditCard"===r(a.currentTarget).find("option:selected").val()?x.newEMI.find(".new-emi-card-fields").hide():H(w.getEMIMenuSelectedCardSection);
a=H(w.toggleEMITenureSelectBehaviour,a);X(a)}function E(a){(r(a.currentTarget).hasClass("sv-select-value")?r(a.currentTarget).val():r(a.currentTarget).find("option:selected").val())?X(!0):X(!1)}function W(){var a=f.create();a.validatePayment(ma());r("form.checkout-page-form").data("checkoutFormReady",!a.hasErrors())}function t(b){var c=r(b.currentTarget);b=K?c.find("i"):c.children("i");if(K&&c.find("#addCreditCardNumber").is(":visible")){var d=r("#auiTemplatingPaypageSelectionFix");0<d.length&&"T1"===
d.val()&&c.find("#addCreditCardNumber").focus()}"1"===c.attr("ischecked")||b.eq(0).hasClass("a-icon-touch-radio-active")||(da(!0),x.continueErrors.hide(),x.paymentRows.attr("ischecked",0),x.paymentRows.attr("isclicked",0),c.attr("ischecked",1),pa(c),b=la(c),X(b),k.when("rewards-section-mobile").execute(function(b){a.trigger("rewards-section-mobile:select-payment-row",c)}),ea(c),Ga(c),Ha(c),Ia(c),"1"===r("#suppressionMessageFixEnabledStatus").val()&&Ja(c),Ka(c),La(),Ca(c),Ea(),ha(),p(c,"#existing-gil-description"),
p(c,"#existing-gil-alert"),p(c,"#existing-gil-si-rcl-description"),p(c,"#existing-gil-si-rcl-alert"),W(),I(c),y.toggleGCForMCB(c,x),F(c),r.isEmptyObject(u)||u.toggleCustomerNudgingMessage(c))}function p(a,b){var c=r(b);if(c&&0!==c.length){var d=0;0<a.find(b).length&&(d=1);d&&!c.is(":visible")?c.removeClass("aok-hidden"):!d&&c.is(":visible")&&c.addClass("aok-hidden")}}function F(a){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=r("input[type\x3d'hidden'][name\x3d'paySelectLocale']");
b.length&&"IN"===b.val()&&a.length&&k.when("client-side-metrics").execute(function(a){a.increaseCount("PayPage-COD-Mobile",1)})}function I(a){if(r("#isGlobalCODEligible").val()){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=r("#new-gc-promo");a.length?b.hide():b.show()}}function S(a){a.$event.preventDefault();var b=a.$target;K?b.closest("#card-expiration").hide():(n.increaseCount("removeauijs36"),b.parent().hide());b.parents("div.a-box-inner").find("#"+a.data.targetId).show();
a=K?".a-touch-radio":"label.a-touch-radio";K?b.parents(a).find("label").trigger("click"):(n.increaseCount("removeauijs37"),b.parents(a).trigger("click"))}function U(a){a=a.$target;K?a.parent().parent().hide():(n.increaseCount("removeauijs38"),a.parent().hide());r("#reward-err-detail").show()}function ga(a){a.$target.parent().hide();r(".financial-offer-err-detail").show()}function wa(a){a.$event.preventDefault();c.makeAjaxCall(a.data.href,{},{successHandler:function(a,d,e){a&&(d=c.getPageId(e))&&b.slideShow(r(d),
a)}})}function xa(a){a.$event.preventDefault();c.makeAjaxCall(a.data.href,{},{successHandler:function(a,d,e){a&&(d=c.getPageId(e))&&b.slideShow(r(d),a)}})}function ya(a){var b=r("input#isPipelinedPage"),b=0<b.length&&"1"===b.val(),d=c.prop("activeGoElement");if(d)for(var e=["gcPromo","newVCC","newVDC"],p=0;p<e.length;p++){var F=x[e[p]];if(F&&F.length&&F.find(d).length)return F.find('input[type\x3d"button"]').trigger("click"),a.$event.preventDefault(),!1}d=V();e=[za,Aa];for(p=0;p<e.length;p++)if((0,e[p])(a.data.url,
d))return a.$event.preventDefault(),b&&a.$event.stopImmediatePropagation(),!1;d=f.create();e=ma();!r.isEmptyObject(w)&&H(w.isEMIPaymentInstrument,e)&&(e=H(w.getEMIMenuSelectedCardSection));d.validatePayment(e);d.apxValidatePayment(e,x.paymentsForm);if((d=d.getHighestErrorId())&&d.identifier)return a.$event.preventDefault(),b&&a.$event.stopImmediatePropagation(),"continue_GilCCContinueErrorIneligibleItems"===d.identifier?A.displayGILEstimatesMobile("StandaloneCreditCardInstallment",ba,ca):"continue_GilContinueErrorIneligibleItems"===
d.identifier?A.displayGILEstimatesMobile("StandaloneInstallment",ba,ca):"continue_GilRCLContinueErrorIneligibleItems"===d.identifier?A.displayGILEstimatesMobile("StandaloneReusableCreditLineInstallment",ba,ca):x.continueErrors.show().find("#"+d.identifier).show(),!1;x.continueErrors.hide().find(".error-message").hide();g.showPageTransition()}function ba(a,e,f){var p=d.jsonify(a);p&&!p.errors&&p.widgetHTML?(a=r(c.pages["gil-estimates"].pageId),b.slideShow(a,p.widgetHTML),h.scrollTo(0,0)):ca(a,e,f)}
function ca(a,b,c){r("#continue_GilCCContinueErrorIneligibleItems").show()}function ja(a){a=r(a.currentTarget);1===a.data("isclicked")?a.data("isclicked",0):a.data("isclicked",1);ha()}function ha(){var a=r("#pm_promo"),b=r("#pm_gc_radio"),c=r("#pm_gc_checkbox"),d="1"===r("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").val();if(!b.length&&!c.length)return!1;var e=r("input[name\x3dgcBalanceRaw]").val();r("input[name\x3damBalanceRaw]").length&&(e=r("input[name\x3damBalanceRaw]").val());
var f=r("input[name\x3disAPBLimitMessagingLaunchWeblabEnabled]").val(),p=r("input[name\x3dhasAPBRedeemableLimitExhausted]").val(),g=r("input[name\x3damAvailableBalanceRaw]").val(),w=r("input[name\x3dremainingBalanceRaw]").val(),F=r("input[name\x3dpurchaseTotalRaw]").val(),l,m,t=r(".purchase-total").length;t?(m=r(".purchase-total").html(),l=r(".remaining-balance").html()):(m=r("input[name\x3dpurchaseTotal]").val(),l=r("input[name\x3dremainingBalance]").val());var n=r(".balance-applied");t?n.html(m):
n.text(m);a=a.closest(".a-control-row");"1"===a.attr("isclicked")||1===a.data("isclicked")?0<w&&(t?n.html(l):n.text(l)):w=F;var a=b.closest(".a-control-row"),h=c.closest(".a-control-row"),q=r(".long"),k=r(".amazon-money-limit-breached"),z=r(".short");f&&G.renderAPBMessagingRemainingBalance({purchaseTotal:m,remainingBalance:l,balanceApplied:n,isPurchaseTotalInSpan:t},e,F,g);"1"===f&&"1"===p?G.displayAPBRedeemableLimitExhaustedMessaging({gcRadioContainer:a,gcCheckboxContainer:h,gcCheckbox:c,gcRadio:b,
shortMsg:z,longMsg:q,amazonMoneyLimitBreachedMsg:k}):0<=e-F?("disabled"===b.attr("disabled")&&b.removeAttr("disabled"),a.removeClass("hidden"),h.addClass("hidden"),c.attr("disabled","disabled"),0==e-F?(q.hide(),z.show()):(q.show(),z.hide())):0<e-w?0>=w?(h.removeClass("hidden"),h.find("i").addClass("a-button-disabled checkbox-disabled"),c.attr("disabled","disabled"),a.addClass("hidden"),b.attr("disabled","disabled"),z.show(),q.hide()):("disabled"===b.attr("disabled")&&b.removeAttr("disabled"),a.removeClass("hidden"),
h.addClass("hidden"),c.attr("disabled","disabled"),q.show(),z.hide()):("disabled"===c.attr("disabled")&&c.removeAttr("disabled"),h.removeClass("hidden"),h.find("i").removeClass("a-button-disabled checkbox-disabled"),a.addClass("hidden"),b.attr("disabled","disabled"),"1"===f?G.renderAPBInsufficientMessaging({shortMsg:z,longMsg:q},e,g):(z.show(),q.hide()));d&&(b.attr("disabled","disabled"),c.attr("disabled","disabled"))}function ka(a){a=a.$target||r(a.currentTarget);Y(a)}function Y(b,c){var d=b.find("input[type\x3d'checkbox']")||
b.find("input[type\x3d'radio']"),e;e=d.is("input[type\x3d'checkbox']")?"checkbox":"radio";if(d.length){var f=d.siblings("i"),p=x.paymentRows.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]'),g=x.paymentRows.filter(".a-touch-radio[data-paymentmethodtype\x3d'creditCard']");b=g.siblings(".installments-select.a-row");var F=g.siblings(".installments-message"),l=g.siblings(".card-offers"),g=g.filter("[data-isinstallmentsonlycard\x3d1]"),m=x.paymentRows.find('input[type\x3d"radio"][value\x3d"morePaymentMethod"]'),
t=K?m.parents(".a-control-row"):m.parent(),h=x.paymentRows.find('input[type\x3d"radio"][id\x3d"pmEmiPaymentOptions"]'),n=!h.parent().find('input[type\x3d"hidden"][name\x3d"isEMIMenuDisabled"]').val(),q=x.paymentRows.find('input[type\x3d"radio"][value\x3d"amazonBusinessCredit"]'),I=q.closest(".payment-row"),v=x.paymentRows.find("#pm_upi_web_collect"),u=x.paymentRows.filter(".upi-saved-handle");c||f.hasClass("a-icon-touch-"+e+"-inactive")?(p.attr("disabled",!0).prop("disabled",!0),n&&H(w.disableEMIMenu,
h),D.showInstantBankDiscountAmazonPaySelected(),B("disableUPIFromSelectionOnPSP",v,u),p.is(":checked")&&(p.attr("checked",!1),p.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),p.siblings("i").addClass("a-icon-radio-inactive").removeClass("a-icon-radio-active"),ea(p)),c=K?p.parents(".a-control-row"):p.parent(),c.addClass("a-color-secondary js-gc-disabled"),m.attr("disabled",!0).prop("disabled",!0),m.is(":checked")&&(m.attr("checked",!1),m.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),
m.siblings("i").addClass("a-icon-radio-inactive").removeClass("a-icon-radio-active"),ea(m)),t.addClass("a-color-secondary js-gc-disabled"),t.siblings(".selected-section-more-payment-method").hide(),(c=b.find("select"))&&c.each(function(){var a=this.id.replace(/\./g,"\\.");z.setValue(a,"");a=r(this).find("option").eq(0).text();r(this).siblings(".a-input-dropdown").text(a)}),b.find(".installments-enabled-text").hide(),F.find(".installments-enabled-text").hide(),l.find(".installments-enabled-text").hide(),
b.find(".installments-disabled-text").show(),F.find(".installments-disabled-text").show(),l.find(".installments-disabled-text").show(),r("#isGurupaPspToggleGcBugfixEnabled").length&&"1"===r("#isGurupaPspToggleGcBugfixEnabled").val()?g.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").filter(":checked").removeAttr("checked"):g.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").removeAttr("checked"),k.when("abc-helper").execute(function(b){a.trigger("abc-helper:disable-payment",
q)})):(p.attr("disabled",!1).prop("disabled",!1),n&&(H(w.enableEMIMenu,h),h.is(":checked")&&(H(w.addEMIMenuSelectionAttributes),r("#selectedSectionEmiPaymentMethod").show())),D.showInstantBankDiscountAmazonPayDeselected(),f.removeClass("a-icon-touch-"+e+"-inactive").addClass("a-icon-touch-"+e+"-active"),c=K?p.parents(".a-control-row"):p.parent(),c.removeClass("a-color-secondary js-gc-disabled"),b.find(".installments-disabled-text").hide(),F.find(".installments-disabled-text").hide(),l.find(".installments-disabled-text").hide(),
b.find(".installments-enabled-text").show(),F.find(".installments-enabled-text").show(),l.find(".installments-enabled-text").show(),g.find("input[name\x3dpaymentMethod]").removeAttr("disabled"),t.parent().find(".payment-invalid").length||(m.attr("disabled",!1).prop("disabled",!1),t.siblings(".selected-section-more-payment-method").show()),t.removeClass("a-color-secondary js-gc-disabled"),I.find(".payment-invalid").length||k.when("abc-helper").execute(function(b){a.trigger("abc-helper:enable-payment",
q)}),B("enableUPIForSelectionOnPSP",v,u),d.is(":checked")&&(m.attr("disabled",!0).prop("disabled",!0),m.is(":checked")&&m.attr("checked",!1),m.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),m.siblings("i").addClass("a-icon-radio-inactive").removeClass("a-icon-radio-active"),t.siblings(".selected-section-more-payment-method").hide(),n&&(H(w.disableEMIMenu,h),h.is(":checked")&&(r("#selectedSectionEmiPaymentMethod").hide(),H(w.removeEMIMenuSelectionAttributes))),
D.showInstantBankDiscountAmazonPaySelected(),B("disableUPIFromSelectionOnPSP",v,u),k.when("abc-helper").execute(function(b){a.trigger("abc-helper:disable-payment",q)})))}}function za(a,b){if("true"!==M(b,"isaddresschallenge"))return!1;a=b.parent();if(m.runConfirmCardValidator(a,a.find("#confirmCardErrors")))return c.scrollTopTo(a.find("#addCreditCardNumber")),!0;a=c.getInputValues(a);m.confirmCreditCard(a,Da,a.confirmCardUrl);return!0}function Aa(a,b){b=c.getInputValues(b.parent());if("undefined"===
typeof b.newMonth||!b.newMonth||!b.newYear||"undefined"===typeof b.newYear||parseInt(b.expmonth,10)===parseInt(b.newMonth,10)&&parseInt(b.expyear,10)===parseInt(b.newYear,10))return!1;b.handler="update-credit-card";b.ccId0=b.paymentmethodid;b.issueNumber0=b.issuer;b.month0=b.newMonth;b.year0=b.newYear;c.makeAjaxCall(a,b,{},{useSif:!0});return!0}function Ba(){var a=r("#new-cc-inbox label");if(a&&0!==a.length){var b;K?b=x.paymentRows.filter(".a-touch-radio[data-paymentmethodtype\x3d'creditCard']"):
(n.increaseCount("removeauijs43"),b=x.paymentRows.filter("label[paymentmethodtype\x3d'creditCard']"));if(b=!(0<b.length))b=x.continueBtn.parents(".a-button").hasClass("a-button-disabled")?!0:!1;b&&(c.scrollTopTo(a),a.trigger("click"))}}function Ca(a){var b=r("#form-add-credit-card");if(b&&0!==b.length){var c=0;0<a.find('input[value\x3d"addingNewCCInBox"]').length&&(c=1);c&&!b.is(":visible")?b.slideDown():b.is(":visible")&&b.slideUp()}}function la(a){var b=f.create();a&&a.length||b.addError("continue_BlankSlate");
a&&"function"===typeof a.parent&&b.validatePCICVVBlock(a.parent());b.apxValidatePayment(a,x.paymentsForm);if(b.hasErrors())return!1;if("pmEmiPaymentOptions"===a.find('input[type\x3d"radio"]').attr("id"))return H(w.getEMIMenuSelectedCardSection).find(".emi-menu-tenures-dropdown").find("option:selected").val()?!0:!1;b=a.find('input[name\x3d"paymentMethod"]').val();if("cashOnDeliveryCash"===b&&a.parent().find(".phonenumberNotVerified").length)return!1;if("StandaloneCreditCardInstallment"===b||"StandaloneInstallment"===
b||"StandaloneReusableCreditLineInstallment"===b)return b=a.find('input[name\x3d"gilShowContinueBlocker"]').val(),a=a.find('input[name\x3d"gilShowContinueBlockerIfPromotions"]').val(),"1"!==b&&"1"!==a;if("addingNewCCInBox"===b||"addingNewCUPDCInBox"===b)return!1;if("upi"===b)return Q(l);if("verifiedDebitCard"!==b&&"verifiedCreditCard"!==b)return!0;if("verifiedCreditCard"===b)return!1;a=x.newVDC.find("#vdcBanksSelect").val();return""!==a&&"OtherBanks"!==a}function Da(b){var e=d.jsonify(b);e.imbWidgetHTML&&
r("#imb-wrapper").html(c.decodeJSonResponse(e.imbWidgetHTML));b=V();var f=M(b,"paymentmethodid");!e.cardWidgetHTML||e.newpaymentmethodid!==f&&e.optionalnewpaymentmethodid!==f||(b.closest(".a-box").replaceWith(c.decodeJSonResponse(e.cardWidgetHTML)),null!=e.rewardsAccountsWidgetHTML&&k.when("rewards-section-mobile").execute(function(b){a.trigger("rewards-section-mobile:refresh-rewards-section",c.decodeJSonResponse(e.rewardsAccountsWidgetHTML))}),ia(),b=V(),"true"!==M(b,"isaddresschallenge")&&(m.setCardPasswordInputStatus(b,
e.newpaymentmethodid,"cvv","#existingCvvNum"),m.setCardPasswordInputStatus(b,e.newpaymentmethodid,"pincode","#existingPincodeNum"),x.continueBtn.closest(".a-row").show()))}function V(){var a=x.paymentRows.filter("[ischecked\x3d1]");if(a.length)return n.increaseCount("removeauijs41"),a;if(K)return x.paymentRows.filter("[data-ischecked\x3d1]");n.increaseCount("removeauijs42");return x.paymentRows.children("i").filter(".a-icon-touch-radio-active").parent()}function ma(){var a=[];a.push(V());x.jppoints&&
x.jppoints.length&&x.jppoints.find("#redeemPoints").is(":checked")&&a.push(x.jppoints);return a}function Ea(){for(var a=x.paymentRows.parent(),b=["#reward-err-link",".financial-offer-err-link"],c=0;c<b.length;c++)r(b[c],a).show();for(var b=["#reward-err-detail",".financial-offer-err-detail"],d=0;d<b.length;d++)r(b[c],a).hide()}function Fa(){for(var a=[".financial-offer-err-detail"],b=0;b<a.length;b++){var c=r(a[b]);c.data("isHidden")||c.show()}}function na(a){a.stopPropagation();a.preventDefault()}
function oa(a,b){fa[b]&&(fa[b](),fa[b]=null);var c=a.find(b);c.length&&(c=c[0],c.addEventListener("click",na),fa[b]=function(){c.removeEventListener("click",na)})}function pa(a){r(".pci-blocking-cvv").length&&(x.paymentRows.each(function(){var a=r(this).parent().find(".pci-blocking-cvv");a.length&&a.hide()}),a&&(a=a.parent().find(".pci-blocking-cvv"),a.length&&a.show()))}function ea(a){var b=".card-cvv-field .card-pcard-field #invoice-address .loc-order-number #net-banking-list #selected-section-more-payment-method #selectedSectionEmiPaymentMethod .new-card-fields .installments-link #rewards-balance-link .financial-offer-link .financial-offer-err-detail .review-continue-text #form-add-cupdc-inbox .otpBlock #ovdWidgetSection".split(" ");
r("#upi-input").length?b.push("#upi-input"):b.push("#upi-acceptance-input");Z||b.push("#domestic-card-list","#third-party-list","#installment-payment-warning");var c=r("#cash-back-ineligible-for-cod-message");c&&c.length&&b.push("#cash-back-ineligible-for-cod-message");for(var c=x.paymentRows.parent(),d=a.parent(),e=0;e<b.length;e++){var f=b[e];"#selectedSectionEmiPaymentMethod"===f&&H(w.removeEMIMenuSelectionAttributes);r(f,c).hide();var p=d.find(f);p.data("isHidden")||(p.show(),".card-cvv-field"===
f&&(oa(d,"#existingCvvNum"),oa(d,"#existingPincodeNum")))}"pmEmiPaymentOptions"===a.find('input[type\x3d"radio"]').attr("id")&&H(w.addEMIMenuSelectionAttributes);a=["#reward-points",".financial-offer"];for(b=0;b<a.length;b++)e=a[b],r(e,c).show(),r(e,d).hide()}function Ga(b){var c=x.paymentRows.parent();c.find("#card-expiration,.payment-info").show();c.find("#addr-challenge,#addr-challenge-msg,.addr-challenge-card-scan,.addr-challenge-confirm,#expire-date-fields").hide();x.continueBtn.closest(".a-row").show();
"true"===M(b,"isaddresschallenge")&&(c=b.parent(),c.find("#card-expiration,.payment-info").hide(),c.find("#addr-challenge,#addr-challenge-msg,.addr-challenge-card-scan,.addr-challenge-confirm,#expire-date-fields").show(),x.continueBtn.closest(".a-row").hide(),b=b.attr("paymentmethodid")?b.attr("paymentmethodid"):b.attr("data-paymentmethodid"),a.trigger("checkout:payment:challenge:log",b))}function Ha(a){x.paymentRows.parent().find(".verified-fail-msg").hide();"true"===M(a,"isverifiedfail")&&a.parent().find(".verified-fail-msg").show()}
function Ia(a){x.paymentRows.parent().find(".cup-expired-msg").hide();"true"!==M(a,"iscupcardexpired")&&"true"!==M(a,"iscupcardexpiringsoon")||a.parent().find(".cup-expired-msg").show()}function Ja(a){x.paymentRows.parent().find("#savedCardSuppressed").hide();a.parent().find("#savedCardSuppressed").show()}function Ka(a){var b=x.paymentRows.parent();b.find(".installments-select").hide();b.find(".installments-message").show();a=a.parent();a.find(".installments-select").show();a.find(".installments-message").hide()}
function La(){var a=r("#imb-wrapper");if(a.length&&a.is(":visible")){var b=a.find(".defaultPaymentMethodExpired"),c=a.find(".codUnavailable"),d=a.find("p").length;0===b.length&&0===c.length||1!==d||a.hide()}}function qa(){var a;K?a=r("#select-payments-view input[type\x3d'radio'][name\x3d'paymentMethod']:checked").closest(".a-touch-radio"):(n.increaseCount("removeauijs44"),a=r("#select-payments-view input[type\x3d'radio'][name\x3d'paymentMethod'][checked\x3d'checked']").closest("label.a-touch-radio"));
a=la(a);X(a)}function X(a){var b=x.continueBtn.parents(".a-button");a?(x.continueBtn.removeAttr("disabled"),b.removeClass("a-button-disabled")):(x.continueBtn.attr("disabled",!0),b.addClass("a-button-disabled"))}function Ma(b){var d=b.$target.closest("a");b=d.closest("div.extender-section");d=d.find("i");d.hasClass("a-icon-extender-expand")?(b.find(".collapsed").hide(),a.slideDown(b.find(".expanded"),200),d.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse")):(b.find(".collapsed").show(),
a.slideUp(b.find(".expanded"),200),d.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"));c.scrollTopTo(aa().find(".reg-expander-anchor"))}function aa(){return V().closest(".payment-box")}function Na(){da()}function da(a){var b=aa();b.find("div.flag-register-rewards").is(":visible")?(b.find(".flag-register-rewards").addClass("aok-hidden"),b.find(".card-unreg-rewards").removeClass("aok-hidden"),b.find(".a-box-inner:first").removeClass("no-padding-bottom")):a||(b.find(".card-unreg-rewards").addClass("aok-hidden"),
b.find(".flag-register-rewards").removeClass("aok-hidden"),b.find(".a-box-inner:first").addClass("no-padding-bottom"));a||c.scrollTopTo(b)}function Oa(a){a.$event.preventDefault();var b=K?".a-touch-radio":"label.a-touch-radio",e=a.$currentTarget.closest(".payment-box"),b=e.find(b);0!==b.length&&(b.find('input[type\x3d"radio"]').click(),"1"===e.find("div.flag-register-rewards").data("cached")?da():(e=a.$target.attr("href"),g.show(),c.makeAjaxCall(e,a.data,{successHandler:function(a){g.hide();var b=
d.jsonify(a);a=c.decodeJSonResponse(b.widgetHTML);aa().find("div.flag-register-rewards").html(a).data("cached","1").find(".error-message").each(function(){var a=r(this),c=a.data("errorid");a.html(b.displaydata[c])});da()}})))}function ra(a){a=x.showAmexWarning_mobile;null!==a&&(a.removeClass("hidden"),a.removeClass("amex_display"))}function Pa(a){g.show();var b=aa(),e=b.find("input[type\x3dradio][name\x3dpaymentMethod]").val(),f=b.find(".card-unreg-rewards").data(),p=b.find(".flag-register-rewards"),
p=c.getInputValues(p);p.programid=f.programid;p.paymentinstrumentid=f.paymentinstrumentid;p.CARD_EXPIRATION_DATE=f.expiredate;p.CARD_HOLDER_NAME=f.holdername;p.returnRefreshedPage=a.data.returnRefreshedPage;p.rewardsdateofbirthmonth&&p.rewardsdateofbirthday&&(p.DATE_OF_BIRTH=p.rewardsdateofbirthmonth+p.rewardsdateofbirthday);c.makeAjaxCall(a.data.url,p,{successHandler:function(a,f,p){g.hide();a&&(a=d.jsonify(a),f=aa().find(".register-error"),a.error?f.show().find(".error-message").hide().filter("#"+
a.error).show():(f.hide(),x.pageContainer.html(a.refreshedPage),ia(),a=K?".a-touch-radio":"label.a-touch-radio",b=x.paymentRows.find('input[type\x3dradio][name\x3dpaymentMethod][value\x3d"'+e+'"]').closest(a),b.trigger("click")),c.scrollTopTo(b))}})}function ia(b){if(c.isMobileCX()){c.refreshElements(x,sa);Z=parseInt(r("input[type\x3d'hidden'][name\x3d'showWidgetInSeparateGroup']").val(),10);Z=isNaN(Z)?0:Z;ta&&(a.declarative("show-expire-date-fields",["click"],S),a.declarative("show-reward-err-detail",
["click"],U),a.declarative("show-financial-offer-err-detail",["click"],ga),a.declarative("submit-payment-form",["submit"],ya),a.declarative("show-reward-points",["click"],wa),a.declarative("show-financial-offer",["click"],xa),a.declarative("show-rewards-reg-mobile",["click"],Oa),a.declarative("register-card-rewards-mobile",["click"],Pa),a.declarative("cancel-register-card-rewards-mobile",["click"],Na),a.declarative("extender-toggle-mobile",["click"],Ma),ta=!1);B("initiateUpiDeviceCheck");x.existingPincodeNum.unbind("click",
ra).bind("click",ra);K?(x.paymentsForm.undelegate(".a-touch-radio","click").delegate(".a-touch-radio:has(input[name\x3dpaymentMethod]:enabled)","click",t),x.paymentsForm.undelegate(".promoLabel","click").delegate(".promoLabel:has(input[name\x3dusePromoBalance]:enabled)","click",ja),b=function(a){a.target.focus()},r("input#existingPincodeNum").bind("click",b),r("input#existingCvvNum").bind("click",b),r("input#existingCvvNum").bind("click",b),r("input#addCreditCardNumber").bind("click",b),r("input#addCreditCardPincode").bind("click",
b),r("input#addCreditCardVerificationNumber").bind("click",b),r(".payment-select").bind("touchstart",function(a){r(this).find("i").removeClass("a-icon-touch-radio-inactive")})):(n.increaseCount("removeauijs46"),x.paymentsForm.undelegate("label.a-touch-radio","click").delegate("label.a-touch-radio:has(input[name\x3dpaymentMethod]:enabled)","click",t),x.paymentsForm.undelegate("label.promoLabel","click").delegate("label.promoLabel:has(input[name\x3dusePromoBalance]:enabled)","click",ja));r("#domestic-card-dropdown").unbind("change").bind("change",
function(){r("#label-domestic-card").trigger("click")});r("#third-party-dropdown").unbind("change").bind("change",function(){r("#label-third-party").trigger("click")});r("#vdcBanksSelect").unbind("change",J).bind("change",J);r("#upiActionSelect").unbind("change",L).bind("change",L);r("#upiRegistration_bankSelect").unbind("change",R).bind("change",R);r("#emiPaymentMethodsSelectList").unbind("change",N).bind("change",N);r(".sv-select-option").unbind("click",ua).bind("click",ua);r(".emi-menu-tenures-dropdown").unbind("change",
E).bind("change",E);r("#net-banking-list").unbind("change",va).bind("change",va);if(0<r("input[name\x3d'needDisableCODandEMIforGC']").length){b=r("#existing-gift-card-promo");if(b.length){b.bind("click",ka);x.paymentsForm.delegate(".js-gc-disabled","click",function(){return!1});var d=K?b.find("#pm_300"):b.children("#pm_300");d.is("input[type\x3d'checkbox']:checked")&&Y(b,!0);b.data("gc-initially-checked")&&Y(b,!0)}var e=r(".existing-gift-card-balance");e.length&&(e.bind("click",ka),x.paymentsForm.delegate(".js-gc-disabled",
"click",function(){return!1}),d=K?e.find("#pm_gc_checkbox"):e.children("#pm_gc_checkbox"),d.is(":checked")&&Y(e,!0),e.data("gc-initially-checked")&&Y(b,!0))}k.when("rewards-section-mobile").execute(function(b){a.trigger("rewards-section-mobile:init",x.paymentsForm,f)});k.when("installments-payselect-mobile").execute(function(){a.trigger("installments-payselect-mobile:init",x.paymentsForm,f)});k.when("apx-payselect-helper").execute(function(){var a=l.get("payselect");a&&a.initEvents(x.paymentsForm,
qa)});pa(V());qa();Ba();ea(V());Fa();ha();b=V();I(b);r.isEmptyObject(u)||u.toggleCustomerNudgingMessage(b);y.determineIsMCBEnabled(x);y.toggleGCForMCB(b,x);r("form.checkout-page-form").data("checkoutFormReady",!0).change()}}function va(a){a=r(a.currentTarget).find("option:selected");var b=a.data("isdisabled"),c=r("#net-banking-list");b?(c.find("#disable-bank-content-mob").show(),c.find("#selected-bank-mob").text(a.text()).show()):c.find("#disable-bank-content-mob").hide()}function ua(a){a=r(a.currentTarget);
var b=a.data(),c=r(document.getElementById(b.id)),d=r(document.getElementById("popover-"+b.id));c.find(".sv-select-value").val(b.value).trigger("change");d.find(".sv-select-option").removeClass("a-active");a.addClass("a-active");b=c.find(".a-button-text");a=a.find(".sv-select-option-primary-text").html();b.html(a)}var r=a.$,x={},ta=!0,K=h.P&&h.P.AUI_BUILD_DATE,sa={jppoints:"#jppoints",continueBtn:"#select-payments-view #continueButton",continueErrors:"#continue-errors",gcPromo:"#new-gc-promo",newVCC:"#new-verified-credit-card",
newVDC:"#new-verified-debit-card",newEMI:"#newEmiCard",paymentRows:"#select-payments-view label.a-touch-radio",paymentsForm:"#select-payments-view form",pageContainer:"#page-container",existingBalance:"#pm_300",showAmexWarning_mobile:"#showAmexWarning_mobile",existingPincodeNum:"#existingPincodeNum",mcbBalanceWarning:"#mcbBalanceWarning"};K&&(sa.paymentRows='#select-payments-view .a-touch-radio:not([data-a-input-name\x3d"rewardsAccount"])');var Z,fa={};return{init:ia,setContinueButtonStatus:X,getSelectedPaymentRow:V,
getGilEstimatesMobileSuccess:ba}});k.when("A","pay-common-util","pay-rewards-currency").register("page-rewards",function(a,d,c){function e(a){a=m(a.currentTarget);var b=n?a.closest("div").data():a.data(),c=a.val()/b.ratio;isNaN(c)||(c=0>c||a.val()<b.min?0:f(c,b.decimalplaces),A.customRewardPoints.html(c))}function b(a){a=m(a.currentTarget);var b=a.data(),c=a.val(),d=parseFloat(A.rewardForm.find("#rewardsmax").val());isNaN(c)||0>c?(A.customRewardPoints.html(0),a.val(0)):c>d&&(b=f(d/b.ratio,b.decimalplaces),
A.customRewardPoints.html(b),a.val(d))}function g(a){a=m(a.currentTarget);"1"!==a.attr("ischecked")&&(A.rewardRows.attr("ischecked",0),a.attr("ischecked",1),"rewardscustom"===a.find("[type\x3dradio]").val()?(A.customReward.show(),A.customRewardText.addClass("a-text-bold")):(A.customReward.hide(),A.customRewardText.removeClass("a-text-bold")))}function f(a,b){isNaN(b)||(a=Number(a).toFixed(b));a=a.toString();b=0<=a.lastIndexOf(".")?a.lastIndexOf("."):a.length;return 3>=b?a:f(a.substring(0,b-3),0)+
","+a.substring(b-3)}var m=a.$,k=!0,n=h.P&&h.P.AUI_BUILD_DATE,A={},y={customReward:"#select-payment-rewards-view #custom-reward",customRewardPoints:"#select-payment-rewards-view #custom-reward-points",customRewardText:"#select-payment-rewards-view #custom-reward-text",rewardForm:"#select-payment-rewards-view form",rewardRows:"#select-payment-rewards-view label.a-touch-radio"};n&&(y.rewardRows="#select-payment-rewards-view .a-touch-radio");return{init:function(){if(d.isMobileCX()){d.refreshElements(A,
y);k&&(k=!1);var a=A.rewardForm.find("input[name\x3drewardsCustom]"),f=!1,h;a.hasClass("show-currency-input-widget-new")?(f=!0,h=m(a)):a.parent().hasClass("show-currency-input-widget-new")&&(f=!0,h=m(a.parent()));if(f){var u=parseFloat(h.data("max")),l=h.data("decimalplaces"),C=h.data("ratio"),G=h.data("country-code");a.each(function(b,d){d=A.rewardForm.find("#custom-reward-points");m(a);b={$element:m(a),maxAmount:u};d={$element:m(d),decimalPlaces:l,ratio:C};var e=c.getCurrencyFormatByCountryCode(G);
c.initializeInlineFormatting(b,d,e)})}else a.unbind("keyup").bind("keyup",e).unbind("blur").bind("blur",b);f=n?".a-touch-radio":"label.a-touch-radio";A.rewardForm.undelegate(f,"click").delegate(f,"click",g)}}}});k.when("A","pay-common-util").register("page-financial-offer",function(a,d){function c(a){a.$event.preventDefault();a=a.$target;var b=d.getInputValues(a),c=a.find(":checked").val();b.selectedFinancialOfferId=c;b.recommendedPaymentMethodId=b.paymentMethodId;d.makeAjaxCall(a.attr("action"),
b)}var e=!0,b={},g={financialOfferForm:"#select-payment-financial-offer-view form",financialOfferRows:"#select-payment-financial-offer-view label.a-touch-radio"};h.P&&h.P.AUI_BUILD_DATE&&(g.financialOfferRows="#select-payment-financial-offer-view .a-touch-radio");return{init:function(){d.isMobileCX()&&(d.refreshElements(b,g),e&&(a.declarative("apply-financial-offer",["submit"],c),e=!1))}}});k.when("A","pay-common-util","ready").execute(function(a,d){function c(){d.isMobileCX()&&(d.init(),d.elements.pageContainer.undelegate(".expando-link",
"click").delegate(".expando-link","click",function(a){var b=e(this);a=b.closest("div.expando-section").find("div.expando-content");a.is(":visible")?a.slideUp("fast",function(){b.find("i").removeClass("a-icon-collapse").addClass("a-icon-expand");b.find("div.expando-toggle-text-show").show();b.find("div.expando-toggle-text-hide").hide()}):a.slideDown("fast",function(){b.find("i").removeClass("a-icon-expand").addClass("a-icon-collapse");b.find("div.expando-toggle-text-show").hide();b.find("div.expando-toggle-text-hide").show()})}))}
var e=a.$,b=e("input#isPipelinedPage");if(0<b.length&&"1"===b.val())a.on("checkout:reload:payselect",c);else c()});k.when("A","pay-common-util","page-slide","pay-validator","ajax-utility","page-transition-controller","pay-credit-card","page-main","pay-common-lib","safe-mash","client-side-metrics","payselect-enhancements","ready").register("mobile-new-payments",function(a,d,c,e,b,g,f,m,k,n,A,y){function w(a){"undefined"!==typeof h.ue&&"undefined"!==typeof h.ue.count&&h.ue.count("PayPage-ClientSide-AddCupClick-Mobile",
1);var b=a.data.url,c={},e;for(e in a.data)"url"!==e&&(c[e]=a.data[e]);"object"===typeof n?"function"===typeof n.showEmbeddedBrowser&&n.showEmbeddedBrowser({targetURL:b,method:"POST",postParameters:c,successCallback:function(){}}):d.submitFormRequest(b,c,{target:"_blank"})}function D(a){"undefined"!==typeof h.ue&&"undefined"!==typeof h.ue.count&&h.ue.count("PayPage-ClientSide-AddCupAckClick-Mobile",1);g.show();h.location.reload()}function q(a,b){var c=a.data.type;f.isWaitingForType(c)?(a.$event.preventDefault(),
g.show(),setTimeout(function(){q(a)},50)):(B("#card-scanner-success-messages").addClass("aok-hidden"),Q(c)?a.$event.preventDefault():B("#cupSecurityCode").is(":visible")&&B("#cupMobileNumber").is(":visible")?l(a,b):b?d.makeAjaxCall(a.data.url,b,{successHandler:J},{useSif:!0}):E(a,{useSif:!0}))}function u(a){a.$event.preventDefault();var b=d.getInputValues(B("#new-cc-inbox #form-add-credit-card"));b.handler=b.handler_addNewCC;q(a,b)}function l(a,c){if(!c){c={};for(var e=N?a.$declarativeParent.find("form").serializeArray():
a.$declarativeParent.serializeArray(),f=0;f<e.length;f++)c[e[f].name]=e[f].value}a.$event.preventDefault();d.makeAjaxCall("/gp/buy/payselect/handlers/add-credit-card.html",c,null,{useSif:!0,success:function(a,c,d){a=b.jsonify(a);C(a,c,d)}})}function C(a){var c={},e={success:function(a,c,e){a=b.jsonify(a);a.checkStatusCount?(a.checkStatusCount=parseInt(a.checkStatusCount,10),isNaN(a.checkStatusCount)&&(a.checkStatusCount=1)):a.checkStatusCount=3;"PENDING"===a.cardStatus&&1<a.checkStatusCount?(--a.checkStatusCount,
C(a)):d.submitFormRequest("/gp/buy/payselect/handlers/submit.html",{newPaymentMethodId:a.paymentInstrumentId})}};c.paymentInstrumentId=a.paymentInstrumentId;a.checkStatusCount&&(c.checkStatusCount=a.checkStatusCount);setTimeout(function(){d.makeAjaxCall("/gp/buy/payselect/handlers/check-credit-card-status.html",c,null,e)},2500)}function G(a){f.handleCreditCardType(a,R)}function M(a){a.$event.preventDefault();var b=a.data.type;if(!Q(b)){var e=P[b],g=B(e.fieldId),e=e.suffix,m=d.getInputValues(g),g=
m["addCreditCardVerificationNumber"+e],l=m["addCreditCardPincode"+e],b={addCreditCardNumber:m["addCreditCardNumber"+e],addCreditCardVerificationNumber:g,addCreditCardPincode:l,handler:m["handler"+e],month:m["month"+e],name:m["name"+e],newPaymentType:b,recommendedPaymentMethodId:m.paymentMethod,year:m["year"+e],cctype:m["cctype"+e],isCardSavedFromEMIMenu:m["isCardSavedFromEMIMenu"+e],isSBIInternationalMaestroSelected:m["isSBIInternationalMaestroSelected"+e]},h=a.$target.hasClass("addCardAndContinueButton");
d.prop("cvv-newcard",g);d.prop("pincode-newcard",l);d.makeAjaxCall(a.data.url,b,{successHandler:function(a){if(a){var b=B(d.pages.main.pageId);c.slideShow(b,a);a=N?B("#select-payments-view .a-touch-radio"):B("#select-payments-view label.a-touch-radio");f.setNewCardCVVInputStatus(a)}},completeHandler:function(a,b){h&&(A.increaseCount("checkout:payselect:addcardandcontinue:continueactionactivated",1),B("#select-payments-view #continueButton").trigger("submit"));B.isEmptyObject(y)||y.triggerAjaxLoadEvent()}},
{useSif:!0,isAddCardAndContinueEnabled:h})}}function v(a,b){b=B("#form-add-direct-debit");var c=b.find("input[name\x3daddBankAccountRoutingNumber]"),d=b.find("input[name\x3daddBankAccountNumber]"),f=b.find("input[name\x3ddebitAccountName]"),g=e.create();g.validateDirectDebitRoutingNum(c,c);g.validateDirectDebitAccountNum(d,d);g.validateDirectDebitAccountName(f,f);g.displayErrors(b.find("#direct-debit-errors"),b);g.hasErrors()?a.$event.preventDefault():E(a)}function J(b,e,f){b&&(e=d.getPageId(f))&&
(c.slideShow(B(e),b),a.trigger("checkout:reload:payselect"),(b=0<B(".activateScrollToError").length)&&0<B("#check-errors").length?B(h).scrollTop(B("#check-errors").offset().top):b&&0<B("#direct-debit-errors").length?B(h).scrollTop(B("#direct-debit-errors").offset().top):b&&0<B("#new-invoice-errors").length?B(h).scrollTop(B("#new-invoice-errors").offset().top):"#select-payments-view"===e&&k.scrollTopTo(m.getSelectedPaymentRow()))}function E(a,b){d.handleForm(a,J,b)}function R(a,b){if(a){"1"===a.isDebitCard?
B("#cardWarnings").show().removeClass("hidden"):B("#cardWarnings").hide().addClass("hidden");b=B(P[b].fieldId);f.setDateSelectorStatus(a,b);if("1"===a.hasErrors){var c=e.create();c.validateGetCreditCardTypeResult(a);if(c.hasErrors()){c.displayErrors(b.find("#cardErrors"),b);return}}c=b.find(".cup-card-field");if(0!==c.length){var d=a.specificFields;d&&1===d.securityCode&&1===d.mobileNumber?c.show():c.hide()}if(a&&(c=a.specificFields,d=b.find(".pincode-field"),0!==d.length)){var g=b.find(".cvv-field");
0!==g.length&&(b=b.find("#cardType"),0!==b.length&&(b.val(a.issuer+a.brand),c&&1===c.pincode?(g.hide(),d.show()):c&&0===c.pincode&&0===c.securityCode?(d.hide(),g.hide()):(d.hide(),g.show())))}}}function Q(a){if(!(a in P))return!0;var b=P[a],c=B(b.fieldId),b=b.suffix,d="1"===c.find("#isSBIMaestroAsSavedCardEnabled").val()&&"1"===c.find('input[name\x3d"isSBIInternationalMaestroSelected'+b+'"]').val(),f=c.find('input[name\x3d"addCreditCardVerificationNumber'+b+'"]'),g=c.find('select[name\x3d"month'+
b+'"]'),m=c.find('input[name\x3d"name'+b+'"]');a=c.find('input[name\x3d"addCreditCardNumber'+("brdc"===a?"":b)+'"]');var l=c.find('input[name\x3d"addCreditCardMobileNumber'+b+'"]'),t=c.find('select[name\x3d"year'+b+'"]'),n=c.find('input[name\x3d"addCreditCardPincode'+b+'"]'),q=e.create();f&&f.length&&f.is(":visible")&&(q.isAMEXCreditCard(a)?q.validateCreditCardCVV2(f,f,"A"):q.validateCreditCardCVV2(f,f));l&&l.length&&l.is(":visible")&&q.validateCreditCardMobile(l,l);g.is(":disabled")||t.is(":disabled")||
q.validateCreditCardDate(g,g.closest(".card-date").find(".a-button"),t,t.closest(".card-date").find(".a-button"));q.validateCreditCardName(m,m);q.validateCreditCardNumber(a,a);d&&q.validateSBIMaestroCardNumberLength(a,a);n&&n.length&&n.is(":visible")&&q.validateCreditCardPincode(n,n);q.displayErrors(c.find("#cardErrors"+b),c);0<B(".activateScrollToError").length&&0<B("#cardErrors").length&&B(h).scrollTop(B("#cardErrors").offset().top);return q.hasErrors()}function O(){if(d.isMobileCX()&&W){a.declarative("new-payment-methods",
["click"],function(a){a.$event.preventDefault();d.makeAjaxCall(a.data.href,{},{successHandler:function(a){if(a){var b=d.pages["new-payment-methods"].pageId;c.slideShow(B(b),a);d.scrollTopTo(B(b));a=B("#pageHeading");a.attr("tabindex","0").css("outline","none");a.focus()}}})});a.declarative("new-cc",["submit"],q);a.declarative("new-cc-inbox",["click"],u);H()?a.declarative("new-dd",["submit"],v):a.declarative("new-dd",["submit"],E);a.declarative("new-invoice",["submit"],E);a.declarative("new-brdc",
["submit"],q);a.declarative("new-verified-card",["click"],M);a.declarative("check-card-type",["change"],G);a.declarative("redirect-cup",["click","touchend"],w);a.declarative("cup-popover-close",["click"],D);a.declarative("new-ba",["submit"],function(a){var b=a.$target;if(b.find("#check-account-number").val()!==b.find("#check-account-number-confirm").val())return b.find("#check-errors").show(),b.find("#addBankAccount_AccountNumberMismatch").show(),b.find("[error\x3daddBankAccount_AccountNumberMismatch]").addClass("a-form-error"),
a.$event.preventDefault(),!1;E(a)});var b;a.declarative("check-terms-show",["click"],function(c){b=B(document).scrollTop();a.$("#check-terms-content").show();B(document).scrollTop(0)});a.declarative("check-terms-close",["click"],function(c){B(document).scrollTop(b);a.$("#check-terms-content").hide()});a.declarative("new-gc-promo",["click"],T);a.declarative("invoice-policy",["click"],function(a){a=a.$declarativeParent;a.find("i.a-icon-touch-link").hide();a.find("span.policy-preview").hide();a.find("span.policy-full").show()});
W=!1}}function T(a){var b=d.getInputValues(B("#new-gc-promo"));a.data.handler&&(b.handler=a.data.handler);d.makeAjaxCall(a.data.url,b,{successHandler:function(a,b,e){a&&(b=d.getPageId(e))&&c.slideShow(B(b),a)},completeHandler:function(a,b){B.isEmptyObject(y)||y.triggerAjaxLoadEvent()}});a.$event.preventDefault()}function H(){var a=B("#useDDNewErrorMessage");return a.length&&"1"===a.val()}var B=a.$,N=h.P&&h.P.AUI_BUILD_DATE,P={cc:{fieldId:"#form-add-credit-card",suffix:""},vcc:{fieldId:"#new-verified-credit-card",
suffix:"_VCC"},emi:{fieldId:"#newEmiCard",suffix:"_VCC"},vdc:{fieldId:"#new-verified-debit-card",suffix:"_VDC"},brdc:{fieldId:"#form-add-br-debit-card",suffix:"_BRDC"}},W=!0,t=B("input#isPipelinedPage");if(0<t.length&&"1"===t.val())a.on("checkout:reload:payselect",O);else O()});k.when("A","pay-common-util","ajax-utility","page-transition-controller","page-main","safe-mash","client-side-metrics","pay-gil","page-conductor","weblab-helper","ready").register("mobile-gil-estimates",function(a,d,c,e,b,
g,f,m,h,n){function k(a){m.actionCloseGilMobileSubpage(a);d.scrollTopTo(b.getSelectedPaymentRow());return!1}function y(a){e.show();m.actionSubmitGilMobileSubpage(a,w,D);return!1}function w(a,c,e){b.getSelectedPaymentRow().find('input[name\x3d"showIneligibleItemSubpage"]').val("");1==parseInt(u("input[name\x3d'gil-rendered-using-apx']").val(),10)&&n.isGILCreditCardEnabled()?(a=u(".pmts-select-payment-instrument-form"))&&0<a.length?h.continueClicked(null,a):f.increaseCount("Checkout:GIL:IneligibleSubpage:ErrorRedirectingToSPC",
1):u(d.pages.main.pageId).find("#continueButton").trigger("click")}function D(a){u("#gil-estimates-subpage").find(".gil-estimates-error").show()}function q(){d.isMobileCX()&&(a.declarative("gil-close-subpage",["click"],k),a.declarative("gil-submit-subpage",["click"],y))}var u=a.$;c=u("input#isPipelinedPage");if(0<c.length&&"1"===c.val())a.on("checkout:reload:payselect",q);else q()});k.when("A","page-main","ready").execute(function(a,d){var c=a.$,c=c("input#isPipelinedPage");if(0<c.length&&"1"===c.val())a.on("checkout:reload:payselect",
d.init);else d.init()});k.when("A","page-rewards","ready").execute(function(a,d){var c=a.$,c=c("input#isPipelinedPage");if(0<c.length&&"1"===c.val())a.on("checkout:reload:payselect",d.init);else d.init()});k.when("A","page-financial-offer","ready").execute(function(a,d){var c=a.$,c=c("input#isPipelinedPage");if(0<c.length&&"1"===c.val())a.on("checkout:reload:payselect",d.init);else d.init()});k.when("A","page-main","pay-common-util","client-side-metrics","mobile-carrier-billing-util","weblab-helper").register("jppoints-mobile",
function(a,d,c,e,b,g){function f(){l.gcCheckbox.is(":checked")||(l.redeemableAmount.text(l.redeemableAmountWithoutGC.val()),l.redeemableValue.text(l.redeemableValueWithoutGC.val()));l.gcRadio&&l.gcRadio.is(":checked")&&m();(u?l.redeemPoints.parents(".a-control-row"):l.redeemPoints.parent("label")).bind("click",A);var a=u?".a-control-row":"label";l.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]').closest(a).bind("click",y);l.jpPointsCustomAmount.bind("keyup",D);l.jpPointsCustomAmount.bind("click",
function(){l.useCustomPoints.attr("checked",!0);l.useCustomPoints.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");l.useMaxPoints.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active");z()||d.setContinueButtonStatus(!1)});(u?l.gcCheckbox.parents(".a-control-row"):l.gcCheckbox.parent("label")).bind("click",w);l.paymentRows.bind("click",function(){var a=q(this).find('input[type\x3d"radio"]');a&&a.length&&(0<a.filter("[value^\x3davailablebalance]").size()?
m():!g.isMCBMultiTenderWeblabEnabled()&&0<a.filter("[value^\x3dMCB]").size()?(m(),b.showMCBWarningMessageForPoints(l)):(l.redeemPoints.attr("disabled",!1),l.jppoints.find('input[type\x3d"radio"]').attr("disabled",!1),l.jppoints.find('input[type\x3d"checkbox"]').attr("disabled",!1),l.useCustomPoints.attr("disabled",!1),l.jpPointsCustomAmount.attr("disabled",!1),l.jppoints.find("#canApplyPoints").show(),l.jppoints.find("#cannotApplyPoints").hide(),b.hideMCBWarningMessageForPoints(l)))})}function m(){l.redeemPoints.attr("checked",
!1).attr("disabled",!0);l.redeemPoints.siblings("i").addClass("a-icon-touch-checkbox-inactive").removeClass("a-icon-touch-checkbox-active");l.jppoints.find('input[type\x3d"radio"]').attr("checked",!1).attr("disabled",!0);l.jppoints.find('input[type\x3d"checkbox"]').attr("checked",!1).attr("disabled",!0);l.jppoints.find("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active");l.useCustomPoints.attr("disabled",!0);l.jpPointsCustomAmount.val("");l.jpPointsCustomAmount.attr("disabled",
!0);l.jppoints.find("#canApplyPoints").hide();l.hiddenSection.hide();l.jppoints.find("#cannotApplyPoints").show()}function z(){if(u)return 0<l.paymentRows.filter("[data-ischecked\x3d1]").length;e.increaseCount("removeauijs48");return 0<l.paymentRows.filter("[ischecked\x3d1]").length}function n(){var a=q('input[type\x3d"radio"][name\x3d"paymentMethod"]');a.attr("checked",!1);a.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active");a.closest("label").attr("ischecked",
0)}function A(b){q(b.target);l.redeemPoints.siblings("i").toggleClass("a-icon-touch-checkbox-active").toggleClass("a-icon-touch-checkbox-inactive");l.redeemPoints.attr("checked",!l.redeemPoints.attr("checked"));if(l.redeemPoints.is(":checked")){l.hiddenSection.show();l.useMaxPoints.attr("checked",!0);l.useMaxPoints.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");b=parseInt(l.redeemableAmount.text(),10);var c=parseInt(l.jpPointsConversionRate.val(),10),
e=parseInt(l.purchaseTotalRaw.val(),10);l.gcCheckbox.is(":checked")&&(e-=parseInt(l.jpPointsCustomerGCValue.val(),10));c*b>=e?(n(),d.setContinueButtonStatus(!0)):z()||d.setContinueButtonStatus(!1)}else l.hiddenSection.hide(),l.useMaxPoints.attr("checked",!1),l.useMaxPoints.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),l.useCustomPoints.attr("checked",!1),l.useCustomPoints.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),
l.jpPointsCustomAmount.val(""),z()||d.setContinueButtonStatus(!1);k.when("installments-payselect-mobile").execute(function(b){a.trigger("installments-payselect-mobile:toggleJPPointsInstallmentEligibility",l.jppoints)});return!1}function y(b){var c=q(b.target);if(c.find("#jpPointsMax").length||c.siblings("#jpPointsMax").length){l.useMaxPoints.attr("checked",!0);l.jpPointsError.hide();l.jpPointsCustomAmount.val("");l.jpPointsCustomAmount.removeClass("a-form-error");l.useMaxPoints.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");
l.useCustomPoints.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active");var c=parseInt(l.redeemableAmount.text(),10),e=parseInt(l.jpPointsConversionRate.val(),10),c=c*e,e=parseInt(l.purchaseTotalRaw.val(),10);l.gcCheckbox.is(":checked")&&(e-=parseInt(l.jpPointsCustomerGCValue.val(),10));c>=e?(n(),d.setContinueButtonStatus(!0)):z()||d.setContinueButtonStatus(!1)}else l.useCustomPoints.attr("checked",!0),l.useCustomPoints.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive"),
l.useMaxPoints.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),l.jpPointsCustomAmount.focus(),z()||d.setContinueButtonStatus(!1);k.when("installments-payselect-mobile").execute(function(c){a.trigger("installments-payselect-mobile:toggleJPPointsInstallmentEligibility",q(b.currentTarget))});return!1}function w(){var a=l.gcCheckbox;if(!a.length&&(a=q('input[type\x3d"radio"][value\x3d"availableBalance"]'),!a.length))return;var b;a.is(":checked")?(a=parseInt(l.redeemableAmountWithoutGC.val(),
10),b=l.redeemableValueWithoutGC.val()):(a=parseInt(l.redeemableAmountWithGC.val(),10),b=l.redeemableValueWithGC.val());l.redeemableAmount.text(a);l.redeemableValue.text(b);D()}function D(){var b=parseInt(l.jpPointsCustomAmount.val(),10);if(!b||0>b)l.jpPointsCustomAmount.val(""),l.jpPointsCustomAmount.removeClass("a-form-error"),l.jpPointsError.hide();else if(l.jpPointsCustomAmount.val(b),parseInt(l.redeemableAmount.text(),10)<b)l.jpPointsError.show(),l.jpPointsCustomAmount.addClass("a-form-error");
else{l.jpPointsError.hide();l.jpPointsCustomAmount.removeClass("a-form-error");var c=parseInt(l.purchaseTotalRaw.val(),10),e=parseInt(l.jpPointsConversionRate.val(),10),e=b*e;if(l.gcCheckbox.is(":checked"))var f=parseInt(l.jpPointsCustomerGCValue.val(),10),e=e+f;e>=c?(n(),d.setContinueButtonStatus(!0)):z()||d.setContinueButtonStatus(!1);k.when("installments-payselect-mobile").execute(function(c){a.trigger("installments-payselect-mobile:actionToggleJPPointsSection",b)})}}var q=a.$,u=h.P&&h.P.AUI_BUILD_DATE,
l={},C={jppoints:"#jppoints",paymentRows:"#select-payments-view label.a-touch-radio",gcCheckbox:'input[type\x3d"checkbox"][name\x3d"useAvailableBalance"]',gcRadio:'input[type\x3d"radio"][value\x3d"availablebalance"]',hiddenSection:"#hiddenSection",jpPointsConversionRate:'input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]',jpPointsCustomAmount:'input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]',jpPointsCustomerGCValue:'input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]',jpPointsError:"#jpPointsError",
purchaseTotalRaw:'input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]',redeemableAmount:"#redeemableAmount",redeemableAmountWithGC:'input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]',redeemableAmountWithoutGC:'input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]',redeemPoints:"#redeemPoints",redeemableValue:"#redeemableValue",redeemableValueWithGC:'input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]',redeemableValueWithoutGC:'input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]',
useCustomPoints:"#jpPointsCustom",useMaxPoints:"#jpPointsMax",mcbPointsWarning:"#mcbPointsWarning"};u&&(C.paymentRows="#select-payments-view .a-touch-radio");a.on("checkout:reload:payselect",function(){c.isMobileCX()&&(c.refreshElements(l,C),l.jppoints&&l.jppoints.length&&f())})});k.when("A","pay-common-util").execute(function(a,d){function c(){e('.a-radio[data-isaddresschallenge\x3d"true"]').unbind("click").bind("click",function(){var a=e(this),c=a.find('input[type\x3d"radio"]').is(":checked"),d=
"1"===a.attr("isfocused");a.attr("isfocused",c?1:0);d&&c&&a.find("#addCreditCardNumber").focus()})}var e=a.$;a.on("checkout:reload:payselect",function(){var a;if(a=h.P&&h.P.AUI_BUILD_DATE){a=parseFloat;var g;g=navigator.userAgent.toLowerCase();g=g.match(/android\/([0-9\.]*)/);a=4.4===a(g?g[1]:0)}a&&(a=e("#useFocusFixForTextBoxWithinRadio"),a=a.length&&"1"===a.val());a&&d.isMobileCX()&&c()})});"use strict";k.when("A","ready").register("purchase-order-number-trial",function(a){function d(){}function c(){}
var e=a.$;a.on("checkout:reload:payselect",function(){var a=e(".checkout-page-form");a&&0!==a.length&&parseInt(a.attr("data-trial-po-number"),10)&&e('#existing-loc-accounts input[type\x3d"text"]').each(function(a){var b=e(this);b.unbind("change").bind("change",function(){var a=b.val();if(a&&0!==a.length){var g;if(b.attr("name")){var h=b.attr("name").split(".");h&&2===h.length&&(g=h[1])}g&&0!==g.length&&e.ajax({type:"POST",url:"/gp/buy/payselect/handlers/set-po-number-trial.html",data:{purchaseOrderNumber:a,
paymentMethodId:g},dataType:"text",async:!0,success:d,error:c,cache:!1})}})})})});"use strict";k.when("A","safe-mash","a-dropdown","client-side-metrics","ready").execute(function(a,d,c,e){function b(){setTimeout(function(){f("#stop-mash-reappear").remove()},100)}function g(a,g){a.append('\x3cdiv id\x3d"stop-mash-reappear" /\x3e');f("#ccScannerUsed").val(1);var k=[1],y="undefined"!==typeof h.ue&&"undefined"!==typeof h.ue.count;y&&!d.showCardScanner?h.ue.count("ccScannerFailureMashFtNotFound",1):d.showCardScanner({cardTypes:k,
successCallback:function(d){if(d&&d.cardData){d=d.cardData;var k;f.isArray(d.number)&&d.number.length&&(k=d.number[0].value);if(k){y&&h.ue.count("ccScannerSuccess",1);a.find("#card-scanner-feature").addClass("aok-hidden");a.find("#addCreditCardNumber").val(k);k=null;if(f.isArray(d.expirationMonth)&&f.isArray(d.expirationYear)&&d.expirationMonth.length&&d.expirationYear.length){var q=parseInt(d.expirationYear[0].value,10);100>q&&(q+=2E3);q>=(new Date).getFullYear()&&(k={month:""+parseInt(d.expirationMonth[0].value,
10),year:""+q})}if(k){y&&h.ue.count("ccScannerSuccessWithMonth",1);var u=a.find("#ccMonth");d=a.find("#ccYear");if(0>=u.length||0>=d.length){b();g&&a.find("#confirm-card").trigger("click");return}m?(c.getSelect(u).val(k.month),c.getSelect(d).val(k.year)):(e.increaseCount("removeauijs34"),u.val(k.month),q=u.siblings("a.a-placeholder"),u=u.find("option[value\x3d"+k.month+"]").text(),q.html(u),d.val(k.year),q=d.siblings("a.a-placeholder"),d=d.find("option[value\x3d"+k.year+"]").text(),q.html(d))}d=!1;
q=a.find("#card-scanner-success-messages");f("#ccName").val()||(q.find("#cc-scan-missing-name").removeClass("aok-hidden"),d=!0);k||(q.find("#cc-scan-missing-exp-date").removeClass("aok-hidden"),d=!0);d&&q.removeClass("aok-hidden")}else y&&(h.ue.count("ccScannerFailure",1),h.ue.count("ccScannerFailureNoNum",1));b();g&&a.find("#confirm-card").trigger("click")}else b()},failCallback:function(a){y&&(h.ue.count("ccScannerFailure",1),h.ue.count("ccScannerFailureError",1));b()}})}var f=a.$,m=h.P&&h.P.AUI_BUILD_DATE;
a.declarative("card-scanner",["click"],function(a){a.$event.preventDefault();a=a.$currentTarget.parents("#add-new-cc, #new-cc, #new-cc-inbox");g(a,!1)});a.declarative("card-scanner-addr-challenge",["click"],function(a){a.$event.preventDefault();a=a.$currentTarget.parents(".payment-box, .payment-row");g(a,!0)})});"use strict";k.when("page-detector","A","ready").register("third-party-account-alternative",function(a,d){var c=d.$;d.declarative("a-third-party-payment-select",["click"],function(a){var b=
null;a.data&&a.data.value?b=a.data.value:(a=a.$target.closest(".payment-alternate"),a.length&&(b=a.data("value")));b&&c("#third-party-select").val(b)});d.on("checkout:reload:payselect",function(){if(a.isMobile()){var d=c(".payment-alternate");d.length&&(d=d.find("input[type\x3d'radio']:checked"),d.length&&d.click())}else if(d=c("#third-party-account").find(".payment-alternate"),0!==d.length){var b=c("#pm-third-party-account");b.length&&b.is(":checked")&&(b=c("#third-party-select").val(),d=d.filter("[data-value\x3d"+
b+"]"),d.length&&(d.addClass("payment-selected"),d.find("input").prop("checked",!0)))}})});"use strict";k.when("A","ready").register("credit-card-autopopulated-fields-clear",function(){});"use strict";k.when("A","ready").register("credit-card-number-format-spacing",function(){});"use strict";k.when("A","ready").register("payselect-enhancements",function(){});"use strict";k.when("A","page-transition-controller","scroll-controller","checkout-modal-popover","page-conductor","checkout-general-utils",
"safe-mash","weblab-helper","client-side-metrics").register("itemselect-controller",function(a,d,c,e,b,g,f,m,k){function n(a){w(a.data);a.$event.preventDefault();a=a.$target.closest(J?"button[type\x3dbutton]":"input[type\x3dbutton]");var b={};b[a.attr("name")]=a.val();v("#isAdditionalStmaLoggingEnabled").length&&"1"===v("#isAdditionalStmaLoggingEnabled").val()&&(v("#isItemSelectRedesignEligible").length&&v("#isItemSelectRedesignEligible").val(),k.increaseCount("Checkout:ItemSelect:DeleteItem:Clicked:Redesign:".isItemSelectRedesignEligible,
1));A(b)}function A(a){d.show();var c=v("form#changeQuantityFormId"),e=c.serialize(),e=e+("\x26"+v.param(a));a={"x-amz-checkout-page":"itemselect"};m.isPipelineDispatchSendHeaderEnabled()&&(a=b.setAjaxTransitionHeader(a));v.ajax({type:"POST",url:c.attr("action"),data:e,dataType:"text",headers:a,error:b.ajaxRedirect,success:y})}function y(a,c,e){var f=e.getResponseHeader("x-amz-checkout-new-cart-quantity");g.updateCartByMash(f);f=e.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==f&&f!==
E?(d.hide(),h.location=f):b.ajaxUpdatePage(a,c,e,{pushNewFrame:"false"})}function w(a){""!==a&&v("form#changeQuantityFormId").attr("action",a)}function D(){d.hide();h.location="/gp/aw/c/ref\x3dox_spc_deal_expired?app-action\x3dcart"}function q(){c.toggleScrollOn();v("div.stma-line-item-hidden-fields input[name^\x3dpreviousQuantity]").each(function(){var a=v(this);if(a.attr("name")&&17<a.attr("name").length){var b=a.attr("name").substring(17);v('div.stma-line-item-details input[name\x3d"quantity.'+
b+'"]').val(a.val())}})}function u(a){function b(a){var c=v("#stma-address-selector"),d=a.data("itemCount"),e=a.data("addressSelectorName"),f=v("#address-item-id-"+d).val();a=a.data("ineligibleAddresses");v("#address-selector-selector").val(e);v("#address-selector-id").val(f);v("#address-selector-num").val(d);c.find(".addressLine").removeClass("a-active");c.find("."+f).addClass("a-active");v("#stma-page-container").hide();v("#stma-page-header").hide();J&&v("#stma-page-footer").hide();c.show();l(a)}
L||(L={value:!1},"1"===v("#rmMultiaddress2ndBackApp").val()&&(L.value=f&&f.navigate&&v("#checkoutDisplayPage").data("useMashNavigateForTransitions")));L.value?f.navigate({url:null,transitionEffect:"slide",successCallback:function(){b(a);h.history.pushState({multipleAddressPageMarker:!0},"");h.history.pushState(null,"");var c=h.onpopstate;h.onpopstate=function(a){a.state.multipleAddressPageMarker&&(G(),h.onpopstate=c,h.history.back())}},failCallback:function(a){}}):b(a)}function l(a){v(".addressLine").prop("disabled",
!1);v(".addressLine").show();v(a.split(" ")).each(function(){v("#"+this).prop("disabled",!0).hide()});var b=v("#filterMessage");a?b.show():b.hide()}function C(a){var b="#"+v("#address-selector-selector").val();if(v(b).hasClass("pantry-item")&&(b=v(".pantry-item"),!(2>b.length))){var c=a.data("addressid"),d=a.data("addresskey"),e=a.data("addresshtml");b.each(function(){var a=v(this);if(a.val()===d)return!0;var b,f=a.parents("a[data-item-count]")[0];f&&(b=v(f).attr("data-item-count"));b&&(a.val(d),
v("#address-item-id-"+b).val(c),v("#isItemSelectRedesignEligible").length&&"1"===v("#isItemSelectRedesignEligible").val()?M(b,e):v("#address-item-display-"+b).text(e))})}}function G(){v("#stma-page-header").show();v("#stma-page-container").show();J&&v("#stma-page-footer").show();v("#stma-address-selector").hide()}function M(a,b){var c=v("#address-item-id-"+a).closest(".stma-line-item-details").find(".line-item-level-messages");c.length&&(c.hide(),v("#selected-address-"+a).removeClass("aok-hidden"));
v("#address-item-display-"+a).text(b)}var v=a.$,J=h.P&&h.P.AUI_BUILD_DATE,L=null;a.on("checkout:reload:itemselect",function(){v("form#changeQuantityFormId").attr("action",v("form#changeQuantityFormId").attr("action")+"\x26action\x3dcontinue");a.defer(function(){v("html").hasClass("a-touch")&&v("a[target\x3d'AmazonHelp']").removeAttr("onclick")});0<v("div.checkout-stma-tablet").length&&v(".quantity-field").unbind("keypress.stma-qty-field").bind("keypress.stma-qty-field",function(b){13===b.which&&(b.preventDefault(),
d.show(),a.trigger("a:declarative:ship-to-multiple-continue:click"),v("form#changeQuantityFormId").submit())});var b=v("#addon-indicator");if(b.data("hasAddonItems")){var e=b.data("addonWarningType"),e=v("#addon-warning-"+e+"-launcher");e.length&&(b.data("showAddressTitle")?(v("#a-popover-addon-warning-normal .select-address-title").show(),v("#a-popover-addon-warning-normal .delete-title").hide(),v("#a-popover-addon-warning-normal .reduce-title").hide()):(v("#a-popover-addon-warning-normal .delete-title").show(),
v("#a-popover-addon-warning-normal .reduce-title").hide(),v("#a-popover-addon-warning-normal .select-address-title").hide()),e.trigger("click"),c.scrollToTop(),c.toggleScrollOff())}});(function(){a.declarative("stma-delete-item",["click"],function(a){n(a)});a.declarative("ship-to-multiple-delete",["click"],function(a){0<v("div.checkout-stma").length&&(v(".quantity-delete-button[data-entity-id\x3d'"+a.$currentTarget.data("entityId")+"']"),h.confirm(v("#addressConfirmDeletion").val())?n(a):a.$event.preventDefault())});
a.declarative("ship-to-multiple-continue",["click"],function(a){w(a.data)});a.declarative("stma-items",["click"],function(a){a=a.$currentTarget;var b=v("#stma-address-selector"),c=a.data("addressid"),d=a.data("addresskey");b.find(".addressLine").removeClass("a-active");b.find("."+c).addClass("a-active");b="#"+v("#address-selector-selector").val();v(b).val(d);d=v("#address-selector-num").val();v("#address-item-id-"+d).val(c);c="#address-item-display-"+d;a=a.data("addresshtml");v("#isItemSelectRedesignEligible").length&&
"1"===v("#isItemSelectRedesignEligible").val()?M(d,a):v(c).text(a);L.value?f.goBack():G()});a.declarative("stma-address-select",["click"],function(a){v("#isAdditionalStmaLoggingEnabled").length&&"1"===v("#isAdditionalStmaLoggingEnabled").val()&&(v("#isItemSelectRedesignEligible").length&&v("#isItemSelectRedesignEligible").val(),k.increaseCount("Checkout:ItemSelect:ChangeAddress:Clicked:Redesign:".isItemSelectRedesignEligible,1));u(a.$currentTarget)});a.declarative("stma-back",["click"],function(a){a.$event.preventDefault();
G()});a.declarative("addon-return-to-cart",["click"],function(a){0<v("div.checkout-stma-mobile").length&&D()});a.declarative("addon-delete-items",["click","touchend"],function(a){0<v("div.checkout-stma").length&&(a.$event.preventDefault(),c.toggleScrollOn(),a=v("input#updateLinkAction").val(),w(a),A({"deleteAddon.x":1,"deleteAddon.y":1}))});a.declarative("addon-dont-delete",["click","touchend"],function(a){0<v("div.checkout-stma").length&&q()});a.declarative("stma-items",["click"],function(a){C(a.$currentTarget)});
a.on("a:popover:hide:addon-warning-normal",function(a){0<v("div.checkout-stma-mobile").length?D():0<v("div.checkout-stma-tablet").length&&q()});a.on("a:popover:hide:addon-warning-special",function(a){0<v("div.checkout-stma").length&&q()})})()});"use strict";k.when("A","checkout-general-utils").register("checkout-confirm-action",function(a,d){var c;a.declarative("a-checkout-confirm-action",["click","touchend"],function(c){if(!d.protectAgainstDoubleAction("checkout-confirm-action")){var b=a.$("#rcx-confirm-"+
c.data.confirmAction).find("#rcx-modal-trigger"),g=b.data("a-checkout-modal-popover");g.data=c.data;b.data("a-checkout-modal-popover",g);setTimeout(function(){b.trigger("click")},30)}});a.declarative("a-popover-confirm",["click","touchend"],function(e){d.protectAgainstDoubleAction("popover-confirm")||(e=e.data,c&&c.data&&e&&a.trigger("a:declarative:"+e,c.data),c&&c.$popover.find("button[data-action]\x3da-popover-close").trigger("click"))});a.on("a:popover:show:checkout-confirm",function(d){c=d.popover;
d=c.$popover.find(".a-popover-inner");var b=a.$("#rcx-confirm-"+c.data.confirmAction).find("#rcx-confirm-template").html();d.html(b);c.updatePosition()});a.on("a:popover:hide:checkout-confirm",function(){c=null})});"use strict";k.when("A").register("pip-controller",function(a){var d=a.$;a.on("checkout:reload:pip",function(){d(".checkout.checkout-pip").length||d("head .aui-page-asset").attr("disabled",!0);d("head .old-pipeline-asset").attr("disabled",!0);0<d("#disablePIPPrefetch").length?(d(".prime-checkout-continue-link").removeClass("checkout-continue-link"),
d(".prime-checkout-continue-form").removeClass("checkout-page-form")):(d(".prime-checkout-continue-link").addClass("checkout-continue-link"),d(".prime-checkout-continue-form").addClass("checkout-page-form"))})});"use strict";k.when("A","page-detector").register("locker-promo-controller",function(a,d){function c(){var a=b("#locker-search-link"),c=a.attr("href");a.attr("href",c+"\x26hasWorkingJavascript\x3d1");b("#locker-promo-checkbox-link").addClass("has-js")}function e(){b("#locker-promo-checkbox-link").addClass("has-js");
if(b("#locker-promo").hasClass("trigger-interstitial")){var a=b("#locker-high-vis-promo-title");setTimeout(function(){a.trigger("click")},50)}}var b=a.$;b("html").hasClass("a-ie6")||(a.on("checkout:reload:spc",c),a.on("checkout:reload:shipoptionselect",e))});"use strict";k.when("A","page-transition-controller","scroll-controller","loading-spinner-controller","page-conductor","checkout-general-utils").register("store-search-popover-controller",function(a,d,c,e,b,g){function f(){if(0<Q&&"undefined"!==
typeof h.Map)try{h.Map.getMapAndIcons(),v=!0}catch(a){--Q,setTimeout(f,500)}Q=20}function m(){N=0;u.find("button.a-button-close").trigger("click")}function k(a){var b=q("#locker-promo");b.hasClass("trigger-interstitial")&&(b.removeClass("trigger-interstitial"),D(B),0<q("#lockerInterstitialHeader").length&&q("#lockerInterstitialHeader").hide(),q.ajax({type:"POST",url:"/gp/azbox/interstitial/handlers/interstitial-opt-out.html/ref\x3d"+a,dataType:"html",cache:!1,headers:{"x-amz-checkout-page":"sosp"}}))}
function n(a){a.filter("style").each(function(){var a=this.text||this.textContent||this.innerHTML||"";if(null!==a){var b=document.createElement("style");b.type="text/css";b.styleSheet?b.styleSheet.cssText=a:b.appendChild(document.createTextNode(a));u.find("#storeResultContent").append(b)}})}function A(a){a.filter("script").each(function(){if(this.src)0<this.src.indexOf("mapcontrol")&&(E=this.src);else{var a=this.text||this.textContent||this.innerHTML||"";if(null!==a){var b=document.createElement("script");
b.type="text/javascript";b.text=a;u.find("#storeResultContent").append(b)}}})}function y(a,d){a.find("div#wrapper").css("width","100%");a.find("div#ft").hide();e.hideSpinner(J);J.show();J.html(a.find("div#wrapper"));J.css({"overflow-y":"scroll"});u.css("position","absolute");u.css("top","50px");q("#storeResultContent").css("height",O+"px");n(a);A(a);null!==E&&!1===v?q.ajax({url:E,async:!1,success:f,dataType:"script",error:function(a,c,d){b.ajaxRedirect(a,c,d)}}):f();c.scrollToTop();c.toggleScrollOff()}
function w(a){J=l.$popover.find("#storeResultContent");e.showSpinner(J);q.ajax({type:"POST",url:a,dataType:"html",data:{defaultStoreUpsellSelectedAddressId:W},async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:function(a,c,d){null!==a?(c=q(a),0<c.find("div.errorblock").length?(e.hideSpinner(J),J.show(),J.html(c.find("div.errorblock").parent())):0<c.find("input[name\x3drefineSearch]").length?(G=c.find("form[name\x3dlocationForm]"),null!==G&&(G.find("input").attr("id","storeSearchRefineButton"),
G.parent().find("h1").css("color","black")),y(c,a)):0<c.find("div#wrapper").length?(c.find("#wrapper").find("tr:first").children("td")[0].style.width="49%",c.find("#wrapper").find("tr:first").children("td")[1].style.width="2%",c.find("#wrapper").find("tr:first").children("td")[2].style.width="49%",c.find("#sl_map").css("width","100%"),c.find("#whatsThisPopoverLink").removeAttr("href"),c.find("#whatsThisPopoverLink").addClass("a-declarative"),c.find("#whatsThisPopoverLink").css("a-declarative"),c.find("#whatsThisLink").addClass("a-declarative"),
c.find("#whatsThisLink").attr("data-action","a-tooltip"),d='{"position":"triggerBottom","content":"'+R+'"}',c.find("#whatsThisLink").attr("data-a-tooltip",d),c.find("#whatsThisLink").css("max-width","100px"),c.find("input[name\x3dshipToThisAddress]").attr("src",L),c.find("input[name\x3dshipToThisAddress], span.default-store-upsell-selected-address").parent().css("text-align","center"),c.find("input[name\x3dshipToThisAddress], span.default-store-upsell-selected-address").parent().css("vertical-align",
"middle"),C=c.find("table.storesearchtable").parent(),C.find("label").css("display","inline"),c.find("table.storesearchtable").parent().append(H),c.find("table.storesearchtable").parent().find("div#lockerPromoPopover").show(),y(c,a)):h.location.reload()):b.ajaxRedirect()},error:function(a,c,d){b.ajaxRedirect(a,c,d)}})}function D(a){u.find("div.a-popover-header h4").text(a)}var q=a.$;if(!q("html").hasClass("a-ie6")){var u,l,C,G,E=null,v=!1,J,L,R,Q=20,O,T,H,B,N,P,W;a.on("a:popover:hide",function(a){a.popover&&
a.popover.name&&a.popover.name.indexOf("store-search-popover")});q(document).delegate("#storeResultContent input.storesearchprimaryinput","click",function(a){a.preventDefault();q(this).parent().parent().find("input[type\x3dradio]").attr("checked","checked")});q(document).delegate("#storeResultContent input[name\x3dshipToThisAddress]","click",function(a){a.preventDefault();a=q(this).parents().find("form")[0].action;a+="?usecase\x3dcheckout\x26hasWorkingJavascript\x3d1\x26shipToThisAddress\x3dContinue";
var b=q(this).parent().parent().find("input:hidden"),c,e;for(e=0;e<b.length;e++){c=b[e].name;var f=b[e].value;if(N&&P&&"storeUpsellAddressId"===c&&f){c=g.addQueryStringParameter(P,"storeUpsellSelectedAddressId",f);break}c=a=a+"\x26"+c+"\x3d"+f}m();d.show();g.redirectWithJavascript(c)});q(document).delegate("#storeResultContent input[name\x3dshowDetailedMap]","click",function(a){a=a.$target[0].id.replace("pinpointImage_idx_","");"undefined"!==typeof h.Map&&h.Map.selectPin(a-1)});q(document).delegate("#storeResultContent input[name\x3dsearchStoreByName]",
"click",function(a){a.preventDefault();G=u.find("form");a=G[0].action;a+="?usecase\x3dcheckout\x26hasWorkingJavascript\x3d1\x26searchStoreByName\x3dContinue";var b=G.find("input:hidden"),c;for(c=0;c<b.length;c++)a=a+"\x26"+b[c].name+"\x3d"+b[c].value;w(a)});q(document).delegate("#storeResultContent #storeSearchRefineButton","click",function(a){a.preventDefault();G=u.find("form[name\x3dlocationForm]");a=G[0].action;a+="?usecase\x3dcheckout\x26hasWorkingJavascript\x3d1\x26";var b=G.find("input:hidden"),
c;for(c=0;c<b.length;c++)a=a+"\x26"+b[c].name+"\x3d"+b[c].value;w(a)});q(document).delegate("#storeResultContent div.storesearchaction input","click",function(a){a.preventDefault();C=u.find("#new-store").parent().find("form");var b=C.find("input:checked")[0].value;a=C[0].action;var c=C.find("input:checked")[0].name,d=u.find("#"+b)[0].name,e=u.find("#"+b)[0].value;a=a+"?usecase\x3dcheckout\x26hasWorkingJavascript\x3d1\x26"+c+"\x3d"+b+"\x26"+d+"\x3d"+e;for(b=0;b<C.find("select").length;b++)c=C.find("select")[b].name,
d=C.find("option:checked")[b].value,a=a+"\x26"+c+"\x3d"+d;c=C.find("input:hidden");for(b=0;b<c.length;b++)a=a+"\x26"+c[b].name+"\x3d"+c[b].value;w(a)});q(document).delegate("div#promoFooter button","click",function(a){k("sosp_locker_tp_optout_nt");m()});q(document).delegate("div.a-popover-header button.a-button-close","click",function(a){k("sosp_locker_tp_optout_cb")});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("store-search-popover")){var b=q(h).width(),
c=q(h).height(),b=parseInt(.88*b,10);O=parseInt(.62*c,10);var d=a.popover.$trigger.data("locker-search-url");u=a.popover.$popover;l=a.popover;B=u.find("div.a-popover-header h4").text();q("#locker-promo").hasClass("trigger-interstitial")&&(D(a.popover.$trigger.data("header-interstitial")),0<q("#lockerInterstitialHeader").length&&q("#lockerInterstitialHeader").show(),d=a.popover.$trigger.data("locker-search-url-interstitial"),O=parseInt(.45*c,10));q("#storeResultContent").css("height",O+"px");q("#storeResultContent").css("width",
b+"px");u.css("position","absolute");u.css("top","50px");l.updatePosition(!0);T=u.find("div#lockerPromo");H=T.clone(!0);H.attr("id","lockerPromoPopover");u.find("#storeResultContent").empty();L=a.popover.$trigger.data("locker-search-button");a.popover.$trigger.data("locker-search-disabled-button");R=a.popover.$trigger.data("restricted-locker-disclaimer-text");N=0;w(d)}});a.on("a:popover:show:store-upsell-ship-options",function(a){var b=q(h).width(),c=q(h).height(),b=parseInt(.88*b,10);O=parseInt(.62*
c,10);c=a.popover.$trigger.data("store-search-url");u=a.popover.$popover;l=a.popover;q("#storeResultContent").css("height",O+"px");q("#storeResultContent").css("width",b+"px");u.css("position","absolute");u.css("top","50px");l.updatePosition(!0);T=u.find("div#store-upsell-pickup-instructions");H=T.clone(!0);H.attr("id","lockerPromoPopover");u.find("#storeResultContent").empty();L=a.popover.$trigger.data("store-search-button-url");R=a.popover.$trigger.data("restricted-store-disclaimer-text");N=1;P=
a.popover.$trigger.data("store-select-pickup-url");W=a.popover.$trigger.data("default-store-upsell-selected-address-id");w(c)});a.on("a:popover:hide:store-upsell-ship-options",function(a){N=0})}});"use strict";k.when("A","page-detector-current-page","first-load-dependencies-base","client-side-metrics","weblab-helper").register("first-load-dependencies",function(a,d,c,e,b){var g=a.$,f=["shared-kitchensink","page-transition-controller","page-conductor","page-conductor-mpp","checkout-federation-injector"];
h.P&&h.P.AUI_BUILD_DATE||(e.increaseCount("removeauijs62"),f.concat(["checkout-modal-popover","form-icon-controller"]));e={accesspoint:["accesspoint-search-controller"],deliverypreference:["delivery-preference-controller"],shipaddressselect:"as-controller as-faf-controller as-tablet-controller as-locker-mobile-controller address-book-controller address-utilities what-if-im-not-in-delivery-preferences weekend-availability-loader".split(" "),billingaddressselect:["as-controller","as-tablet-controller",
"address-book-controller"],editaddress:["as-controller","as-tablet-controller","weekend-availability-loader"],giftselect:["gift-form-controller","gift-form-del-opt-controller","widgets/giftOptions/giftOptions"],itemselect:["itemselect-controller","itemselect-quantity-controller","address-popovers","itemselect-address-controller","address-popovers"],newaddress:["what-if-im-not-in-delivery-preferences","weekend-availability-loader"],payselect:"pay-common-lib pay-common-util pay-gil pay-validator pay-credit-card existing-payments jppoints page-slide page-main page-rewards mobile-new-payments mobile-gil-estimates jppoints-mobile purchase-order-number-trial otp-for-cod mobile-carrier-billing-util emi-helper instant-bank-discount-helper rentals-ineligible".split(" "),
payauth:["pay-auth"],pip:["pip-controller"],shipoptionselect:["shipoptionselect-controller","deliv-prefs-sosp","scheduled-delivery-readiness-checker"],spc:"delivery-preferences-controller gc-redeem-controller gift-popover-controller inline-address-popover-controller thirdparty-redirect-popover-controller inline-fps-balance-controller inline-points-controller order-summary-controller-mpp place-order-controller prime-decline-controller quantity-update-controller shipping-speed-selection-controller time-preferences-controller verification-checkbox-controller installments-controller pay-validator page-conductor toggle-pyo-button toggle-pyo-button-common spc-apx-standin".split(" "),
spclite:["verification-checkbox-controller","get-final-results-update"],throttle:["checkout-throttle-error"]};b.isSospCalendarFixEnabled()&&e.shipoptionselect.push("load");d=d.getCurrentPage();var m=g.merge(f,e[d]||[]);a.on("afterReady",function(){c.allDependenciesCheck(m)})});"use strict";k.when("A","ready").execute(function(a){function d(){c()?f("span.#button_verify").removeClass("a-button-disabled").find('input[type\x3d"submit"]').removeAttr("disabled"):f("span.#button_verify").addClass("a-button-disabled").find('input[type\x3d"submit"]').attr("disabled",
"disabled")}function c(){var a=!0;f('input[type\x3d"text"]:visible').each(function(){var b=f(this);a=b.val()?"documentNumber"===b.attr("name")&&10!==b.val().length||"birthdate"===b.attr("name")&&7!==b.val().length||"expiry"===b.attr("name")&&7!==b.val().length?!1:!0:!1;if(!a)return!1});return a}function e(){f('input[type\x3d"radio"][name\x3d"idType"]').change(function(){f(".container").removeClass("newGermanId oldGermanId passportId").addClass(this.value);f('input[type\x3d"text"]:visible').each(function(){f(this).val("")});
d()})}function b(){a.on("a:dropdown:selected:idType",function(a){f(".container").removeClass("newGermanId oldGermanId passportId").addClass(a.value);f('input[type\x3d"text"]:visible').each(function(){f(this).val("")});d()})}function g(){f("form").submit(function(a){f("#documentNumber").attr("name","");f("#expiry").attr("name","");return!0})}var f=a.$;a.on("checkout:reload",function(){if(0<f(".checkout-ageEntry").length){var a=0<f(".checkout-ageEntry-mobile").length;f(".checkout-age-verification-inputs").removeClass("nojs").addClass("js");
a?(a=f("#idSelector option:selected").attr("value"),-1<["newGermanId","oldGermanId","passportId"].indexOf(a)?f(".container").removeClass("newGermanId oldGermanId passportId").addClass(a):f(".container").removeClass("newGermanId oldGermanId passportId").addClass("newGermanId")):(a=f('input[type\x3d"radio"]:checked').val(),f(".container").removeClass("newGermanId oldGermanId passportId").addClass(a));d();-1<f(location).attr("href").indexOf("age-verification")&&h.history.replaceState({page:"ageDisplay"},
"","/gp/buy/age-verification/handlers/display.html");f('input[type\x3d"text"]').keyup(d);e();b();g()}})});"use strict";k.when("A","ready").execute(function(a){var d=a.$;d(document).ready(function(){d("#changeCORForm").find("#learnMorePopoverLinkPhoneNumber").remove()});d("#changeCORForm").submit(function(){var c={};d(this).find("input").each(function(a,b){c[b.name]=b.value});d(this).find("select").each(function(a,b){c[b.name]=b.options[b.selectedIndex].value||b.options[b.selectedIndex].innerHTML});
a.ajax("/gp/buy/dsv/handlers/change-country-setting.html",{method:"post",params:c,success:function(a){a.success?d("#continueCheckout").submit():"FormErrors"===a.error?d("#dsvAddressForm").html(a.newForm):"DependencyFailure"===a.error?d("#continueCheckout").submit():d("#showWereSorryPage").submit()},error:function(a){d("#continueCheckout").submit()}});return!1})});"use strict";k.when("A","client-side-metrics").execute(function(a,d){var c=a.$;a.declarative("imb-enter-cvv","click",function(a){d.increaseCount("checkout:spc:desktop:expresscheckout:imbclicked");
(a=a.data)&&a.focusTarget&&(a=c("#"+a.focusTarget))&&a.length&&a.focus()})});"use strict";k.when("A","place-order-controller","button-blocker","ready").register("toggle-pyo-button",function(a,d,c){var e=a.$;return{disable:function(){var a=e("form#spc-form");a&&a.length&&(a=a.find(".continue-button-blocker"))&&a.length&&(a=a.find("input").data("blockerText"),c.show("place-order-cvv-error",a))},enable:function(){var a=e("form#spc-form");a&&a.length&&c.hide("place-order-cvv-error")}}});"use strict";
k.when("A","pay-validator","toggle-pyo-button","page-conductor").register("toggle-pyo-button-common",function(a,d,c,e){function b(a){return n("\x3cinput\x3e").attr({type:"hidden",name:"returnjson",id:"returnjsonel",value:a})}function g(a){if(!y&&"1"!==h()){var c=b((new Date).getTime());c.appendTo(a);e.submitFormAjax(a,function(a){y=!1;try{var b=JSON.parse(a);if(b&&b.isOK){var c=b.responseTimestamp;c>A&&(A=c,f(b.isOK))}}catch(d){}},function(){y=!1;f(0)},E,{action:"/gp/buy/spc/handlers/set-payment.html"});
y=!0;c.remove()}}function f(a){var b=n("input[name\x3dINExpressCheckoutSetPayment]");b&&b.length&&b.val(a)}function h(){var a=n("input[name\x3dINExpressCheckoutSetPayment]");if(a&&a.length)return a.val()}function k(a,b,d){function e(a){var h=n("#spc-form"),m=n(a.currentTarget),k=parseInt(m.attr("maxlength"),10),w=k,m=m.val(),u=!1;m&&k&&!isNaN(k)&&(b===d.isValidCardCVV?u=b(m,k):b===d.isValidCardPincode&&(6===k&&(w=5),u=b(m,w,k)));u?(c.enable(),g(h)):(c.disable(),f(0));h&&h.length&&13===a.keyCode&&
h.submit()}a.keyup(e);a.change(e)}var n=a.$,A=0,y=!1;a.on("checkout:reload:spc",function(){var a=n("#spc-form");if(a&&a.length&&(a=n("input[name\x3disINExpressCheckoutCC]"))&&a.length&&1===parseInt(a.val(),10)){var a=d.create(),b=a.isValidCardCVV,e=n("#existingCvvNum"),e=e&&e.length?e:n("input[name\x3daddCreditCardVerificationNumber]");e&&0!==e.length||(e=(e=n("#addCreditCardPincode"))&&e.length?e:n("input[name\x3daddCreditCardPincode]"),b=a.isValidCardPincode);a=e&&0!==e.length?{inputEl:e,inputValidator:b,
validator:a}:E;if(a){k(a.inputEl,a.inputValidator,a.validator);c.disable();return}}c.enable()})});"use strict";k.when("A","mash","client-side-metrics","ready").register("gc-scan-to-claim",function(a,d,c){function e(){setTimeout(function(){h("#stop-mash-reappear").remove()},100)}function b(a){e();c.increaseCount("gcScannerOnRCXFailureError",1);a.code===d.cardScanError.CANNOT_OPEN_CAMERA?c.increaseCount("gcScannerOnRCXFailureError:cannotOpenCamera",1):a.code===d.cardScanError.INVALID_CARD_TYPE?c.increaseCount("gcScannerOnRCXFailureError:invalidCardType",
1):a.code===d.cardScanError.NO_SUPPORTED_CARD_TYPES&&c.increaseCount("gcScannerOnRCXFailureError:unsupportedCardType",1)}function g(b){b?(b=b.cardData)?(b=b.number)?(14>b.length&&c.increaseCount("gcScannerOnRCXMashError:invalidClaimCodeLength",1),b=14>b.length?b:b.replace(/^(.{4})(.{6})(.+)?$/,"$1-$2-$3"),(h("#spc-gcpromoinput").length?h("#spc-gcpromoinput"):h("#gcpromoinput")).val(b),c.increaseCount("gcScannerOnRCXSuccess:showClaimCode",1),a.state.replace("cxt-gc-redemption-method",{method:"scan"}),
(h("#apply-gc-button").length?h("#apply-gc-button"):h("#button-add-gcpromo")).trigger("click"),a.trigger("gc:scan:rcx:success")):(c.increaseCount("gcScannerOnRCXMashError:noClaimCode",1),e()):(c.increaseCount("gcScannerOnRCXMashError:noCardData",1),e()):(c.increaseCount("gcScannerOnRCXMashError:noCardInfo",1),e())}function f(a){a.$event.preventDefault();h("#apply-gc-button-container").append('\x3cdiv id\x3d"stop-mash-reappear" /\x3e');c.increaseCount("gcScannerOnRCXSuccess:clickOnScanButton",1);d.showCardScanner({cardTypes:[2],
successCallback:g,failCallback:b})}var h=a.$;a.declarative("gc-scan","click",f);a.declarative("gc-scan-input-box","keyup change",function(a){a=h("#spc-gcpromoinput").length?h("#spc-gcpromoinput"):h("#gcpromoinput");var b=h("#apply-gc-button-container");0<h.trim(a.val()).length?b.removeClass("hidden"):b.hasClass("hidden")||b.addClass("hidden")});return 0>=h("div#gc-promo-delay").length?{showScanner:a.constants.NOOP}:{showScanner:f}});"use strict";k.when("A","ready").execute(function(a){function d(){e();
b()}function c(){var a=f(n.taxregistrationnumberInput).val();f(n.taxregistrationnumberInput).val(a.replace(k,""));a=f(n.businesslegalnameInput).val();f(n.businesslegalnameInput).val(a.trim());e();b()}function e(){var a=g(f(n.taxregistrationnumberInput).val()),b=g(f(n.businesslegalnameInput).val());a&&b?f(n.taxaddressform).attr("action",A.nonSifActionUrl):f(n.taxaddressform).attr("action",A.sifActionUrl)}function b(){var a=f(n.continueDeclarativeSpanId),b=a.find("span.a-button-text"),c;c=f(n.taxregistrationnumberInput).val();
var d=f(n.businesslegalnameInput).val();if(g(c)&&g(d))c=!0;else{var d=!d||g(d.toString().trim()),e=f(n.taxaddressRadio).length?f(n.taxaddressRadio+":checked").val():f(n.taxaddressSelection).val(),e=g(e);c=g(c)||!h.test(c)||d||e?!1:!0}c?a.removeClass("a-button-disabled").find('input[type\x3d"submit"]').removeAttr("disabled"):a.addClass("a-button-disabled").find('input[type\x3d"submit"]').attr("disabled","disabled");a=g(f(n.taxregistrationnumberInput).val())&&g(f(n.businesslegalnameInput).val())?A.continueButtonLabel:
A.saveAndContinueButtonLabel;f('input[type\x3d"submit"]').val(a);b&&b.text(a)}function g(a){return!a||0===a.toString().length}var f=a.$,h=/^\d{11}$/,k=/\s+/g,n={taxaddressform:"#taxAddressFormId",taxregistrationnumberInput:"#tax-registration-number-field-tr",businesslegalnameInput:"#business-legal-name-tr",taxaddressRadio:'input:radio[name\x3d"taxaddressid"]',taxaddressSelection:"#taxaddressid",continueDeclarativeSpanId:"span.#continue-submit-span"},A={};a.on("checkout:reload:taxaddressentry",function(){0!=
f("#continueButtonLabel").length&&(A.continueButtonLabel=f("#continueButtonLabel").text().trim(),A.saveAndContinueButtonLabel=f("#saveAndContinueButtonLabel").text().trim(),A.sifActionUrl=f("#sifActionUrl").text().trim(),A.nonSifActionUrl=f("#nonSifActionUrl").text().trim(),f(n.taxregistrationnumberInput).keyup(c).blur(c),f(n.businesslegalnameInput).keyup(d).blur(c),d())})})});
/* ******** */
